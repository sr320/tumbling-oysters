<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Tumbling Oysters</title>
<link>https://sr320.github.io/tumbling-oysters/</link>
<atom:link href="https://sr320.github.io/tumbling-oysters/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.6.40</generator>
<lastBuildDate>Wed, 12 Mar 2025 07:00:00 GMT</lastBuildDate>
<item>
  <title>OA OA OA</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/40-HawsOA/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid automatic execution</span></span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot width</span></span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot height</span></span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center align plots</span></span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents '##' in output</span></span>
<span id="cb1-10">)</span></code></pre></div>
</div>
<p>Lets redo the bismark with new genome.</p>
<section id="download-reads" class="level1">
<h1>Download Reads</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-P ../../data/Haws-10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*fq.gz"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">https://gannet.fish.washington.edu/spartina/project-oyster-oa/Haws/trimmed-data-2/</span></code></pre></div>
</div>
</section>
<section id="download-new-genome" class="level1">
<h1>Download new genome</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../../data/Haws-10</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/datasets</span> download genome accession GCF_963853765.1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include</span> gff3,rna,cds,protein,genome,seq-report</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> ../../data/Haws-10/ncbi_dataset.zip</span></code></pre></div>
</div>
</section>
<section id="genome-prep" class="level1">
<h1>Genome Prep</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directories and programs</span></span>
<span id="cb5-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/Bismark-0.24.0/"</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bowtie2-2.4.4-linux-x86_64/"</span></span>
<span id="cb5-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_genome_preparation</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">--verbose <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">--parallel 12 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9">--path_to_aligner <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span></span></code></pre></div>
</div>
</section>
<section id="checking-alignment-min-scores" class="level1">
<h1>Checking alignment min scores</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../../data/Haws-10/</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set directories and files</span></span>
<span id="cb7-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb7-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb7-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/"</span></span>
<span id="cb7-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">checkpoint_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/completed_samples.log"</span></span>
<span id="cb7-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/Bismark-0.24.0/"</span></span>
<span id="cb7-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bowtie2-2.4.4-linux-x86_64/"</span></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the checkpoint file if it doesn't exist</span></span>
<span id="cb7-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb7-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_val_2_val_2_val_2.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_val_2_val_2_val_2.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-15"></span>
<span id="cb7-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample has already been processed</span></span>
<span id="cb7-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-18">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already processed. Skipping..."</span></span>
<span id="cb7-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb7-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-21"></span>
<span id="cb7-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define log files for stdout and stderr</span></span>
<span id="cb7-23">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stdout_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stdout.log"</span></span>
<span id="cb7-24">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stderr.log"</span></span>
<span id="cb7-25"></span>
<span id="cb7-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the array of score_min parameters to test</span></span>
<span id="cb7-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-28">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.4"</span></span>
<span id="cb7-29">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.6"</span></span>
<span id="cb7-30">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.8"</span></span>
<span id="cb7-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-1.0"</span></span>
<span id="cb7-32">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,-1,-0.6"</span></span>
<span id="cb7-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-34"></span>
<span id="cb7-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through each score_min parameter</span></span>
<span id="cb7-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> score_min <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-37">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-38">        </span>
<span id="cb7-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a subdirectory for this parameter</span></span>
<span id="cb7-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">param_output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_score_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-41">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span></span>
<span id="cb7-42"></span>
<span id="cb7-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb7-44">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-45">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-46">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-47">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> 25000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-48">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-49">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-50">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-51">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_val_1_val_1_val_1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-52">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_val_2_val_2_val_2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-53">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-54">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span>_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-55">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb7-56"></span>
<span id="cb7-57">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the command was successful</span></span>
<span id="cb7-58">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-59">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> processed successfully."</span></span>
<span id="cb7-60">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb7-61">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> failed. Check </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> for details."</span></span>
<span id="cb7-62">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb7-64"></span>
<span id="cb7-65">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mark the sample as completed in the checkpoint file</span></span>
<span id="cb7-66">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-67">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb7-68">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All tests for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> completed."</span></span>
<span id="cb7-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb7-70">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> encountered errors. Check logs for details."</span></span>
<span id="cb7-71">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb7-73"></span>
<span id="cb7-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define summary file</span></span>
<span id="cb7-75"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/parameter_comparison_summary.csv"</span></span>
<span id="cb7-76"></span>
<span id="cb7-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize summary file</span></span>
<span id="cb7-78"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample,Score_Min,Alignment_Rate"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file}</span></span>
<span id="cb7-79"></span>
<span id="cb7-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through parameter output directories</span></span>
<span id="cb7-81"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dir <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_score_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-82">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-83">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name and score_min parameter from directory name</span></span>
<span id="cb7-84">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-85">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score_.*"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/score_//; s/_/,/g'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-86"></span>
<span id="cb7-87">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Locate the summary file</span></span>
<span id="cb7-88">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_PE_report.txt"</span></span>
<span id="cb7-89"></span>
<span id="cb7-90">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract metrics</span></span>
<span id="cb7-91">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$summary_file_path</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-92">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mapping</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mapping efficiency:"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file_path}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "mapping efficiency ", $3}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-93">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mapping}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file}</span></span>
<span id="cb7-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-96"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<p>Summary file does not, did manual inspection</p>
</section>
<section id="full-run" class="level1">
<h1>Full Run</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set variables</span></span>
<span id="cb8-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb8-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb8-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/"</span></span>
<span id="cb8-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.8"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Single value for score_min</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb8-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_val_2_val_2_val_2.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb8-9">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_val_2_val_2_val_2.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb8-10">    </span>
<span id="cb8-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-12"></span>
<span id="cb8-13">    </span>
<span id="cb8-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb8-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/Bismark-0.24.0/bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie2</span> /home/shared/bowtie2-2.4.4-linux-x86_64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_val_1_val_1_val_1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_val_2_val_2_val_2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb8-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<section id="deduplication" class="level2">
<h2 class="anchored" data-anchor-id="deduplication">Deduplication</h2>
<p>Notebook 14</p>
<p>/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 /home/shared/Bismark-0.24.0/deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-6">--output_dir /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-7">/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10/{}.bam</span></code></pre></div>
</div>
</section>
<section id="methylation-extraction" class="level2">
<h2 class="anchored" data-anchor-id="methylation-extraction">Methylation Extraction</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/Bismark-0.24.0/bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--multicore</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2">--output /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3">{} </span></code></pre></div>
</div>
</section>
<section id="methylation-calls" class="level2">
<h2 class="anchored" data-anchor-id="methylation-calls">Methylation Calls</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 48 /home/shared/Bismark-0.24.0/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">--genome_folder /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/data/Haws-10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">-o /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</div>
</section>
<section id="output" class="level2">
<h2 class="anchored" data-anchor-id="output">output</h2>
<p>https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-14/</p>
<pre><code>CpG_context_zr3644_10_pe.deduplicated.txt
CpG_context_zr3644_11_pe.deduplicated.txt
CpG_context_zr3644_12_pe.deduplicated.txt
CpG_context_zr3644_13_pe.deduplicated.txt
CpG_context_zr3644_14_pe.deduplicated.txt
CpG_context_zr3644_15_pe.deduplicated.txt
CpG_context_zr3644_16_pe.deduplicated.txt
CpG_context_zr3644_17_pe.deduplicated.txt
CpG_context_zr3644_18_pe.deduplicated.txt
CpG_context_zr3644_19_pe.deduplicated.txt
CpG_context_zr3644_1_pe.deduplicated.txt
CpG_context_zr3644_20_pe.deduplicated.txt
CpG_context_zr3644_21_pe.deduplicated.txt
CpG_context_zr3644_22_pe.deduplicated.txt
CpG_context_zr3644_23_pe.deduplicated.txt
CpG_context_zr3644_24_pe.deduplicated.txt
CpG_context_zr3644_2_pe.deduplicated.txt
CpG_context_zr3644_3_pe.deduplicated.txt
CpG_context_zr3644_4_pe.deduplicated.txt
CpG_context_zr3644_5_pe.deduplicated.txt
CpG_context_zr3644_6_pe.deduplicated.txt
CpG_context_zr3644_7_pe.deduplicated.txt
CpG_context_zr3644_8_pe.deduplicated.txt
CpG_context_zr3644_9_pe.deduplicated.txt
Non_CpG_context_zr3644_10_pe.deduplicated.txt
Non_CpG_context_zr3644_11_pe.deduplicated.txt
Non_CpG_context_zr3644_12_pe.deduplicated.txt
Non_CpG_context_zr3644_13_pe.deduplicated.txt
Non_CpG_context_zr3644_14_pe.deduplicated.txt
Non_CpG_context_zr3644_15_pe.deduplicated.txt
Non_CpG_context_zr3644_16_pe.deduplicated.txt
Non_CpG_context_zr3644_17_pe.deduplicated.txt
Non_CpG_context_zr3644_18_pe.deduplicated.txt
Non_CpG_context_zr3644_19_pe.deduplicated.txt
Non_CpG_context_zr3644_1_pe.deduplicated.txt
Non_CpG_context_zr3644_20_pe.deduplicated.txt
Non_CpG_context_zr3644_21_pe.deduplicated.txt
Non_CpG_context_zr3644_22_pe.deduplicated.txt
Non_CpG_context_zr3644_23_pe.deduplicated.txt
Non_CpG_context_zr3644_24_pe.deduplicated.txt
Non_CpG_context_zr3644_2_pe.deduplicated.txt
Non_CpG_context_zr3644_3_pe.deduplicated.txt
Non_CpG_context_zr3644_4_pe.deduplicated.txt
Non_CpG_context_zr3644_5_pe.deduplicated.txt
Non_CpG_context_zr3644_6_pe.deduplicated.txt
Non_CpG_context_zr3644_7_pe.deduplicated.txt
Non_CpG_context_zr3644_8_pe.deduplicated.txt
Non_CpG_context_zr3644_9_pe.deduplicated.txt
zr3644_10.CpG_report.merged_CpG_evidence.cov
zr3644_10.CpG_report.txt
zr3644_10.cytosine_context_summary.txt
zr3644_10_pe.deduplicated.bam
zr3644_10_pe.deduplicated.bedGraph.gz
zr3644_10_pe.deduplicated.bismark.cov.gz
zr3644_10_pe.deduplicated.M-bias.txt
zr3644_10_pe.deduplicated_splitting_report.txt
zr3644_10_pe.deduplication_report.txt
zr3644_11.CpG_report.merged_CpG_evidence.cov
zr3644_11.CpG_report.txt
zr3644_11.cytosine_context_summary.txt
zr3644_11_pe.deduplicated.bam
zr3644_11_pe.deduplicated.bedGraph.gz
zr3644_11_pe.deduplicated.bismark.cov.gz
zr3644_11_pe.deduplicated.M-bias.txt
zr3644_11_pe.deduplicated_splitting_report.txt
zr3644_11_pe.deduplication_report.txt
zr3644_12.CpG_report.merged_CpG_evidence.cov
zr3644_12.CpG_report.txt
zr3644_12.cytosine_context_summary.txt
zr3644_12_pe.deduplicated.bam
zr3644_12_pe.deduplicated.bedGraph.gz
zr3644_12_pe.deduplicated.bismark.cov.gz
zr3644_12_pe.deduplicated.M-bias.txt
zr3644_12_pe.deduplicated_splitting_report.txt
zr3644_12_pe.deduplication_report.txt
zr3644_13.CpG_report.merged_CpG_evidence.cov
zr3644_13.CpG_report.txt
zr3644_13.cytosine_context_summary.txt
zr3644_13_pe.deduplicated.bam
zr3644_13_pe.deduplicated.bedGraph.gz
zr3644_13_pe.deduplicated.bismark.cov.gz
zr3644_13_pe.deduplicated.M-bias.txt
zr3644_13_pe.deduplicated_splitting_report.txt
zr3644_13_pe.deduplication_report.txt
zr3644_14.CpG_report.merged_CpG_evidence.cov
zr3644_14.CpG_report.txt
zr3644_14.cytosine_context_summary.txt
zr3644_14_pe.deduplicated.bam
zr3644_14_pe.deduplicated.bedGraph.gz
zr3644_14_pe.deduplicated.bismark.cov.gz
zr3644_14_pe.deduplicated.M-bias.txt
zr3644_14_pe.deduplicated_splitting_report.txt
zr3644_14_pe.deduplication_report.txt
zr3644_15.CpG_report.merged_CpG_evidence.cov
zr3644_15.CpG_report.txt
zr3644_15.cytosine_context_summary.txt
zr3644_15_pe.deduplicated.bam
zr3644_15_pe.deduplicated.bedGraph.gz
zr3644_15_pe.deduplicated.bismark.cov.gz
zr3644_15_pe.deduplicated.M-bias.txt
zr3644_15_pe.deduplicated_splitting_report.txt
zr3644_15_pe.deduplication_report.txt
zr3644_16.CpG_report.merged_CpG_evidence.cov
zr3644_16.CpG_report.txt
zr3644_16.cytosine_context_summary.txt
zr3644_16_pe.deduplicated.bam
zr3644_16_pe.deduplicated.bedGraph.gz
zr3644_16_pe.deduplicated.bismark.cov.gz
zr3644_16_pe.deduplicated.M-bias.txt
zr3644_16_pe.deduplicated_splitting_report.txt
zr3644_16_pe.deduplication_report.txt
zr3644_17.CpG_report.merged_CpG_evidence.cov
zr3644_17.CpG_report.txt
zr3644_17.cytosine_context_summary.txt
zr3644_17_pe.deduplicated.bam
zr3644_17_pe.deduplicated.bedGraph.gz
zr3644_17_pe.deduplicated.bismark.cov.gz
zr3644_17_pe.deduplicated.M-bias.txt
zr3644_17_pe.deduplicated_splitting_report.txt
zr3644_17_pe.deduplication_report.txt
zr3644_18.CpG_report.merged_CpG_evidence.cov
zr3644_18.CpG_report.txt
zr3644_18.cytosine_context_summary.txt
zr3644_18_pe.deduplicated.bam
zr3644_18_pe.deduplicated.bedGraph.gz
zr3644_18_pe.deduplicated.bismark.cov.gz
zr3644_18_pe.deduplicated.M-bias.txt
zr3644_18_pe.deduplicated_splitting_report.txt
zr3644_18_pe.deduplication_report.txt
zr3644_19.CpG_report.merged_CpG_evidence.cov
zr3644_19.CpG_report.txt
zr3644_19.cytosine_context_summary.txt
zr3644_19_pe.deduplicated.bam
zr3644_19_pe.deduplicated.bedGraph.gz
zr3644_19_pe.deduplicated.bismark.cov.gz
zr3644_19_pe.deduplicated.M-bias.txt
zr3644_19_pe.deduplicated_splitting_report.txt
zr3644_19_pe.deduplication_report.txt
zr3644_1.CpG_report.merged_CpG_evidence.cov
zr3644_1.CpG_report.txt
zr3644_1.cytosine_context_summary.txt
zr3644_1_pe.deduplicated.bam
zr3644_1_pe.deduplicated.bedGraph.gz
zr3644_1_pe.deduplicated.bismark.cov.gz
zr3644_1_pe.deduplicated.M-bias.txt
zr3644_1_pe.deduplicated_splitting_report.txt
zr3644_1_pe.deduplication_report.txt
zr3644_20.CpG_report.merged_CpG_evidence.cov
zr3644_20.CpG_report.txt
zr3644_20.cytosine_context_summary.txt
zr3644_20_pe.deduplicated.bam
zr3644_20_pe.deduplicated.bedGraph.gz
zr3644_20_pe.deduplicated.bismark.cov.gz
zr3644_20_pe.deduplicated.M-bias.txt
zr3644_20_pe.deduplicated_splitting_report.txt
zr3644_20_pe.deduplication_report.txt
zr3644_21.CpG_report.merged_CpG_evidence.cov
zr3644_21.CpG_report.txt
zr3644_21.cytosine_context_summary.txt
zr3644_21_pe.deduplicated.bam
zr3644_21_pe.deduplicated.bedGraph.gz
zr3644_21_pe.deduplicated.bismark.cov.gz
zr3644_21_pe.deduplicated.M-bias.txt
zr3644_21_pe.deduplicated_splitting_report.txt
zr3644_21_pe.deduplication_report.txt
zr3644_22.CpG_report.merged_CpG_evidence.cov
zr3644_22.CpG_report.txt
zr3644_22.cytosine_context_summary.txt
zr3644_22_pe.deduplicated.bam
zr3644_22_pe.deduplicated.bedGraph.gz
zr3644_22_pe.deduplicated.bismark.cov.gz
zr3644_22_pe.deduplicated.M-bias.txt
zr3644_22_pe.deduplicated_splitting_report.txt
zr3644_22_pe.deduplication_report.txt
zr3644_23.CpG_report.merged_CpG_evidence.cov
zr3644_23.CpG_report.txt
zr3644_23.cytosine_context_summary.txt
zr3644_23_pe.deduplicated.bam
zr3644_23_pe.deduplicated.bedGraph.gz
zr3644_23_pe.deduplicated.bismark.cov.gz
zr3644_23_pe.deduplicated.M-bias.txt
zr3644_23_pe.deduplicated_splitting_report.txt
zr3644_23_pe.deduplication_report.txt
zr3644_24.CpG_report.merged_CpG_evidence.cov
zr3644_24.CpG_report.txt
zr3644_24.cytosine_context_summary.txt
zr3644_24_pe.deduplicated.bam
zr3644_24_pe.deduplicated.bedGraph.gz
zr3644_24_pe.deduplicated.bismark.cov.gz
zr3644_24_pe.deduplicated.M-bias.txt
zr3644_24_pe.deduplicated_splitting_report.txt
zr3644_24_pe.deduplication_report.txt
zr3644_2.CpG_report.merged_CpG_evidence.cov
zr3644_2.CpG_report.txt
zr3644_2.cytosine_context_summary.txt
zr3644_2_pe.deduplicated.bam
zr3644_2_pe.deduplicated.bedGraph.gz
zr3644_2_pe.deduplicated.bismark.cov.gz
zr3644_2_pe.deduplicated.M-bias.txt
zr3644_2_pe.deduplicated_splitting_report.txt
zr3644_2_pe.deduplication_report.txt
zr3644_3.CpG_report.merged_CpG_evidence.cov
zr3644_3.CpG_report.txt
zr3644_3.cytosine_context_summary.txt
zr3644_3_pe.deduplicated.bam
zr3644_3_pe.deduplicated.bedGraph.gz
zr3644_3_pe.deduplicated.bismark.cov.gz
zr3644_3_pe.deduplicated.M-bias.txt
zr3644_3_pe.deduplicated_splitting_report.txt
zr3644_3_pe.deduplication_report.txt
zr3644_4.CpG_report.merged_CpG_evidence.cov
zr3644_4.CpG_report.txt
zr3644_4.cytosine_context_summary.txt
zr3644_4_pe.deduplicated.bam
zr3644_4_pe.deduplicated.bedGraph.gz
zr3644_4_pe.deduplicated.bismark.cov.gz
zr3644_4_pe.deduplicated.M-bias.txt
zr3644_4_pe.deduplicated_splitting_report.txt
zr3644_4_pe.deduplication_report.txt
zr3644_5.CpG_report.merged_CpG_evidence.cov
zr3644_5.CpG_report.txt
zr3644_5.cytosine_context_summary.txt
zr3644_5_pe.deduplicated.bam
zr3644_5_pe.deduplicated.bedGraph.gz
zr3644_5_pe.deduplicated.bismark.cov.gz
zr3644_5_pe.deduplicated.M-bias.txt
zr3644_5_pe.deduplicated_splitting_report.txt
zr3644_5_pe.deduplication_report.txt
zr3644_6.CpG_report.merged_CpG_evidence.cov
zr3644_6.CpG_report.txt
zr3644_6.cytosine_context_summary.txt
zr3644_6_pe.deduplicated.bam
zr3644_6_pe.deduplicated.bedGraph.gz
zr3644_6_pe.deduplicated.bismark.cov.gz
zr3644_6_pe.deduplicated.M-bias.txt
zr3644_6_pe.deduplicated_splitting_report.txt
zr3644_6_pe.deduplication_report.txt
zr3644_7.CpG_report.merged_CpG_evidence.cov
zr3644_7.CpG_report.txt
zr3644_7.cytosine_context_summary.txt
zr3644_7_pe.deduplicated.bam
zr3644_7_pe.deduplicated.bedGraph.gz
zr3644_7_pe.deduplicated.bismark.cov.gz
zr3644_7_pe.deduplicated.M-bias.txt
zr3644_7_pe.deduplicated_splitting_report.txt
zr3644_7_pe.deduplication_report.txt
zr3644_8.CpG_report.merged_CpG_evidence.cov
zr3644_8.CpG_report.txt
zr3644_8.cytosine_context_summary.txt
zr3644_8_pe.deduplicated.bam
zr3644_8_pe.deduplicated.bedGraph.gz
zr3644_8_pe.deduplicated.bismark.cov.gz
zr3644_8_pe.deduplicated.M-bias.txt
zr3644_8_pe.deduplicated_splitting_report.txt
zr3644_8_pe.deduplication_report.txt
zr3644_9.CpG_report.merged_CpG_evidence.cov
zr3644_9.CpG_report.txt
zr3644_9.cytosine_context_summary.txt
zr3644_9_pe.deduplicated.bam
zr3644_9_pe.deduplicated.bedGraph.gz
zr3644_9_pe.deduplicated.bismark.cov.gz
zr3644_9_pe.deduplicated.M-bias.txt
zr3644_9_pe.deduplicated_splitting_report.txt
zr3644_9_pe.deduplication_report.txt</code></pre>


<!-- -->

</section>
</section>

 ]]></description>
  <category>oyster</category>
  <category>methylation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/40-HawsOA/</guid>
  <pubDate>Wed, 12 Mar 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-oyster-oa__RStudio_Server_2025-02-28_18-24-54.png" medium="image" type="image/png"/>
</item>
<item>
  <title>lncRNA Discovery Pipeline</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/39-lncRNA/</link>
  <description><![CDATA[ 





<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This lab notebook documents the process of identifying long non-coding RNAs (lncRNAs) from RNA-seq data. The pipeline includes data acquisition, genome alignment, transcript assembly, filtering, and classification.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid automatic execution</span></span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot width</span></span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot height</span></span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center align plots</span></span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents '##' in output</span></span>
<span id="cb1-10">)</span></code></pre></div>
</div>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb2-2">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb2-5"> </span>
<span id="cb2-6">DATA_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/01-lncRNA"</span></span>
<span id="cb2-7">OUTPUT_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-lncRNA"</span></span>
<span id="cb2-8">THREADS <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"42"</span></span>
<span id="cb2-9">  </span>
<span id="cb2-10">FASTQ_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20230519-E5_coral-fastqc-fastp-multiqc-RNAseq/P_meandrina/trimmed/"</span></span>
<span id="cb2-11">FASTQ_SUFFIX <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq.gz"</span></span>
<span id="cb2-12">GENOME_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://owl.fish.washington.edu/halfshell/genomic-databank/Pocillopora_meandrina_HIv1.assembly.fasta"</span></span>
<span id="cb2-13"></span>
<span id="cb2-14"></span>
<span id="cb2-15">GTF_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/d5f546705e3df40558eeaa5c18b122c79d2f4453/F-Ptua/data/Pocillopora_meandrina_HIv1.genes-validated.gtf"</span></span>
<span id="cb2-16">GFF_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/deep-dive-expression/F-Ptuh/data/Pocillopora_meandrina_HIv1.genes-validated.gff3"</span></span>
<span id="cb2-17"></span>
<span id="cb2-18">GFFPATTERN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"|class_code "x"|class_code "o"|class_code "i"'</span></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#RAVEN</span></span>
<span id="cb2-21">HISAT2_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/hisat2-2.2.1/"</span></span>
<span id="cb2-22">SAMTOOLS_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/samtools-1.12/"</span></span>
<span id="cb2-23">STRINGTIE_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/stringtie-2.2.1.Linux_x86_64"</span></span>
<span id="cb2-24">GFFCOMPARE_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/gffcompare-0.12.6.Linux_x86_64"</span></span>
<span id="cb2-25">BEDTOOLS_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bedtools2/bin"</span></span>
<span id="cb2-26">CPC2_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/CPC2_standalone-1.0.1"</span></span>
<span id="cb2-27">CONDA_PATH <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/anaconda/anaconda3/bin/conda"</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#KLONE</span></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HISAT2_DIR &lt;- ""</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SAMTOOLS_DIR &lt;- ""</span></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># STRINGTIE_DIR &lt;- ""</span></span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GFFCOMPARE_DIR &lt;- "/srlab/programs/gffcompare-0.12.6.Linux_x86_64/"</span></span>
<span id="cb2-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BEDTOOLS_DIR &lt;- ""</span></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPC2_DIR &lt;- "/srlab/programs/CPC2_standalone-1.0.1/bin/"</span></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CONDA_PATH &lt;- ""</span></span>
<span id="cb2-37"></span>
<span id="cb2-38">GENOME_FASTA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.fasta"</span>)</span>
<span id="cb2-39">GENOME_GTF <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gtf"</span>)</span>
<span id="cb2-40">GENOME_GFF <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gff"</span>)</span>
<span id="cb2-41">FASTQ_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq"</span>)</span>
<span id="cb2-42">GENOME_INDEX <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(OUTPUT_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.index"</span>)</span>
<span id="cb2-43"></span>
<span id="cb2-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb2-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(</span>
<span id="cb2-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">THREADS =</span> THREADS,</span>
<span id="cb2-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">DATA_DIR =</span> DATA_DIR,</span>
<span id="cb2-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_SOURCE =</span> FASTQ_SOURCE,</span>
<span id="cb2-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX =</span> FASTQ_SUFFIX,</span>
<span id="cb2-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OUTPUT_DIR =</span> OUTPUT_DIR,</span>
<span id="cb2-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_SOURCE =</span> GENOME_SOURCE,</span>
<span id="cb2-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GTF_SOURCE =</span> GTF_SOURCE,</span>
<span id="cb2-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GFF_SOURCE =</span> GFF_SOURCE,</span>
<span id="cb2-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HISAT2_DIR =</span> HISAT2_DIR,</span>
<span id="cb2-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR =</span> SAMTOOLS_DIR,</span>
<span id="cb2-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">STRINGTIE_DIR =</span> STRINGTIE_DIR,</span>
<span id="cb2-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR =</span> GFFCOMPARE_DIR,</span>
<span id="cb2-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR =</span> BEDTOOLS_DIR,</span>
<span id="cb2-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CPC2_DIR =</span> CPC2_DIR,</span>
<span id="cb2-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CONDA_PATH =</span> CONDA_PATH,</span>
<span id="cb2-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_FASTA =</span> GENOME_FASTA,</span>
<span id="cb2-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_GTF =</span> GENOME_GTF,</span>
<span id="cb2-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_GFF =</span> GENOME_GFF,</span>
<span id="cb2-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_DIR =</span> FASTQ_DIR,</span>
<span id="cb2-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_INDEX =</span> GENOME_INDEX</span>
<span id="cb2-66">)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DATA_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
</section>
<section id="download-genome-and-reads-for-hisat" class="level1">
<h1>Download Genome and Reads for Hisat</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">-P <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SOURCE}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GTF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gtf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FAIL - FFS you downloaded a HTML not and genome feature file!"</span></span>
<span id="cb9-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</div>
</section>
<section id="hisat" class="level1">
<h1>HISAT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_exons.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_splice_sites.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"></span>
<span id="cb11-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2-build"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--exon</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ss</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-build_stats.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over every file ending in .fastq.gz that contains "_R2_"</span></span>
<span id="cb12-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb12-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the basename (filename without path)</span></span>
<span id="cb12-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-5">    </span>
<span id="cb12-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Derive a sample name by taking everything before "_R2_"</span></span>
<span id="cb12-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-8">    </span>
<span id="cb12-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding R1 filename by replacing "_R2_" with "_R1_"</span></span>
<span id="cb12-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${r2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_R2_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>_R1_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-11">    </span>
<span id="cb12-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the output SAM file name using the sample name</span></span>
<span id="cb12-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sam"</span></span>
<span id="cb12-14">    </span>
<span id="cb12-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run hisat2 with the paired-end files</span></span>
<span id="cb12-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<section id="convert-sam-to-bam" class="level2">
<h2 class="anchored" data-anchor-id="convert-sam-to-bam">convert SAM to BAM</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> samfile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-2">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.bam"</span></span>
<span id="cb13-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb13-4">  </span>
<span id="cb13-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert SAM to BAM</span></span>
<span id="cb13-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$samfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-7">  </span>
<span id="cb13-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort BAM</span></span>
<span id="cb13-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-10">  </span>
<span id="cb13-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index sorted BAM</span></span>
<span id="cb13-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> index <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
</section>
<section id="stringtie" class="level1">
<h1>StringTie</h1>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples–an important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-4">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-5">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-6">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.sorted.bam"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-3">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<p>#GFFCOMPARE</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFCOMPARE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gffcompare"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-3">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged.annotated.gtf"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="bedtools" class="level1">
<h1>Bedtools</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BEDTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> getfasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-2">-fi <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-3">-bed <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-4">-fo <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
</div>
<p>#CPC2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb20-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CPC2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-3">-i <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2"</span></span></code></pre></div>
</div>
<p>Filter</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<p>Subsetting fasta</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> faidx <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define input and output file paths using the OUTPUT_DIR variable</span></span>
<span id="cb24-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb24-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span>
<span id="cb24-4"></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line of the input file</span></span>
<span id="cb24-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb24-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "transcript::" from the line</span></span>
<span id="cb24-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">transcript::</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-9">    </span>
<span id="cb24-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the line by ':' to get the chromosome and position string</span></span>
<span id="cb24-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chromosome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pos</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$line</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-12">    </span>
<span id="cb24-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position string by '-' to separate start and end positions</span></span>
<span id="cb24-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">end</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pos</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-15">    </span>
<span id="cb24-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb24-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((start</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb24-18">    </span>
<span id="cb24-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, updated start, and end positions to the output file (tab-separated)</span></span>
<span id="cb24-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\t%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$chromosome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$start</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$end</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$input</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb27-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN {</span></span>
<span id="cb27-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries = 0;</span></span>
<span id="cb27-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    min_length = 1e9;</span></span>
<span id="cb27-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    max_length = 0;</span></span>
<span id="cb27-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length = 0;</span></span>
<span id="cb27-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"># Skip comment lines</span></span>
<span id="cb27-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/^#/ { next }</span></span>
<span id="cb27-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb27-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (NF &lt; 9) next;</span></span>
<span id="cb27-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries++;</span></span>
<span id="cb27-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    start = $4;</span></span>
<span id="cb27-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    end = $5;</span></span>
<span id="cb27-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    gene_length = end - start + 1;</span></span>
<span id="cb27-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &lt; min_length) min_length = gene_length;</span></span>
<span id="cb27-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &gt; max_length) max_length = gene_length;</span></span>
<span id="cb27-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length += gene_length;</span></span>
<span id="cb27-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    feature[$3]++;</span></span>
<span id="cb27-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    chrom[$1]++;</span></span>
<span id="cb27-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    # Use two-argument match() and then extract the gene_id manually.</span></span>
<span id="cb27-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (match($9, /gene_id "[^"]+"/)) {</span></span>
<span id="cb27-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gene_str = substr($9, RSTART, RLENGTH);</span></span>
<span id="cb27-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Remove the "gene_id " prefix and the quotes.</span></span>
<span id="cb27-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/gene_id "/, "", gene_str);</span></span>
<span id="cb27-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/"/, "", gene_str);</span></span>
<span id="cb27-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        genes[gene_str] = 1;</span></span>
<span id="cb27-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">END {</span></span>
<span id="cb27-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    avg_length = (total_entries &gt; 0) ? sum_length / total_entries : 0;</span></span>
<span id="cb27-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    unique_gene_count = 0;</span></span>
<span id="cb27-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (g in genes)</span></span>
<span id="cb27-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        unique_gene_count++;</span></span>
<span id="cb27-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Basic GTF File Statistics:";</span></span>
<span id="cb27-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "--------------------------";</span></span>
<span id="cb27-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Total entries:      " total_entries;</span></span>
<span id="cb27-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Unique genes:       " unique_gene_count;</span></span>
<span id="cb27-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Min gene length:    " min_length;</span></span>
<span id="cb27-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Max gene length:    " max_length;</span></span>
<span id="cb27-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    printf("Average gene length: %.2f\n", avg_length);</span></span>
<span id="cb27-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nFeature counts:";</span></span>
<span id="cb27-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (f in feature) {</span></span>
<span id="cb27-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " f ": " feature[f];</span></span>
<span id="cb27-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nChromosome counts:";</span></span>
<span id="cb27-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (c in chrom) {</span></span>
<span id="cb27-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " c ": " chrom[c];</span></span>
<span id="cb27-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$tf_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>lncRNA)</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/39-lncRNA/</guid>
  <pubDate>Fri, 28 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_bestblogever_-_main_-_RStudio_2025-02-28_08-51-47.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Please Klone me</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/38-klone/</link>
  <description><![CDATA[ 





<p>Let’s get everyone up an running with Klone and RStudio.</p>
<section id="log-in" class="level1">
<h1>Log in</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@Stevens-MacBook-Air-184</span> ~ % ssh sr320@klone.hyak.uw.edu</span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@klone.hyak.uw.edu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Password:</span> </span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@klone.hyak.uw.edu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Duo</span> two-factor login for sr320</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a passcode or select one of the following options:</span>
<span id="cb1-6"></span>
<span id="cb1-7"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> Duo Push to XXX-XXX-3626</span>
<span id="cb1-8"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> Duo Push to iOS</span>
<span id="cb1-9"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span> Phone call to XXX-XXX-3626</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Passcode</span> or option <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1-3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1</span></code></pre></div>
</div>
</section>
<section id="cd-to-srlab-directory" class="level1">
<h1>CD to srlab directory</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /gscratch/srlab/</span></code></pre></div>
</div>
<p>Create user directory in srlab (if not present)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> sr320</span></code></pre></div>
</div>
</section>
<section id="add-containers-to-your-local-directory" class="level1">
<h1>Add containers to your local directory</h1>
<pre><code>-rwxr-xr-x 1 samwhite all   3311583232 2024-12-04 srlab-bioinformatics-container-09dfcb2.sif
-rwxrwxr-x 1 samwhite srlab 2985074688 2024-10-17 srlab-bioinformatics-container-2bd5d44.sif
-rwxr-xr-x 1 samwhite all   3008335872 2024-11-06 srlab-bioinformatics-container-586bf21.sif
-rwxr-xr-x 1 samwhite all   3008442368 2024-11-07 srlab-bioinformatics-container-f4142f4.sif
-rwxr-xr-x 1 samwhite all   3380895744 2025-01-04 srlab-R4.4-bioinformatics-container-703094b.sif</code></pre>
<p>Specifically <code>srlab-R4.4-bioinformatics-container-703094b.sif</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#within user directory</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> ../containers/srlab-R4.4-bioinformatics-container-703094b.sif . </span></code></pre></div>
</div>
<p>See Footnotes for more information on containers.</p>
</section>
<section id="slurm-job-script" class="level1">
<h1>SLURM JOB SCRIPT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> ../sr320/rstudio-server.job .</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>User needs to (maybe) set/change the following in the SLURM script before starting script:</p>
<ul>
<li><p><code>#SBATCH --partition=</code></p></li>
<li><p><code>#SBATCH --time=</code></p></li>
<li><p><code>#SBATCH --cpus-per-task=</code></p></li>
<li><p><code>#SBATCH --mem=</code></p></li>
<li><p><code>#SBATCH --chdir=</code></p></li>
<li><p><code>RSTUDIO_CWD="/gscratch/srlab/sr320" # UPDATE THIS LINE</code></p></li>
<li><p><code>RSTUDIO_SIF="srlab-R4.4-bioinformatics-container-703094b.sif" # UPDATE THIS LINE</code></p></li>
</ul></li>
</ul>
</div>
</div>
<section id="partition-options" class="level2">
<h2 class="anchored" data-anchor-id="partition-options">Partition Options</h2>
<p><code>cpu-g2-mem2x</code> or <code>ckpt</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[sr320@klone-login03</span> containers]$ hyakalloc</span>
<span id="cb7-2">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Account</span> resources available to user: sr320        </span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╭─────────┬──────────────┬──────┬────────┬──────┬───────╮</span></span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> Account │    Partition │ CPUs │ Memory │ GPUs │       │</span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├─────────┼──────────────┼──────┼────────┼──────┼───────┤</span></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   srlab │ cpu-g2-mem2x │   32 │   490G │    0 │ TOTAL │</span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>         │              │   12 │   100G │    0 │ USED  │</span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>         │              │   20 │   390G │    0 │ FREE  │</span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╰─────────┴──────────────┴──────┴────────┴──────┴───────╯</span></span>
<span id="cb7-10"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Checkpoint</span> Resources  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ckpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╭───────┬──────┬──────╮</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>       │ CPUs │ GPUs │</span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├───────┼──────┼──────┤</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> Idle: │ 4557 │  148 │</span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╰───────┴──────┴──────╯</span></span></code></pre></div>
</div>
<p>Open</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nano</span> rstudio-server.job</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/sh</span></span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=rstudio-server</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=cpu-g2-mem2x #update this line - use hyakalloc to find partitions you can use</span></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=15-08:00:00</span></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks=1              # Number of tasks</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --cpus-per-task=12     # Increased threads from 4 to 8</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=100G</span></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=USR2</span></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=%x_%j.out</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb9-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/srlab/sr320</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This script will request a single CPU with four threads with 20GB of RAM for 2 hours. </span></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># You can adjust --time, --nodes, --ntasks, and --mem above to adjust these settings for your session.</span></span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --output=%x_%j.out creates a output file called rstudio-server_NNNNNNNN.out </span></span>
<span id="cb9-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where the %x is short hand for --job-name above and the N's are an 8-digit </span></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># jobID assigned by SLURM when our job is submitted.</span></span>
<span id="cb9-22"></span>
<span id="cb9-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_CWD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sr320"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># UPDATE THIS LINE</span></span>
<span id="cb9-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_SIF</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srlab-R4.4-bioinformatics-container-703094b.sif"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># UPDATE THIS LINE</span></span>
<span id="cb9-25"></span>
<span id="cb9-26"></span>
<span id="cb9-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create temp directory for ephemeral content to bind-mount in the container</span></span>
<span id="cb9-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_TMP</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/usr/bin/python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import tempfile; print(tempfile.mkdtemp())'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-29"></span>
<span id="cb9-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> 700 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/run <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/tmp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/var/lib/rstudio-server</span>
<span id="cb9-34"></span>
<span id="cb9-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/database.conf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">provider=sqlite</span></span>
<span id="cb9-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">directory=/var/lib/rstudio-server</span></span>
<span id="cb9-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-39"></span>
<span id="cb9-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set OMP_NUM_THREADS to prevent OpenBLAS (and any other OpenMP-enhanced</span></span>
<span id="cb9-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># libraries used by R) from spawning more threads than the number of processors</span></span>
<span id="cb9-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># allocated to the job.</span></span>
<span id="cb9-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb9-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set R_LIBS_USER to a path specific to rocker/rstudio to avoid conflicts with</span></span>
<span id="cb9-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># personal libraries from any R installation in the host environment</span></span>
<span id="cb9-46"></span>
<span id="cb9-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/rsession.sh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#!/bin/sh</span></span>
<span id="cb9-49"></span>
<span id="cb9-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export OMP_NUM_THREADS=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_JOB_CPUS_PER_NODE}</span></span>
<span id="cb9-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export R_LIBS_USER=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/R</span></span>
<span id="cb9-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">exec /usr/lib/rstudio-server/bin/rsession "</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{@}"</span></span>
<span id="cb9-53"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-54"></span>
<span id="cb9-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/rsession.sh</span>
<span id="cb9-56"></span>
<span id="cb9-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINER_BIND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,/gscratch:/gscratch,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/run:/run,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmp:/tmp,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/database.conf:/etc/rstudio/database.conf,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rsession.sh:/etc/rstudio/rsession.sh,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/var/lib/rstudio-server:/var/lib/rstudio-server"</span></span>
<span id="cb9-58"></span>
<span id="cb9-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do not suspend idle sessions.</span></span>
<span id="cb9-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alternative to setting session-timeout-minutes=0 in /etc/rstudio/rsession.conf</span></span>
<span id="cb9-61"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_RSTUDIO_SESSION_TIMEOUT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb9-62"></span>
<span id="cb9-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_USER</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">id</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-un</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-64"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_PASSWORD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">openssl</span> rand <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-base64</span> 15<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-65"></span>
<span id="cb9-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get unused socket per https://unix.stackexchange.com/a/132524</span></span>
<span id="cb9-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tiny race condition between the python &amp; apptainer commands</span></span>
<span id="cb9-68"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">readonly</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PORT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/mmfs1/sw/pyenv/versions/3.9.5/bin/python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import socket; s=socket.socket(); s.bind(("", 0)); print(s.getsockname()[1]); s.close()'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. SSH tunnel from your workstation using the following command:</span></span>
<span id="cb9-71"></span>
<span id="cb9-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ssh -N -L 8787:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HOSTNAME}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PORT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">@klone.hyak.uw.edu</span></span>
<span id="cb9-73"></span>
<span id="cb9-74"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   and point your web browser to http://localhost:8787</span></span>
<span id="cb9-75"></span>
<span id="cb9-76"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. log in to RStudio Server using the following credentials:</span></span>
<span id="cb9-77"></span>
<span id="cb9-78"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   user: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span></span>
<span id="cb9-79"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   password: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_PASSWORD}</span></span>
<span id="cb9-80"></span>
<span id="cb9-81"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">When done using RStudio Server, terminate the job by:</span></span>
<span id="cb9-82"></span>
<span id="cb9-83"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. Exit the RStudio Session ("power" button in the top right corner of the RStudio window)</span></span>
<span id="cb9-84"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. Issue the following command on the login node:</span></span>
<span id="cb9-85"></span>
<span id="cb9-86"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      scancel -f </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_JOB_ID}</span></span>
<span id="cb9-87"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-88"></span>
<span id="cb9-89"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> /etc/bashrc</span>
<span id="cb9-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load apptainer</span>
<span id="cb9-91"></span>
<span id="cb9-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cleanenv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--home</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_SIF}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-93">    rserver <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--www-port</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PORT}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-94">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-none</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-95">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-pam-helper-path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pam-helper <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-96">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-stay-signed-in-days</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>30 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-97">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-timeout-minutes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-98">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rsession-path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/etc/rstudio/rsession.sh <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-99">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--server-user</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span></span>
<span id="cb9-100"></span>
<span id="cb9-101"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINER_EXIT_CODE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span></span>
<span id="cb9-102"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rserver exited </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$APPTAINER_EXIT_CODE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-103"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$APPTAINER_EXIT_CODE</span></span></code></pre></div>
</div>
</section>
</section>
<section id="run" class="level1">
<h1>Run</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> rstudio-server.job</span></code></pre></div>
</div>
</section>
<section id="folllow-instructions-in-output-file-to-connect-to-rstudio." class="level1">
<h1>Folllow Instructions in output file to connect to RStudio.</h1>
<p>eg</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> SSH tunnel from your workstation using the following command:</span>
<span id="cb11-2"></span>
<span id="cb11-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-N</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 8787:n3263:56093 sr320@klone.hyak.uw.edu</span>
<span id="cb11-4"></span>
<span id="cb11-5">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">and</span> point your web browser to http://localhost:8787</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> log in to RStudio Server using the following credentials:</span>
<span id="cb11-8"></span>
<span id="cb11-9">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user:</span> sr320</span>
<span id="cb11-10">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">password:</span> PDQlr876755PgP3g37c</span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">When</span> done using RStudio Server, terminate the job by:</span>
<span id="cb11-13"></span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> Exit the RStudio Session <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"power"</span> button in the top right corner of the RStudio window<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> Issue the following command on the login node:</span>
<span id="cb11-16"></span>
<span id="cb11-17">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scancel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> 24359989</span></code></pre></div>
</div>
</section>
<section id="footnotes" class="level1">
<h1>Footnotes</h1>
<pre><code>srlab-bioinformatics-container-&lt;git commit hash&gt;.sif: A "catch-all" container which holds most of the commonly used bioinformatics software
used by the Roberts Lab. The &lt;git commit hash&gt; is taken from the definition file used to construct the container. The definition file can be found at
/gscratch/srlab/gitrepos/RobertsLab/code/apptainer_definition_files/srlab-bioinformatics-container.def.</code></pre>
<section id="definition-file" class="level2">
<h2 class="anchored" data-anchor-id="definition-file">Definition File</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[sr320@klone-login03</span> containers]$ cat /gscratch/srlab/gitrepos/RobertsLab/code/apptainer_definition_files/srlab-bioinformatics-container.def</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To use RepeatMasker with this container, RepeatMasker must be installed on the local computer in the following location:</span></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker</span></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RepeatMasker must be configured on the local computer prior to running via this container.</span></span>
<span id="cb14-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The container expects the following files:</span></span>
<span id="cb14-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb14-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5</span></span>
<span id="cb14-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config</span></span>
<span id="cb14-11"></span>
<span id="cb14-12"></span>
<span id="cb14-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Bootstrap:</span> docker</span>
<span id="cb14-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">From:</span> rocker/rstudio:4.4.1</span>
<span id="cb14-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%files</span></span>
<span id="cb14-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load file with R package installation commands in to container at /tmp</span></span>
<span id="cb14-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expects file called "r_packages_installs.R" to be in current directory.</span></span>
<span id="cb14-18">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">r_packages_installs.R</span> /tmp/</span>
<span id="cb14-19"></span>
<span id="cb14-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%setup</span></span>
<span id="cb14-21"></span>
<span id="cb14-22"></span>
<span id="cb14-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%environment</span></span>
<span id="cb14-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Set program locations/versions for system PATH </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb14-25">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_location</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs"</span></span>
<span id="cb14-26">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.24.2"</span></span>
<span id="cb14-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5.4"</span></span>
<span id="cb14-28">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1.9"</span></span>
<span id="cb14-29">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastp_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.23.4"</span></span>
<span id="cb14-30">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.12.1"</span></span>
<span id="cb14-31">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gffcompare_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gffcompare-0.12.6"</span></span>
<span id="cb14-32">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">kallisto_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.51.1"</span></span>
<span id="cb14-34">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">miniforge_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24.7.1-0"</span></span>
<span id="cb14-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">multiqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.24.1"</span></span>
<span id="cb14-36">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_blast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.16.0"</span></span>
<span id="cb14-37">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_datasets_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"13.34.0"</span></span>
<span id="cb14-38">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repeatmasker_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.1.7-p1"</span></span>
<span id="cb14-39">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmblast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.14.1"</span></span>
<span id="cb14-40">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">salmon_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.10.0"</span></span>
<span id="cb14-41">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.20"</span></span>
<span id="cb14-42">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stringtie_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-43">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmomatic_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.39"</span></span>
<span id="cb14-44"></span>
<span id="cb14-45">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mamba_envs_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/envs"</span></span>
<span id="cb14-46"></span>
<span id="cb14-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######################################################</span></span>
<span id="cb14-48"></span>
<span id="cb14-49">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LC_ALL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>C</span>
<span id="cb14-50">    </span>
<span id="cb14-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Set container system PATH </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb14-52">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/usr/local/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/local/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-59"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Bismark-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bowtie2-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-sra-linux-x86_64:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-61"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/fastqc-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-63"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/kallisto-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/build/src:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-65"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-66"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mamba_envs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc_env/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-67"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/ncbi-blast-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">+/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-68"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/ncbi-datasets-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-69"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/RepeatMasker:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-70"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rmblast-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-71"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/salmon-latest_linux_x86_64/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-72"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/samtools-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-73"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.Linux_x86_64:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-74"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Trimmomatic-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-75"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trf409.linux64"</span></span>
<span id="cb14-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######################################################</span></span>
<span id="cb14-77"></span>
<span id="cb14-78"></span>
<span id="cb14-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%post</span></span>
<span id="cb14-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install common/base libraries/dependencies</span></span>
<span id="cb14-81">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt</span> update <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-82">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-install-recommends</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-83">    apt-utils <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-84">    aptitude <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-85">    automake <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-86">    build-essential <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-87">    bzip2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-88">    cmake <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-89">    coreutils <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-90">    curl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-91">    debconf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-92">    default-jdk <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-93">    dialog <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-94">    emboss <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-95">    gcc-multilib <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-96">    gdebi-core <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-97">    gfortran <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-98">    git <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-99">    gobjc++ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-100">    hmmer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-101">    htop <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-102">    infernal <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-103">    libapparmor1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-104">    libbz2-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-105">    libc6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-106">    libcurl4-openssl-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-107">    libedit2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-108">    libfontconfig1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-109">    liblzma-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-110">    libncurses5-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-111">    libncurses-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-112">    libncursesw5-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-113">    libpango1.0-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-114">    libpng-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-115">    libreadline-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-116">    libsm6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-117">    libsparsehash-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-118">    libssl-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-119">    liburi-escape-xs-perl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-120">    liburi-perl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-121">    libxml2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-122">    libxrender1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-123">    libz-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-124">    libbz2-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-125">    liblzma-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-126">    libxt6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-127">    libxtst6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-128">    libzmq3-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-129">    locales <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-130">    locales-all <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-131">    man <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-132">    nano <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-133">    ncurses-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-134">    net-tools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-135">    openssh-client <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-136">    parallel <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-137">    pkg-config <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-138">    psmisc <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-139">    python3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-140">    python-setuptools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-141">    rsync <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-142">    ruby <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-143">    software-properties-common <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-144">    sqlite3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-145">    sudo <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-146">    texinfo <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-147">    tree <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-148">    unzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-149">    wget <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-150">    xorg-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-151">    zlib1g-dev</span>
<span id="cb14-152"></span>
<span id="cb14-153">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run R package installation script file</span></span>
<span id="cb14-154">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Rscript</span> /tmp/r_packages_installs.R</span>
<span id="cb14-155"></span>
<span id="cb14-156">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">########## Set program versions ##########</span></span>
<span id="cb14-157"></span>
<span id="cb14-158">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bedtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v2.31.0"</span></span>
<span id="cb14-159">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.24.2"</span></span>
<span id="cb14-160">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5.4"</span></span>
<span id="cb14-161">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1.9"</span></span>
<span id="cb14-162">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastp_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.23.4"</span></span>
<span id="cb14-163">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.12.1"</span></span>
<span id="cb14-164">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gffcompare_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gffcompare-0.12.6"</span></span>
<span id="cb14-165">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-166">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">kallisto_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.51.1"</span></span>
<span id="cb14-167">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">miniforge_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24.7.1-0"</span></span>
<span id="cb14-168">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">multiqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.24.1"</span></span>
<span id="cb14-169">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_blast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.16.0"</span></span>
<span id="cb14-170">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_datasets_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"16.34.0"</span></span>
<span id="cb14-171">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repeatmasker_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.1.7-p1"</span></span>
<span id="cb14-172">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmblast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.14.1"</span></span>
<span id="cb14-173">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">salmon_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.10.0"</span></span>
<span id="cb14-174">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stringtie_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-175">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.20"</span></span>
<span id="cb14-176">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmomatic_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.39"</span></span>
<span id="cb14-177"></span>
<span id="cb14-178">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##########################################</span></span>
<span id="cb14-179">    </span>
<span id="cb14-180"></span>
<span id="cb14-181">    </span>
<span id="cb14-182">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set threads for faster builds</span></span>
<span id="cb14-183">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40"</span></span>
<span id="cb14-184"></span>
<span id="cb14-185">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make programs directory</span></span>
<span id="cb14-186">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> /srlab/programs</span>
<span id="cb14-187"></span>
<span id="cb14-188">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to installation directory</span></span>
<span id="cb14-189">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-190"></span>
<span id="cb14-191">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Install Miniforge (Conda/Mamba)</span></span>
<span id="cb14-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/conda-forge/miniforge/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>/Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh</span>
<span id="cb14-193">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ./miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span></span>
<span id="cb14-194"></span>
<span id="cb14-195">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:/srlab/programs/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin"</span></span>
<span id="cb14-196"></span>
<span id="cb14-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> init</span>
<span id="cb14-198">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> ./miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>/etc/profile.d/conda.sh</span>
<span id="cb14-199"></span>
<span id="cb14-200">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh</span>
<span id="cb14-201"></span>
<span id="cb14-202">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Configure conda channels</span></span>
<span id="cb14-203">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels defaults</span>
<span id="cb14-204">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels bioconda</span>
<span id="cb14-205">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels conda-forge</span>
<span id="cb14-206">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--set</span> channel_priority strict</span>
<span id="cb14-207"></span>
<span id="cb14-208">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install bedtools</span></span>
<span id="cb14-209">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/arq5x/bedtools2/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bedtools_version}</span>/bedtools.static</span>
<span id="cb14-210">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> bedtools.static bedtools</span>
<span id="cb14-211">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> a+x bedtools</span>
<span id="cb14-212"></span>
<span id="cb14-213">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install Bismark</span></span>
<span id="cb14-214">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/FelixKrueger/Bismark/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-215">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-216">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-217"></span>
<span id="cb14-218">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install bowtie2</span></span>
<span id="cb14-219">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/BenLangmead/bowtie2/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>/bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-220">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-221">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-222"></span>
<span id="cb14-223">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install DIAMOND BLAST</span></span>
<span id="cb14-224">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/bbuchfink/diamond/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${diamond_version}</span>/diamond-linux64.tar.gz</span>
<span id="cb14-225">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> diamond-linux64.tar.gz</span>
<span id="cb14-226">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> diamond-linux64.tar.gz</span>
<span id="cb14-227"></span>
<span id="cb14-228">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install fastp</span></span>
<span id="cb14-229">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://opengene.org/fastp/fastp.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp_version}</span></span>
<span id="cb14-230">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> fastp.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp_version}</span> fastp</span>
<span id="cb14-231">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> a+x ./fastp</span>
<span id="cb14-232"></span>
<span id="cb14-233">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install FastQC</span></span>
<span id="cb14-234">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-235">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-236">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> FastQC fastqc-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span></span>
<span id="cb14-237">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-238"></span>
<span id="cb14-239">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install gffcompare</span></span>
<span id="cb14-240">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://ccb.jhu.edu/software/stringtie/dl/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-241">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-242">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-243"></span>
<span id="cb14-244">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install HISAT2</span></span>
<span id="cb14-245">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/DaehwanKimLab/hisat2/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-246">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-247">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> hisat2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span></span>
<span id="cb14-248">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb14-249">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb14-250">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-251"></span>
<span id="cb14-252">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install kallisto</span></span>
<span id="cb14-253">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/pachterlab/kallisto/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-254">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-255">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> kallisto-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span></span>
<span id="cb14-256">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> build</span>
<span id="cb14-257">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> build</span>
<span id="cb14-258">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmake</span> ..</span>
<span id="cb14-259">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span></span>
<span id="cb14-260">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-261">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-262"></span>
<span id="cb14-263">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install MultiQC</span></span>
<span id="cb14-264">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> multiqc_env multiqc=1.24.1</span>
<span id="cb14-265"></span>
<span id="cb14-266">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install NCBI datasets</span></span>
<span id="cb14-267">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> ncbi-datasets-v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span></span>
<span id="cb14-268"></span>
<span id="cb14-269">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ncbi-datasets-v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span></span>
<span id="cb14-270">    </span>
<span id="cb14-271">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/ncbi/datasets/releases/download/v16.34.0/linux-amd64.cli.package.zip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-272">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> linux-amd64.cli.package.zip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-273">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> linux-amd64.cli.package.zip</span>
<span id="cb14-274"></span>
<span id="cb14-275">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-276"></span>
<span id="cb14-277">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install NCBI BLAST</span></span>
<span id="cb14-278">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>/ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-279">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-zxvpf</span> ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-280">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-281"></span>
<span id="cb14-282">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RepeatMasker conda environment with Python3 and h5py using mamba</span></span>
<span id="cb14-283">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> repeatmasker-env python=3.8 h5py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb14-284"></span>
<span id="cb14-285">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install RepeatMasker</span></span>
<span id="cb14-286">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.repeatmasker.org/RepeatMasker/RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-287">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-288">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-289"></span>
<span id="cb14-290">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Remove default RepeatMasker DB</span></span>
<span id="cb14-291">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> /srlab/programs/RepeatMasker/Libraries/famdb/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb14-292"></span>
<span id="cb14-293">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up symlinks to RepeatMasker files on Klone</span></span>
<span id="cb14-294">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5 /srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5</span>
<span id="cb14-295">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config /srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config</span>
<span id="cb14-296"></span>
<span id="cb14-297">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install RMBLAST</span></span>
<span id="cb14-298">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.repeatmasker.org/rmblast/rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-299">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-300">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-301"></span>
<span id="cb14-302">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install salmon</span></span>
<span id="cb14-303">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/COMBINE-lab/salmon/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>/salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-304">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-305">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-306"></span>
<span id="cb14-307">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install samtools</span></span>
<span id="cb14-308">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/samtools/samtools/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>/samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-309">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xjvf</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-310">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span></span>
<span id="cb14-311">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./configure</span></span>
<span id="cb14-312">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb14-313">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb14-314">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-315"></span>
<span id="cb14-316">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install trimmomatic</span></span>
<span id="cb14-317">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-318">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-319">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span></span>
<span id="cb14-320">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-321"></span>
<span id="cb14-322">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install StringTie</span></span>
<span id="cb14-323">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://ccb.jhu.edu/software/stringtie/dl/stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-324">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-325">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-326"></span>
<span id="cb14-327">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install TRF</span></span>
<span id="cb14-328">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/Benson-Genomics-Lab/TRF/releases/download/v4.09.1/trf409.linux64</span>
<span id="cb14-329">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x trf409.linux64</span>
<span id="cb14-330"></span>
<span id="cb14-331"></span>
<span id="cb14-332"></span>
<span id="cb14-333"></span>
<span id="cb14-334"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%labels</span></span>
<span id="cb14-335">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Author</span> Sam White</span>
<span id="cb14-336">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Version</span> v0.0.5</span>
<span id="cb14-337">    </span>
<span id="cb14-338"></span>
<span id="cb14-339"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%help</span></span>
<span id="cb14-340">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">This</span> is an Apptainer definition file for an Ubuntu container containing bioinformatics software for the Roberts Lab.</span></code></pre></div>
</div>


<!-- -->

</section>
</section>

 ]]></description>
  <category>hyak</category>
  <category>hpc</category>
  <category>rstudio</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/38-klone/</guid>
  <pubDate>Wed, 19 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_sr320__sr320klone-login03__ssh_klone.hyak.uw.edu__9830_2025-02-20_09-08-29.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Apul Time Series Methylation</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/</link>
  <description><![CDATA[ 





<p>Here we take the first set of time series methylation data to CpG level percent methylation.</p>
<section id="data-was-trimmed" class="level1">
<h1>Data was trimmed</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/</a></p>
</div>
</div>
<p>To reproduce the trimming and quality control (QC) of <em>Acropora pulchra</em> Whole Genome Bisulfite Sequencing (WGBS) data, obtain the raw FastQ files and use <strong>fastp</strong> to trim <strong>25bp from the 5’ end</strong> while removing adapters, polyG, and polyA sequences; if errors occur, attempt repair with <strong>BBTools’ repair.sh</strong> before re-trimming. Evaluate trimmed reads with <strong>FastQC</strong>, then summarize results using <strong>MultiQC</strong>. The complete workflow, including commands and scripts, is available in the project repository, and output files can be accessed <a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/">here</a>.</p>
</section>
<section id="reads-were-aligned" class="level1">
<h1>Reads were aligned</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/</a></p>
</div>
</div>
<p>To align <em>Acropora pulchra</em> WGBS reads using <strong>Bismark</strong> on the <strong>Hyak</strong> cluster, trimmed FastQ files were prepared, and a <strong>fastq_pairs.txt</strong> file was generated. The alignment process was initiated by submitting a SLURM array job using sbatch –array=1-$(wc -l &lt; ../output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/fastq_pairs.txt) 02.20-D-Apul-WGBS-alignment-SLURM-job.sh, which allowed each node to process a unique FastQ pair. The job script (02.20-D-Apul-WGBS-alignment-SLURM_array-bismark.sh) configured directories, allocated computational resources (bismark_threads=5), extracted FastQ filenames, and executed <strong>Bismark</strong> with <strong>Bowtie2</strong> using the parameters –score_min L,0,-0.6 –non_directional –gzip -p 5. The SLURM script (02.20-D-Apul-WGBS-alignment-SLURM-job.sh) defined job parameters (#SBATCH –cpus-per-task=20 –mem=100G –time=72:00:00) and executed the containerized Bismark workflow via <strong>Apptainer</strong>.</p>
</section>
<section id="taking-bams-to-tables" class="level1">
<h1>Taking BAMS to tables</h1>
<section id="deduplicated" class="level2">
<h2 class="anchored" data-anchor-id="deduplicated">Deduplicated</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _R1_001.fastp-trim_bismark_bt2_pe.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-6">--output_dir ../output/15-Apul-bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-7">/gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark//{}_R1_001.fastp-trim_bismark_bt2_pe.bam</span></code></pre></div>
</section>
<section id="sorted" class="level2">
<h2 class="anchored" data-anchor-id="sorted">Sorted</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> 24 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">../output/15-Apul-bismark/{}_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">-o ../output/15-Apul-bismark/{}.sorted.bam</span></code></pre></div>
</section>
<section id="methylation-extraction" class="level2">
<h2 class="anchored" data-anchor-id="methylation-extraction">Methylation Extraction</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2">bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3">--multicore 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> ../output/15-Apul-bismark <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{}"</span></span></code></pre></div>
</section>
<section id="methylation-call" class="level2">
<h2 class="anchored" data-anchor-id="methylation-call">Methylation call</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 24 coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">--genome_folder /gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-o ../output/15-Apul-bismark/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../output/15-Apul-bismark/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</section>
<section id="rename-cov-files" class="level2">
<h2 class="anchored" data-anchor-id="rename-cov-files">Rename cov files</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the CSV file and create an associative array - hand edited 3 filenames first</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_map</span></span>
<span id="cb5-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col3</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col4</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">azenta_sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-4">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$azenta_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ../../M-multi-species/data/e5_DNA_Azenta_metadata.csv</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/15.5-Apul-bismark/</span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over all *.cov files and rename them</span></span>
<span id="cb5-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.cov<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the portion before the first underscore</span></span>
<span id="cb5-12">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-13">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="made-bedgraph" class="level2">
<h2 class="anchored" data-anchor-id="made-bedgraph">Made bedgraph</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/15.5-Apul-bismark/</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>merged_CpG_evidence.cov</span>
<span id="cb6-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-5">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STEM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _R1_001.fastp-trim_bismark_bt2.CpG_report.merged_CpG_evidence.cov<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN {OFS = FS} {if ($5+$6 &gt;= 10) {print $1, $2, $3, $4}}'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-7">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STEM}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_10x.bedgraph</span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="created-modified-tables" class="level2">
<h2 class="anchored" data-anchor-id="created-modified-tables">Created modified tables</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/15.5-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "CpG_"_$1"_"$2, $4}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_processed.txt"</span></span>
<span id="cb7-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_httpsgannet.fish.washington.eduseashellbu-githubtimeseries_molecularD-Apuloutput15.5-Apul-bismarkACR-139-TP2_10x_proc_2025-02-08_05-03-16.png" class="img-fluid"></p>
<p>Now there are files for each of the Apul samples @ <a href="https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/" class="uri">https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/</a></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>methylation</category>
  <category>coral</category>
  <category>bismark</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/</guid>
  <pubDate>Sat, 08 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_urol-e5timeseries_molecular_2025-02-08_04-42-58.png" medium="image" type="image/png"/>
</item>
<item>
  <title>We wish you a Merry Mytilus!</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/36-merry/</link>
  <description><![CDATA[ 





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/mm.gif" class="img-fluid figure-img"></p>
<figcaption>merry</figcaption>
</figure>
</div>
<p>Following Bismark alignment took data through methylkit to identify DMLs.</p>
<p>In case methyKit needs an installation</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">requireNamespace</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quietly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb1-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4">BiocManager<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylKit"</span>)</span></code></pre></div>
<p>Used cov files to import into methylkit</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-P ../data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*cov"</span> https://gannet.fish.washington.edu/seashell/bu-github/project-mytilus-methylation/output/09-meth-quant/</span></code></pre></div>
<p>Get a list of said files</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">analysisFilescov <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/105M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/106M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/107M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/109M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/239M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/240M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/241M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/242M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/269M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/270M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/271M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/272M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-14">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/69M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-15">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/70M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-16">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/71M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-17">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/72M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-18">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/78M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/79M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-20">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/80M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-21">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/81M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/92M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-23">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/94M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-24">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/95M.CpG_report.merged_CpG_evidence.cov"</span></span>
<span id="cb3-25">) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Put all .bam files into a list for analysis.</span></span></code></pre></div>
<p>Create a methylKit object with 2x coverage</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">myobj_23 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">methRead</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> analysisFilescov, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample.id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"105M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"106M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"107M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"109M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"239M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"240M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"241M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"242M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"269M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"270M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"271M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"272M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"69M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"70M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"71M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"72M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"78M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"79M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"80M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"81M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"92M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"94M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"95M"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assembly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pipeline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bismarkCoverage"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">context=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mincov=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">treatment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<p>Filter methylKit object for 5x coverage</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">filtered.myobj<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filterByCoverage</span>(myobj_23,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lo.count=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lo.perc=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-2">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hi.count=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hi.perc=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">98</span>)</span></code></pre></div>
<p>Unite methylKit object such that need data for 10 samples per group.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">meth_filter<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>methylKit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(filtered.myobj, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.per.group=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destrand=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<p>Visualize the data</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clusterSamples</span>(meth_filter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"correlation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PCASamples</span>(meth_filter)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-mytilus-methylation____RStudio_Server_2024-12-24_07-39-59.png" class="img-fluid figure-img"></p>
<figcaption>cluster</figcaption>
</figure>
</div>
<p>Find Differences</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">myDiff<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculateDiffMeth</span>(meth_filter,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>)</span></code></pre></div>
<p>Get DMLs at 55% Difference</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get all diffentially methylated bases</span></span>
<span id="cb9-2">myDiff_1055p<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getMethylDiff</span>(myDiff,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">qvalue=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.table</span>(myDiff_1055p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11-methylkit-klone/myDiff_1055p.tab"</span>)</span></code></pre></div>
<p>Convert to Bedgraph</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input and output file names</span></span>
<span id="cb11-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11-methylkit-klone/myDiff_1055p.tab"</span></span>
<span id="cb11-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV/myDiff1055p.bedgraph"</span></span>
<span id="cb11-4"></span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the BEDGRAPH header</span></span>
<span id="cb11-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"track type=bedGraph name=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MethDiff</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> description=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Methylation difference data</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-8"></span>
<span id="cb11-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process the input file to remove quotes and convert it to BEDGRAPH format</span></span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 {gsub(/"/, "", $2); print $2 "\t" $3-1 "\t" $4 "\t" $8}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$INPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Conversion complete. Output saved to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>track type=bedGraph name="MethDiff" description="Methylation difference data"
NC_086373.1 90626337    90626340    56.3226247436774
NC_086373.1 105503508   105503511   -57.8638497652582
NC_086374.1 34742950    34742953    58.2670906200318
NC_086375.1 31938078    31938081    -60.6923802783675
NC_086375.1 43581687    43581690    58.1981981981982
NC_086375.1 90876603    90876606    55.8823529411765
NC_086376.1 5631155 5631158 58.9955022488756
NC_086378.1 6633120 6633123 -55.241935483871
NC_086379.1 1603829 1603832 -60.822949869603
NC_086379.1 47961733    47961736    56.4495530012771
NC_086379.1 64017639    64017642    -63.5951772013153
NC_086379.1 64017774    64017777    -59.1351928466569
NC_086381.1 21212099    21212102    -56.0704607046071
NC_086382.1 25952233    25952236    -55.8318584070797
NC_086382.1 36708760    36708763    -56.5044858523119
NC_086386.1 17736432    17736435    -58.4235938927313</code></pre>
<p>Using IGV for some visualization!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/mm.gif" class="img-fluid figure-img"></p>
<figcaption>merry</figcaption>
</figure>
</div>
<p>Intersecting BEDGRAPH with GFF files to get gene information of where DMLs are located.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input files</span></span>
<span id="cb13-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BEDGRAPH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV/myDiff1055p.bedgraph"</span></span>
<span id="cb13-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GFF_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV"</span></span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory for intersect results</span></span>
<span id="cb13-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-intersectbed/"</span></span>
<span id="cb13-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_DIR</span></span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through all GFF files in the directory</span></span>
<span id="cb13-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> GFF <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF_DIR</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gff<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BASENAME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .gff<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-12">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_DIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BASENAME}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_intersect.bed"</span></span>
<span id="cb13-13">    </span>
<span id="cb13-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intersecting </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$BEDGRAPH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb13-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> intersect <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-loj</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$BEDGRAPH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-19">    </span>
<span id="cb13-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Result saved to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb13-22"></span>
<span id="cb13-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All intersections completed!"</span></span></code></pre></div>
<p>TLDR</p>
<ol type="1">
<li><p><strong>LOC134690221</strong>: <strong>GRAM domain-containing protein 4-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+56.32).</p>
<p>• <strong>Function</strong>: Involved in membrane-associated processes like signaling or vesicle trafficking.</p></li>
<li><p><strong>LOC134695637</strong>: <strong>Otoferlin-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-57.86).</p>
<p>• <strong>Function</strong>: Plays a role in vesicle-mediated transport and sensory signaling.</p></li>
<li><p><strong>LOC134707074</strong>: <strong>Receptor-type tyrosine-protein phosphatase N2-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+58.27).</p>
<p>• <strong>Function</strong>: Regulates cell signaling pathways affecting growth and differentiation.</p></li>
<li><p><strong>LOC134711256</strong>: <strong>Cancer-related nucleoside-triphosphatase homolog</strong></p>
<p>• <strong>Methylation status</strong>:</p>
<p>• Hypomethylated (-60.69).</p>
<p>• Hypermethylated (+58.20).</p>
<p>• <strong>Function</strong>: Involved in DNA/RNA metabolism and stress responses.</p></li>
<li><p><strong>LOC134712818</strong>: <strong>Uncharacterized protein</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+55.88).</p>
<p>• <strong>Function</strong>: Unknown.</p></li>
<li><p><strong>LOC134714536</strong>: <strong>Coatomer subunit epsilon-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+58.99).</p>
<p>• <strong>Function</strong>: Key player in intracellular vesicle trafficking.</p></li>
<li><p><strong>LOC134720671</strong>: <strong>Roundabout homolog 1-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-55.24).</p>
<p>• <strong>Function</strong>: Guides axon growth and cell migration.</p></li>
<li><p><strong>LOC134724475</strong>: <strong>Uncharacterized protein</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-60.82).</p>
<p>• <strong>Function</strong>: Unknown.</p></li>
<li><p><strong>LOC134725187</strong>: <strong>Membrane protein BRI3-like</strong></p>
<p>• <strong>Methylation status</strong>:</p>
<p>• Hypermethylated (+56.45).</p>
<p>• Hypomethylated (-63.60, -59.14).</p>
<p>• <strong>Function</strong>: Participates in signaling and membrane dynamics.</p></li>
<li><p><strong>LOC134685297</strong>: <strong>Tumor protein p53-inducible protein 11-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-56.07).</p>
<p>• <strong>Function</strong>: Responds to cellular stress, regulates apoptosis, and growth arrest.</p></li>
<li><p><strong>LOC134687110</strong>: <strong>Alpha-ketoglutarate-dependent dioxygenase alkB homolog 3-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-55.83).</p>
<p>• <strong>Function</strong>: Modifies nucleic acids or lipids, involved in repair and metabolism.</p></li>
<li><p><strong>LOC134687290</strong>: <strong>Mitogen-activated protein kinase kinase kinase 5-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-56.50).</p>
<p>• <strong>Function</strong>: Key regulator of stress response and cellular signaling.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/dml.gif" class="img-fluid figure-img"></p>
<figcaption>dml</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>Pollution impacts DNA methylation in mussels as an adaptive or maladaptive response to environmental stress. This epigenetic flexibility allows mussels to fine-tune gene expression for survival, repair, and detoxification under polluted conditions. However, prolonged or excessive changes can lead to impaired growth, reproduction, or transgenerational effects, ultimately affecting mussel populations and ecosystem health.</p>
</blockquote>


<!-- -->


 ]]></description>
  <category>mytilus</category>
  <category>methylation</category>
  <category>methylkit</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/36-merry/</guid>
  <pubDate>Tue, 24 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Userssr320Desktopigv_session.xml_2024-12-24_07-26-36.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Time-series Apul lncRNA count matrix</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/34-Apul-lncRNA/</link>
  <description><![CDATA[ 





<p>I started with a bed file from discovery (see below) and used it to count the number of lncRNAs in each sample from Time Series data (Apul)</p>
<section id="converted-bed-to-gtf" class="level2">
<h2 class="anchored" data-anchor-id="converted-bed-to-gtf">Converted Bed to GTF</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/10.1-Apul-lncRNA/Apul_lncRNA.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/05-Apul-lncRNA/lncRNAs.gtf</span></code></pre></div>
<pre><code>==&gt; /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/10.1-Apul-lncRNA/Apul_lncRNA.bed &lt;==
ntLink_0    84514   93551
ntLink_0    15627   19151
ntLink_0    23443   23874
ntLink_1    7484    9525
ntLink_1    51265   51766
ntLink_2    217051  217761
ntLink_2    330551  331392
ntLink_3    56721   62176
ntLink_3    76352   81676
ntLink_3    95705   100623</code></pre>
<section id="gtf" class="level3">
<h3 class="anchored" data-anchor-id="gtf">GTF</h3>
<pre><code>ntLink_0    .   lncRNA  84514   93551   .   +   .   gene_id "lncRNA_001";
ntLink_0    .   lncRNA  15627   19151   .   +   .   gene_id "lncRNA_002";
ntLink_0    .   lncRNA  23443   23874   .   +   .   gene_id "lncRNA_003";
ntLink_1    .   lncRNA  7484    9525    .   +   .   gene_id "lncRNA_004";
ntLink_1    .   lncRNA  51265   51766   .   +   .   gene_id "lncRNA_005";
ntLink_2    .   lncRNA  217051  217761  .   +   .   gene_id "lncRNA_006";</code></pre>
</section>
</section>
<section id="feature-count" class="level2">
<h2 class="anchored" data-anchor-id="feature-count">Feature Count</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/subread-2.0.5-Linux-x86_64/bin/featureCounts</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2">-T 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">-a ../output/05-Apul-lncRNA/lncRNAs.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">-o ../output/05-Apul-lncRNA/counts.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-t lncRNA <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">-g gene_id <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">-p <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../data/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>sorted.bam</span></code></pre></div>
</section>
<section id="count-matrix" class="level2">
<h2 class="anchored" data-anchor-id="count-matrix">Count Matrix</h2>
<p><a href="https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/output/05-Apul-lncRNA/counts.txt" class="uri">https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/output/05-Apul-lncRNA/counts.txt</a></p>
<hr>
<p>Before I did that, first lncRNA were discovered. This was done with the deep-dive expression samples (n=5)</p>
</section>
<section id="discovery" class="level1">
<h1>Discovery</h1>
<section id="stringtie" class="level2">
<h2 class="anchored" data-anchor-id="stringtie">StringTie</h2>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples–an important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/07-Apul-Hisat/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">-p 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">-G ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6">-o ../output/10.1-Apul-lncRNA/{}.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">../output/07-Apul-Hisat/{}.sorted.bam</span></code></pre></div>
<p>Merges all individual GTF assemblies into a single merged GTF file.</p>
<p>This is used to create a non-redundant set of transcripts after running StringTie separately on multiple RNA-Seq datasets.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-G ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-o ../output/10.1-Apul-lncRNA/stringtie_merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-5">../output/10.1-Apul-lncRNA/RNA<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</section>
<section id="gffcompare" class="level2">
<h2 class="anchored" data-anchor-id="gffcompare">GFFcompare</h2>
<p>https://ccb.jhu.edu/software/stringtie/gffcompare.shtml</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/gffcompare-0.12.6.Linux_x86_64/gffcompare</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2">-r ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">-o ../output/10.1-Apul-lncRNA/gffcompare_merged <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">../output/10.1-Apul-lncRNA/stringtie_merged.gtf</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">Filter</h2>
<p>Filters the combined GTF output from GFFcompare to select only the lines representing “transcripts” and excluding lines starting with “#” (these are lines in the output format from GFFcompare that don’t contain transcript information). This step further filters for a class code of “u”, and keep only those with lengths greater than 199 bases. The “u’ class code from the GFFcompare step is for”unknown” transcripts, that is those that are not previously annotated in our reference GFF as protein coding. The size filter of +200nt is a common filtering step for isolating lncRNAs.</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-2">../output/10.1-Apul-lncRNA/gffcompare_merged.annotated.gtf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"\|class_code "x"|\class_code "i"\|class_code "y"'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.gtf</span></code></pre></div>
</section>
<section id="bedtools" class="level2">
<h2 class="anchored" data-anchor-id="bedtools">Bedtools</h2>
<p>Extracts the sequence data from the <code>$FASTA</code> reference file based on the coordinates from the filtered GTF. The resulting sequences represent potential lncRNA candidates.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/bedtools2/bin/fastaFromBed</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2">-fi ../data/Apulcra-genome.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-3">-bed ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">-fo ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fgrep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta </span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta </span></code></pre></div>
</section>
<section id="cpc2" class="level2">
<h2 class="anchored" data-anchor-id="cpc2">CPC2</h2>
<p>Initializes a conda environment (Anaconda) and runs CPC2, a software to predict whether a transcript is coding or non-coding. The results are saved to the $OUTPUT_DIR. CPC2 uses ORF (Open Reading Frame) Analysis, Isometric Feature Mapping (Isomap), Sequence Homology, RNA Sequence Features, and Quality of Translation to assess coding potential and flag any transcripts we would want to exclude using the FASTA generated in the previous step.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/CPC2_standalone-1.0.1/bin/CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">-i ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">-o ../output/10.1-Apul-lncRNA/Apul_CPC2</span></code></pre></div>
</section>
<section id="filter-1" class="level2">
<h2 class="anchored" data-anchor-id="filter-1">Filter</h2>
<p>Filters the CPC2 results to get only noncoding transcripts (using the class “noncoding” from the CPC2 results) and extracts their IDs and matches these IDs with the sequences from the previous step to generate a GTF of long noncoding transcripts.</p>
<p>Matches these IDs with the sequences from the previous step to generate a GTF of noncoding transcripts.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> ../output/10.1-Apul-lncRNA/Apul_CPC2.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt</span></code></pre></div>
</section>
</section>
<section id="subsetting-fasta" class="level1">
<h1>subsetting fasta</h1>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/samtools-1.12/samtools</span> faidx ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-2">-r ../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA.fasta</span></code></pre></div>
</section>
<section id="getting-genome-feature-track" class="level1">
<h1>Getting genome feature track</h1>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Open the input file and the output file</span></span>
<span id="cb14-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> infile, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../output/10.1-Apul-lncRNA/Apul_lncRNA.bed'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outfile:</span>
<span id="cb14-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line in the input file</span></span>
<span id="cb14-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> infile:</span>
<span id="cb14-6">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove 'transcript::' and then split the line by ':' to extract the relevant parts</span></span>
<span id="cb14-7">        parts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line.strip().replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'transcript::'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>).split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span>)</span>
<span id="cb14-8">        chromosome <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb14-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position part by '-' to get start and end positions</span></span>
<span id="cb14-10">        start, end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>)</span>
<span id="cb14-11">        </span>
<span id="cb14-12">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BED format requires the start position to be 0-based</span></span>
<span id="cb14-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb14-14">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(start) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-15">        </span>
<span id="cb14-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, start, and end positions to the output file</span></span>
<span id="cb14-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Separate each field with a tab character</span></span>
<span id="cb14-18">        outfile.write(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chromosome<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>end<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb14-19"></span>
<span id="cb14-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># After running this script, 'output.bed' will contain the converted data in BED format.</span></span></code></pre></div>
<ul>
<li>note that when you take this bed and make gtf you get -1 starts that make program fail - of course the 0-based / 1-based issue that will eventually need to be looked into.</li>
</ul>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>lncRNA</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/34-Apul-lncRNA/</guid>
  <pubDate>Fri, 20 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries_molecular__RStudio_Server_2024-12-20_03-51-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Mytilus DNA methylation calls</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/35-myt-meth/</link>
  <description><![CDATA[ 





<p>Following the genome prep did an alignment. This was preceded by an assessment of min_score variable. Selection was based on high alignment rate with minimal non CpG methylation.</p>
<p>Based on <a href="https://marineomics.github.io/FUN_02_DNA_methylation.html" class="uri">https://marineomics.github.io/FUN_02_DNA_methylation.html</a></p>
<section id="alignment" class="level1">
<h1>Alignment</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set variables</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/"</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/"</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01.2-bismark"</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-1.0"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Single value for score_min</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb1-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R1.fastp-trim.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-9">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1.fastp-trim.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-10">    </span>
<span id="cb1-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13">    </span>
<span id="cb1-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb1-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/Bismark-0.24.0/bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie2</span> /home/shared/bowtie2-2.4.4-linux-x86_64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-24">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="deduplication" class="level1">
<h1>deduplication</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/01.2-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 /home/shared/Bismark-0.24.0/deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">--output_dir ../output/09-meth-quant <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">../output/01.2-bismark/{}.bam</span></code></pre></div>
</section>
<section id="methylation-extraction" class="level1">
<h1>Methylation extraction</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/09-meth-quant/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/Bismark-0.24.0/bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--multicore</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> ../output/09-meth-quant {} </span></code></pre></div>
</section>
<section id="methylation-call" class="level1">
<h1>Methylation call</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/09-meth-quant/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 48 /home/shared/Bismark-0.24.0/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">--genome_folder ../data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-o ../output/09-meth-quant/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../output/09-meth-quant/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
<p>This resulted in CpG_report.merged_CpG_evidence.cov files..</p>
</section>
<section id="sorted-bams" class="level1">
<h1>Sorted bams</h1>
<p>deduplicated sorted bams were also sorted..</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/samtools-1.12/samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> 48 {}.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">-o {}.sorted.bam</span></code></pre></div>


<!-- -->

</section>

 ]]></description>
  <category>mytilus</category>
  <category>methylation</category>
  <category>bismark</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/35-myt-meth/</guid>
  <pubDate>Thu, 19 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-mytilus-methylation__RStudio_Server_2024-12-20_04-34-37.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Hip Hip Array</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/33-bismark-array/</link>
  <description><![CDATA[ 





<p>Finally got the kinks out of the code! This is run on klone with a slurm job file and shell script.</p>
<section id="slurm" class="level2">
<h2 class="anchored" data-anchor-id="slurm">Slurm</h2>
<pre class="slurm"><code>#!/bin/sh

#SBATCH --job-name=04-cea-bis          # Job name
#SBATCH --output=%x_%A_%a.slurm.out             # Standard output and error log
#SBATCH --error=%x_%A_%a.slurm.err              # Error log
#SBATCH --account=srlab
#SBATCH --partition=ckpt #update this line - use hyakalloc to find partitions you can use
#SBATCH --time=10-02:00:00
#SBATCH --ntasks=1                        # Run a single task
#SBATCH --cpus-per-task=30                # Number of CPU cores per task
#SBATCH --array=0-31                      # Array range (adjust based on the number of samples)
#SBATCH --mem=100G                         # Memory per node
#SBATCH --chdir=/gscratch/scrubbed/sr320/github/ceasmallr/output/04.2-bismark-align



# Execute Roberts Lab bioinformatics container
# Binds home directory
# Binds /gscratch directory
# Directory bindings allow outputs to be written to the hard drive.
apptainer exec \
--home "$PWD" \
--bind /mmfs1/home/ \
--bind /mmfs1/gscratch/ \
/gscratch/srlab/sr320/srlab-bioinformatics-container-586bf21.sif \
../../code/04.1.sh</code></pre>
</section>
<section id="shell" class="level2">
<h2 class="anchored" data-anchor-id="shell">Shell</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set directories and files</span></span>
<span id="cb2-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/"</span></span>
<span id="cb2-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/genome"</span></span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span></span>
<span id="cb2-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">checkpoint_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"completed_samples.log"</span></span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the checkpoint file if it doesn't exist</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb2-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>R1_001.fastp-trim.20220827.fq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_ARRAY_TASK_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1_001.fastp-trim.20220827.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample has already been processed</span></span>
<span id="cb2-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-18">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already processed. Skipping..."</span></span>
<span id="cb2-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 0</span>
<span id="cb2-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define log files for stdout and stderr</span></span>
<span id="cb2-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stdout_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stdout.log"</span></span>
<span id="cb2-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stderr.log"</span></span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark align</span></span>
<span id="cb2-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> 10000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> L,0,-0.6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_001.fastp-trim.20220827.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_001.fastp-trim.20220827.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-37">    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the command was successful</span></span>
<span id="cb2-40"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the sample name to the checkpoint file</span></span>
<span id="cb2-42">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb2-43">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> processed successfully."</span></span>
<span id="cb2-44"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb2-45">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> failed. Check </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> for details."</span></span>
<span id="cb2-46"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</section>
<section id="elevated-shell-script" class="level2">
<h2 class="anchored" data-anchor-id="elevated-shell-script">Elevated Shell Script</h2>
<p>Not to brag, but Sam helped me take it up a notch by evaluating score_min parameters for comparisons</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set directories and files</span></span>
<span id="cb3-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/"</span></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/genome"</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span></span>
<span id="cb3-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">checkpoint_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"completed_samples.log"</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the checkpoint file if it doesn't exist</span></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb3-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>R1_001.fastp-trim.20220827.fq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_ARRAY_TASK_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1_001.fastp-trim.20220827.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample has already been processed</span></span>
<span id="cb3-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-18">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already processed. Skipping..."</span></span>
<span id="cb3-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 0</span>
<span id="cb3-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define log files for stdout and stderr</span></span>
<span id="cb3-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stdout_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stdout.log"</span></span>
<span id="cb3-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stderr.log"</span></span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the array of score_min parameters to test</span></span>
<span id="cb3-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb3-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.4"</span></span>
<span id="cb3-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.6"</span></span>
<span id="cb3-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.8"</span></span>
<span id="cb3-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-1.0"</span></span>
<span id="cb3-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,-1,-0.6"</span></span>
<span id="cb3-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through each score_min parameter</span></span>
<span id="cb3-36"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> score_min <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-37">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-38">    </span>
<span id="cb3-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a subdirectory for this parameter</span></span>
<span id="cb3-40">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">param_output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_score_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-41">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span></span>
<span id="cb3-42"></span>
<span id="cb3-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb3-44">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-45">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> 10000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-48">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-49">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_001.fastp-trim.20220827.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-51">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_001.fastp-trim.20220827.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-52">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-53">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span>_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-54">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_ARRAY_TASK_ID}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb3-55"></span>
<span id="cb3-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the command was successful</span></span>
<span id="cb3-57">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-58">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> processed successfully."</span></span>
<span id="cb3-59">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb3-60">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> failed. Check </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> for details."</span></span>
<span id="cb3-61">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-62"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb3-63"></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mark the sample as completed in the checkpoint file</span></span>
<span id="cb3-65"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-66">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb3-67">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All tests for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> completed."</span></span>
<span id="cb3-68"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb3-69">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> encountered errors. Check logs for details."</span></span>
<span id="cb3-70"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-71"></span>
<span id="cb3-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define directories</span></span>
<span id="cb3-73"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span></span>
<span id="cb3-74"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/parameter_comparison_summary.csv"</span></span>
<span id="cb3-75"></span>
<span id="cb3-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize summary file</span></span>
<span id="cb3-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#echo "Sample,Score_Min,Alignment_Rate,Unique_Alignments,Mismatch_Rate,Bisulfite_Efficiency" &gt; ${summary_file}</span></span>
<span id="cb3-78"></span>
<span id="cb3-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through parameter output directories</span></span>
<span id="cb3-80"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dir <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_score_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-81">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb3-82">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name and score_min parameter from directory name</span></span>
<span id="cb3-83">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-84">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score_.*"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/score_//; s/_/,/g'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-85"></span>
<span id="cb3-86">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Locate the summary file</span></span>
<span id="cb3-87">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_PE_report.txt"</span></span>
<span id="cb3-88"></span>
<span id="cb3-89">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract metrics</span></span>
<span id="cb3-90">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mapping</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mapping efficiency:"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file_path}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "mapping efficiency ", $3}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-91">        </span>
<span id="cb3-92"></span>
<span id="cb3-93">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append to the summary file</span></span>
<span id="cb3-94">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mapping}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file}</span></span>
<span id="cb3-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb3-96"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>klone</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/33-bismark-array/</guid>
  <pubDate>Wed, 20 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MultiQC_Report_2024-11-21_17-51-28.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Running Bismark in SLURM Array for Methylation Analysis</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/32-bismark-array/</link>
  <description><![CDATA[ 





<p>This post discusses a two-part script for methylation analysis using Bismark, which is managed via SLURM on a high-performance computing (HPC) cluster. This workflow is designed to automate the analysis of large numbers of whole-genome bisulfite sequencing (WGBS) samples efficiently. The setup involves a SLURM script to submit jobs in an array format and a bash script that processes each sample with Bismark. While powerful, there are some potential points of complexity and pitfalls in this workflow, which may challenge new users or cause issues in large-scale executions.</p>
<section id="slurm-job" class="level2">
<h2 class="anchored" data-anchor-id="slurm-job">slurm job</h2>
<pre class="shell"><code>#!/bin/sh

#SBATCH --job-name=bismark_array          # Job name
#SBATCH --output=%x_%A_%a.slurm.out             # Standard output and error log
#SBATCH --error=%x_%A_%a.slurm.err              # Error log
#SBATCH --account=srlab
#SBATCH --partition=ckpt #update this line - use hyakalloc to find partitions you can use
#SBATCH --time=01-02:00:00
#SBATCH --ntasks=1                        # Run a single task
#SBATCH --cpus-per-task=30                # Number of CPU cores per task
#SBATCH --array=0-47                      # Array range (adjust based on the number of samples)
#SBATCH --mem=100G                         # Memory per node
#SBATCH --chdir=/gscratch/scrubbed/sr320/github/project-mytilus-methylation/output/02-bismark-klone-array



# Execute Roberts Lab bioinformatics container
# Binds home directory
# Binds /gscratch directory
# Directory bindings allow outputs to be written to the hard drive.
apptainer exec \
--home "$PWD" \
--bind /mmfs1/home/ \
--bind /mmfs1/gscratch/ \
/gscratch/srlab/sr320/srlab-bioinformatics-container-586bf21.sif \
../../code/02.1.sh
</code></pre>
</section>
<section id="bash-script" class="level2">
<h2 class="anchored" data-anchor-id="bash-script">bash script</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/bash</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set directories and files</span></span>
<span id="cb2-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/raw-wgbs/"</span></span>
<span id="cb2-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../01-bismark-init/"</span></span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span></span>
<span id="cb2-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">checkpoint_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"completed_samples.log"</span></span>
<span id="cb2-7"></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the checkpoint file if it doesn't exist</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb2-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_1.fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${files</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$SLURM_ARRAY_TASK_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_1.fastq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample has already been processed</span></span>
<span id="cb2-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-18">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already processed. Skipping..."</span></span>
<span id="cb2-19">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 0</span>
<span id="cb2-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define log files for stdout and stderr</span></span>
<span id="cb2-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stdout_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stdout.log"</span></span>
<span id="cb2-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stderr.log"</span></span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark for this sample</span></span>
<span id="cb2-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 30 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> L,0,-0.6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> 10000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_1.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_2.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-36">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stdout_log}</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the command was successful</span></span>
<span id="cb2-39"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb2-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Append the sample name to the checkpoint file</span></span>
<span id="cb2-41">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb2-42">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> processed successfully."</span></span>
<span id="cb2-43"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb2-44">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> failed. Check </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> for details."</span></span>
<span id="cb2-45"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</section>
<section id="potential-pitfalls-and-tips" class="level2">
<h2 class="anchored" data-anchor-id="potential-pitfalls-and-tips">Potential Pitfalls and Tips</h2>
<ol type="1">
<li><p>Managing Array Jobs in SLURM</p>
<p>• Description: The SLURM array functionality (#SBATCH –array=0-47) is used to handle multiple samples. Each job in the array corresponds to a sample, allowing parallel processing, which is ideal for large datasets.</p>
<p>• Potential Issue: Array indexing can be confusing and prone to errors. If the job array range (0-47) does not match the number of samples, it could result in missing or redundant processing. In addition, if the number of samples changes, the array range needs to be updated manually, which can be a source of mistakes.</p>
<p>• Tip: Automate the array range based on sample count or add sanity checks to ensure the array indices match the actual sample count.</p></li>
<li><p>Path Bindings and Containerized Execution</p>
<p>• Description: The SLURM script calls an Apptainer container using apptainer exec with various paths bound (–home “$PWD” and –bind /mmfs1/home/ /mmfs1/gscratch/). This setup isolates the software environment, ensuring consistent software dependencies.</p>
<p>• Potential Issue: If bindings aren’t set up correctly, the container might not be able to access necessary directories, causing runtime errors or failed output generation. It can also be difficult to debug path issues inside the container.</p>
<p>• Tip: Double-check that all required directories (such as genome reference files or raw data folders) are accessible within the container. Testing path bindings on a single sample before running the full array can prevent widespread errors.</p></li>
<li><p>Checkpoint System for Completed Samples</p>
<p>• Description: The bash script uses a checkpointing system with completed_samples.log to track processed samples. Before processing, it checks if a sample is already in this log and skips it if so.</p>
<p>• Potential Issue: If the script is interrupted (e.g., due to a timeout or node failure), samples that were partially processed will not appear in completed_samples.log, potentially leading to partial or corrupted outputs. Additionally, if a sample’s output log is manually edited or removed, the checkpoint will no longer match.</p>
<p>• Tip: Regularly monitor completed_samples.log and the output logs to identify incomplete processing and re-run those samples if necessary. Implementing a more robust checkpointing system, such as one that verifies output file integrity, can also help.</p></li>
<li><p>Memory and CPU Allocation</p>
<p>• Description: The SLURM script requests 100 GB of memory and 30 CPU cores per task (–mem=100G and –cpus-per-task=30). These settings are essential for performance, particularly with WGBS, as Bismark can be resource-intensive.</p>
<p>• Potential Issue: Memory and CPU requirements may vary based on sample size and cluster specifications. Allocating too many resources can lead to longer queue times or wasted computational power, whereas insufficient resources can cause job failures.</p>
<p>• Tip: Start with smaller allocations to determine the minimum requirements for your dataset. Adjust based on real-time monitoring and optimize allocations to minimize queue times and reduce computation costs.</p></li>
<li><p>Error Handling and Logging</p>
<p>• Description: Standard output and error logs are generated for each sample (stdout_log and stderr_log). These logs are helpful for debugging if something goes wrong during processing.</p>
<p>• Potential Issue: If logging paths are incorrectly set, or if log files are overwritten by subsequent runs, critical information may be lost. Additionally, having separate logs for each sample can generate a large number of files, which may be challenging to manage and monitor.</p>
<p>• Tip: Consider implementing a log rotation system or consolidating logs for easier tracking. Reviewing the stderr_log periodically can help identify recurring issues before they impact large numbers of samples.</p></li>
</ol>
<p>Conclusion</p>
<p>While this SLURM and bash script setup provides a scalable solution for methylation analysis, understanding these potential challenges is essential for successful execution. By managing SLURM arrays carefully, verifying path bindings, implementing a reliable checkpoint system, optimizing resource requests, and ensuring robust error logging, researchers can streamline this workflow and avoid common pitfalls.</p>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>klone</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/32-bismark-array/</guid>
  <pubDate>Sun, 10 Nov 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-mytilus-methylation__RStudio_Server_2024-11-10_11-32-22.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Stats on e5 genomes</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/31-e5-genome-stats/</link>
  <description><![CDATA[ 





<p>This assessment compares the genomic assemblies and annotations of three coral species: <em>Acropora pulchra</em> (Apul), <em>Porites evermanni</em> (Peve), and <em>Pocillopora meandrina</em> (Ptuh). The analysis focuses on genome assembly metrics, gene annotation statistics, and potential biological implications.</p>
<hr>
<section id="genome-assembly-quality" class="level3">
<h3 class="anchored" data-anchor-id="genome-assembly-quality"><strong>1. Genome Assembly Quality</strong></h3>
<section id="number-of-sequences-and-contiguity" class="level4">
<h4 class="anchored" data-anchor-id="number-of-sequences-and-contiguity"><strong>Number of Sequences and Contiguity</strong></h4>
<ul>
<li><strong>Apul (A. pulchra)</strong>
<ul>
<li><strong>Number of Sequences:</strong> 174</li>
<li><strong>N50:</strong> 17,861,421 bp</li>
<li><strong>L50:</strong> 10</li>
<li><strong>Longest Sequence:</strong> 45,111,900 bp</li>
</ul></li>
<li><strong>Peve (P. evermanni)</strong>
<ul>
<li><strong>Number of Sequences:</strong> 8,186</li>
<li><strong>N50:</strong> 171,385 bp</li>
<li><strong>L50:</strong> 935</li>
<li><strong>Longest Sequence:</strong> 1,802,771 bp</li>
</ul></li>
<li><strong>Ptuh (P. meandrina)</strong>
<ul>
<li><strong>Number of Sequences:</strong> 212</li>
<li><strong>N50:</strong> 10,024,633 bp</li>
<li><strong>L50:</strong> 13</li>
<li><strong>Longest Sequence:</strong> 21,651,136 bp</li>
</ul></li>
</ul>
<p><strong>Assessment:</strong></p>
<ul>
<li><strong>Assembly Contiguity:</strong> Apul exhibits the highest assembly contiguity, indicated by the lowest number of sequences and highest N50 value. Ptuh ranks second, while Peve has a more fragmented assembly with a significantly higher number of sequences and lower N50.</li>
<li><strong>Sequence Length Distribution:</strong> Apul’s longest sequence is substantially longer than those of Peve and Ptuh, suggesting a more complete assembly.</li>
</ul>
</section>
<section id="genome-size-and-gc-content" class="level4">
<h4 class="anchored" data-anchor-id="genome-size-and-gc-content"><strong>Genome Size and GC Content</strong></h4>
<ul>
<li><strong>Total Genome Length:</strong>
<ul>
<li><strong>Peve:</strong> 603,805,388 bp</li>
<li><strong>Apul:</strong> 518,313,916 bp</li>
<li><strong>Ptuh:</strong> 376,579,914 bp</li>
</ul></li>
<li><strong>GC Content:</strong>
<ul>
<li><strong>Apul:</strong> 39.05%</li>
<li><strong>Ptuh:</strong> 38.03%</li>
<li><strong>Peve:</strong> 36.38%</li>
</ul></li>
</ul>
<p><strong>Assessment:</strong></p>
<ul>
<li><strong>Genome Size Variability:</strong> Peve has the largest genome size but the most fragmented assembly, which may indicate repetitive elements or assembly challenges.</li>
<li><strong>GC Content Consistency:</strong> All species have similar GC content, ranging from 36.38% to 39.05%, which is typical for coral genomes.</li>
</ul>
<hr>
</section>
</section>
<section id="gene-annotation-and-features" class="level3">
<h3 class="anchored" data-anchor-id="gene-annotation-and-features"><strong>2. Gene Annotation and Features</strong></h3>
<section id="gene-counts-and-features" class="level4">
<h4 class="anchored" data-anchor-id="gene-counts-and-features"><strong>Gene Counts and Features</strong></h4>
<ul>
<li><strong>Apul:</strong>
<ul>
<li><strong>Total Genes:</strong> 36,447</li>
<li><strong>Unique Features:</strong> 5 (exon, CDS, gene, mRNA, tRNA)</li>
<li><strong>Total GFF Entries:</strong> 499,892</li>
</ul></li>
<li><strong>Peve:</strong>
<ul>
<li><strong>Total Genes:</strong> 40,389</li>
<li><strong>Unique Features:</strong> 3 (CDS, mRNA, UTR)</li>
<li><strong>Total GFF Entries:</strong> 286,807</li>
</ul></li>
<li><strong>Ptuh:</strong>
<ul>
<li><strong>Total Genes:</strong> 31,840</li>
<li><strong>Unique Features:</strong> 3 (exon, CDS, transcript)</li>
<li><strong>Total GFF Entries:</strong> 448,910</li>
</ul></li>
</ul>
<p><strong>Assessment:</strong></p>
<ul>
<li><strong>Gene Count:</strong> Peve has the highest number of predicted genes, followed by Apul and Ptuh.</li>
<li><strong>Annotation Features:</strong> Apul includes tRNA annotations, which are absent in Peve and Ptuh. This suggests a more comprehensive annotation in Apul.</li>
<li><strong>Unique Sources:</strong> Different gene prediction tools were used—Apul (funannotate), Peve (Gmove), Ptuh (AUGUSTUS)—which may affect gene count and features.</li>
</ul>
</section>
<section id="gene-length-and-total-bases" class="level4">
<h4 class="anchored" data-anchor-id="gene-length-and-total-bases"><strong>Gene Length and Total Bases</strong></h4>
<ul>
<li><strong>Average Gene Length:</strong>
<ul>
<li><strong>Apul:</strong> 5,887.31 bp</li>
<li><strong>Ptuh:</strong> 1,376.95 bp</li>
<li><strong>Peve:</strong> 1,337.5 bp</li>
</ul></li>
<li><strong>Total Bases in Genes:</strong>
<ul>
<li><strong>Apul:</strong> 214,577,849 bp</li>
<li><strong>Peve:</strong> 54,020,937 bp</li>
<li><strong>Ptuh:</strong> 43,842,885 bp</li>
</ul></li>
</ul>
<p><strong>Assessment:</strong></p>
<ul>
<li><strong>Gene Length:</strong> Apul’s average gene length is significantly longer than that of Peve and Ptuh, potentially indicating differences in gene structure, annotation methods, or biological variation.</li>
<li><strong>Total Coding Sequence:</strong> Apul has a higher total base count in genes, which correlates with longer genes and may reflect a greater number of exons or longer intronic regions.</li>
</ul>
<hr>
</section>
</section>
<section id="biological-implications-and-considerations" class="level3">
<h3 class="anchored" data-anchor-id="biological-implications-and-considerations"><strong>3. Biological Implications and Considerations</strong></h3>
<ul>
<li><strong>Assembly Quality Impact:</strong> The higher contiguity in Apul and Ptuh assemblies may lead to more accurate gene predictions and annotations compared to Peve.</li>
<li><strong>Gene Prediction Tools:</strong> The use of different annotation tools can result in varying gene counts and features. Funannotate (Apul) provides tRNA annotations, suggesting a more thorough annotation pipeline.</li>
<li><strong>Gene Length Variation:</strong> The discrepancy in average gene lengths might be due to:
<ul>
<li><strong>Biological Differences:</strong> Genuine differences in gene structure among species.</li>
<li><strong>Annotation Strategies:</strong> Differences in handling of introns, UTRs, or alternative splicing events.</li>
<li><strong>Prediction Algorithms:</strong> Varying sensitivity and specificity of gene prediction tools.</li>
</ul></li>
</ul>
<hr>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion"><strong>4. Conclusion</strong></h3>
<ul>
<li><strong>Best Assembly:</strong> <em>Acropora pulchra</em> (Apul) exhibits the most contiguous and comprehensive genome assembly and annotation among the three species.</li>
<li><strong>Gene Annotation Depth:</strong> Apul’s inclusion of tRNA and longer gene lengths suggests a more detailed annotation, which could facilitate better functional genomics studies.</li>
<li><strong>Areas for Improvement:</strong> Peve’s fragmented assembly and shorter gene lengths indicate potential areas for reassembly and reannotation to improve genomic resources.</li>
</ul>
<hr>
<p><strong>Recommendation:</strong> For comparative genomics and evolutionary studies, researchers should consider the differences in assembly quality and annotation methods. Standardizing gene prediction tools and reannotating genomes where necessary could enhance the reliability of cross-species comparisons.</p>
<hr>
<p>data:</p>
<ul>
<li><p><a href="https://github.com/urol-e5/deep-dive-expression/blob/main/D-Apul/code/12-Apul-genome-explore.md" class="uri">https://github.com/urol-e5/deep-dive-expression/blob/main/D-Apul/code/12-Apul-genome-explore.md</a></p></li>
<li><p><a href="https://github.com/urol-e5/deep-dive-expression/blob/main/E-Peve/code/04-Peve-genome-explore.md" class="uri">https://github.com/urol-e5/deep-dive-expression/blob/main/E-Peve/code/04-Peve-genome-explore.md</a></p></li>
<li><p><a href="https://github.com/urol-e5/deep-dive-expression/blob/main/F-Ptuh/code/04-Ptuh-genome-explore.md" class="uri">https://github.com/urol-e5/deep-dive-expression/blob/main/F-Ptuh/code/04-Ptuh-genome-explore.md</a></p></li>
</ul>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/31-e5-genome-stats/</guid>
  <pubDate>Sat, 05 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2024-10-05_13-39-55.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Connecting annotations</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/30-hisat-annot/</link>
  <description><![CDATA[ 





<p>Here is a quick explanation of what many folks are running into. The challenge and the solution is very dependent on the species you are working with.</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="https://gannet.fish.washington.edu/seashell/snaps/RPReplay_Final1727953956.MP4"></video></div>


<!-- -->


 ]]></description>
  <category>blast</category>
  <category>hisat</category>
  <category>annotation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/30-hisat-annot/</guid>
  <pubDate>Thu, 03 Oct 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_bestblogever_-_main_-_RStudio_2024-10-03_10-09-40.png" medium="image" type="image/png"/>
</item>
<item>
  <title>re prime</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/29-prime/</link>
  <description><![CDATA[ 





<p>Went out to hatchery to re prime what is left from 10k seed on Friday Sept 13th.</p>
<p>Rinsed all bags with freshwater hose.</p>
<p>Bags 56 and 66 then went into FW (5 gallon bucket) for two hours.</p>
<p>47 and 30 were moved into white tank inside (far right). Water temperature 23C. (Lagoon is currently at 17C). Two heater set at 36 set to come on 11pm - 5am daily. Temperature profile is as follows.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_APEX_Fusion_2024-09-14_12-34-03.png" class="img-fluid figure-img"></p>
<figcaption>Apex</figcaption>
</figure>
</div>
<p>Bags 75 and 76 were placed in FW for two hours then moved into white tank described above.</p>
<p>Bags 36/37 (controls) and 50/49 (immune) simply went back to lagoon.</p>
<p>Still waiting for info on farm deployment but planning on going out Sunday and checking on water system (flow) and do freshwater immersions. Poly IC should arrive Monday.</p>
<section id="update-sunday-sept-15th" class="level1">
<h1>Update Sunday Sept 15th</h1>
<p>Went out and did FW immersion (2 hours) on 75/76 and 56/66.</p>
<p>Also snapped photos for documenting size and number of seed.</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_IMG_6967.png_2024-09-15_18-49-37.png" class="img-fluid" alt="Bag 30"> Full size images</p>
<ul>
<li><p><a href="http://gannet.fish.washington.edu/seashell/snaps/IMG_6967.png">Bag 30a</a></p></li>
<li><p><a href="http://gannet.fish.washington.edu/seashell/snaps/IMG_6968.png">Bag 30b</a></p></li>
<li><p><a href="http://gannet.fish.washington.edu/seashell/snaps/IMG_6969.png">Bag 30c</a></p></li>
</ul>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>stress</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/29-prime/</guid>
  <pubDate>Sat, 14 Sep 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-09-14_12-28-40.png" medium="image" type="image/png"/>
</item>
<item>
  <title>R N A T O G O</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-28-go-gene/</link>
  <description><![CDATA[ 





<p>tldr:</p>
<p>GO annotations for Deep Dive Transcript sets:</p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/D-Apul/output/20-Apul-gene-annotation/Apul-rna-GO.tsv" class="uri">https://github.com/urol-e5/deep-dive/blob/main/D-Apul/output/20-Apul-gene-annotation/Apul-rna-GO.tsv</a></p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/E-Peve/output/20-Peve-gene-annotation/Peve-rna-GO.tsv" class="uri">https://github.com/urol-e5/deep-dive/blob/main/E-Peve/output/20-Peve-gene-annotation/Peve-rna-GO.tsv</a></p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/F-Pmea/output/20-Pmea-gene-annotation/Pmea-rna-GO.tsv" class="uri">https://github.com/urol-e5/deep-dive/blob/main/F-Pmea/output/20-Pmea-gene-annotation/Pmea-rna-GO.tsv</a></p>
<hr>
<p>This was done just as with <a href="https://sr320.github.io/tumbling-oysters/posts/sr320-27-go/">proteins set</a> (except different query and blastx as opposed to blastp)</p>
<p>Note both Proteins and transcripts wre obtained from: <a href="https://github.com/urol-e5/deep-dive/wiki/Species-Characteristics-and-Genomic-Resources" class="uri">https://github.com/urol-e5/deep-dive/wiki/Species-Characteristics-and-Genomic-Resources</a></p>
<hr>
<p>Actual code at</p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/20-Apul-gene-annotation.Rmd" class="uri">https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/20-Apul-gene-annotation.Rmd</a></p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/E-Peve/code/20-Peve-gene-annotation.Rmd" class="uri">https://github.com/urol-e5/deep-dive/blob/main/E-Peve/code/20-Peve-gene-annotation.Rmd</a></p>
<p><a href="https://github.com/urol-e5/deep-dive/blob/main/F-Pmea/code/20-Pmea-gene-annotation.Rmd" class="uri">https://github.com/urol-e5/deep-dive/blob/main/F-Pmea/code/20-Pmea-gene-annotation.Rmd</a></p>


<!-- -->


 ]]></description>
  <category>blast</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-28-go-gene/</guid>
  <pubDate>Tue, 27 Aug 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_deep-dive__RStudio_Server_2024-08-27_16-05-41.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Git that Pro GO</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-27-go/</link>
  <description><![CDATA[ 





<p>tldr:</p>
<p>Got GO annotations for Deep Dive Protein sets:</p>
<p>https://raw.githubusercontent.com/urol-e5/deep-dive/main/D-Apul/output/20-Apul-gene-annotation/Apul-protein-GO.tsv</p>
<p>https://raw.githubusercontent.com/urol-e5/deep-dive/main/E-Peve/output/20-Peve-gene-annotation/Peve-protein-GO.tsv</p>
<p>https://github.com/urol-e5/deep-dive/raw/main/F-Pmea/output/20-Pmea-gene-annotation/Pmea-protein-GO.tsv</p>
<hr>
<p>Here is example code</p>
<section id="apul-annotation" class="level1">
<h1>20-Apul Annotation</h1>
<p>Steven Roberts 25 August, 2024</p>
<p>Apul</p>
</section>
<section id="protein" class="level1">
<h1>Protein</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> https://gannet.fish.washington.edu/seashell/snaps/GCF_013753865.1_Amil_v2.1.protein.faa</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/GCF_013753865.1_Amil_v2.1.protein.faa</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../../data/blast_dbs</span></code></pre></div>
</section>
<section id="swiss-prot-download" class="level1">
<h1>Swiss Prot download</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../../data/blast_dbs</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.fasta.gz</span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> uniprot_sprot.fasta.gz uniprot_sprot_r2024_04.fasta.gz</span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gunzip</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k</span> uniprot_sprot_r2024_04.fasta.gz</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta</span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Sequences"</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">-in ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-out ../../data/blast_dbs/uniprot_sprot_r2024_04</span></code></pre></div>
</section>
<section id="blastp" class="level1">
<h1>Blastp</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/GCF_013753865.1_Amil_v2.1.protein.faa"</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5">-db ../../data/blast_dbs/uniprot_sprot_r2024_04 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-6">-out ../output/20-Apul-gene-annotation/blastp_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-7">-evalue 1E-05 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">-num_threads 48 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-10">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-11">-outfmt 6</span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/20-Apul-gene-annotation/blastp_out.tab</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'|'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\t'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ../output/20-Apul-gene-annotation/blastp_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/20-Apul-gene-annotation/blastp_out_sep.tab</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> ../output/20-Apul-gene-annotation/blastp_out_sep.tab</span></code></pre></div>
</section>
<section id="download-go-info" class="level1">
<h1>Download GO info</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap__in_UniProtKB_search_571864__UniProt_2024-08-23_16-18-03.png" class="img-fluid"></p>
<pre><code>sr320@raven:/home/shared/8TB_HDD_01/sr320/github/deep-dive/data$ curl -H "Accept: text/plain; format=tsv" "https://rest.uniprot.org/uniprotkb/stream?fields=accession%2Creviewed%2Cid%2Cprotein_name%2Cgene_names%2Corganism_name%2Clength%2Cgo_p%2Cgo_c%2Cgo%2Cgo_f%2Cgo_id&amp;format=tsv&amp;query=%28*%29+AND+%28reviewed%3Atrue%29" -o SwissProt-Annot-GO_082324.tsv</code></pre>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../../data/SwissProt-Annot-GO_082324.tsv </span></code></pre></div>
</section>
<section id="join-blast-with-go-info" class="level1">
<h1><strong>Join blast with GO info</strong></h1>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">bltabl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/20-Apul-gene-annotation/blastp_out_sep.tab"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb12-2"></span>
<span id="cb12-3">spgo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/SwissProt-Annot-GO_082324.tsv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">annot_tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(bltabl, spgo, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V3"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Entry"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(</span>
<span id="cb13-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">query =</span> V1,</span>
<span id="cb13-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">blast_hit =</span> V3,</span>
<span id="cb13-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">evalue =</span> V13,</span>
<span id="cb13-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ProteinNames =</span> Protein.names,</span>
<span id="cb13-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BiologicalProcess =</span> Gene.Ontology..biological.process.,</span>
<span id="cb13-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GeneOntologyIDs =</span> Gene.Ontology.IDs</span>
<span id="cb13-9">  )</span></code></pre></div>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(annot_tab)</span></code></pre></div>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.table</span>(annot_tab, </span>
<span id="cb15-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/20-Apul-gene-annotation/Apul-protein-GO.tsv"</span>, </span>
<span id="cb15-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, </span>
<span id="cb15-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb15-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quote =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/20-Apul-gene-annotation/Apul-protein-GO.tsv</span></code></pre></div>
<hr>
<p>Actual code at</p>
<p>https://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/20-Apul-gene-annotation.Rmd</p>
<p>https://github.com/urol-e5/deep-dive/blob/main/E-Peve/code/20-Peve-gene-annotation.Rmd</p>
<p>https://github.com/urol-e5/deep-dive/blob/main/F-Pmea/code/20-Pmea-gene-annotation.Rmd</p>


<!-- -->

</section>

 ]]></description>
  <category>blast</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-27-go/</guid>
  <pubDate>Sun, 25 Aug 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap__in_UniProtKB_search_571864__UniProt_2024-08-23_16-18-03.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Double header</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-26-ploidy/</link>
  <description><![CDATA[ 





<p>Did a Tuesday / Wednesday B2B. Tuesday - focused on finding Kathleen diploids and triploids.</p>
<section id="ploidy" class="level2">
<h2 class="anchored" data-anchor-id="ploidy">Ploidy</h2>
<p>See <a href="https://shedurkin.github.io/Roberts-LabNotebook/posts/projects/pacific_oyster/2024_06_25_Point_Whitney.html">Kathleen’s post</a> for more details.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TLDR: Kathleens’s post
</div>
</div>
<div class="callout-body-container callout-body">
<p>The experiment took place at Point Whitney, and involved selecting, counting, measuring, and segregating 200 oysters each from diploid and triploid groups into different treatment and control groups. The oysters ranged in size from 20mm to 60mm, and notable observations included size differences between the groups and instances of mortality and fused oysters.</p>
<p>The oysters were separated into four treatment bags, two each for diploids and triploids, without individual tags but with identifiers on the bags to distinguish among treatment groups and controls. The stress hardening plan involves subjecting these oysters to elevated temperatures (35°C) for four-hour sessions, three times a week for two weeks, with the aim of studying their response to stress.</p>
</div>
</div>
<p>On Wednesday, I exposed the treated cohorts to 35°C for 4 hours using right white tub. Oyster are outside in 3-holer.</p>
</section>
<section id="also-did-some-larvae-work." class="level2">
<h2 class="anchored" data-anchor-id="also-did-some-larvae-work.">Also did some larvae work.</h2>
<p>Tuesday 3PM I checked the parameter. They were only single digits, around two or five. The header tank was almost three-quarters full. What I did is I increased the flow water input into the three close uhddles. So now it’s a steady stream. Did not touch the flow of the water coming into the back three. And I doubled the pump rate. It was at 40 and now it is at 80. [water букetting] The other thing, I realized that if you increase the flow, the huddles cannot take it. While I didn’t clean the huddles, I decided for the top three that were getting the higher flow that I would change them out from 40 microns to 75 microns.</p>
<p>Wednesday 11AM First row was now reading 50 on flourometer. Back row 2,2, 20. Went ahead and changed back to 75um filters. Noting flow rate is still different between front and back rows.</p>
</section>
<section id="k-seed-start" class="level2">
<h2 class="anchored" data-anchor-id="k-seed-start">10k seed start</h2>
<p>Seed were divided into 10 bags.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-27_10-26-59.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>seed</figcaption>
</figure>
</div>
<p>Plan is to do 5 treatments - Tagging on to Kathleens</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Bags</th>
<th>Treatments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>14 &amp; 18</td>
<td>35C for 1hour</td>
</tr>
<tr class="even">
<td></td>
<td>Freshwater 1 hour</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>control</td>
</tr>
</tbody>
</table>
<p>Bags stay in lagoon.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-27_10-31-57.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>lagoon</figcaption>
</figure>
</div>
</section>
<section id="hatchery-planner" class="level2">
<h2 class="anchored" data-anchor-id="hatchery-planner">Hatchery planner</h2>
<p><a href="https://docs.google.com/spreadsheets/d/1CRWMH9Tk5LQFAhCYJin3_Epk1yLwI7kGytP3hRK2vZU/edit?usp=sharing">google-sheet</a></p>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>temperature</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-26-ploidy/</guid>
  <pubDate>Wed, 26 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-27_10-12-25.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Oyster bath</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-25-oyster/</link>
  <description><![CDATA[ 





<p>On the 17th Madeline set up an incubator to see how long it would take oysters to die- <a href="https://genefish.wordpress.com/2024/06/17/6-17-24/">POST</a></p>
<p>On the 18th we saw no signs of death but added oysters in water.. in beakers and 12-well plate</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2024-06-21_12-27-11.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>incubator</figcaption>
</figure>
</div>
<p>Camera monitoring of adults has yet to observe gapping</p>
<p>On the 20th there was death likely in dry oysters based on smell but no visual indication of gaping.</p>
<p>The oysters in the 12 well plate had gapers. 5/6 of oysters in freshwater were gaping and 3/6 of oyster in seawater were gaping. <em>This equates to gaping at 48 hours</em>.</p>
<p>On the same day oysters were placed in 12 well plate and clear tupperware.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2024-06-21_12-32-00.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>incubator</figcaption>
</figure>
</div>
<p>Note that we went with both “large” and “small” in 12-well plate. The last cohort in the 12-well were all “small”.</p>
<p>Oyster were check by Kathleen on June 21 with no gaping.</p>
<p>Camera shows no gaping on adults on 21.</p>


<!-- -->


 ]]></description>
  <category>oyster</category>
  <category>temperature</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-25-oyster/</guid>
  <pubDate>Thu, 20 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2024-06-21_12-20-56.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Huddl Launch</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-24-fd/</link>
  <description><![CDATA[ 





<p>Went out to the hatchery for a day 3 drop of commercial spawn. Larvae were in 2 5k tanks. The night before there was a bit of a banjo filter clog but it seems no larvae were lost.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-17_10-18-50.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>larvae</figcaption>
</figure>
</div>
<p>We were able to get 1 Million larvae. Those that were caught on 40um filter. The hatchery kept everything on 70 &amp; 60 um filters which came out to be about 66 million.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-17_10-06-00.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>larvae</figcaption>
</figure>
</div>
<p>Huddls were at about 28C with algae pump set at 30 and algae tank getting 24 liters of algae (topped of with water). Flourometer counts were quite high ~40 when larvae were added but we cannot figure out how it got that high. EDTA (0.04g) was added to 50 gallon header. Commercial group will be left in tanks for 8 days. We will try something similar.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-17_10-17-35.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption>system</figcaption>
</figure>
</div>


<!-- -->


 ]]></description>
  <category>oyster</category>
  <category>aquaculture</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-24-fd/</guid>
  <pubDate>Mon, 17 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_ChatGPT_2024-06-17_10-21-36.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Repro Repro</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-23-repro/</link>
  <description><![CDATA[ 





<p>Using Swiss-Prot Repro subset..</p>
<p>Based on the following GO Term</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_QuickGOTerm_GO0022414_2024-06-15_17-30-33.png" class="img-fluid figure-img"></p>
<figcaption>GO:0022414</figcaption>
</figure>
</div>
<p><a href="https://www.ebi.ac.uk/QuickGO/term/GO:0022414" class="uri">https://www.ebi.ac.uk/QuickGO/term/GO:0022414</a></p>
<section id="make-blastdb" class="level1">
<h1><strong>Make BlastDB</strong></h1>
<p>(Would only be needed once)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A0022414%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../data/SwissProt-GO:0022414.fa</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/SwissProt-GO:0022414.fa</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Sequences"</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> ../data/SwissProt-GO:0022414.fa </span></code></pre></div>
</div>
<pre><code>&gt;sp|A0A060A682|HAP2_TETTH Hapless 2 OS=Tetrahymena thermophila OX=5911 GN=HAP2 PE=1 SV=1
MKFLAFGLIYFHFCILNRCEYITSSTIQKCYNSSNEPNNCSQKAVIVLSLENGQIANTEQ
VVATLNQLSDSGVNKQLQNSFIFEVTKSPVTALFPLIYLQDFNSQPLEQVIATTLFSCKD
GFYDSSPTCKFQYDSKGQKILDSQGYCCYCSLSDILGMGNDLSRGKVCYALNLGAGSATA
HCLKFSPLWYSAFKIQQYQLYFEVNINIYTVDSQNQKNLKQTLKLSTSNPTMKSSDNSTI
SKIIGTFTPTQPPADLSSYYLVKPSFPATDPRVLQGISSWMFVDKTMFTLDGTQCNKIGV
SYSGFRQQSSSCSQPVGSCLQNQLENLYQSDLILLSQNKQPKYLLESQGNFNQVQFQGQT
ILQQGLSGSASTLITIEIDAAQIKFVTNLGIGCISQCSINNFESHSGNGKLVALVQNQGN
YSAEFVLGFNCSSNVQPIQGQKLFLTANQLYNFNCSVSVNSDISAINNNCTINLYDAIGN
QLDSKNILFNTTSTNHTSNQGNNTGQQQSSQEYKSSQSCSDKCSSFWSFWCYFSAGCIKE
Number of Sequences
12309</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.11.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2">-in ../data/SwissProt-GO:0022414.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">-out ../blastdb/SwissProt-GO:0022414</span></code></pre></div>
</div>
</section>
<section id="set-query" class="level1">
<h1><strong>Set Query</strong></h1>
<section id="set-fasta-as-variable" class="level2">
<h2 class="anchored" data-anchor-id="set-fasta-as-variable"><strong>set fasta as variable</strong></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/PO2457_Ostrea_lurida.protein.fasta"</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Sequences"</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span></span></code></pre></div>
</div>
<pre><code>&gt;ANN15860-RA
MTDFGIYEVPVQTGVNHTTSSCALQCEIRTTCTLFRINKLTSECDFYNGGRYKTAIPVQGNQFYQKVPDSANCISGRDEWFPEYQKCIWIHMEALNHQEAKDRCESGGKIMMGAKDTTQIKSLMNLLDFKWIHVYALRVGQKSYEWFDGSSVSSTNWWCSDQPYEDSACLGVDLSMIHWCLAGGIDDIPCTDDRTFFCV
&gt;ANN15859-RA
MYLCKDFYAIMESSKGDDCENDEDACLQNPCPMDRNCTDLSPDEETAFGRGYNCTPCPSGYQDIDNKCEDLDECNNNSTNICDSFTQDCENTEGGYDCTCKTGYRKVGQTCHDIDECSESTSDCQQICTNSPGSFSCSCVVGHSLNSDNKNCTAQVTDICYDAGLSCEYTCDNSTGTFVCVCPSGYELESNGQNCTVVRGIRVRIGLQHPLACRKRRLNGAVIRMRLEKPRSRVTADIDECTRSVCSQACNNTIGSYSCFCFPGYSLNSDKTTCLACEAPYYGDNCGQVCRCGAGLESCDQVHGCLCLSGWTGTSCNLDIDECTANPAICGSDKICKNLQGSYTCNCREGFEKNGTECVDIDECTNADNNNCNEWTSMCQNTYGGYTCKCLTGYKKKISYYGEILDAFVCHDIDECALDTHDCAQTCTNADGGYHCGCQFGFVLADDRRSCERVSDIASLFPSLNCSYAYKENPSNTSAAYCFCENGYYLHPKDQQSCIDVNECQFYSDTYVVLNKCSNYYHRFTNCVNVPGSYQCTCPPVGFVLENDERTCAVCDGFHYGEDCKTPCNCGPGALTCDNLRGCQCKMGWAGSRCEADIDECSTGTLCTGTNQVCQNTPGSYQCICDTGYKAIRWGICIDIDECNTGTNPCSQVCTNTPGSYYCSCNTGFRLVGTSQCDDYDECSAPVSACDQVCVNTVGSYKCSCNPGFLLNSTTRTTCYSKTVCTNTTLNCSQQCGVNSGGSEYCFCNIGYTLNADGFSCDDRDECSPNPCSENCSQNAPGAGYTCSCSVGKKLDVDQRTCIDCDTGTYGLNCATNCSCNDQNTKSCDKVTGSCICKTGWEGTNCSSDINECLNKTICPSISNCFNNVGTYSCICPSGYSLIGGQCIECSSSTYGLNCGSSCSCKFIFTQSCNKQNGGCSCMFGRDAPNCRYDIGECFNPNTCNLNNSFCSEEPFPYMCICLKGYEYEKHSNGTCIDINECARGTSNCDKNAVCINTEGSFNCSCKSGFTGNGLTCTAALTTTQRVTPGDVTTQRVTPSDVTTQRVTPSGVTTQRVTPGDVTTQRVTPGDVTTPRVTPGDVTTPRVTPGYVTTQRVTPGDVTTTQVIPVDVTTPRVTPGDITTPRVTPGDITTLRVTPGDVTTPRVTPGDVTTLRVTPGDVTTPRVTPGDVTIPHFTPGVVTTQRVTPGDVTTPRVTPGDVITPRITSGDVTSSESVTTDTSTTPVTSQSTEVPTTYTPATGEALFSVSFTFSIDGKQDEKEAIQSEMLTALTALYTGRIKGFIKVILIDSRLGGLIGDHSVVTSSNTPVETRSDFTRTLNNLAKGALKITYNGTQYPVWAIAVADSTGNLQNVSVLVSSTVCQVFDTLNTCPRGQQCDDLDGIVQCRVIEINSKQDSLKVIVGLGVGIPLSFIVVLVLAIIWICYCRQKHKERYFSSKDDLDKTMHTDGFLISGIPTRIFSLGWRVPHALRNWGDDSSTSDVNERRGRRGRGFGNTYRGGRQLYSELIFNYRMMGNF
&gt;ANN15862-RA
MSVTYLKGLSTRYRNLTEKEIKRGDELVSVDISEENPTVLLRNVETSSRRIKEFSGKLEETMEKWSMAIEDKETQQGEHDKFSEISEVVFNLLAEANESSDQLVILEKTLQEHLATLKKPAEMTDPRLEQMIHLQSKMQEQILHFQELSLQQHRPGQVAVKLPKLELPTYNGDKIKFKEFWDAFDATVHKNPKLSNIEKFNYLRSKLIGPAHVAISGLSLSNENYDVAITILRDRFGDTQSVINKHYVELINTQCATNDTLSLRKLYDDLERHLRSLEALHQDVNQDVFISMITSKLPKETLLQLEIQKGPKGKWTVQKLRELLKGYITVKESSELQAASVAVHEDKHMTAEALVISTKESTIKHDRQTRRSEKSPMCTYCDGSHWTDECRRYRTIEDRKQRLKGKCFICLKSGHRSKECRVVKACYHCKQTGDHHRSLCPKKFTLRHRESTNTHLTEEVCRTSETPKRSTMSENSLLSSGDIVLMQTARTEVSNQCRENSEPARLLMDSGSQRTYITEKLADKLKLKTRITEKISLITFGAEKPKIVKTPKVSLTIKLKDGQYLSIEANVVPQITGTVQRKPIPKDVQERCQNIWKNLQLADTLPENFEDSTIDILVGSDYYLDLILPERIEIQRGFYLLASRLGWILTGRTQETFGREEQVMMITNGTLSLTEYCLHSAVDECIFTNSLDDFWNLEAIGIQDSPYTSDDERALENFNKTLKIEDNRYQVTWPWKEEFPELPENRELAFGRLKSLVHKLQRNPDLLHKYDDIIQDQCTRGIIEKIPSNHRETGVKHYIPHHAVVDLTKPTTKVRIVYDASAKTEHSHSSLNECLHRGPVMLHDLCGLLMRFRLKKIGIIADIEKAFLQIGLQEKDRNATRFFWLKDATNPTVEDNVQVYRFCRVPFGVISSPFLLAATVDHHLSSYNSETAENIRNNIYVDNVITGVDTIQEAEILYKEAKQIFGDISMNLRDWSSNAEEFHRFIPTEDQSARENLKILGLTWDLKEDVLTVPYQKSKTAPVTKREVLQRVASIFDPLGFFTPVTLKAKLFLQTLWQKNLEWDAPLTKEDIQEWKVIAADLVDIQYCQIPRYLGLSGEVSYRLLCFCDASAKAFATVVYLQLIDASSNICRLVFSKTRLAPTKQITMPRLELLAVLIGVRSMCFVENQLKLKISEKILWTDPQCVLHWIKTKKPLTVFVENRVKEIREKVDLELQYVTSADNPADIASRGIMAETLKDSMQWWNGPSWLTEKKSQWPVWNPSSNDIHSDAIESEYKKPRVMYEAKLLAGEGPPGYKDTCAEQKNPFDIDAERFSSFMKLIRVLAWIQRFIKKLKREKSACGPLTVEEMEEAKILLIKSIQNQNYTDVKSALIEKKRHNLVNQLGLTLDEDGIIRCIGRLGAAQLTEGARAPILLPKKNHVTDLLIDSYHRKSLHAGVSQTLSIVRQTYWIPQGRAEVRRVLRKCTVCKRHEGGPYRMPLMPPLPRKRVNESSPFTYTGVDYFGPIYVKANSGTKKVWVCLFTCLVVRSVHLELMQDMSTEEFLLGLRRFIARWGKPRQLISDNASQFKLASGVIEKAWSSTVSDVDVQSYVANEDMKWQFIVELAPWMGGFYERLIGVVKRCLRKTIGKLCLAFEQLRTLLAEAEAAVNSRPLVYVGDDINSNITLTPAHFLSLNPKIGISGCGEEENTEDPEYLPNISNAEVLLQTWKKGQKHLDAFWKAWRDDYLLSLRERTAYKLKEGRIQHCKEPQIDDVVLIKDDLPRGSWKIGRVCELRASQDGQIRSGKVLLPNKKTLNRPLNLLYPIECSKETENSDSEATKENQSTESDHGTVSGIESVTKPKSQPVLRETPDARPKRRSARRAEEKIKDWLNP
&gt;ANN15865-RA
MMALLDQEENNFIRAIFTIHAIAPKAVKRLFKNRHPDNGILTQELSAIKSDLMRTKGFPKHMAFLIFPSQGKHVNPDEFDLSVLIFLLQNFSNLPAPIKGWNTKPPITDSSEAADLTRIRLIRNDLAHNNDGKLKQSEFEVLWKELERVSIFRYLNFIIYLCAHGGCDRSAEDAYSSMAPDPAFASSKALGRLGEGVYDDELKNCKIATRENIDDMKRQVQELSDEIKFFEIATRENIDDMNTQVQGLREELQSPVPFNIRRDMLEEVEEWRKENEDFYETNFARNLHQAAAKEDFIMIIGEPGSGKTTTMHHIALKLNVEGGYDILPIQKPSEIKQYYSNNKRQVFVIDDAVGVHSLNDAMMREWEDLKPSLKRWKLLMINDFVKQSTKLTDPRNHVREMQEKHQCKILVSCRSFLTKTDAFPAFLREIEIVDAQNSRNRIGYLERQNIFATIFRTTRESIPLSKEIVMQYDSFPLLCRMCCSQGTIKPEVFFKRPFKHYFEEIDRMFHENKLSYFVLIFCLVFRCSFPDKPNSDTMEGFHSILDKCHLNQGTSYEEIRATILAMKDTYLRKVGEDEYDFYHIIIRDIIAYHFHSKSGLPILTKYGSDSFIRDRIRPKGPLPEDNPDDGYLIELKKDELSNFIERVCKNLMVKDWLVTFNSNFLPDAELEMHICKYLDRTNQFHSLLKRTNKHQSPNDLTKIQSYNRLLAALVDFPYKKTYQDIYHLRKEVLRPLTFIFWLIGFGWFEMFKAAFAISDTNITREIENSRHATLVLSALGGDEKMIRFINKSIVKSNSRCFICKTSAFLETFFVHCCNCPINHLSGFTIACIMGNGKVANYLKGILSYSADTEFDVSVLENFCTPKVGYLRHYRVSVMEIACNLGHMDMVCHFFKEKKLRIGTVKKSLLMACQNGQKDVFEFLLTEIPKDRFKDIDIRSLLKRSLYIASYFGHEMLVALLLERNVPVDTCDTSKRTPLLAASGRGHINVAKVLFSSGANVNSSDVFGWTPLKVACAKGYTEIVRLLLTNDDIILDDPNSDKCTSENRELPIRVTDEVSDTLLRRVFVSRTYNAILAVFPGYDLFPLFLASCNGHHEIVELLLSKGVSVDRTIEVGGIESSLTVASSNGYPKVVSLLLAHGASLYVEGSGRTALMSVCSSEGNSFNIIPNSVYRETDKYFLGDANHLEAVKEILSKDNSQQFLDTKDEEGMSALHFASLNCHSDIIDLLLVQNIEINTRNSSGITPLWLASKYDYPEIVSILVSHDADVNICSKDKHSPLWIACAERTEGYGLFDTVWTHGKVISMLLTKADIDSIGIENLTALNIACMKDDDELVSYLLSKGASIGNNLLLAFLQTHFKIAGLLILEKIRRL
&gt;ANN15866-RA
MLTPTRHLIPPLGTTNVRILYLNGEFLLDSLERIRERVPKFSSAVALVDFYARLTHTGKDYNCKWTEDLSIALQKPKPHRVVNLRHLCRLSINRSVPNTVTRTEMLGYLDKLPVSRHLKTYLKEYPYIH
Number of Sequences
33939</code></pre>
</section>
</section>
<section id="blast" class="level1">
<h1><strong>Blast</strong></h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/PO2457_Ostrea_lurida.protein.fasta"</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5">-db ../blastdb/SwissProt-GO:0022414 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-6">-out ../output/04-repro-annot/blastout.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-7">-evalue 1E-20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-8">-num_threads 48 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-9">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-10">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-11">-outfmt 6</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/04-repro-annot/blastout.tab</span></code></pre></div>
</div>
<pre><code>ANN15859-RA sp|P07207|NOTCH_DROME   27.146  1072    523 60  96  1012    162 1130    5.83e-40    162
ANN15865-RA sp|Q9VCA8|ANKHM_DROME   27.049  366 193 9   907 1269    2316    2610    1.97e-24    110
ANN15898-RA sp|Q9Z0E8|S22A5_MOUSE   27.604  576 327 13  236 784 12  524 4.19e-57    204
ANN15903-RA sp|Q9Z0E8|S22A5_MOUSE   29.242  554 337 11  16  545 2   524 1.16e-63    217
ANN15914-RA sp|P49891|ST1E1_MOUSE   31.250  256 153 8   28  269 49  295 2.65e-26    103
ANN04321-RA sp|O15455|TLR3_HUMAN    22.802  671 421 18  29  655 238 855 1.93e-26    114
ANN04322-RA sp|P15620|ZN271_MOUSE   24.554  505 321 18  1022    1523    80  527 2.78e-26    114
ANN04330-RA sp|O88572|LRP6_MOUSE    27.494  902 546 38  66  930 65  895 9.40e-60    226
ANN04334-RA sp|P20241|NRG_DROME 25.049  507 314 23  299 765 26  506 2.24e-24    109
ANN04339-RA sp|Q969R2|OSBP2_HUMAN   50.591  761 322 13  11  757 184 904 0.0 749</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/04-repro-annot/blastout.tab</span></code></pre></div>
</div>
<pre><code>4641 ../output/04-repro-annot/blastout.tab</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tr</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'|'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\t'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ../output/04-repro-annot/blastout.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/04-repro-annot/blastout_sep.tab</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> ../output/04-repro-annot/blastout_sep.tab</span></code></pre></div>
</div>
<pre><code>ANN15859-RA sp  P07207  NOTCH_DROME 27.146  1072    523 60  96  1012    162 1130    5.83e-40    162</code></pre>
</section>
<section id="download-swiss-prot-information" class="level1">
<h1><strong>Download Swiss-Prot Information</strong></h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain; format=tsv"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?fields=accession%2Creviewed%2Cid%2Cprotein_name%2Cgene_names%2Corganism_name%2Clength%2Cgo_p%2Cgo_c%2Cgo%2Cgo_f%2Cgo_id&amp;format=tsv&amp;query=%28%28go%3A0022414%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../data/SwissProt-GO:0022414.tsv</span></code></pre></div>
</div>
</section>
<section id="join-blast-with-go-info" class="level1">
<h1><strong>Join blast with GO info</strong></h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">bltabl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-repro-annot/blastout_sep.tab"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb15-2"></span>
<span id="cb15-3">spgo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/SwissProt-GO:0022414.tsv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">header =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">annot_tab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(bltabl, spgo,  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"V3"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Entry"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(V1, V3, V13, Protein.names, Organism, Gene.Ontology..biological.process., Gene.Ontology.IDs)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(annot_tab)</span></code></pre></div>
</div>
<pre><code>           V1     V3      V13
1 ANN15859-RA P07207 5.83e-40
2 ANN15865-RA Q9VCA8 1.97e-24
3 ANN15898-RA Q9Z0E8 4.19e-57
4 ANN15903-RA Q9Z0E8 1.16e-63
5 ANN15914-RA P49891 2.65e-26
6 ANN04321-RA O15455 1.93e-26
                                                                                                                        Protein.names
1                                             Neurogenic locus Notch protein [Cleaved into: Processed neurogenic locus Notch protein]
2                  Ankyrin repeat and KH domain-containing protein mask (Multiple ankyrin repeat single KH domain-containing protein)
3 Organic cation/carnitine transporter 2 (High-affinity sodium-dependent carnitine cotransporter) (Solute carrier family 22 member 5)
4 Organic cation/carnitine transporter 2 (High-affinity sodium-dependent carnitine cotransporter) (Solute carrier family 22 member 5)
5       Sulfotransferase 1E1 (ST1E1) (EC 2.8.2.4) (Estrogen sulfotransferase, testis isoform) (Sulfotransferase, estrogen-preferring)
6                                                                                             Toll-like receptor 3 (CD antigen CD283)
                             Organism
1 Drosophila melanogaster (Fruit fly)
2 Drosophila melanogaster (Fruit fly)
3                Mus musculus (Mouse)
4                Mus musculus (Mouse)
5                Mus musculus (Mouse)
6                Homo sapiens (Human)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Gene.Ontology..biological.process.
1 actin filament organization [GO:0007015]; asymmetric cell division [GO:0008356]; axon guidance [GO:0007411]; border follicle cell migration [GO:0007298]; cell dedifferentiation [GO:0043697]; cell differentiation [GO:0030154]; cell fate commitment [GO:0045165]; chaeta development [GO:0022416]; chaeta morphogenesis [GO:0008407]; compartment boundary maintenance [GO:0060289]; compound eye development [GO:0048749]; compound eye morphogenesis [GO:0001745]; compound eye retinal cell programmed cell death [GO:0046667]; crystal cell differentiation [GO:0042688]; defense response to insect [GO:0002213]; determination of adult lifespan [GO:0008340]; dorsal appendage formation [GO:0046843]; dorsal closure [GO:0007391]; dorsal/ventral axis specification [GO:0009950]; embryonic hemopoiesis [GO:0035162]; epithelial cell proliferation involved in Malpighian tubule morphogenesis [GO:0061331]; epithelial cell type specification, open tracheal system [GO:0035153]; eye-antennal disc development [GO:0035214]; eye-antennal disc morphogenesis [GO:0007455]; female germ-line stem cell population maintenance [GO:0036099]; follicle cell of egg chamber development [GO:0030707]; follicle cell of egg chamber migration [GO:0007297]; follicle cell of egg chamber stalk formation [GO:0030713]; foregut morphogenesis [GO:0007440]; formation of a compartment boundary [GO:0060288]; germ-line stem cell population maintenance [GO:0030718]; germ-line stem-cell niche homeostasis [GO:0060250]; germarium-derived egg chamber formation [GO:0007293]; glial cell differentiation [GO:0010001]; glial cell fate determination [GO:0007403]; glial cell migration [GO:0008347]; hemocyte proliferation [GO:0035172]; imaginal disc-derived leg joint morphogenesis [GO:0016348]; imaginal disc-derived leg morphogenesis [GO:0007480]; imaginal disc-derived leg segmentation [GO:0036011]; imaginal disc-derived male genitalia morphogenesis [GO:0048803]; imaginal disc-derived wing margin morphogenesis [GO:0008587]; imaginal disc-derived wing morphogenesis [GO:0007476]; imaginal disc-derived wing vein specification [GO:0007474]; intestinal stem cell homeostasis [GO:0036335]; lamellocyte differentiation [GO:0035171]; larval lymph gland hemopoiesis [GO:0035167]; lateral inhibition [GO:0046331]; leg disc morphogenesis [GO:0007478]; long-term memory [GO:0007616]; lymph gland development [GO:0048542]; Malpighian tubule tip cell differentiation [GO:0061382]; mesoderm development [GO:0007498]; morphogenesis of an epithelial fold [GO:0060571]; motor neuron axon guidance [GO:0008045]; muscle cell cellular homeostasis [GO:0046716]; muscle cell fate determination [GO:0007521]; myoblast development [GO:0048627]; negative regulation of cell-cell adhesion mediated by cadherin [GO:2000048]; negative regulation of compound eye photoreceptor development [GO:0045316]; negative regulation of gene expression [GO:0010629]; negative regulation of lamellocyte differentiation [GO:0035204]; negative regulation of neurogenesis [GO:0050768]; negative regulation of Notch signaling pathway [GO:0045746]; nervous system process [GO:0050877]; neuroblast development [GO:0014019]; neuroblast fate determination [GO:0007400]; neuroblast fate specification [GO:0014018]; neuroblast proliferation [GO:0007405]; neuron fate determination [GO:0048664]; neuron fate specification [GO:0048665]; neuronal stem cell population maintenance [GO:0097150]; Notch signaling pathway [GO:0007219]; ommatidial rotation [GO:0016318]; oocyte localization involved in germarium-derived egg chamber formation [GO:0030720]; oogenesis [GO:0048477]; peripheral nervous system development [GO:0007422]; positive regulation of cell population proliferation [GO:0008284]; positive regulation of crystal cell differentiation [GO:0042691]; positive regulation of DNA-templated transcription [GO:0045893]; positive regulation of G1/S transition of mitotic cell cycle [GO:1900087]; positive regulation of gene expression [GO:0010628]; positive regulation of neuroblast proliferation [GO:0002052]; positive regulation of neuron apoptotic process [GO:0043525]; positive regulation of transcription by RNA polymerase II [GO:0045944]; R1/R6 cell differentiation [GO:0048052]; R3/R4 cell differentiation [GO:0048056]; R7 cell differentiation [GO:0045466]; regulation of cardioblast cell fate specification [GO:0042686]; regulation of cell differentiation [GO:0045595]; regulation of filopodium assembly [GO:0051489]; regulation of glycolytic process [GO:0006110]; regulation of growth [GO:0040008]; regulation of mitotic cell cycle [GO:0007346]; regulation of neuroblast proliferation [GO:1902692]; regulation of neurogenesis [GO:0050767]; regulation of stem cell division [GO:2000035]; response to symbiont [GO:0009608]; retinal cell programmed cell death [GO:0046666]; second mitotic wave involved in compound eye morphogenesis [GO:0016330]; sensory organ development [GO:0007423]; sensory organ precursor cell fate determination [GO:0016360]; stem cell differentiation [GO:0048863]; wing disc dorsal/ventral pattern formation [GO:0048190]; wing disc pattern formation [GO:0035222]
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            compound eye photoreceptor cell differentiation [GO:0001751]; dorsal appendage formation [GO:0046843]; flight [GO:0060361]; innate immune response [GO:0045087]; mitochondrion organization [GO:0007005]; negative regulation of autophagy of mitochondrion [GO:1903147]; negative regulation of establishment of blood-brain barrier [GO:0090212]; positive regulation of receptor signaling pathway via JAK-STAT [GO:0046427]; positive regulation of sevenless signaling pathway [GO:0045874]; positive regulation of transcription by RNA polymerase II [GO:0045944]; sarcomere organization [GO:0045214]; vascular endothelial growth factor receptor signaling pathway [GO:0048010]; wound healing, spreading of cells [GO:0044319]; wound healing, spreading of epidermal cells [GO:0035313]
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (R)-carnitine transmembrane transport [GO:1902270]; (R)-carnitine transport [GO:1900749]; adult heart development [GO:0007512]; carnitine metabolic process [GO:0009437]; carnitine transport [GO:0015879]; establishment of localization in cell [GO:0051649]; locomotory behavior [GO:0007626]; mitochondrion organization [GO:0007005]; quaternary ammonium group transport [GO:0015697]; reproductive structure development [GO:0048608]; response to tumor necrosis factor [GO:0034612]; response to type II interferon [GO:0034341]; sodium ion transport [GO:0006814]; transport across blood-brain barrier [GO:0150104]
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                (R)-carnitine transmembrane transport [GO:1902270]; (R)-carnitine transport [GO:1900749]; adult heart development [GO:0007512]; carnitine metabolic process [GO:0009437]; carnitine transport [GO:0015879]; establishment of localization in cell [GO:0051649]; locomotory behavior [GO:0007626]; mitochondrion organization [GO:0007005]; quaternary ammonium group transport [GO:0015697]; reproductive structure development [GO:0048608]; response to tumor necrosis factor [GO:0034612]; response to type II interferon [GO:0034341]; sodium ion transport [GO:0006814]; transport across blood-brain barrier [GO:0150104]
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 estrogen metabolic process [GO:0008210]; female pregnancy [GO:0007565]; sulfation [GO:0051923]
6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                activation of NF-kappaB-inducing kinase activity [GO:0007250]; cellular response to exogenous dsRNA [GO:0071360]; cellular response to interferon-beta [GO:0035458]; cellular response to mechanical stimulus [GO:0071260]; cellular response to type II interferon [GO:0071346]; cellular response to virus [GO:0098586]; cellular response to xenobiotic stimulus [GO:0071466]; defense response to bacterium [GO:0042742]; defense response to virus [GO:0051607]; detection of virus [GO:0009597]; extrinsic apoptotic signaling pathway [GO:0097191]; hyperosmotic response [GO:0006972]; I-kappaB phosphorylation [GO:0007252]; inflammatory response to wounding [GO:0090594]; innate immune response [GO:0045087]; JNK cascade [GO:0007254]; male gonad development [GO:0008584]; microglial cell activation [GO:0001774]; necroptotic signaling pathway [GO:0097527]; negative regulation of osteoclast differentiation [GO:0045671]; positive regulation of angiogenesis [GO:0045766]; positive regulation of apoptotic process [GO:0043065]; positive regulation of canonical NF-kappaB signal transduction [GO:0043123]; positive regulation of chemokine production [GO:0032722]; positive regulation of cytokine production involved in inflammatory response [GO:1900017]; positive regulation of gene expression [GO:0010628]; positive regulation of inflammatory response [GO:0050729]; positive regulation of interferon-alpha production [GO:0032727]; positive regulation of interferon-beta production [GO:0032728]; positive regulation of interleukin-12 production [GO:0032735]; positive regulation of interleukin-6 production [GO:0032755]; positive regulation of interleukin-8 production [GO:0032757]; positive regulation of JNK cascade [GO:0046330]; positive regulation of macrophage cytokine production [GO:0060907]; positive regulation of non-canonical NF-kappaB signal transduction [GO:1901224]; positive regulation of transcription by RNA polymerase II [GO:0045944]; positive regulation of tumor necrosis factor production [GO:0032760]; positive regulation of type II interferon production [GO:0032729]; positive regulation of type III interferon production [GO:0034346]; regulation of dendritic cell cytokine production [GO:0002730]; response to dsRNA [GO:0043331]; response to exogenous dsRNA [GO:0043330]; signal transduction [GO:0007165]; toll-like receptor 3 signaling pathway [GO:0034138]; toll-like receptor signaling pathway [GO:0002224]; type III interferon production [GO:0034343]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Gene.Ontology.IDs
1 GO:0001745; GO:0002052; GO:0002213; GO:0003682; GO:0003713; GO:0004888; GO:0005112; GO:0005509; GO:0005634; GO:0005654; GO:0005737; GO:0005768; GO:0005769; GO:0005770; GO:0005771; GO:0005783; GO:0005788; GO:0005796; GO:0005829; GO:0005886; GO:0005912; GO:0006110; GO:0007015; GO:0007219; GO:0007293; GO:0007297; GO:0007298; GO:0007346; GO:0007391; GO:0007400; GO:0007403; GO:0007405; GO:0007411; GO:0007422; GO:0007423; GO:0007440; GO:0007455; GO:0007474; GO:0007476; GO:0007478; GO:0007480; GO:0007498; GO:0007521; GO:0007616; GO:0008045; GO:0008284; GO:0008340; GO:0008347; GO:0008356; GO:0008407; GO:0008587; GO:0009608; GO:0009950; GO:0009986; GO:0010001; GO:0010628; GO:0010629; GO:0014018; GO:0014019; GO:0016020; GO:0016318; GO:0016324; GO:0016330; GO:0016348; GO:0016360; GO:0022416; GO:0030139; GO:0030154; GO:0030707; GO:0030713; GO:0030718; GO:0030720; GO:0032991; GO:0035035; GO:0035153; GO:0035162; GO:0035167; GO:0035171; GO:0035172; GO:0035204; GO:0035214; GO:0035222; GO:0036011; GO:0036099; GO:0036335; GO:0040008; GO:0042686; GO:0042688; GO:0042691; GO:0043525; GO:0043697; GO:0045165; GO:0045316; GO:0045466; GO:0045595; GO:0045746; GO:0045893; GO:0045944; GO:0046331; GO:0046666; GO:0046667; GO:0046716; GO:0046843; GO:0048052; GO:0048056; GO:0048190; GO:0048477; GO:0048542; GO:0048627; GO:0048664; GO:0048665; GO:0048749; GO:0048803; GO:0048863; GO:0050699; GO:0050767; GO:0050768; GO:0050877; GO:0051489; GO:0060250; GO:0060288; GO:0060289; GO:0060571; GO:0061331; GO:0061382; GO:0097150; GO:1900087; GO:1902692; GO:1990433; GO:2000035; GO:2000048
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             GO:0001751; GO:0003723; GO:0005634; GO:0005737; GO:0005829; GO:0007005; GO:0019901; GO:0030018; GO:0031430; GO:0035313; GO:0044319; GO:0045087; GO:0045214; GO:0045874; GO:0045944; GO:0046427; GO:0046843; GO:0048010; GO:0060361; GO:0090212; GO:0090575; GO:1903147
3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     GO:0005524; GO:0005737; GO:0005829; GO:0005886; GO:0006814; GO:0007005; GO:0007512; GO:0007626; GO:0009437; GO:0009925; GO:0015199; GO:0015226; GO:0015293; GO:0015651; GO:0015697; GO:0015879; GO:0016020; GO:0016323; GO:0016324; GO:0031526; GO:0034341; GO:0034612; GO:0048608; GO:0051649; GO:0150104; GO:1900749; GO:1901235; GO:1902270
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     GO:0005524; GO:0005737; GO:0005829; GO:0005886; GO:0006814; GO:0007005; GO:0007512; GO:0007626; GO:0009437; GO:0009925; GO:0015199; GO:0015226; GO:0015293; GO:0015651; GO:0015697; GO:0015879; GO:0016020; GO:0016323; GO:0016324; GO:0031526; GO:0034341; GO:0034612; GO:0048608; GO:0051649; GO:0150104; GO:1900749; GO:1901235; GO:1902270
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             GO:0004062; GO:0004304; GO:0005496; GO:0005737; GO:0005829; GO:0007565; GO:0008146; GO:0008210; GO:0050294; GO:0051923
6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             GO:0000139; GO:0001774; GO:0002224; GO:0002730; GO:0003725; GO:0004888; GO:0005615; GO:0005737; GO:0005765; GO:0005769; GO:0005789; GO:0005886; GO:0006972; GO:0007165; GO:0007250; GO:0007252; GO:0007254; GO:0008584; GO:0009597; GO:0010008; GO:0010628; GO:0016020; GO:0031012; GO:0032722; GO:0032727; GO:0032728; GO:0032729; GO:0032735; GO:0032755; GO:0032757; GO:0032760; GO:0034138; GO:0034343; GO:0034346; GO:0035458; GO:0036020; GO:0038023; GO:0038187; GO:0042742; GO:0042802; GO:0043065; GO:0043123; GO:0043330; GO:0043331; GO:0045087; GO:0045671; GO:0045766; GO:0045944; GO:0046330; GO:0050729; GO:0051607; GO:0060907; GO:0071260; GO:0071346; GO:0071360; GO:0071466; GO:0090594; GO:0097191; GO:0097527; GO:0098586; GO:1900017; GO:1901224</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>blast</category>
  <category>gene ontology</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-23-repro/</guid>
  <pubDate>Sat, 15 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2024-06-15_17-21-46.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Spring Cleaning</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-22-PW/</link>
  <description><![CDATA[ 





<p>We went out to the hatchery twice this week to clean up inventory and get prepped for spawning. We tagged a long for the second commercial spawn of the year.</p>
<section id="new-bags" class="level1">
<h1>New bags</h1>
<p>On the near 10-holers there were 5 bags that were fouled and likely our PH stocks</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-15-13.png" class="img-fluid" style="width:50.0%"></p>
<p>In A there were two bags re-labelled with White Tags: 31 and 2.</p>
<p>In B there were two bags re-labelled with White Tags: 13 and 17. 13 had blue tie wraps on top and bottom (and black on top). 17 had black tie wrap at top. It is assummed blue are BLUE.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-21-35.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>bluewraps</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-22-38.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>clean</figcaption>
</figure>
</div>
<p>I also cleaned an additonal bag and labelled: White tag: 8</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-24-16.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>bags-trays</figcaption>
</figure>
</div>
<p>More inventory notes in <a href="https://ahuffmyer.github.io/ASH_Putnam_Lab_Notebook/Point-Whitney-Field-Day-June-12-2024/">Ariana’s Notebook</a>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TLDR: Ariana’s post
</div>
</div>
<div class="callout-body-container callout-body">
<p>The main activities included organizing and re-tagging oysters, setting up HUDL larval systems, and resetting temperature loggers.</p>
<p>Key activities were categorized into various efforts:</p>
<p>- <strong>Effort B to F</strong>: Oysters were moved and re-tagged using cattle tags and distributed across different upweller tanks.</p>
<p>- <strong>Effort F</strong>: Special attention was given to broodstock received from USDA ARS, which were kept in adult bags and monitored.</p>
<p>- <strong>LCO Project</strong>: Focused on moving spat from silos to bags in outdoor upwellers.</p>
<p>The post also covered the setup of technical equipment and maintenance:</p>
<p>- <strong>HUDL Systems</strong>: Installation included setting up air lines, cleaning HUDLs, and adjusting heaters to control water temperatures.</p>
<p>- <strong>Weekly Measurements</strong>: Temperature, pH, and salinity of tanks were measured and recorded.</p>
<p>- <strong>Logger Data</strong>: New Hobo Tidbit loggers were launched to collect temperature data.</p>
<p>The work done on this field day was part of ongoing efforts to manage and monitor oyster populations effectively, with detailed data being recorded and made accessible via GitHub for further analysis. This reflects the thorough and organized approach to field research and data management in marine sciences.</p>
</div>
</div>
</section>
<section id="ph-stocks" class="level1">
<h1>PH Stocks</h1>
<p>Who is what?</p>
<p>see also <a href="https://github.com/RobertsLab/resources/issues/1689" class="uri">https://github.com/RobertsLab/resources/issues/1689</a></p>
<p>Five where “confirmed” with ploidy indicated but spelled out label.</p>
<p>Orange = ? triploid<br>
Pink = ?<br>
Blue = ? Tetraploid<br>
Yellow = F14 (2n) diploid<br>
Dog [Putnam hobo] = F5 (2n)? triploid<br>
Cat [very big, few] = F5 (3n)<br>
Bird [Tank 3 hobo] = F13 (either 2n or 3n) triploid<br>
Toad = F14 (3n)</p>
</section>
<section id="heath-trays" class="level1">
<h1>Heath Trays</h1>
<p>Five 2024 USDA family were placed in heath trays. (see pic above)</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-33-15.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="spawning" class="level1">
<h1>Spawning</h1>
<p>See <a href="https://ahuffmyer.github.io/ASH_Putnam_Lab_Notebook/Spawning-at-Point-Whitney-June-13-2024/">Ariana’s Notebook</a> for details.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TLDR: Ariana’s post
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><strong>Sexing Oysters</strong>:</p>
<ul>
<li>Oysters are opened and examined to determine their sex by observing the gonads under a microscope. The quality of eggs and sperm is assessed based on their appearance—good eggs are round and concentrated, while good sperm exhibit motility.</li>
</ul></li>
<li><p><strong>Preparing Eggs</strong>:</p>
<ul>
<li>Eggs are extracted from selected female oysters and placed into dishes without water to prevent premature activation. The eggs are then homogenized by hand in a bag and sieved through mesh screens to filter out debris. They are rinsed with warm seawater to clean and prepare them for fertilization.</li>
</ul></li>
<li><p><strong>Preparing Sperm</strong>:</p>
<ul>
<li>Sperm are collected by gently squeezing the gonads over a dish of warm seawater. The sperm solution is then filtered through a fine mesh to ensure an optimal and clean concentration for fertilization.</li>
</ul></li>
<li><p><strong>Fertilization Process</strong>:</p>
<ul>
<li>The prepared sperm and eggs are combined in buckets with warm seawater. The process is carefully controlled to maintain a suitable sperm to egg ratio, ensuring effective fertilization. After combining, the mixture is monitored for signs of successful fertilization, such as the appearance of polar bodies.</li>
</ul></li>
<li><p><strong>Transferring to Larval Tanks</strong>:</p>
<ul>
<li>The successfully fertilized eggs are then transferred into large larval tanks. Conditions in these tanks are meticulously controlled, including temperature and pH. Microbial growth is managed by adding EDTA, and the larvae are initially fed after one day of fertilization, with subsequent feeding scheduled based on developmental progress.</li>
</ul></li>
</ol>
</div>
</div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-35-23.png" class="img-fluid" style="width:50.0%"> <img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-36-36.png" class="img-fluid" style="width:50.0%" alt="eggs"></p>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>aquaculture</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-22-PW/</guid>
  <pubDate>Wed, 12 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-15_10-12-18.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Seed travels</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/sr320-21-wescott/</link>
  <description><![CDATA[ 





<p>tldr: We deployed seed in Wescott Bay.</p>
<div class="quarto-video"><video id="video_shortcode_videojs_video1" class="video-js vjs-default-skin vjs-fluid" controls="" preload="auto" data-setup="{}" title=""><source src="http://gannet.fish.washington.edu/seashell/snaps/IMG_6670.mov"></video></div>
<p>Seed from Point Whitney were picked up on Thursday afternoon and driven up to Wescott Bay Friday morning. Arrived about 11 am. For each bag Grace tagged 15 oysters. oyster where deployed in bottom sitting bags in the schema below.</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/IMG_6661.png" class="img-fluid"></p>
<p>More shots of the deployment.</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-08_10-29-21.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-08_10-30-45.png" class="img-fluid"></p>


<!-- -->


 ]]></description>
  <category>oyster</category>
  <category>aquaculture</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/sr320-21-wescott/</guid>
  <pubDate>Fri, 07 Jun 2024 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2024-06-08_10-13-56.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
