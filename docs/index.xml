<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Tumbling Oysters</title>
<link>https://sr320.github.io/tumbling-oysters/</link>
<atom:link href="https://sr320.github.io/tumbling-oysters/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.6.40</generator>
<lastBuildDate>Wed, 24 Dec 2025 08:00:00 GMT</lastBuildDate>
<item>
  <title>Merry Linkmas</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/69-linksmas/</link>
  <description><![CDATA[ 





<p>Here are few tidbits to bring you cheer this Christmas Season!</p>
<p>In no particular order:</p>
<section id="paper-genomic-insights-into-the-origin-of-ecotypes" class="level1">
<h1>1) [Paper] Genomic insights into the origin of ecotypes</h1>
<section id="highlights" class="level2">
<h2 class="anchored" data-anchor-id="highlights">Highlights</h2>
<p>The ecotype concept describes populations of species that are phenotypically and genetically differentiated by adaptation to contrasting habitats.</p>
<p>Ecotypes offer a powerful framework for understanding how, and why, biodiversity arises within species and why similar environments repeatedly generate similar forms.</p>
<p>A century after its introduction, the ecotype concept continues to shape thinking about adaptation, ecological diversification, and the early stages of speciation.</p>
<p>The concept has expanded far beyond its botanical origins, influencing research across the tree of life.</p>
<p>Genomic tools have provided new insight into the forces and factors that drive the formation of ecotypes.</p>
<p>Integrating genomic, ecological, and experimental approaches will be essential for tackling emerging challenges in the decade ahead.</p>
<p><a href="https://www.cell.com/action/showPdf?pii=S0169-5347%2825%2900345-3">Link</a></p>
</section>
</section>
<section id="paper-defining-the-epigenetic-toolkit-as-an-evolvable-trait" class="level1">
<h1>2) [Paper] Defining the epigenetic toolkit as an evolvable trait</h1>
<section id="highlights-1" class="level2">
<h2 class="anchored" data-anchor-id="highlights-1">Highlights</h2>
<p>Previous studies have revealed the genetic basis of many complex epigenetic and phenotypic traits through classic screening or genome-wide association studies (GWAS). We explore the question of how the homeostatic state of a plant is balanced under varied levels of nutrient supply when environmental or internal (epi)genetic factors significantly perturb this balance.</p>
<p>We explore how epigenetic regulation of the genome of a plant interacts with physiological processes (such as homeostasis) at the biological pathway level when exposed to different nutrient availability scenarios and under changing environmental conditions.</p>
<p>We propose a conceptual model involving an ‚Äòepigenetic toolkit‚Äô where plants sense environmental pressures to develop a complex crosstalk between physiology, epigenetic/epigenomic state, and their genetic code, and ultimately fine-tune adaptation at the organismal level.</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Defining_the_epigenetic_toolkit_as_an_evolvable_trait_Trends_in_Plant_Science_2025-12-22_11-24-19.png" class="img-fluid"></p>
<p><a href="https://www.cell.com/action/showPdf?pii=S1360-1385%2825%2900348-6">Link</a></p>
</section>
</section>
<section id="software-isoformswitchanalyzer-v2-analysis-of-functional-isoform-changes-in-long-read-and-single-cell-sequencing-data" class="level1">
<h1>3) [Software] IsoformSwitchAnalyzeR v2: Analysis of Functional Isoform Changes in Long-read and Single-cell Sequencing Data</h1>
<p><a href="https://www.biorxiv.org/content/10.64898/2025.12.08.693027v1.full.pdf">Link</a></p>
</section>
<section id="book-modern-statistics-for-modern-biology" class="level1">
<h1>4) [Book] Modern Statistics for Modern Biology</h1>
<p><a href="https://web.stanford.edu/class/bios221/book/">Link</a></p>
</section>
<section id="paper-the-plant-mind-unraveling-abiotic-stress-priming-memory-and-adaptation" class="level1">
<h1>5) [Paper] The Plant Mind: Unraveling Abiotic Stress Priming, Memory, and Adaptation</h1>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">ABSTRACT</h2>
<p>Plants exhibit a remarkable capacity to adapt to recurrent abiotic stresses, prompting a re-evaluation of traditional views on plant responses to environmental challenges. This review explores the intricate mechanisms of stress priming, memory, and adaptation in plants. Specifically, it details the molecular and physiological processes underlying abiotic stress priming, which serve as a gateway to understanding plant memory. Stress priming fosters resilience against diverse stressors through interconnected pathways involving hormone signaling, transcriptional regulation, DNA methylation, histone modifications, and small RNAs. These epigenetic changes orchestrate stress-responsive gene expression and can, in some cases, be passed on to future generations. This review distinguishes between somatic memory, intergenerational effects, and transgenerational inheritance to avoid conceptual overlap. By connecting short-term priming to long-term adaptation and potential heritability, this article proposes a paradigm shift in how plant resilience is understood, with significant implications for crop improvement under climate stress.</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_The_Plant_Mind_Unraveling_Abiotic_Stress_Priming_Memory_and_Adaptation_-_Aswathi_-_2025_-_Physiologia_Plantarum_-_Wiley_Onli_2025-12-22_11-34-49.png" class="img-fluid"></p>
<p><a href="https://onlinelibrary.wiley.com/doi/epdf/10.1111/ppl.70372">Link</a></p>
</section>
</section>
<section id="software-gff-analysis-tools---ai-agent" class="level1">
<h1>6) [Software] <a href="https://github.com/ToyokoLabs/gffutilsAI#gff-analysis-tools---ai-agent">GFF Analysis Tools - AI Agent</a></h1>
<p>This AI agent provides an intuitive interface for bioinformatics researchers to analyze GFF files without writing complex code. Users can ask questions in natural language, and the agent will select and execute the appropriate analysis tools to provide comprehensive answers.</p>
<section id="features" class="level2">
<h2 class="anchored" data-anchor-id="features">Features</h2>
<section id="coordinate-based-queries" class="level3">
<h3 class="anchored" data-anchor-id="coordinate-based-queries">üß¨ Coordinate-based Queries</h3>
<ul>
<li>Find features by genomic coordinates (regions and specific positions)</li>
<li>Query features overlapping genomic regions with filtering by type and strand</li>
<li>Identify features containing specific genomic positions</li>
</ul>
</section>
<section id="relationship-and-hierarchy-analysis" class="level3">
<h3 class="anchored" data-anchor-id="relationship-and-hierarchy-analysis">üîó Relationship and Hierarchy Analysis</h3>
<ul>
<li>Explore gene structure and organization (get all child features like exons, CDS, UTRs)</li>
<li>Find parent features of any given feature using upward traversal</li>
<li>Get all features of specific types with efficient iteration</li>
</ul>
</section>
<section id="statistical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="statistical-analysis">üìä Statistical Analysis</h3>
<ul>
<li>Calculate comprehensive feature statistics (counts, length distributions per feature type)</li>
<li>Generate per-chromosome feature summaries and analysis</li>
<li>Analyze length distributions with detailed statistics (min, max, mean, median, std dev, percentiles)</li>
<li>Create histogram data for feature length distributions</li>
</ul>
</section>
<section id="attribute-based-searches" class="level3">
<h3 class="anchored" data-anchor-id="attribute-based-searches">üîç Attribute-based Searches</h3>
<ul>
<li>Search features by attribute key-value pairs (exact and partial matching)</li>
<li>Find features containing specific attribute keys</li>
<li>Support pattern matching and logical operations for attribute queries</li>
</ul>
</section>
<section id="positional-analysis" class="level3">
<h3 class="anchored" data-anchor-id="positional-analysis">üìç Positional Analysis</h3>
<ul>
<li>Identify intergenic regions (gaps between genes) with filtering options</li>
<li>Calculate feature density in genomic windows across chromosomes</li>
<li>Analyze strand distribution of features with counts and percentages</li>
<li>Support clustering analysis and positional insights</li>
</ul>
</section>
<section id="export-and-reporting" class="level3">
<h3 class="anchored" data-anchor-id="export-and-reporting">üì§ Export and Reporting</h3>
<ul>
<li>Export feature data to CSV format with comprehensive filtering</li>
<li>Generate human-readable summary reports of GFF file contents</li>
<li>Provide formatted output for downstream analysis</li>
</ul>
</section>
</section>
</section>
<section id="paper-comprehensive-whole-transcriptome-analysis-reveals-specific-lncrna-circrna-and-mirna-mrna-networks-of-pearl-oyster-pinctada-fucata-martensii-in-response-to-hypoxia-stress" class="level1">
<h1>7) [Paper] Comprehensive whole transcriptome analysis reveals specific lncRNA, circRNA and miRNA-mRNA networks of pearl oyster (<em>Pinctada fucata martensii</em>) in response to hypoxia stress</h1>
<section id="highlights-2" class="level2">
<h2 class="anchored" data-anchor-id="highlights-2">Highlights</h2>
<p>Construct a ceRNA network with 9 DElncRNAs, 10 DEcircRNAs, 3 DEmiRNAs, and 6 DEmRNAs.</p>
<p>CeRNA networks are critically involved in the molecular response to hypoxia.</p>
<p>Hypoxia drives ceRNA-based regulation of metabolism, antioxidation, and RNA splicing.</p>
</section>
<section id="abstract-1" class="level2">
<h2 class="anchored" data-anchor-id="abstract-1">Abstract</h2>
<p>Hypoxia is a prevalent environmental stressor in both natural and aquaculture environments. <em>Pinctada fucata martensii</em>, a commercially valuable pearl oyster species, is particularly susceptible to hypoxic stress in aquaculture. To explore its molecular response to short-term hypoxia, whole-transcriptome sequencing was performed on gill tissues under normoxic and hypoxic conditions. A total of 721 differentially expressed mRNAs (DEmRNAs), 259 long non-coding RNAs (DElncRNAs), 55 circular RNAs (DEcircRNAs), and 17 microRNAs (DEmiRNAs) were identified. Based on predicted interactions among these differentially expressed RNAs, a competing endogenous RNA (ceRNA) network was constructed, consisting of 9 DElncRNAs, 10 DEcircRNAs, 3 DEmiRNAs, and 6 DEmRNAs. Six DElncRNAs and three DEcircRNAs were predicted to interact with miR-152, and the axis-mediated activation of target genes‚ÄìALDH5A1 and SLC23A2, FAT4 and CCDC97, and LAC‚Äìwas implicated in the modulation of metabolic pathways, enzyme activity, antioxidant defenses, thereby promoting antioxidant capacity and suppressing cell growth as part of an adaptive survival strategy. This ceRNA network reveals a key molecular hub that links hypoxia sensing to immunomodulatory mechanisms. Moreover, the co-repression of stress-response genes HSP20 and HSP70 in this network enhances hypoxic tolerance increased energy utilization efficiency and regulation of RNA. Functional analysis of the network revealed enrichment in pathways related to energy metabolism, antioxidant defense, and RNA splicing regulation. These findings provide novel insights into transcriptomic regulation and adaptive mechanisms in bivalves under hypoxic stress.</p>
<p><a href="https://www.sciencedirect.com/science/article/pii/S2352513425006921">Link</a></p>
</section>
</section>
<section id="paper-multi-omics-reprogramming-drives-a-counterintuitive-reversal-of-disease-susceptibility-during-ageing" class="level1">
<h1>8 [Paper] Multi-Omics Reprogramming Drives a Counterintuitive Reversal of Disease Susceptibility During Ageing</h1>
<section id="abstract-2" class="level2">
<h2 class="anchored" data-anchor-id="abstract-2">Abstract</h2>
<p>Ageing is a progressive and irreversible biological process characterized by the deterioration of physiological functions and increased vulnerability to mortality. Although extensively studied in vertebrates, ageing in long-lived invertebrates remains comparatively unexplored. While ageing typically leads to greater susceptibility to infectious diseases, a striking and unexpected reversal was identified in oysters: older oysters exhibit markedly increased tolerance to the Pacific Oyster Mortality Syndrome (POMS), a panzootic disease primarily driven by the OsHV-1 herpesvirus and responsible for severe losses in global aquaculture. To investigate this counterintuitive pattern, we challenged oysters aged 4, 16, and 28 months from four biparental families and conducted an integrative multi-omics analysis, including epigenomics, transcriptomics, and metabolomics on the two families showing the strongest age-related increase in survival. Our results reveal that ageing in <em>Magallana gigas</em> is characterized by coordinated epigenetic, transcriptional, and metabolic reprogramming that reduces host permissiveness to POMS. We show that the epigenetic remodeling of key immune regulators (e.g., Toll-like receptors, MyD88) aligns with transcriptional rewiring of NF-Œ∫B and ubiquitin pathways, producing a finely tuned innate immune state marked by enhanced antiviral activity but reduced antibacterial responsiveness. We also identify age-related repression of mTOR signaling, likely promoting autophagy and improving viral control. These regulatory changes are tightly linked to metabolic adjustments, including reduced TCA cycle flux, remodeled nitrogen metabolism, and altered glutathione dynamics, which collectively support a stress-tolerant, energy-conserving phenotype. Together, our findings reveal a fundamental evolutionary trade-off: juveniles prioritize growth at the cost of viral susceptibility, whereas adults invest in cellular maintenance and antiviral preparedness.</p>
<p><a href="https://www.biorxiv.org/content/10.64898/2025.12.12.693928v2">Link</a></p>
</section>
</section>
<section id="paper-unraveling-the-microrna-regulatory-network-underlying-the-planktonic-to-benthic-transition-in-the-pacific-oyster" class="level1">
<h1>9 [Paper] Unraveling the microRNA regulatory network underlying the planktonic-to-benthic transition in the Pacific oyster</h1>
<section id="abstract-3" class="level2">
<h2 class="anchored" data-anchor-id="abstract-3">Abstract</h2>
<p>The Pacific oyster, <em>Crassostrea gigas</em>, undergoes a critical developmental transition from planktonic larvae to sessile benthic juveniles, a process essential for both aquaculture productivity and the stability of marine ecosystems. While environmental and neuroendocrine cues regulating this transition have been extensively studied, the contribution of microRNAs (miRNAs) remains largely unexplored. In this study, we employed a high-resolution temporal sampling strategy to investigate oyster metamorphosis, identified 33 miRNAs associated with larval settlement and metamorphosis. Additionally, we uncovered 35 highly correlated miRNA-target gene pairs, revealing a complex post-transcriptional regulatory network. We further validated the expression pattern of the potential regulatory hub miRNA novel_mir_80 and confirmed its presence through whole-mount in situ hybridization using LNA-modified probes. Functional annotation of target genes highlighted key roles in adhesion, signal transduction, protein homeostasis, cytoskeleton remodeling, genome stability, and transcriptional and epigenetic regulation. These results underscore the pivotal role of miRNAs in orchestrating developmental reprogramming during the planktonic-benthic transition. Our findings not only expand current understanding of miRNA-mediated gene regulation in <em>C. gigas</em>, but also provide novel molecular targets with potential applications in oyster breeding and aquaculture management.</p>
<p><a href="https://www.sciencedirect.com/science/article/pii/S2352513425006908">Link</a></p>
</section>
</section>
<section id="paper-fasting-reduces-viral-susceptibility-in-oysters-until-energy-depletion-becomes-detrimental" class="level1">
<h1>10 [Paper] Fasting reduces viral susceptibility in oysters until energy depletion becomes detrimental</h1>
<section id="abstract-4" class="level2">
<h2 class="anchored" data-anchor-id="abstract-4">Abstract</h2>
<p>Nutritional status is a key determinant of disease outcomes in animals, yet its effects are complex. While abundant food supplies support host immunity, they may also fuel pathogen proliferation, whereas food limitation can restrict resources for both host and parasite. The balance between these opposing processes and the physiological limits to fasting as a protective strategy remain poorly understood. Here we tested how the duration of food deprivation affects infection outcome, using the Pacific oyster (<em>Magallana gigas</em>) and its lethal pathogen Ostreid herpesvirus 1 as a model system. We found that moderate fasting markedly improved survival, with the lowest mortality observed after 14‚Äì28 days without food. However, beyond this range, survival declined sharply, revealing a tipping point where prolonged starvation reversed its protective effect. Biochemical analyses of oysters from Sequence 1 at the onset of infection provided mechanistic insight: carbohydrate reserves were depleted rapidly, lipid reserves fell by approximately 90% after 28 days of starvation and protein catabolism occurred only after extended fasting, coinciding with the decline in survival. Our results demonstrate that fasting can transiently enhance resistance to viral infection but is constrained by finite energy reserves. By identifying a physiological threshold beyond which starvation compromises survival, we uncover a novel mechanism linking host energetics to disease outcomes.</p>
<p><a href="https://royalsocietypublishing.org/rsbl/article/21/12/20250606/364694">Link</a></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>links</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/69-linksmas/</guid>
  <pubDate>Wed, 24 Dec 2025 08:00:00 GMT</pubDate>
  <media:content url="https://sr320.github.io/tumbling-oysters/posts/69-linksmas/link.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Barnacle</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/68-barnacle/</link>
  <description><![CDATA[ 





<section id="more-lamda-testing" class="level1">
<h1>More lamda testing</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDAS_GENE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 2 4 6 8 10"</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_SAMPLE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.1</span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_TIME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.05</span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RANK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>35</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/41-rank35-optimization</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR_BASE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>../output/41-rank35-optimization</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> LG <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDAS_GENE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-11">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTDIR_BASE}</span>/lambda_gene_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${LG}</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> run python ../scripts/14.1-barnacle/build_tensor_and_run.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--input-file</span> ../output/14-pca-orthologs/vst_counts_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output-dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rank</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$RANK</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-gene</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-sample</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_SAMPLE</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-time</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_TIME</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-iter</span> 1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tol</span> 1e-5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seed</span> 92</span>
<span id="cb1-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SETTINGS</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-6"></span>
<span id="cb2-7">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization"</span></span>
<span id="cb2-8"></span>
<span id="cb2-9">lambda_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10"</span>)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FUNCTION: read gene_factors.csv AND FIX HEADER</span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-14">read_gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(lambda) {</span>
<span id="cb2-15">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s/lambda_gene_%s/barnacle_factors/gene_factors.csv"</span>,</span>
<span id="cb2-16">                 base_url, lambda)</span>
<span id="cb2-17"></span>
<span id="cb2-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading: "</span>, url)</span>
<span id="cb2-19">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb2-20"></span>
<span id="cb2-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fix the shifted header here</span></span>
<span id="cb2-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First column should be "gene", others "comp1..compN"</span></span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb2-24"></span>
<span id="cb2-25">  df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda_gene <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lambda</span>
<span id="cb2-26">  df</span>
<span id="cb2-27">}</span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># READ ALL RUNS</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-32">all_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(lambda_vals, read_gene_factors)</span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LONG FORMAT FOR ANALYSIS</span></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb2-37">factor_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb2-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>),</span>
<span id="cb2-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>,</span>
<span id="cb2-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span></span>
<span id="cb2-42">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">sparsity_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> factor_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_zero =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(loading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(loading) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-12</span>),</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparsity =</span> n_zero <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_values</span>
<span id="cb3-7">  )</span>
<span id="cb3-8"></span>
<span id="cb3-9">sparsity_tbl </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 4
  lambda_gene n_values n_zero sparsity
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
1 1             343000   3079  0.00898
2 10            343000  25244  0.0736 
3 2             343000   3798  0.0111 
4 4             343000   7023  0.0205 
5 6             343000  16289  0.0475 
6 8             343000  21282  0.0620 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">gene_component_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> factor_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(loading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene, gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_components =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(component),</span>
<span id="cb5-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb5-7">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">multi_component_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_component_counts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene, n_components) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5">multi_component_summary</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 59 √ó 3
   lambda_gene n_components n_genes
   &lt;chr&gt;              &lt;int&gt;   &lt;int&gt;
 1 1                     27       2
 2 1                     28       3
 3 1                     29       5
 4 1                     30      17
 5 1                     31      54
 6 1                     32     127
 7 1                     33     402
 8 1                     34    1526
 9 1                     35    7664
10 10                    24       3
# ‚Ñπ 49 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">summary_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sparsity_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb8-3">    gene_component_counts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb8-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_components =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(n_components),</span>
<span id="cb8-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frac_multi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(n_components <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb8-9">      ),</span>
<span id="cb8-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda_gene"</span></span>
<span id="cb8-11">  )</span>
<span id="cb8-12"></span>
<span id="cb8-13">summary_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 6
  lambda_gene n_values n_zero sparsity mean_components frac_multi
  &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;
1 1             343000   3079  0.00898            34.7          1
2 10            343000  25244  0.0736             32.4          1
3 2             343000   3798  0.0111             34.6          1
4 4             343000   7023  0.0205             34.3          1
5 6             343000  16289  0.0475             33.3          1
6 8             343000  21282  0.0620             32.8          1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb10-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_1/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb10-3"></span>
<span id="cb10-4"></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb10-9">  </span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb10-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb10-12">  </span>
<span id="cb10-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb10-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb10-16">  </span>
<span id="cb10-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb10-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb10-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb10-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb11-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_2/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb11-3"></span>
<span id="cb11-4"></span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb11-7"></span>
<span id="cb11-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb11-9">  </span>
<span id="cb11-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb11-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb11-12">  </span>
<span id="cb11-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb11-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb11-16">  </span>
<span id="cb11-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb11-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb11-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb11-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb12-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_4/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb12-3"></span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb12-9">  </span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb12-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb12-12">  </span>
<span id="cb12-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb12-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb12-16">  </span>
<span id="cb12-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb12-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb12-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb12-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb13-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_6/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb13-3"></span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb13-9">  </span>
<span id="cb13-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb13-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb13-12">  </span>
<span id="cb13-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb13-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb13-16">  </span>
<span id="cb13-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb13-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb13-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb13-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb14-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_8/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb14-3"></span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb14-7"></span>
<span id="cb14-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb14-9">  </span>
<span id="cb14-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb14-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb14-12">  </span>
<span id="cb14-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb14-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb14-16">  </span>
<span id="cb14-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb14-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb14-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb14-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb14-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb15-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/41-rank35-optimization/lambda_gene_10/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb15-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb15-7"></span>
<span id="cb15-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb15-9">  </span>
<span id="cb15-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb15-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb15-12">  </span>
<span id="cb15-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb15-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb15-16">  </span>
<span id="cb15-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb15-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb15-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb15-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/68-barnacle/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/68-barnacle/</guid>
  <pubDate>Thu, 04 Dec 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_15-34-25.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Coefficient of Gene Expression and GBM</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/</link>
  <description><![CDATA[ 





<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This script calculates the coefficient of variation (CV) of gene expression across samples for each gene and examines the relationship between CV and gene body methylation for three coral species:</p>
<ul>
<li><em>Acropora pulchra</em></li>
<li><em>Porites evermanni</em></li>
<li><em>Pocillopora tuahiniensis</em></li>
</ul>
<p>Biomineralization genes are highlighted in each plot.</p>
<p><strong>Coefficient of Variation (CV)</strong> is calculated as: CV = (SD / Mean) √ó 100</p>
<p>This metric captures expression variability relative to mean expression level.</p>
</section>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span></code></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<section id="gene-expression-count-matrices" class="level3">
<h3 class="anchored" data-anchor-id="gene-expression-count-matrices">Gene Expression Count Matrices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb2-2">apul_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2/apul-gene_count_matrix.csv"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb2-5">peve_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/output/02.20-E-Peve-RNAseq-alignment-HiSat2/peve-gene_count_matrix.csv"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb2-8">ptua_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/output/02.20-F-Ptua-RNAseq-alignment-HiSat2/ptua-gene_count_matrix.csv"</span>)</span></code></pre></div>
</div>
</section>
<section id="gene-body-methylation-data" class="level3">
<h3 class="anchored" data-anchor-id="gene-body-methylation-data">Gene Body Methylation Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb3-2">apul_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/D-Apul/output/40-Apul-Gene-Methylation/Apul-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb3-5">peve_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/E-Peve/output/15-Peve-Gene-Methylation/Peve-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb3-8">ptua_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/F-Ptua/output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span></code></pre></div>
</div>
</section>
<section id="biomineralization-gene-lists" class="level3">
<h3 class="anchored" data-anchor-id="biomineralization-gene-lists">Biomineralization Gene Lists</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb4-2">apul_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/apul_biomin_counts.csv"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb4-5">peve_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/peve_biomin_counts.csv"</span>)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb4-8">ptua_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/ptua_biomin_counts.csv"</span>)</span></code></pre></div>
</div>
</section>
</section>
<section id="calculate-coefficient-of-variation" class="level2">
<h2 class="anchored" data-anchor-id="calculate-coefficient-of-variation">Calculate Coefficient of Variation</h2>
<section id="function-to-calculate-cv" class="level3">
<h3 class="anchored" data-anchor-id="function-to-calculate-cv">Function to Calculate CV</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CV = (standard deviation / mean) * 100</span></span>
<span id="cb5-2">calculate_cv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb5-3">  mean_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-4">  sd_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb5-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (mean_val <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb5-7">  }</span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>((sd_val <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> mean_val) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb5-9">}</span></code></pre></div>
</div>
</section>
<section id="acropora-pulchra" class="level3">
<h3 class="anchored" data-anchor-id="acropora-pulchra">Acropora pulchra</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate CV and mean expression across samples for each gene</span></span>
<span id="cb6-2">apul_expression_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cv_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_cv</span>(count)</span>
<span id="cb6-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(cv_expression), cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove genes with zero mean</span></span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb6-13">apul_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb6-17"></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb6-19">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expression_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(apul_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs</span></span>
<span id="cb6-23">apul_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb6-28">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> apul_biomin_genes)</span>
<span id="cb6-30"></span>
<span id="cb6-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acropora pulchra:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Acropora pulchra:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Total genes with CV and methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(apul_combined), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total genes with CV and methylation: 20666 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomineralization genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomineralization genes: 484 </code></pre>
</div>
</div>
</section>
<section id="porites-evermanni" class="level3">
<h3 class="anchored" data-anchor-id="porites-evermanni">Porites evermanni</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate CV and mean expression across samples for each gene</span></span>
<span id="cb12-2">peve_expression_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb12-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb12-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb12-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cv_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_cv</span>(count)</span>
<span id="cb12-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(cv_expression), cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>)</span>
<span id="cb12-11"></span>
<span id="cb12-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb12-13">peve_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb12-17"></span>
<span id="cb12-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb12-19">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expression_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(peve_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb12-21"></span>
<span id="cb12-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs - add "gene-" prefix to match expression data format</span></span>
<span id="cb12-23">peve_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, .)</span>
<span id="cb12-27"></span>
<span id="cb12-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb12-29">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> peve_biomin_genes)</span>
<span id="cb12-31"></span>
<span id="cb12-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Porites evermanni:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Porites evermanni:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Total genes with CV and methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(peve_combined), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total genes with CV and methylation: 19855 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomineralization genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomineralization genes: 479 </code></pre>
</div>
</div>
</section>
<section id="pocillopora-tuahiniensis" class="level3">
<h3 class="anchored" data-anchor-id="pocillopora-tuahiniensis">Pocillopora tuahiniensis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate CV and mean expression across samples for each gene</span></span>
<span id="cb18-2">ptua_expression_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb18-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb18-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb18-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cv_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculate_cv</span>(count)</span>
<span id="cb18-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(cv_expression), cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>)</span>
<span id="cb18-11"></span>
<span id="cb18-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb18-13">ptua_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb18-17"></span>
<span id="cb18-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb18-19">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expression_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(ptua_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb18-21"></span>
<span id="cb18-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs - add "gene-" prefix to match expression data format</span></span>
<span id="cb18-23">ptua_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, .)</span>
<span id="cb18-27"></span>
<span id="cb18-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb18-29">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> ptua_biomin_genes)</span>
<span id="cb18-31"></span>
<span id="cb18-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pocillopora tuahiniensis:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pocillopora tuahiniensis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Total genes with CV and methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(ptua_combined), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Total genes with CV and methylation: 22609 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomineralization genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomineralization genes: 459 </code></pre>
</div>
</div>
</section>
</section>
<section id="create-plots" class="level2">
<h2 class="anchored" data-anchor-id="create-plots">Create Plots</h2>
<section id="acropora-pulchra-1" class="level3">
<h3 class="anchored" data-anchor-id="acropora-pulchra-1">Acropora pulchra</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(apul_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>),</span>
<span id="cb24-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb24-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Gene Body Methylation - Acropora pulchra"</span>,</span>
<span id="cb24-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb24-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb24-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/plot-apul-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="porites-evermanni-1" class="level3">
<h3 class="anchored" data-anchor-id="porites-evermanni-1">Porites evermanni</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(peve_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>),</span>
<span id="cb25-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb25-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Gene Body Methylation - Porites evermanni"</span>,</span>
<span id="cb25-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb25-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb25-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/plot-peve-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pocillopora-tuahiniensis-1" class="level3">
<h3 class="anchored" data-anchor-id="pocillopora-tuahiniensis-1">Pocillopora tuahiniensis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ptua_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>),</span>
<span id="cb26-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb26-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Gene Body Methylation - Pocillopora tuahiniensis"</span>,</span>
<span id="cb26-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb26-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb26-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/plot-ptua-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="combined-panel-plot" class="level2">
<h2 class="anchored" data-anchor-id="combined-panel-plot">Combined Panel Plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add species identifier to each dataset</span></span>
<span id="cb27-2">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acropora pulchra"</span>)</span>
<span id="cb27-3">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Porites evermanni"</span>)</span>
<span id="cb27-4">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pocillopora tuahiniensis"</span>)</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all data</span></span>
<span id="cb27-7">all_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(apul_combined, peve_combined, ptua_combined)</span>
<span id="cb27-8"></span>
<span id="cb27-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create faceted plot</span></span>
<span id="cb27-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>),</span>
<span id="cb27-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb27-15">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Gene Body Methylation"</span>,</span>
<span id="cb27-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb27-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb27-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/combined-plot-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary for each species</span></span>
<span id="cb28-2">summary_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(species, is_biomin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb28-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb28-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_cv =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb28-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median_cv =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb28-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_cv =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb28-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb28-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb28-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb28-12">  )</span>
<span id="cb28-13"></span>
<span id="cb28-14">summary_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-15">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb28-16">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomin Gene"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean CV"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median CV"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SD CV"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Meth"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SD Meth"</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: left;">Biomin Gene</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean CV</th>
<th style="text-align: right;">Median CV</th>
<th style="text-align: right;">SD CV</th>
<th style="text-align: right;">Mean Meth</th>
<th style="text-align: right;">SD Meth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">20182</td>
<td style="text-align: right;">125.32</td>
<td style="text-align: right;">80.37</td>
<td style="text-align: right;">122.36</td>
<td style="text-align: right;">15.57</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">484</td>
<td style="text-align: right;">97.89</td>
<td style="text-align: right;">79.92</td>
<td style="text-align: right;">60.60</td>
<td style="text-align: right;">7.07</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">22150</td>
<td style="text-align: right;">115.05</td>
<td style="text-align: right;">76.72</td>
<td style="text-align: right;">107.76</td>
<td style="text-align: right;">7.61</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">459</td>
<td style="text-align: right;">89.32</td>
<td style="text-align: right;">74.81</td>
<td style="text-align: right;">56.38</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">19376</td>
<td style="text-align: right;">145.34</td>
<td style="text-align: right;">93.99</td>
<td style="text-align: right;">128.20</td>
<td style="text-align: right;">15.28</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">479</td>
<td style="text-align: right;">114.25</td>
<td style="text-align: right;">86.93</td>
<td style="text-align: right;">89.49</td>
<td style="text-align: right;">6.76</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="correlation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis">Correlation Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== CORRELATION: CV vs GENE BODY METHYLATION ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== CORRELATION: CV vs GENE BODY METHYLATION ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Acropora pulchra ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Acropora pulchra ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">cor_apul <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb33-2">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb33-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_apul<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_apul<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Spearman rho = -0.386 , p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomin genes only:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomin genes only:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">apul_biomin_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, is_biomin)</span>
<span id="cb37-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(apul_biomin_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb37-3">  cor_apul_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(apul_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, apul_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb37-4">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb37-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_apul_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_apul_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb37-6">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb37-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Not enough biomin genes for correlation</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb37-8">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Spearman rho = -0.38 , p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb39-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Porites evermanni ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Porites evermanni ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">cor_peve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb41-2">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb41-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_peve<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_peve<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Spearman rho = -0.45 , p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomin genes only:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomin genes only:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">peve_biomin_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, is_biomin)</span>
<span id="cb45-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(peve_biomin_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb45-3">  cor_peve_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(peve_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, peve_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb45-4">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb45-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_peve_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_peve_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb45-6">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb45-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Not enough biomin genes for correlation</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb45-8">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Spearman rho = -0.403 , p = 3.61e-20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb47-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Pocillopora tuahiniensis ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Pocillopora tuahiniensis ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1">cor_ptua <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb49-2">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb49-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ptua<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ptua<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Spearman rho = -0.409 , p = 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Biomin genes only:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Biomin genes only:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1">ptua_biomin_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, is_biomin)</span>
<span id="cb53-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(ptua_biomin_only) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) {</span>
<span id="cb53-3">  cor_ptua_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(ptua_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, ptua_biomin_only<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, </span>
<span id="cb53-4">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb53-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Spearman rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ptua_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ptua_biomin<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb53-6">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb53-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"    Not enough biomin genes for correlation</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb53-8">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Spearman rho = -0.314 , p = 7.65e-12 </code></pre>
</div>
</div>
</section>
<section id="cv-distribution-comparison" class="level2">
<h2 class="anchored" data-anchor-id="cv-distribution-comparison">CV Distribution Comparison</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Boxplot comparing CV distribution between biomin and other genes</span></span>
<span id="cb55-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> is_biomin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>),</span>
<span id="cb55-5">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb55-6">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomin genes"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Coefficient of Variation by Gene Type"</span>,</span>
<span id="cb55-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb55-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb55-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb55-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/cv-distribution-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="statistical-tests-cv-comparison" class="level2">
<h2 class="anchored" data-anchor-id="statistical-tests-cv-comparison">Statistical Tests: CV Comparison</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== WILCOXON TEST: CV of Biomin vs Other Genes ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== WILCOXON TEST: CV of Biomin vs Other Genes ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb58-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Acropora pulchra ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Acropora pulchra ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1">apul_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wilcox.test</span>(cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> is_biomin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> apul_combined)</span>
<span id="cb60-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  W ="</span>, apul_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>statistic, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(apul_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  W = 4872457 , p = 0.929 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Other):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Other): 80.37 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Biomin):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Biomin): 79.92 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb66-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Porites evermanni ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Porites evermanni ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1">peve_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wilcox.test</span>(cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> is_biomin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> peve_combined)</span>
<span id="cb68-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  W ="</span>, peve_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>statistic, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(peve_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  W = 5114222 , p = 0.000132 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Other):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Other): 93.99 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Biomin):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Biomin): 86.93 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb74-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Pocillopora tuahiniensis ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Pocillopora tuahiniensis ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1">ptua_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wilcox.test</span>(cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> is_biomin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ptua_combined)</span>
<span id="cb76-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  W ="</span>, ptua_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>statistic, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(ptua_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  W = 5322898 , p = 0.0836 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Other):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Other): 76.72 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Median CV (Biomin):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, is_biomin)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median CV (Biomin): 74.81 </code></pre>
</div>
</div>
</section>
<section id="cv-vs-log10-expression-by-methylation-status" class="level2">
<h2 class="anchored" data-anchor-id="cv-vs-log10-expression-by-methylation-status">CV vs Log10 Expression by Methylation Status</h2>
<p>This section examines the relationship between coefficient of variation (CV) and log10-transformed mean expression, categorizing genes by their methylation status:</p>
<ul>
<li><strong>Methylated</strong>: Gene body methylation &gt; 60%</li>
<li><strong>Unmethylated</strong>: Gene body methylation &lt; 1%</li>
<li><strong>Intermediate</strong>: Gene body methylation between 1% and 60%</li>
</ul>
<section id="categorize-genes-by-methylation-status" class="level3">
<h3 class="anchored" data-anchor-id="categorize-genes-by-methylation-status">Categorize Genes by Methylation Status</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add methylation category and log expression to combined data</span></span>
<span id="cb82-2">all_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb82-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb82-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mean_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb82-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methylation_status =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb82-6">      mean_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>,</span>
<span id="cb82-7">      mean_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>,</span>
<span id="cb82-8">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span></span>
<span id="cb82-9">    ),</span>
<span id="cb82-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">methylation_status =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(methylation_status, </span>
<span id="cb82-11">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>, </span>
<span id="cb82-12">                                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span>, </span>
<span id="cb82-13">                                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>))</span>
<span id="cb82-14">  )</span>
<span id="cb82-15"></span>
<span id="cb82-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary of methylation categories by species</span></span>
<span id="cb82-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== GENE COUNTS BY METHYLATION STATUS ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== GENE COUNTS BY METHYLATION STATUS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1">all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb84-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(species, methylation_status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb84-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> methylation_status, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> n) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb84-4">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>()</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 30%">
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">species</th>
<th style="text-align: right;">Unmethylated (&lt;1%)</th>
<th style="text-align: right;">Intermediate (1-60%)</th>
<th style="text-align: right;">Methylated (&gt;60%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: right;">7839</td>
<td style="text-align: right;">11662</td>
<td style="text-align: right;">1165</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: right;">11458</td>
<td style="text-align: right;">11054</td>
<td style="text-align: right;">97</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: right;">8366</td>
<td style="text-align: right;">10063</td>
<td style="text-align: right;">1426</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="cv-vs-log10-expression---all-species-combined" class="level3">
<h3 class="anchored" data-anchor-id="cv-vs-log10-expression---all-species-combined">CV vs Log10 Expression - All Species Combined</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot intermediate genes first (background)</span></span>
<span id="cb85-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span>),</span>
<span id="cb85-4">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb85-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot unmethylated genes</span></span>
<span id="cb85-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>),</span>
<span id="cb85-8">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb85-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot methylated genes on top</span></span>
<span id="cb85-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>),</span>
<span id="cb85-12">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb85-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb85-15">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>,</span>
<span id="cb85-16">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb85-17">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Log10 Expression by Methylation Status"</span>,</span>
<span id="cb85-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb85-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/cv-vs-expression-combined-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cv-vs-log10-expression---faceted-by-species" class="level3">
<h3 class="anchored" data-anchor-id="cv-vs-log10-expression---faceted-by-species">CV vs Log10 Expression - Faceted by Species</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot intermediate genes first (background)</span></span>
<span id="cb86-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span>),</span>
<span id="cb86-4">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb86-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot unmethylated genes</span></span>
<span id="cb86-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>),</span>
<span id="cb86-8">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb86-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot methylated genes on top</span></span>
<span id="cb86-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>),</span>
<span id="cb86-12">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb86-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb86-15">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>,</span>
<span id="cb86-16">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb86-17">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation vs Log10 Expression by Methylation Status"</span>,</span>
<span id="cb86-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb86-21">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb86-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/cv-vs-expression-faceted-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cv-vs-log10-expression---highlighting-methylated-and-unmethylated-only" class="level3">
<h3 class="anchored" data-anchor-id="cv-vs-log10-expression---highlighting-methylated-and-unmethylated-only">CV vs Log10 Expression - Highlighting Methylated and Unmethylated Only</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot intermediate genes as background</span></span>
<span id="cb87-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate (1-60%)"</span>),</span>
<span id="cb87-4">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression),</span>
<span id="cb87-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray85"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot unmethylated genes</span></span>
<span id="cb87-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>),</span>
<span id="cb87-8">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb87-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot methylated genes on top</span></span>
<span id="cb87-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>),</span>
<span id="cb87-12">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status),</span>
<span id="cb87-13">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb87-15">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb87-16">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CV vs Log10 Expression: Methylated vs Unmethylated Genes"</span>,</span>
<span id="cb87-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intermediate methylation genes shown in light gray background"</span>,</span>
<span id="cb87-20">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb87-21">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coefficient of Variation (%)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb87-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb87-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/cv-vs-expression-highlight-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="expression-distribution-methylated-vs-unmethylated-genes" class="level3">
<h3 class="anchored" data-anchor-id="expression-distribution-methylated-vs-unmethylated-genes">Expression Distribution: Methylated vs Unmethylated Genes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter to only methylated and unmethylated genes</span></span>
<span id="cb88-2">meth_unmeth_only <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb88-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span>))</span>
<span id="cb88-4"></span>
<span id="cb88-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histogram - All species combined</span></span>
<span id="cb88-6">p_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(meth_unmeth_only, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> methylation_status)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb88-9">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb88-10">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Expression: Methylated vs Unmethylated Genes"</span>,</span>
<span id="cb88-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb88-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency (Number of Genes)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb88-16"></span>
<span id="cb88-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Histogram - Faceted by species</span></span>
<span id="cb88-18">p_faceted <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(meth_unmeth_only, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> methylation_status)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb88-21">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb88-22">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Expression by Species"</span>,</span>
<span id="cb88-25">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb88-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Frequency (Number of Genes)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb88-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb88-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span>
<span id="cb88-30"></span>
<span id="cb88-31">p_combined</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/expression-histogram-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1">p_faceted</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/expression-histogram-faceted-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="expression-distribution---density-plot" class="level3">
<h3 class="anchored" data-anchor-id="expression-distribution---density-plot">Expression Distribution - Density Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(meth_unmeth_only, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> methylation_status, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> methylation_status)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb90-4">                               <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb90-5">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unmethylated (&lt;1%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E41A1C"</span>,</span>
<span id="cb90-7">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylated (&gt;60%)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#377EB8"</span>),</span>
<span id="cb90-8">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density Distribution of Gene Expression: Methylated vs Unmethylated"</span>,</span>
<span id="cb90-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb90-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Density"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb90-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb90-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/index_files/figure-html/expression-density-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics-by-methylation-status" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics-by-methylation-status">Summary Statistics by Methylation Status</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1">methylation_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb91-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(species, methylation_status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb91-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb91-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb91-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_cv =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb91-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median_cv =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(cv_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb91-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_log_expr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb91-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median_log_expr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb91-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb91-10">  )</span>
<span id="cb91-11"></span>
<span id="cb91-12">methylation_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb91-13">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb91-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation Status"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean CV"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median CV"</span>, </span>
<span id="cb91-15">                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Log Expr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median Log Expr"</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: left;">Methylation Status</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean CV</th>
<th style="text-align: right;">Median CV</th>
<th style="text-align: right;">Mean Log Expr</th>
<th style="text-align: right;">Median Log Expr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">Unmethylated (&lt;1%)</td>
<td style="text-align: right;">7839</td>
<td style="text-align: right;">150.75</td>
<td style="text-align: right;">108.16</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">Intermediate (1-60%)</td>
<td style="text-align: right;">11662</td>
<td style="text-align: right;">107.40</td>
<td style="text-align: right;">67.56</td>
<td style="text-align: right;">2.10</td>
<td style="text-align: right;">2.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">Methylated (&gt;60%)</td>
<td style="text-align: right;">1165</td>
<td style="text-align: right;">122.30</td>
<td style="text-align: right;">62.07</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">2.46</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">Unmethylated (&lt;1%)</td>
<td style="text-align: right;">11458</td>
<td style="text-align: right;">139.00</td>
<td style="text-align: right;">96.10</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">1.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">Intermediate (1-60%)</td>
<td style="text-align: right;">11054</td>
<td style="text-align: right;">89.57</td>
<td style="text-align: right;">63.12</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">2.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">Methylated (&gt;60%)</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">66.89</td>
<td style="text-align: right;">58.94</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">2.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">Unmethylated (&lt;1%)</td>
<td style="text-align: right;">8366</td>
<td style="text-align: right;">181.81</td>
<td style="text-align: right;">125.91</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">Intermediate (1-60%)</td>
<td style="text-align: right;">10063</td>
<td style="text-align: right;">119.58</td>
<td style="text-align: right;">78.21</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">Methylated (&gt;60%)</td>
<td style="text-align: right;">1426</td>
<td style="text-align: right;">102.70</td>
<td style="text-align: right;">68.32</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">1.98</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="statistical-tests-cv-by-methylation-status" class="level3">
<h3 class="anchored" data-anchor-id="statistical-tests-cv-by-methylation-status">Statistical Tests: CV by Methylation Status</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb92" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== KRUSKAL-WALLIS TEST: CV across Methylation Status ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== KRUSKAL-WALLIS TEST: CV across Methylation Status ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(sp <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(all_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>species)) {</span>
<span id="cb94-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"---"</span>, sp, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb94-3">  sp_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> sp)</span>
<span id="cb94-4">  kw_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kruskal.test</span>(cv_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> methylation_status, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sp_data)</span>
<span id="cb94-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Kruskal-Wallis chi-squared ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(kw_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>statistic, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), </span>
<span id="cb94-6">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", df ="</span>, kw_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>parameter, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(kw_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb94-7">  </span>
<span id="cb94-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pairwise Wilcoxon tests</span></span>
<span id="cb94-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  Pairwise Wilcoxon tests:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb94-10">  pw_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pairwise.wilcox.test</span>(sp_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, sp_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>methylation_status, </span>
<span id="cb94-11">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p.adjust.method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bonferroni"</span>)</span>
<span id="cb94-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(pw_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value)</span>
<span id="cb94-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb94-14">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Acropora pulchra ---
  Kruskal-Wallis chi-squared = 2367.2 , df = 2 , p = 0 
  Pairwise Wilcoxon tests:
                     Unmethylated (&lt;1%) Intermediate (1-60%)
Intermediate (1-60%)        0.00000e+00                   NA
Methylated (&gt;60%)          1.64382e-123          0.001130075

--- Porites evermanni ---
  Kruskal-Wallis chi-squared = 3048.76 , df = 2 , p = 0 
  Pairwise Wilcoxon tests:
                     Unmethylated (&lt;1%) Intermediate (1-60%)
Intermediate (1-60%)       0.000000e+00                   NA
Methylated (&gt;60%)         1.507402e-273         3.971524e-26

--- Pocillopora tuahiniensis ---
  Kruskal-Wallis chi-squared = 3697.56 , df = 2 , p = 0 
  Pairwise Wilcoxon tests:
                     Unmethylated (&lt;1%) Intermediate (1-60%)
Intermediate (1-60%)       0.000000e+00                   NA
Methylated (&gt;60%)          1.904952e-26           0.07566394</code></pre>
</div>
</div>
</section>
<section id="correlation-cv-vs-expression-by-methylation-status" class="level3">
<h3 class="anchored" data-anchor-id="correlation-cv-vs-expression-by-methylation-status">Correlation: CV vs Expression by Methylation Status</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== SPEARMAN CORRELATION: CV vs Log10 Expression by Methylation Status ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== SPEARMAN CORRELATION: CV vs Log10 Expression by Methylation Status ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(sp <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(all_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>species)) {</span>
<span id="cb98-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"---"</span>, sp, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb98-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(meth_status <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(all_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>methylation_status)) {</span>
<span id="cb98-4">    subset_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> sp, methylation_status <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> meth_status)</span>
<span id="cb98-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(subset_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb98-6">      cor_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(subset_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cv_expression, subset_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, </span>
<span id="cb98-7">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spearman"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb98-8">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>, meth_status, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">": rho ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb98-9">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_test<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), </span>
<span id="cb98-10">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" (n ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(subset_data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb98-11">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb98-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  "</span>, meth_status, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">": Not enough genes (n ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(subset_data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb98-13">    }</span>
<span id="cb98-14">  }</span>
<span id="cb98-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb98-16">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Acropora pulchra ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Unmethylated (&lt;1%) : rho = -0.758 , p = 0  (n = 7839 )</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Intermediate (1-60%) : rho = -0.68 , p = 0  (n = 11662 )</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Methylated (&gt;60%) : rho = -0.678 , p = 2.05e-157  (n = 1165 )

--- Porites evermanni ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Unmethylated (&lt;1%) : rho = -0.803 , p = 0  (n = 8366 )</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Intermediate (1-60%) : rho = -0.731 , p = 0  (n = 10063 )</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Methylated (&gt;60%) : rho = -0.711 , p = 3.91e-220  (n = 1426 )

--- Pocillopora tuahiniensis ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Unmethylated (&lt;1%) : rho = -0.728 , p = 0  (n = 11458 )</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Intermediate (1-60%) : rho = -0.695 , p = 0  (n = 11054 )
   Methylated (&gt;60%) : rho = -0.603 , p = 0  (n = 97 )</code></pre>
</div>
</div>
</section>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb108" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13)
Platform: aarch64-apple-darwin20
Running under: macOS Tahoe 26.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.3.2 lubridate_1.9.4 forcats_1.0.1   stringr_1.5.2  
 [5] dplyr_1.1.4     purrr_1.1.0     readr_2.1.5     tidyr_1.3.1    
 [9] tibble_3.3.0    ggplot2_4.0.0   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] bit_4.6.0          gtable_0.3.6       jsonlite_2.0.0     crayon_1.5.3      
 [5] compiler_4.5.1     tidyselect_1.2.1   parallel_4.5.1     scales_1.4.0      
 [9] yaml_2.3.10        fastmap_1.2.0      R6_2.6.1           labeling_0.4.3    
[13] generics_0.1.4     curl_7.0.0         knitr_1.50         htmlwidgets_1.6.4 
[17] pillar_1.11.1      RColorBrewer_1.1-3 tzdb_0.5.0         rlang_1.1.6       
[21] stringi_1.8.7      xfun_0.54          S7_0.2.0           bit64_4.6.0-1     
[25] timechange_0.3.0   cli_3.6.5          withr_3.0.2        magrittr_2.0.4    
[29] digest_0.6.37      grid_4.5.1         vroom_1.6.6        rstudioapi_0.17.1 
[33] hms_1.1.3          lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.5    
[37] glue_1.8.0         farver_2.1.2       rmarkdown_2.30     tools_4.5.1       
[41] pkgconfig_2.0.3    htmltools_0.5.8.1 </code></pre>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/67-coeff-var/</guid>
  <pubDate>Thu, 04 Dec 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-12-04_07-26-50.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Context dependent DNA methylation :: miRNA regulation of gene expression</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/66-biomin-methylation-miRNA/</link>
  <description><![CDATA[ 





<section id="read-in-cross-species-methylation-mirna-comparison-data" class="level1">
<h1>Read in Cross-Species Methylation miRNA Comparison Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read CSV from remote URL</span></span>
<span id="cb1-2">biomin_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/biomin_comparison_20251130_052506/cross_species_methylation_mirna_comparison.csv"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 611 Columns: 15
‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Delimiter: ","
chr  (1): og_id
dbl (11): n_species, apul_context_strength, apul_improvement, apul_r2, peve_...
lgl  (3): apul_context_dependent, peve_context_dependent, ptua_context_depen...

‚Ñπ Use `spec()` to retrieve the full column specification for this data.
‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display structure of the data</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(biomin_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 611
Columns: 15
$ og_id                  &lt;chr&gt; "OG_01155", "OG_02619", "OG_06119", "OG_08793",‚Ä¶
$ n_species              &lt;dbl&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,‚Ä¶
$ apul_context_strength  &lt;dbl&gt; 1.5210053, 1.4686122, 0.9717545, 0.8087638, 0.9‚Ä¶
$ apul_context_dependent &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE‚Ä¶
$ apul_improvement       &lt;dbl&gt; 4.542280e-02, 4.080240e-04, 6.730879e-03, 7.044‚Ä¶
$ apul_r2                &lt;dbl&gt; 0.5495437, 0.5965734, 0.5632711, 0.6156382, 0.5‚Ä¶
$ peve_context_strength  &lt;dbl&gt; 0.9962671, 1.0244916, 1.2526347, 1.4507635, 1.1‚Ä¶
$ peve_context_dependent &lt;lgl&gt; FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE,‚Ä¶
$ peve_improvement       &lt;dbl&gt; 2.785907e-02, 4.279548e-02, 6.041180e-02, 3.231‚Ä¶
$ peve_r2                &lt;dbl&gt; 0.5239709, 0.4887706, 0.7519803, 0.5892956, 0.6‚Ä¶
$ ptua_context_strength  &lt;dbl&gt; 1.4149060, 1.3928000, 1.4860590, 1.4495109, 1.4‚Ä¶
$ ptua_context_dependent &lt;lgl&gt; FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE, F‚Ä¶
$ ptua_improvement       &lt;dbl&gt; 3.367814e-02, 6.301667e-02, 1.140166e-01, 4.800‚Ä¶
$ ptua_r2                &lt;dbl&gt; 0.5576365, 0.4958976, 0.5536735, 0.6081574, 0.4‚Ä¶
$ mean_context_strength  &lt;dbl&gt; 1.310726, 1.295301, 1.236816, 1.236346, 1.19955‚Ä¶</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View column names to identify context dependent columns</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(biomin_data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "og_id"                  "n_species"              "apul_context_strength" 
 [4] "apul_context_dependent" "apul_improvement"       "apul_r2"               
 [7] "peve_context_strength"  "peve_context_dependent" "peve_improvement"      
[10] "peve_r2"                "ptua_context_strength"  "ptua_context_dependent"
[13] "ptua_improvement"       "ptua_r2"                "mean_context_strength" </code></pre>
</div>
</div>
</section>
<section id="summary-of-context-dependent-groups" class="level1">
<h1>Summary of Context Dependent Groups</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify columns that contain "context" in their name (case insensitive)</span></span>
<span id="cb7-2">context_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(biomin_data), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Context-related columns found:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Context-related columns found:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(context_cols)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "apul_context_strength"  "apul_context_dependent" "peve_context_strength" 
[4] "peve_context_dependent" "ptua_context_strength"  "ptua_context_dependent"
[7] "mean_context_strength" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for rows where any context dependent column is TRUE</span></span>
<span id="cb11-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First, let's see unique values in context columns</span></span>
<span id="cb11-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(context_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb11-4">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (col <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> context_cols) {</span>
<span id="cb11-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Unique values in"</span>, col, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb11-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(biomin_data[[col]]))</span>
<span id="cb11-7">  }</span>
<span id="cb11-8">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Unique values in apul_context_strength :
  [1] 1.5210053 1.4686122 0.9717545 0.8087638 0.9392760 1.1867517 1.1661343
  [8] 1.5266324 0.9790248 1.6806886 1.1407917 0.9352201 1.0162652 1.0759084
 [15] 1.0906613 0.7956819 1.2331926 1.0647917 1.3480270 1.0065100 0.6788373
 [22] 1.7699775 0.9817814 0.6953154 0.9697093 0.9795832 1.1846948 0.8948526
 [29] 0.8376585 0.7537790 0.9734574 1.2986062 1.3042339 1.2566377 1.2073803
 [36] 1.1719138 0.4838400 0.9116153 1.0712626 1.0302731 0.7004548 1.1107593
 [43] 0.6135444 0.9840409 0.8025398 0.8977149 0.9465684 0.3889291 0.8141095
 [50] 0.6951846 0.6790790 1.0387031 1.0217601 0.8537525 0.6037977 0.7654756
 [57] 0.9779878 1.2961206 0.7238753 0.7272980 0.9720048 0.5653736 0.9874203
 [64] 0.9261418 0.6736686 0.8024550 1.2647949 0.9824010 0.6881109 0.3984062
 [71] 0.8853583 0.9122248 1.0299710 0.9420400 0.8114961 1.1269004 0.8736419
 [78] 0.8922733 0.2592512 1.0534686 0.6377086 0.7193908 0.9016007 0.8919931
 [85] 0.5131795 1.0572084 0.9190864 0.6425073 0.9476628 0.9079487 0.9888151
 [92] 0.6163162 0.7210294 0.5506604 0.3311742 0.7299102 0.6722439 0.4242897
 [99] 0.3994733 0.5870028 1.2700770        NA 1.3787355 1.5612844 1.5826942
[106] 1.1830914 0.9200262 1.4490784 1.8053371 1.0123960 1.1363415 1.1501350
[113] 1.3385444 1.2854709 1.1493544 1.0207283 1.3098951 1.1911210 0.8752388
[120] 1.0066910 1.3683771 1.1880021 1.5110779 0.8778843 1.1780774 1.1268855
[127] 1.2006001 1.2360252 1.0489726 0.8279252 1.1145611 0.8548954 0.9624495
[134] 1.1860685 1.4929435 1.1703841 1.0182194 1.5617765 1.2675733 1.2915712
[141] 1.0185594 0.8157635 1.1920148 1.2129086 1.3030838 0.7302221 1.0549104
[148] 1.1700095 1.4198918 1.1943181 1.0296594 1.1618123 0.9681725 1.0928932
[155] 0.8833417 1.1268010 1.0813868 0.9619526 0.8739806 0.8528617 1.3603219
[162] 1.1271233 1.2460202 0.9868753 1.0457793 0.9559422 1.1463036 0.9443693
[169] 1.2890331 0.8460410 0.8616859 0.6904839 1.6004786 0.5267972 0.7319011
[176] 1.0486275 1.1499568 1.1971106 0.9933572 0.9060864 0.8549193 0.8589213
[183] 0.6600287 1.1974981 0.7560685 0.6584202 1.0042000 0.8793598 0.8490334
[190] 1.2014146 1.2491064 1.1129278 1.1947807 1.0846427 1.2458097 1.3920571
[197] 0.9489826 0.9241358 0.6221756 0.8703770 0.7863923 0.5062372 0.7492466
[204] 0.7512697 0.9140403 0.5068823 1.0500980 0.6439405 0.6937298 0.7409128
[211] 0.9435256 0.5997723 0.8153285 0.6686174 0.7933766 0.5650183 0.6202492
[218] 1.0458144 0.8489848 0.9733974 0.9932778 0.8413606 1.1129022 0.9068886
[225] 0.9338849 0.5399323 1.2580175 0.5728934 1.3942634 0.5776230 0.6070259
[232] 1.2590693 0.7783844 0.9332572 0.4554141 0.9844705 0.9177532 0.4897440
[239] 0.4974171 0.8884588 0.9048206 0.7620361 0.7492338 0.6355758 0.7745086
[246] 0.8988785 0.7004502 0.7701659 0.9155693 0.4622773 0.6532438 1.0345924
[253] 0.6919324 0.5744296 0.4194247 0.5983485 0.8423933 0.7309599 0.2878046
[260] 0.6489733 0.7660981 0.4850826 0.7223149 0.5451732 0.6056769 0.4190426
[267] 0.3951051 0.5736550 0.5338322 0.1005362 0.9479788 1.4806336 1.4733946
[274] 1.4417109 1.3969251 1.3673747 1.3036000 1.2796473 1.2419111 1.2410928
[281] 1.2339513 1.2262897 1.2107255 1.2102872 1.2102189 1.1984038 1.1869192
[288] 1.1853484 1.1771592 1.1646136 1.1600195 1.1433012 1.1420694 1.1319728
[295] 1.1250897 1.1080518 1.0994019 1.0897755 1.0816391 1.0244446 1.0119372
[302] 1.0113012 1.0095001 1.0067032 1.0064652 0.9722323 0.9688839 0.9648068
[309] 0.9609933 0.9596259 0.9585918 0.9546278 0.9426111 0.9397804 0.9299949
[316] 0.9189571 0.8796054 0.8327863 0.8110399 0.8104258 0.7959653 0.7249008
[323] 0.6964786 0.6559203 0.6386183 0.6123647 0.5120528 0.5110356 0.5070016
[330] 0.4752355 0.3181766 0.2744171 0.1409422

Unique values in apul_context_dependent :
[1] FALSE  TRUE    NA

Unique values in peve_context_strength :
  [1] 0.99626714 1.02449159 1.25263469 1.45076355 1.17445040 0.79956930
  [7] 1.16510795 0.92273479 1.35808525 0.77568342 1.09745363 1.24733457
 [13] 1.07489313 1.25458754 0.87769840 1.33917127 1.20400162 1.24427411
 [19] 0.61937307 1.04919890 0.93278295 0.93198699 1.07988651 1.00249447
 [25] 1.29297367 0.93128838 0.78095832 1.34095802 1.25945467 1.19836273
 [31] 0.70124053 1.01679781 1.00517251 1.13061201 0.64697208 0.95017198
 [37] 1.33873175 0.89646465 1.01422941 0.75206418 0.88021142 1.10525164
 [43] 0.94023458 1.29674550 0.73313502 0.97744503 0.84015171 1.33396632
 [49] 0.81615519 1.00176957 1.12296541 1.10928382 0.92776134 0.79022895
 [55] 1.17919774 0.86244003 0.85383851 0.38895441 0.92787545 0.61539113
 [61] 0.51660061 0.63759431 0.90798424 0.72352975 1.36931858 0.79297426
 [67] 0.48431794 0.72755745 0.76759946 1.14478775 0.44074229 0.45448232
 [73] 0.73371139 0.81632356 1.23352198 0.59271857 0.63161818 0.76520911
 [79] 1.08674775 0.46008801 1.17159121 0.64517903 0.84730111 0.27030874
 [85] 0.89826827 1.02940774 0.95378680 1.01525253 0.38930413 0.50313221
 [91] 0.67849890 1.08643819 1.08033786 0.75081575 0.74514370 0.30482527
 [97] 0.58757002 0.47010759 0.37384242 0.72698326         NA 1.52327334
[103] 1.38779722 1.33735922 1.31594426 1.16301358 1.27933673 1.22445709
[109] 1.22013655 1.19809717 1.10602494 1.24314076 1.06092097 1.22094345
[115] 1.19359519 1.24877790 1.19118337 1.20011511 1.10721771 1.07113952
[121] 0.91395409 0.90805196 1.17632432 1.20223857 1.29750449 1.13479927
[127] 0.85198973 1.23852454 0.97377659 1.05347390 1.19476862 1.17813712
[133] 1.21270746 1.13712496 1.02584020 1.14947264 1.28881281 1.03964051
[139] 0.84447591 1.06537942 1.08042306 1.17404962 0.89536276 1.03849217
[145] 1.32079036 1.04241187 1.19897496 1.12289152 0.88784861 1.13240293
[151] 0.31409834 0.76999260 0.92365284 1.20821553 0.86846732 1.14594258
[157] 1.12835920 1.12291005 0.44898009 0.88670657 0.96652306 1.20150543
[163] 1.17125385 0.64861834 0.92402810 1.05785827 0.91983090 0.79384044
[169] 0.64095444 0.61112882 0.67460424 0.41996047 0.76706124 0.80462681
[175] 0.80153122 0.53556279 1.02517709 1.11973541 1.08438686 0.54867661
[181] 0.83104740 0.69284560 1.15435790 1.23223587 0.32925325 0.66026316
[187] 1.15137039 0.57799979 0.86261148 0.91949035 0.73340498 1.00568694
[193] 0.78265509 1.13139543 0.68032691 0.60741037 0.50068704 0.77549221
[199] 0.25473459 0.37474014 0.89462849 0.64713383 0.53955424 0.29403184
[205] 0.37745822 0.44378433 0.52771055 0.48640639 0.60730233 0.84793002
[211] 0.71088690 0.55831453 0.99148566 0.79172468 0.49443793 0.79051981
[217] 0.61984580 0.67883407 0.53192178 0.16135035 0.50700535 0.47912362
[223] 0.39924622 0.64033772 0.53235119 0.42657142 0.50673299 0.06620029
[229] 0.58141529 1.34479192 1.31225025 1.24395644 1.24282007 1.22892159
[235] 1.19110334 1.15038711 1.14711174 1.14213707 1.11389655 1.05795908
[241] 1.04979512 1.03626541 1.01126897 0.99623873 0.92415085 0.92063887
[247] 0.91901129 0.91372043 0.89994438 0.89638919 0.89577838 0.84654246
[253] 0.83941076 0.80537758 0.75470095 0.75441620 0.73421825 0.64879956
[259] 0.60480241 0.59284432 0.54205873 0.50998914 0.48995108 0.48257571
[265] 0.31923068

Unique values in peve_context_dependent :
[1] FALSE  TRUE    NA

Unique values in ptua_context_strength :
  [1] 1.4149060 1.3928000 1.4860590 1.4495109 1.4849456 1.6114782 1.2455426
  [8] 1.1240720 1.1872014 1.0285770 1.2442072 1.2326676 1.3082528 1.0337898
 [15] 1.3727795 1.1966488 0.8942806 0.9918106 1.2619950 1.1633376 1.6073742
 [22] 0.5018816 1.1419919 1.5033297 0.9287888 1.2682021 1.2094349 0.9333425
 [29] 1.0695879 1.1997492 1.4397979 0.7956825 0.7937776 0.6864053 1.1802553
 [36] 0.9042285 1.1948569 1.1845484 0.8775869 1.1772377 1.3748497 0.7305533
 [43] 1.3469763 0.6150367 1.3548418 1.0083482 1.0963346 1.1526755 1.2417909
 [50] 1.1469886 1.0300454 0.6769978 0.8731906 1.1647562 1.0227259 1.1600103
 [57] 0.9502591 1.0905180 1.1079630 1.4151532 1.2664312 1.5436651 0.8465310
 [64] 1.0704609 0.6677958 1.1009586 0.9394141 0.9586694 1.1811509 1.0611002
 [71] 1.2700171 1.2162969 0.8191365 0.8195657 0.5305453 0.8098849 1.0241982
 [78] 0.8716133 1.1802553 1.0054205 0.7055174 1.0735794 0.6855617 1.2361614
 [85] 0.9842197 0.2731507 0.4617118 0.6375427 0.9505097 0.8526424 0.5741643
 [92] 0.5104113 0.3566194 0.8207341 1.0022485 1.0396646 0.8003053 0.9795584
 [99] 1.0833567 0.4288373 1.8332432 1.4989439 1.6018084 1.4029527 1.5130299
[106] 1.5486827 1.2597869 1.6304029 1.8811998 1.4730021 1.3153204 0.8883912
[113] 1.6724209 1.4900577 1.4325508 1.4445305 1.2442424        NA 1.3861076
[120] 1.3080677 1.5035696 1.2805398 1.1879140 1.3052371 1.2845079 1.3723581
[127] 1.2062798 1.5655934 1.4311872 1.2105032 0.8815807 1.1432456 1.5131892
[134] 1.1943152 1.2405243 1.1729523 1.1617436 1.1578730 1.2881734 1.5065581
[141] 1.2186678 1.4741894 1.3589648 1.2464541 1.3989783 1.4011298 1.1291728
[148] 1.1007402 1.0049497 1.1136929 0.7834103 1.1371853 1.1005468 1.4062393
[155] 0.6913917 0.9854329 0.9585385 1.2314569 1.4332412 1.2723484 1.0460129
[162] 1.0256640 0.9341771 1.5030831 1.0606414 0.8056531 1.0300096 1.0043698
[169] 1.1869582 1.0776977 1.1729453 1.0368704 1.2268789 1.0875312 1.0269248
[176] 1.3171084 1.0623263 1.2373284 1.0837157 1.2465059 1.2633611 0.7940659
[183] 0.7536408 0.9724537 0.8533388 1.1031084 0.8811798 0.9314258 1.1896435
[190] 0.7836523 1.2257648 1.7561475 1.2019104 1.3669221 0.4475605 1.2632253
[197] 1.5031122 1.0934763 0.8070476 1.2832160 0.9608722 1.1367811 0.8583550
[204] 0.8486230 0.7984237 1.0007019 0.8576449 1.0794262 1.5264451 1.1116005
[211] 1.0808658 0.9990668 1.2928985 0.7541299 0.7406954 1.2611974 1.2674468
[218] 0.9115597 1.0360718 0.9888021 0.9841479 1.1083526 0.6953924 0.7653758
[225] 0.6829402 0.7794138 0.4589443 0.9015460 0.9119556 1.2133065 0.9639233
[232] 1.0473459 1.3220820 1.1531126 1.0784330 1.0661141 1.3955691 1.0443655
[239] 0.9918902 0.9944223 0.8800967 1.2855380 0.7392336 1.1405782 1.2454831
[246] 0.7536202 0.6584946 1.0363671 1.2199974 0.8220159 0.9270068 1.0628450
[253] 0.9334491 1.0796553 0.9545088 0.5140624 1.4111704 1.0768536 1.0956281
[260] 0.6693501 1.1363274 0.7884408 0.7095188 0.8542455 0.6879702 0.5803579
[267] 0.9105391 0.7722967 0.7433553 0.9902182 0.4058612 1.0883539 1.0483941
[274] 1.1532600 0.8783116 1.0688953 0.8515742 0.7344220 0.6938705 1.1687729
[281] 0.9742204 1.0761619 0.6247228 0.6848879 1.3058337 1.1038883 1.0957076
[288] 0.6881710 0.6691165 0.8105987 1.1947330 0.8127902 1.0995842 1.0011162
[295] 0.8912026 1.0295142 0.7394939 0.6536069 0.7969532 0.4101780 0.7492877
[302] 0.9428848 0.8484580 0.9992072 0.5428510 1.0611807 0.6427285 0.6699944
[309] 0.7863228 1.1471034 0.7792173 0.8016012 0.5692416 0.7493976 0.7280138
[316] 0.6462151 0.9366575 0.3917691 1.8752375 1.8748981 1.8365720 1.6251565
[323] 1.5902256 1.5281611 1.5260327 1.5075041 1.4832541 1.4350747 1.4316854
[330] 1.3798743 1.3786324 1.3760189 1.3749854 1.3748288 1.3623577 1.3594297
[337] 1.3561613 1.3526470 1.3468568 1.3437551 1.3395873 1.3339894 1.3315317
[344] 1.3268290 1.3216576 1.3196924 1.3163854 1.3141797 1.3133541 1.3120328
[351] 1.2996034 1.2992670 1.2893918 1.2825196 1.2751756 1.2732174 1.2690494
[358] 1.2613364 1.2549526 1.2408649 1.2370585 1.2145719 1.2143128 1.2102717
[365] 1.2080838 1.2000141 1.1997900 1.1995144 1.1980875 1.1965785 1.1952378
[372] 1.1856142 1.1759676 1.1737987 1.1684083 1.1625975 1.1562130 1.1473461
[379] 1.1464274 1.1425534 1.1289598 1.1285714 1.1275336 1.1239780 1.1205354
[386] 1.1147864 1.1067151 1.1058399 1.0903008 1.0861473 1.0824998 1.0803419
[393] 1.0745229 1.0727695 1.0677412 1.0667246 1.0643131 1.0607802 1.0586900
[400] 1.0586081 1.0583729 1.0569797 1.0506318 1.0501887 1.0459287 1.0324508
[407] 1.0302358 1.0276669 1.0271985 1.0260012 1.0245751 1.0232299 1.0192004
[414] 1.0057687 1.0032600 1.0021127 0.9994402 0.9991554 0.9966063 0.9914873
[421] 0.9885497 0.9882614 0.9848329 0.9768307 0.9630503 0.9614221 0.9592008
[428] 0.9541078 0.9514773 0.9331183 0.9317241 0.9167096 0.8934545 0.8848535
[435] 0.8644039 0.8538326 0.8471971 0.8468868 0.8239513 0.8237795 0.8213319
[442] 0.8162255 0.7626210 0.7588087 0.7408166 0.7196337 0.7107158 0.6993804
[449] 0.6781055 0.6699571 0.6558806 0.6309829 0.6210306 0.6086447 0.6068133
[456] 0.5896320 0.5792348 0.5451309 0.5327403 0.4726444 0.3275282

Unique values in ptua_context_dependent :
[1] FALSE  TRUE    NA

Unique values in mean_context_strength :
  [1] 1.3107262 1.2953013 1.2368161 1.2363461 1.1995573 1.1992664 1.1922616
  [8] 1.1911464 1.1747705 1.1616497 1.1608175 1.1384074 1.1331370 1.1214286
 [15] 1.1137131 1.1105006 1.1104916 1.1002921 1.0764650 1.0730155 1.0729981
 [22] 1.0679487 1.0678866 1.0670465 1.0638239 1.0596912 1.0583627 1.0563844
 [29] 1.0555670 1.0506303 1.0381653 1.0370288 1.0343947 1.0245517 1.0115359
 [36] 1.0087714 1.0058096 0.9975428 0.9876930 0.9865250 0.9851720 0.9821881
 [43] 0.9669184 0.9652744 0.9635055 0.9611694 0.9610182 0.9585236 0.9573519
 [50] 0.9479809 0.9440299 0.9416616 0.9409040 0.9362459 0.9352405 0.9293086
 [57] 0.9273618 0.9251977 0.9199046 0.9192808 0.9183455 0.9155444 0.9139785
 [64] 0.9067108 0.9035943 0.8987960 0.8961757 0.8895426 0.8789537 0.8680981
 [71] 0.8653726 0.8610013 0.8609396 0.8593097 0.8585211 0.8431680 0.8431528
 [78] 0.8430319 0.8420848 0.8396590 0.8382724 0.8127164 0.8114878 0.7994878
 [85] 0.7985558 0.7865890 0.7781950 0.7651009 0.7624922 0.7545745 0.7471594
 [92] 0.7377219 0.7193289 0.7074034 0.6928555 0.6914667 0.6867064 0.6246519
 [99] 0.6188908 0.5809411 1.5516601 1.5111086 1.4902720 1.4821186 1.4504135
[106] 1.4430209 1.4212406 1.4067472 1.4006130 1.3944732 1.3821994 1.3468641
[113] 1.3424084 1.3131996 1.2977822 1.2973328 1.2913934 1.2824038 1.2677310
[120] 1.2662624 1.2621489 1.2503382 1.2489046 1.2481791 1.2413025 1.2391915
[127] 1.2247103 1.2204161 1.2189391 1.2146491 1.2044728 1.2020492 1.1963293
[134] 1.1960117 1.1955367 1.1861963 1.1837049 1.1820678 1.1809294 1.1792365
[141] 1.1716215 1.1685730 1.1672416 1.1666144 1.1645424 1.1607072 1.1587968
[148] 1.1564662 1.1545909 1.1527486 1.1514894 1.1512271 1.1498807 1.1381769
[155] 1.1359923 1.1354655 1.1291145 1.1283720 1.1265841 1.1265031 1.1250548
[162] 1.1250082 1.1245023 1.1230625 1.1227443 1.1203908 1.1192863 1.1186305
[169] 1.1166526 1.1165237 1.1153254 1.1127725 1.1121639 1.1085386 1.1083088
[176] 1.1074113 1.0993928 1.0993413 1.0975257 1.0902122 1.0881987 1.0860772
[183] 1.0832208 1.0807921 1.0733831 1.0713747 1.0680011 1.0663456 1.0611039
[190] 1.0602433 1.0581114 1.0574282 1.0569814 1.0497885 1.0496795 1.0449918
[197] 1.0440956 1.0400774 1.0394169 1.0388647 1.0387461 1.0383861 1.0363427
[204] 1.0359029 1.0351229 1.0317982 1.0287030 1.0240196 1.0166089 1.0149547
[211] 1.0085646 1.0076316 1.0075586 1.0047499 1.0026242 1.0021488 0.9992899
[218] 0.9977671 0.9970296 0.9930020 0.9927563 0.9889147 0.9877126 0.9852609
[225] 0.9837862 0.9827949 0.9764636 0.9758140 0.9711004 0.9636612 0.9598088
[232] 0.9580326 0.9578798 0.9577158 0.9564151 0.9534458 0.9519894 0.9510965
[239] 0.9484035 0.9450304 0.9391518 0.9388605 0.9320283 0.9284693 0.9255007
[246] 0.9252643 0.9180457 0.9177410 0.9171502 0.9168691 0.9141596 0.9138584
[253] 0.9138398 0.9086919 0.9077648 0.9057134 0.8982585 0.8979768 0.8970685
[260] 0.8962102 0.8946658 0.8922594 0.8905229 0.8893986 0.8891150 0.8890583
[267] 0.8886400 0.8843370 0.8827708 0.8790271 0.8778453 0.8770651 0.8743888
[274] 0.8741363 0.8739427 0.8731491 0.8702118 0.8685584 0.8581943 0.8579386
[281] 0.8575822 0.8571636 0.8557982 0.8539656 0.8534012 0.8513983 0.8478031
[288] 0.8468286 0.8466301 0.8465971 0.8395926 0.8386201 0.8356639 0.8352726
[295] 0.8319393 0.8306236 0.8279022 0.8269735 0.8269019 0.8244990 0.8232592
[302] 0.8215489 0.8169047 0.8149793 0.8145252 0.8135638 0.8120935 0.8106771
[309] 0.8078581 0.8045967 0.8013205 0.7999328 0.7968161 0.7965623 0.7883149
[316] 0.7869686 0.7863174 0.7860956 0.7810120 0.7716843 0.7644134 0.7633892
[323] 0.7579603 0.7570013 0.7530904 0.7507685 0.7487017 0.7405264 0.7369419
[330] 0.7268815 0.7224842 0.7223852 0.7206101 0.7186614 0.7114438 0.7093159
[337] 0.6944341 0.6926221 0.6754028 0.6744927 0.6607813 0.6594838 0.6591223
[344] 0.6542269 0.6365517 0.6321500 0.6007192 0.6004237 0.5927555 0.5874592
[351] 0.5842201 0.5615595 0.5530031 0.5363933 0.5202826 0.5185969 0.5070896
[358] 0.4865922 1.8752375 1.8748981 1.8365720 1.6251565 1.5902256 1.5281611
[365] 1.5260327 1.5075041 1.4832541 1.4806336 1.4733946 1.4417109 1.4350747
[372] 1.4316854 1.3969251 1.3861076 1.3798743 1.3786324 1.3760189 1.3749854
[379] 1.3748288 1.3673747 1.3623577 1.3594297 1.3561613 1.3526470 1.3468568
[386] 1.3447919 1.3437551 1.3395873 1.3339894 1.3315317 1.3268290 1.3216576
[393] 1.3196924 1.3163854 1.3141797 1.3133541 1.3122502 1.3120328 1.3036000
[400] 1.2996034 1.2992670 1.2893918 1.2825196 1.2796473 1.2751756 1.2732174
[407] 1.2690494 1.2613364 1.2549526 1.2439564 1.2428201 1.2419111 1.2410928
[414] 1.2408649 1.2370585 1.2339513 1.2289216 1.2262897 1.2145719 1.2143128
[421] 1.2107255 1.2102872 1.2102717 1.2102189 1.2080838 1.2000141 1.1997900
[428] 1.1995144 1.1984038 1.1980875 1.1965785 1.1952378 1.1911033 1.1869192
[435] 1.1856142 1.1853484 1.1771592 1.1759676 1.1737987 1.1729523 1.1684083
[442] 1.1646136 1.1625975 1.1600195 1.1562130 1.1503871 1.1473461 1.1471117
[449] 1.1464274 1.1433012 1.1425534 1.1421371 1.1420694 1.1319728 1.1289598
[456] 1.1285714 1.1275336 1.1250897 1.1239780 1.1205354 1.1147864 1.1138965
[463] 1.1080518 1.1067151 1.1058399 1.1005468 1.0994019 1.0903008 1.0897755
[470] 1.0861473 1.0824998 1.0816391 1.0803419 1.0745229 1.0727695 1.0677412
[477] 1.0667246 1.0643131 1.0607802 1.0586900 1.0586081 1.0583729 1.0579591
[484] 1.0569797 1.0506318 1.0501887 1.0497951 1.0459287 1.0368704 1.0362654
[491] 1.0324508 1.0302358 1.0276669 1.0271985 1.0260012 1.0245751 1.0244446
[498] 1.0232299 1.0192004 1.0119372 1.0113012 1.0112690 1.0095001 1.0067032
[505] 1.0064652 1.0057687 1.0032600 1.0021127 0.9994402 0.9991554 0.9966063
[512] 0.9962387 0.9914873 0.9885497 0.9882614 0.9854329 0.9848329 0.9768307
[519] 0.9724537 0.9722323 0.9688839 0.9648068 0.9630503 0.9614221 0.9609933
[526] 0.9596259 0.9592008 0.9585918 0.9585385 0.9546278 0.9541078 0.9514773
[533] 0.9428848 0.9426111 0.9397804 0.9331183 0.9317241 0.9299949 0.9241509
[540] 0.9206389 0.9190113 0.9189571 0.9167096 0.9137204 0.9105391 0.8999444
[547] 0.8963892 0.8957784 0.8934545 0.8848535 0.8796054 0.8644039 0.8538326
[554] 0.8471971 0.8468868 0.8465425 0.8394108 0.8327863 0.8239513 0.8237795
[561] 0.8213319 0.8162255 0.8110399 0.8104258 0.8053776 0.7959653 0.7626210
[568] 0.7588087 0.7547009 0.7544162 0.7408166 0.7342183 0.7249008 0.7196337
[575] 0.7107158 0.6993804 0.6964786 0.6781055 0.6699571 0.6559203 0.6558806
[582] 0.6487996 0.6386183 0.6309829 0.6210306 0.6123647 0.6086447 0.6068133
[589] 0.6048024 0.5928443 0.5896320 0.5792348 0.5451309 0.5420587 0.5327403
[596] 0.5120528 0.5110356 0.5099891 0.5070016 0.4899511 0.4825757 0.4752355
[603] 0.4726444 0.4589443 0.3275282 0.3192307 0.3181766 0.2744171 0.1409422</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter and summarize data where context dependent columns have TRUE values</span></span>
<span id="cb13-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(context_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb13-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create filter for rows where any context dependent column is TRUE</span></span>
<span id="cb13-4">  context_true_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> biomin_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>))</span>
<span id="cb13-6">  </span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of rows with context dependent = TRUE:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(context_true_data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb13-8">  </span>
<span id="cb13-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summarize by og_id</span></span>
<span id="cb13-10">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"og_id"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(context_true_data)) {</span>
<span id="cb13-11">    context_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> context_true_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(og_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb13-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_records =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb13-15">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean_{.col}"</span>),</span>
<span id="cb13-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb13-17">      )</span>
<span id="cb13-18">    </span>
<span id="cb13-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(context_summary)</span>
<span id="cb13-20">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb13-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Column 'og_id' not found in data</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb13-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(context_true_data))</span>
<span id="cb13-23">  }</span>
<span id="cb13-24">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows with context dependent = TRUE: 239 

# A tibble: 239 √ó 14
   og_id   n_records mean_n_species mean_apul_context_st‚Ä¶¬π mean_apul_improvement
   &lt;chr&gt;       &lt;int&gt;          &lt;dbl&gt;                  &lt;dbl&gt;                 &lt;dbl&gt;
 1 OG_000‚Ä¶         1              2                NaN                NaN       
 2 OG_001‚Ä¶         1              3                  0.259              0.000355
 3 OG_003‚Ä¶         1              1                NaN                NaN       
 4 OG_004‚Ä¶         1              3                  0.719              0.0805  
 5 OG_004‚Ä¶         1              3                  0.331              0.00357 
 6 OG_006‚Ä¶         1              2                  0.497              0.00731 
 7 OG_006‚Ä¶         1              2                  1.19               0.00175 
 8 OG_008‚Ä¶         1              2                NaN                NaN       
 9 OG_008‚Ä¶         1              1                NaN                NaN       
10 OG_011‚Ä¶         1              2                  1.51               0.0157  
# ‚Ñπ 229 more rows
# ‚Ñπ abbreviated name: ¬π‚Äãmean_apul_context_strength
# ‚Ñπ 9 more variables: mean_apul_r2 &lt;dbl&gt;, mean_peve_context_strength &lt;dbl&gt;,
#   mean_peve_improvement &lt;dbl&gt;, mean_peve_r2 &lt;dbl&gt;,
#   mean_ptua_context_strength &lt;dbl&gt;, mean_ptua_improvement &lt;dbl&gt;,
#   mean_ptua_r2 &lt;dbl&gt;, mean_mean_context_strength &lt;dbl&gt;, mean_n_records &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display detailed view of context-dependent records</span></span>
<span id="cb15-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context_true_data"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(context_true_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb15-3"></span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Detailed view of context-dependent records:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(context_true_data)</span>
<span id="cb15-6">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Detailed view of context-dependent records:
# A tibble: 239 √ó 15
   og_id n_species apul_context_strength apul_context_dependent apul_improvement
   &lt;chr&gt;     &lt;dbl&gt;                 &lt;dbl&gt; &lt;lgl&gt;                             &lt;dbl&gt;
 1 OG_0‚Ä¶         3                 1.47  FALSE                          0.000408
 2 OG_0‚Ä¶         3                 0.972 FALSE                          0.00673 
 3 OG_0‚Ä¶         3                 1.17  FALSE                          0.00495 
 4 OG_0‚Ä¶         3                 1.53  TRUE                           0.265   
 5 OG_0‚Ä¶         3                 0.979 FALSE                          0.000131
 6 OG_0‚Ä¶         3                 1.68  FALSE                          0.0154  
 7 OG_0‚Ä¶         3                 1.14  FALSE                          0.0257  
 8 OG_0‚Ä¶         3                 0.935 FALSE                          0.00783 
 9 OG_0‚Ä¶         3                 1.02  FALSE                          0.00689 
10 OG_0‚Ä¶         3                 1.08  FALSE                          0.000887
# ‚Ñπ 229 more rows
# ‚Ñπ 10 more variables: apul_r2 &lt;dbl&gt;, peve_context_strength &lt;dbl&gt;,
#   peve_context_dependent &lt;lgl&gt;, peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;,
#   ptua_context_strength &lt;dbl&gt;, ptua_context_dependent &lt;lgl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, mean_context_strength &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="species-specific-and-shared-context-dependent-ogs" class="level1">
<h1>Species-Specific and Shared Context-Dependent OGs</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify species-specific context dependent columns</span></span>
<span id="cb17-2">species_context_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> context_cols[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shared|common"</span>, context_cols, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)]</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create summary of which OGs are TRUE for each species</span></span>
<span id="cb17-5">species_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> biomin_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(og_id, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>())</span>
<span id="cb17-7"></span>
<span id="cb17-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count how many species have TRUE for each OG</span></span>
<span id="cb17-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(context_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb17-10">  og_species_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> biomin_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb17-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species_true_count =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c_across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> </span>
<span id="cb17-14">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c_across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> </span>
<span id="cb17-15">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c_across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb17-16">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb17-18">  </span>
<span id="cb17-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OGs with TRUE in exactly one species (species-specific)</span></span>
<span id="cb17-20">  single_species_ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> og_species_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species_true_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-22">  </span>
<span id="cb17-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OGs shared across two species</span></span>
<span id="cb17-24">  two_species_ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> og_species_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species_true_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb17-26">  </span>
<span id="cb17-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OGs shared across three species</span></span>
<span id="cb17-28">  three_species_ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> og_species_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species_true_count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb17-30">  </span>
<span id="cb17-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OGs with context-dependent = TRUE in exactly 1 species:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(single_species_ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb17-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OGs with context-dependent = TRUE in exactly 2 species:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(two_species_ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb17-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OGs with context-dependent = TRUE in all 3 species:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(three_species_ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb17-34">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OGs with context-dependent = TRUE in exactly 1 species: 205 
OGs with context-dependent = TRUE in exactly 2 species: 32 
OGs with context-dependent = TRUE in all 3 species: 2 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Detailed breakdown by species</span></span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (col <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> context_cols) {</span>
<span id="cb19-3">  species_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_context.*|context_dependent_|_methylation.*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb19-4">  true_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, species_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- OGs with context-dependent = TRUE:"</span>, true_count, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb19-6">  </span>
<span id="cb19-7">  species_ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> biomin_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(.data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> .data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> .data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb19-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(og_id, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(col), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric))</span>
<span id="cb19-10">  </span>
<span id="cb19-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb19-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(species_ogs)</span>
<span id="cb19-13">  }</span>
<span id="cb19-14">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 apul - OGs with context-dependent = TRUE: 0 

 apul - OGs with context-dependent = TRUE: 47 
# A tibble: 47 √ó 13
   og_id apul_context_dependent n_species apul_context_strength apul_improvement
   &lt;chr&gt; &lt;lgl&gt;                      &lt;dbl&gt;                 &lt;dbl&gt;            &lt;dbl&gt;
 1 OG_0‚Ä¶ TRUE                           3                 1.53            0.265 
 2 OG_0‚Ä¶ TRUE                           3                 1.23            0.0558
 3 OG_0‚Ä¶ TRUE                           3                 0.695           0.170 
 4 OG_0‚Ä¶ TRUE                           3                 0.973           0.0433
 5 OG_1‚Ä¶ TRUE                           3                 1.30            0.0848
 6 OG_1‚Ä¶ TRUE                           3                 1.17            0.0586
 7 OG_0‚Ä¶ TRUE                           3                 0.389           0.0725
 8 OG_0‚Ä¶ TRUE                           3                 1.04            0.111 
 9 OG_0‚Ä¶ TRUE                           3                 0.982           0.0635
10 OG_0‚Ä¶ TRUE                           3                 0.885           0.0849
# ‚Ñπ 37 more rows
# ‚Ñπ 8 more variables: apul_r2 &lt;dbl&gt;, peve_context_strength &lt;dbl&gt;,
#   peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;, ptua_context_strength &lt;dbl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, mean_context_strength &lt;dbl&gt;

 peve - OGs with context-dependent = TRUE: 0 

 peve - OGs with context-dependent = TRUE: 69 
# A tibble: 69 √ó 13
   og_id peve_context_dependent n_species apul_context_strength apul_improvement
   &lt;chr&gt; &lt;lgl&gt;                      &lt;dbl&gt;                 &lt;dbl&gt;            &lt;dbl&gt;
 1 OG_0‚Ä¶ TRUE                           3                 0.972        0.00673  
 2 OG_0‚Ä¶ TRUE                           3                 0.979        0.000131 
 3 OG_0‚Ä¶ TRUE                           3                 1.14         0.0257   
 4 OG_0‚Ä¶ TRUE                           3                 1.08         0.000887 
 5 OG_0‚Ä¶ TRUE                           3                 0.796        0.00436  
 6 OG_0‚Ä¶ TRUE                           3                 1.35         0.0291   
 7 OG_0‚Ä¶ TRUE                           3                 1.01         0.000222 
 8 OG_0‚Ä¶ TRUE                           3                 0.970        0.0000296
 9 OG_0‚Ä¶ TRUE                           3                 0.895        0.00291  
10 OG_0‚Ä¶ TRUE                           3                 0.838        0.00305  
# ‚Ñπ 59 more rows
# ‚Ñπ 8 more variables: apul_r2 &lt;dbl&gt;, peve_context_strength &lt;dbl&gt;,
#   peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;, ptua_context_strength &lt;dbl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, mean_context_strength &lt;dbl&gt;

 ptua - OGs with context-dependent = TRUE: 0 

 ptua - OGs with context-dependent = TRUE: 159 
# A tibble: 159 √ó 13
   og_id ptua_context_dependent n_species apul_context_strength apul_improvement
   &lt;chr&gt; &lt;lgl&gt;                      &lt;dbl&gt;                 &lt;dbl&gt;            &lt;dbl&gt;
 1 OG_0‚Ä¶ TRUE                           3                 1.47          0.000408
 2 OG_0‚Ä¶ TRUE                           3                 0.972         0.00673 
 3 OG_0‚Ä¶ TRUE                           3                 1.17          0.00495 
 4 OG_0‚Ä¶ TRUE                           3                 0.979         0.000131
 5 OG_0‚Ä¶ TRUE                           3                 1.68          0.0154  
 6 OG_0‚Ä¶ TRUE                           3                 0.935         0.00783 
 7 OG_0‚Ä¶ TRUE                           3                 1.02          0.00689 
 8 OG_0‚Ä¶ TRUE                           3                 1.08          0.000887
 9 OG_0‚Ä¶ TRUE                           3                 0.796         0.00436 
10 OG_0‚Ä¶ TRUE                           3                 1.23          0.0558  
# ‚Ñπ 149 more rows
# ‚Ñπ 8 more variables: apul_r2 &lt;dbl&gt;, peve_context_strength &lt;dbl&gt;,
#   peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;, ptua_context_strength &lt;dbl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, mean_context_strength &lt;dbl&gt;

 mean - OGs with context-dependent = TRUE: 0 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary of shared OGs with quantitative metrics</span></span>
<span id="cb21-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two_species_ogs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(two_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== OGs Shared Across Two Species ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb21-4">  two_species_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> two_species_ogs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(og_id, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric))</span>
<span id="cb21-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(two_species_summary)</span>
<span id="cb21-7">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== OGs Shared Across Two Species ===
# A tibble: 32 √ó 16
   og_id    apul_context_strength apul_context_dependent peve_context_strength
   &lt;chr&gt;                    &lt;dbl&gt; &lt;lgl&gt;                                  &lt;dbl&gt;
 1 OG_06119                 0.972 FALSE                                   1.25
 2 OG_07153                 0.979 FALSE                                   1.36
 3 OG_04467                 1.08  FALSE                                   1.25
 4 OG_07150                 0.796 FALSE                                   1.34
 5 OG_02190                 1.23  TRUE                                    1.20
 6 OG_08849                 1.01  FALSE                                   1.05
 7 OG_06616                 0.695 TRUE                                    1.00
 8 OG_01611                 1.26  FALSE                                   1.13
 9 OG_02666                 0.389 TRUE                                    1.33
10 OG_05666                 0.695 FALSE                                   1.00
# ‚Ñπ 22 more rows
# ‚Ñπ 12 more variables: peve_context_dependent &lt;lgl&gt;,
#   ptua_context_strength &lt;dbl&gt;, ptua_context_dependent &lt;lgl&gt;,
#   mean_context_strength &lt;dbl&gt;, n_species &lt;dbl&gt;, apul_improvement &lt;dbl&gt;,
#   apul_r2 &lt;dbl&gt;, peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, species_true_count &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"three_species_ogs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(three_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== OGs Shared Across All Three Species ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb23-3">  three_species_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> three_species_ogs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(og_id, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(context_cols), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric))</span>
<span id="cb23-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(three_species_summary)</span>
<span id="cb23-6">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== OGs Shared Across All Three Species ===
# A tibble: 2 √ó 16
  og_id    apul_context_strength apul_context_dependent peve_context_strength
  &lt;chr&gt;                    &lt;dbl&gt; &lt;lgl&gt;                                  &lt;dbl&gt;
1 OG_06592                 0.973 TRUE                                   0.701
2 OG_04243                 0.638 TRUE                                   1.17 
# ‚Ñπ 12 more variables: peve_context_dependent &lt;lgl&gt;,
#   ptua_context_strength &lt;dbl&gt;, ptua_context_dependent &lt;lgl&gt;,
#   mean_context_strength &lt;dbl&gt;, n_species &lt;dbl&gt;, apul_improvement &lt;dbl&gt;,
#   apul_r2 &lt;dbl&gt;, peve_improvement &lt;dbl&gt;, peve_r2 &lt;dbl&gt;,
#   ptua_improvement &lt;dbl&gt;, ptua_r2 &lt;dbl&gt;, species_true_count &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate quantitative summary statistics for context-dependent OGs</span></span>
<span id="cb25-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context_true_data"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(context_true_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb25-3">  numeric_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(context_true_data)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(context_true_data, is.numeric)]</span>
<span id="cb25-4">  </span>
<span id="cb25-5">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(numeric_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb25-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== Quantitative Summary of Context-Dependent OGs ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb25-7">    quant_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> context_true_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-8">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_of</span>(numeric_cols), </span>
<span id="cb25-9">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb25-10">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb25-11">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb25-12">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)),</span>
<span id="cb25-13">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{.col}_{.fn}"</span>))</span>
<span id="cb25-14">    </span>
<span id="cb25-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transpose for better readability</span></span>
<span id="cb25-16">    quant_summary_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> quant_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-17">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"metric"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"value"</span>)</span>
<span id="cb25-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(quant_summary_long)</span>
<span id="cb25-19">  }</span>
<span id="cb25-20">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Quantitative Summary of Context-Dependent OGs ===
# A tibble: 44 √ó 2
   metric                      value
   &lt;chr&gt;                       &lt;dbl&gt;
 1 n_species_mean             1.92  
 2 n_species_sd               0.738 
 3 n_species_min              1     
 4 n_species_max              3     
 5 apul_context_strength_mean 0.965 
 6 apul_context_strength_sd   0.313 
 7 apul_context_strength_min  0.141 
 8 apul_context_strength_max  1.81  
 9 apul_improvement_mean      0.0369
10 apul_improvement_sd        0.0440
# ‚Ñπ 34 more rows</code></pre>
</div>
</div>
</section>
<section id="summary-paragraph" class="level1">
<h1>Summary Paragraph</h1>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate dynamic summary paragraph</span></span>
<span id="cb27-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context_cols"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(context_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-3">  </span>
<span id="cb27-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get counts per species</span></span>
<span id="cb27-5">  species_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(context_cols, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(col) {</span>
<span id="cb27-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> biomin_data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb27-7">  })</span>
<span id="cb27-8">  </span>
<span id="cb27-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get OG lists per species</span></span>
<span id="cb27-10">  species_ogs_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(context_cols, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(col) {</span>
<span id="cb27-11">    biomin_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(.data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> .data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> .data[[col]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"true"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(og_id)</span>
<span id="cb27-14">  })</span>
<span id="cb27-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(species_ogs_list) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> context_cols</span>
<span id="cb27-16">  </span>
<span id="cb27-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build paragraph</span></span>
<span id="cb27-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">## Cross-Species Context-Dependent Methylation and miRNA Analysis</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb27-19">  </span>
<span id="cb27-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This analysis examined orthogroup (OG) patterns across species for context-dependent methylation and miRNA associations. "</span>)</span>
<span id="cb27-21">  </span>
<span id="cb27-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Species-specific findings</span></span>
<span id="cb27-23">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(context_cols)) {</span>
<span id="cb27-24">    col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> context_cols[i]</span>
<span id="cb27-25">    species_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_context.*|context_dependent_|_methylation.*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, col, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ignore.case =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb27-26">    ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> species_ogs_list[[col]]</span>
<span id="cb27-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-28">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**"</span>, species_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"** showed context-dependent patterns in "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" OGs ("</span>, </span>
<span id="cb27-29">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ogs, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", ..."</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"). "</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-30">    }</span>
<span id="cb27-31">  }</span>
<span id="cb27-32">  </span>
<span id="cb27-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Shared patterns</span></span>
<span id="cb27-34">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two_species_ogs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(two_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">A total of **"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(two_species_ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" OGs** exhibited context-dependent patterns shared across exactly two species"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(two_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb27-37">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(two_species_ogs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>og_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-38">    }</span>
<span id="cb27-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">". "</span>)</span>
<span id="cb27-40">  }</span>
<span id="cb27-41">  </span>
<span id="cb27-42">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"three_species_ogs"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(three_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Notably, **"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(three_species_ogs), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" OGs** showed conserved context-dependent patterns across all three species"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-44">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(three_species_ogs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb27-45">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(three_species_ogs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>og_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-46">    }</span>
<span id="cb27-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", suggesting evolutionary conservation of these regulatory mechanisms. "</span>)</span>
<span id="cb27-48">  }</span>
<span id="cb27-49">  </span>
<span id="cb27-50">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Quantitative highlights</span></span>
<span id="cb27-51">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exists</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context_true_data"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(context_true_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-52">    numeric_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(context_true_data)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(context_true_data, is.numeric)]</span>
<span id="cb27-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(numeric_cols) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb27-54">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Quantitatively, context-dependent OGs showed the following characteristics: "</span>)</span>
<span id="cb27-55">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (nc <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(numeric_cols, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) {</span>
<span id="cb27-56">        mean_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(context_true_data[[nc]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb27-57">        sd_val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(context_true_data[[nc]], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb27-58">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**"</span>, nc, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"** (mean ¬± SD: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(mean_val, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ¬± "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(sd_val, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"); "</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb27-59">      }</span>
<span id="cb27-60">    }</span>
<span id="cb27-61">  }</span>
<span id="cb27-62">  </span>
<span id="cb27-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb27-64">}</span></code></pre></div>
<section id="cross-species-context-dependent-methylation-and-mirna-analysis" class="level2">
<h2 class="anchored" data-anchor-id="cross-species-context-dependent-methylation-and-mirna-analysis">Cross-Species Context-Dependent Methylation and miRNA Analysis</h2>
<p>This analysis examined orthogroup (OG) patterns across species for context-dependent methylation and miRNA associations. <strong>apul</strong> showed context-dependent patterns in 47 OGs (OG_01452, OG_02190, OG_06616, OG_06592, OG_10121, ‚Ä¶). <strong>peve</strong> showed context-dependent patterns in 69 OGs (OG_06119, OG_07153, OG_01753, OG_04467, OG_07150, ‚Ä¶). <strong>ptua</strong> showed context-dependent patterns in 159 OGs (OG_02619, OG_06119, OG_05637, OG_07153, OG_01414, ‚Ä¶).</p>
<p>A total of <strong>32 OGs</strong> exhibited context-dependent patterns shared across exactly two species. Notably, <strong>2 OGs</strong> showed conserved context-dependent patterns across all three species (OG_06592, OG_04243), suggesting evolutionary conservation of these regulatory mechanisms.</p>
<p>Quantitatively, context-dependent OGs showed the following characteristics: <strong>n_species</strong> (mean ¬± SD: 1.921 ¬± 0.738); <strong>apul_context_strength</strong> (mean ¬± SD: 0.965 ¬± 0.313); <strong>apul_improvement</strong> (mean ¬± SD: 0.037 ¬± 0.044);</p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/66-biomin-methylation-miRNA/</guid>
  <pubDate>Mon, 01 Dec 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-12-01_19-30-14.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Plotting Biomineralization Gene Expression vs Gene Body Methylation in Three Coral Species</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/</link>
  <description><![CDATA[ 





<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This script creates x-y plots of gene expression versus gene body methylation for three coral species: - <em>Acropora pulchra</em> - <em>Porites evermanni</em> - <em>Pocillopora tuahiniensis</em></p>
<p>Biomineralization genes are highlighted in each plot.</p>
</section>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<section id="gene-expression-count-matrices" class="level3">
<h3 class="anchored" data-anchor-id="gene-expression-count-matrices">Gene Expression Count Matrices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb2-2">apul_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-RNAseq-alignment-HiSat2/apul-gene_count_matrix.csv"</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb2-5">peve_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/E-Peve/output/02.20-E-Peve-RNAseq-alignment-HiSat2/peve-gene_count_matrix.csv"</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb2-8">ptua_expression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/F-Ptua/output/02.20-F-Ptua-RNAseq-alignment-HiSat2/ptua-gene_count_matrix.csv"</span>)</span></code></pre></div>
</div>
</section>
<section id="gene-body-methylation-data" class="level3">
<h3 class="anchored" data-anchor-id="gene-body-methylation-data">Gene Body Methylation Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb3-2">apul_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/D-Apul/output/40-Apul-Gene-Methylation/Apul-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb3-5">peve_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/E-Peve/output/15-Peve-Gene-Methylation/Peve-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb3-8">ptua_methylation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/F-Ptua/output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span></code></pre></div>
</div>
</section>
<section id="biomineralization-gene-lists" class="level3">
<h3 class="anchored" data-anchor-id="biomineralization-gene-lists">Biomineralization Gene Lists</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb4-2">apul_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/apul_biomin_counts.csv"</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb4-5">peve_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/peve_biomin_counts.csv"</span>)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb4-8">ptua_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/ptua_biomin_counts.csv"</span>)</span></code></pre></div>
</div>
</section>
</section>
<section id="data-preview" class="level2">
<h2 class="anchored" data-anchor-id="data-preview">Data Preview</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preview expression data structure</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(apul_expression)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 41
  gene_id  `ACR-139-TP1` `ACR-139-TP2` `ACR-139-TP3` `ACR-139-TP4` `ACR-145-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 FUN_002‚Ä¶             3             2             3             4            12
2 FUN_002‚Ä¶             0             1             0             0             0
3 FUN_002‚Ä¶             0             0             0             0             0
4 FUN_002‚Ä¶            10             5            10            10            23
5 FUN_002‚Ä¶             2             1             1             2             2
6 FUN_002‚Ä¶            12             7            10            10            26
# ‚Ñπ 35 more variables: `ACR-145-TP2` &lt;dbl&gt;, `ACR-145-TP3` &lt;dbl&gt;,
#   `ACR-145-TP4` &lt;dbl&gt;, `ACR-150-TP1` &lt;dbl&gt;, `ACR-150-TP2` &lt;dbl&gt;,
#   `ACR-150-TP3` &lt;dbl&gt;, `ACR-150-TP4` &lt;dbl&gt;, `ACR-173-TP1` &lt;dbl&gt;,
#   `ACR-173-TP2` &lt;dbl&gt;, `ACR-173-TP3` &lt;dbl&gt;, `ACR-173-TP4` &lt;dbl&gt;,
#   `ACR-186-TP1` &lt;dbl&gt;, `ACR-186-TP2` &lt;dbl&gt;, `ACR-186-TP3` &lt;dbl&gt;,
#   `ACR-186-TP4` &lt;dbl&gt;, `ACR-225-TP1` &lt;dbl&gt;, `ACR-225-TP2` &lt;dbl&gt;,
#   `ACR-225-TP3` &lt;dbl&gt;, `ACR-225-TP4` &lt;dbl&gt;, `ACR-229-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_expression)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 39
  gene_id  `POR-216-TP1` `POR-216-TP2` `POR-216-TP3` `POR-216-TP4` `POR-236-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Pe‚Ä¶            29            75            63            25            82
2 gene-Pe‚Ä¶             0             1             0             1             0
3 gene-Pe‚Ä¶             0             0             0             0             0
4 gene-Pe‚Ä¶            13            13             0             0             0
5 gene-Pe‚Ä¶           105           114           164             6            16
6 gene-Pe‚Ä¶             2             0             0             1             0
# ‚Ñπ 33 more variables: `POR-236-TP2` &lt;dbl&gt;, `POR-245-TP1` &lt;dbl&gt;,
#   `POR-245-TP2` &lt;dbl&gt;, `POR-245-TP3` &lt;dbl&gt;, `POR-245-TP4` &lt;dbl&gt;,
#   `POR-260-TP1` &lt;dbl&gt;, `POR-260-TP2` &lt;dbl&gt;, `POR-260-TP3` &lt;dbl&gt;,
#   `POR-260-TP4` &lt;dbl&gt;, `POR-262-TP1` &lt;dbl&gt;, `POR-262-TP2` &lt;dbl&gt;,
#   `POR-262-TP3` &lt;dbl&gt;, `POR-262-TP4` &lt;dbl&gt;, `POR-69-TP1` &lt;dbl&gt;,
#   `POR-69-TP2` &lt;dbl&gt;, `POR-69-TP3` &lt;dbl&gt;, `POR-69-TP4` &lt;dbl&gt;,
#   `POR-72-TP1` &lt;dbl&gt;, `POR-72-TP2` &lt;dbl&gt;, `POR-72-TP3` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_expression)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 40
  gene_id  `POC-201-TP1` `POC-201-TP2` `POC-201-TP3` `POC-219-TP1` `POC-219-TP2`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Po‚Ä¶            54           170            18           168            31
2 gene-Po‚Ä¶           957           759           143           757           446
3 gene-Po‚Ä¶           249           452           381           501           218
4 gene-Po‚Ä¶           365           191            13            73            64
5 gene-Po‚Ä¶           187           435           137           754           332
6 gene-Po‚Ä¶           379           602           138           561           389
# ‚Ñπ 34 more variables: `POC-219-TP3` &lt;dbl&gt;, `POC-219-TP4` &lt;dbl&gt;,
#   `POC-222-TP1` &lt;dbl&gt;, `POC-222-TP2` &lt;dbl&gt;, `POC-222-TP3` &lt;dbl&gt;,
#   `POC-222-TP4` &lt;dbl&gt;, `POC-255-TP1` &lt;dbl&gt;, `POC-255-TP2` &lt;dbl&gt;,
#   `POC-255-TP3` &lt;dbl&gt;, `POC-255-TP4` &lt;dbl&gt;, `POC-259-TP1` &lt;dbl&gt;,
#   `POC-259-TP2` &lt;dbl&gt;, `POC-259-TP3` &lt;dbl&gt;, `POC-259-TP4` &lt;dbl&gt;,
#   `POC-40-TP1` &lt;dbl&gt;, `POC-40-TP2` &lt;dbl&gt;, `POC-40-TP3` &lt;dbl&gt;,
#   `POC-40-TP4` &lt;dbl&gt;, `POC-42-TP1` &lt;dbl&gt;, `POC-42-TP2` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preview methylation data structure</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(apul_methylation)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 41
  gene_id  `ACR-139-TP1` `ACR-139-TP2` `ACR-139-TP3` `ACR-139-TP4` `ACR-145-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 FUN_000‚Ä¶         2.16          1.23          0.491        1.34           0.649
2 FUN_000‚Ä¶         2.36          1.63          1.19         1.58           0.948
3 FUN_000‚Ä¶         0.179         0.648         0.183        0.0801         0.939
4 FUN_000‚Ä¶         0             0.222         0            0             NA    
5 FUN_000‚Ä¶         0.5           0.231         0            0              0    
6 FUN_000‚Ä¶        54.8          58.2          54.0         66.5           45.8  
# ‚Ñπ 35 more variables: `ACR-145-TP2` &lt;dbl&gt;, `ACR-145-TP3` &lt;dbl&gt;,
#   `ACR-145-TP4` &lt;dbl&gt;, `ACR-150-TP1` &lt;dbl&gt;, `ACR-150-TP2` &lt;dbl&gt;,
#   `ACR-150-TP3` &lt;dbl&gt;, `ACR-150-TP4` &lt;dbl&gt;, `ACR-173-TP1` &lt;dbl&gt;,
#   `ACR-173-TP2` &lt;dbl&gt;, `ACR-173-TP3` &lt;dbl&gt;, `ACR-173-TP4` &lt;dbl&gt;,
#   `ACR-186-TP1` &lt;dbl&gt;, `ACR-186-TP2` &lt;dbl&gt;, `ACR-186-TP3` &lt;dbl&gt;,
#   `ACR-186-TP4` &lt;dbl&gt;, `ACR-225-TP1` &lt;dbl&gt;, `ACR-225-TP2` &lt;dbl&gt;,
#   `ACR-225-TP3` &lt;dbl&gt;, `ACR-225-TP4` &lt;dbl&gt;, `ACR-229-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_methylation)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 38
  gene_id  `POR-216-TP1` `POR-216-TP2` `POR-216-TP3` `POR-216-TP4` `POR-236-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Pe‚Ä¶         0.773         0.171         0.422         0.307        0.0893
2 gene-Pe‚Ä¶         0.400         0.485         0.873         0.670        0.775 
3 gene-Pe‚Ä¶         0.492         0.535         0.793         0.386        0.554 
4 gene-Pe‚Ä¶         2.21          0.487         1.01          4.62         1.91  
5 gene-Pe‚Ä¶        27.0          29.8          29.0          33.1          8.23  
6 gene-Pe‚Ä¶        12.7          19.2          19.0          22.5         21.6   
# ‚Ñπ 32 more variables: `POR-236-TP2` &lt;dbl&gt;, `POR-245-TP1` &lt;dbl&gt;,
#   `POR-245-TP2` &lt;dbl&gt;, `POR-245-TP3` &lt;dbl&gt;, `POR-245-TP4` &lt;dbl&gt;,
#   `POR-260-TP1` &lt;dbl&gt;, `POR-260-TP2` &lt;dbl&gt;, `POR-260-TP3` &lt;dbl&gt;,
#   `POR-260-TP4` &lt;dbl&gt;, `POR-262-TP1` &lt;dbl&gt;, `POR-262-TP2` &lt;dbl&gt;,
#   `POR-262-TP3` &lt;dbl&gt;, `POR-262-TP4` &lt;dbl&gt;, `POR-69-TP1` &lt;dbl&gt;,
#   `POR-69-TP2` &lt;dbl&gt;, `POR-69-TP3` &lt;dbl&gt;, `POR-69-TP4` &lt;dbl&gt;,
#   `POR-72-TP1` &lt;dbl&gt;, `POR-72-TP2` &lt;dbl&gt;, `POR-72-TP3` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_methylation)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 33
  gene_id  `POC-201-TP1` `POC-201-TP2` `POC-219-TP1` `POC-219-TP2` `POC-219-TP3`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Po‚Ä¶        55.9          65            NA           56.7           70.8  
2 gene-Po‚Ä¶        62.1          64.3          57.9         58.0           63.0  
3 gene-Po‚Ä¶        21.6          23.3          24.0         18.2           22.6  
4 gene-Po‚Ä¶         0.281         0.146         0.433        0.159          0.338
5 gene-Po‚Ä¶         0.301         0             0            0.0916         0.394
6 gene-Po‚Ä¶         9.58          8.64          7.63         7.43           7.72 
# ‚Ñπ 27 more variables: `POC-219-TP4` &lt;dbl&gt;, `POC-222-TP1` &lt;dbl&gt;,
#   `POC-222-TP3` &lt;dbl&gt;, `POC-222-TP4` &lt;dbl&gt;, `POC-255-TP1` &lt;dbl&gt;,
#   `POC-255-TP2` &lt;dbl&gt;, `POC-255-TP3` &lt;dbl&gt;, `POC-259-TP1` &lt;dbl&gt;,
#   `POC-259-TP2` &lt;dbl&gt;, `POC-40-TP1` &lt;dbl&gt;, `POC-40-TP2` &lt;dbl&gt;,
#   `POC-40-TP3` &lt;dbl&gt;, `POC-40-TP4` &lt;dbl&gt;, `POC-42-TP2` &lt;dbl&gt;,
#   `POC-42-TP4` &lt;dbl&gt;, `POC-52-TP1` &lt;dbl&gt;, `POC-52-TP2` &lt;dbl&gt;,
#   `POC-52-TP3` &lt;dbl&gt;, `POC-52-TP4` &lt;dbl&gt;, `POC-53-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Preview biomin gene lists</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(apul_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 42
  group_id gene_id    `ACR-139-TP1` `ACR-139-TP2` `ACR-139-TP3` `ACR-139-TP4`
  &lt;chr&gt;    &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 OG_13910 FUN_002435         16875         28318         32788         51133
2 OG_10516 FUN_002646            82            10           437           209
3 OG_13916 FUN_002648            75            67           101            67
4 OG_10520 FUN_002663            43             0             0            12
5 OG_10522 FUN_002671             7             4            17             0
6 OG_10523 FUN_002672          4618          3317          1903          2991
# ‚Ñπ 36 more variables: `ACR-145-TP1` &lt;dbl&gt;, `ACR-145-TP2` &lt;dbl&gt;,
#   `ACR-145-TP3` &lt;dbl&gt;, `ACR-145-TP4` &lt;dbl&gt;, `ACR-150-TP1` &lt;dbl&gt;,
#   `ACR-150-TP2` &lt;dbl&gt;, `ACR-150-TP3` &lt;dbl&gt;, `ACR-150-TP4` &lt;dbl&gt;,
#   `ACR-173-TP1` &lt;dbl&gt;, `ACR-173-TP2` &lt;dbl&gt;, `ACR-173-TP3` &lt;dbl&gt;,
#   `ACR-173-TP4` &lt;dbl&gt;, `ACR-186-TP1` &lt;dbl&gt;, `ACR-186-TP2` &lt;dbl&gt;,
#   `ACR-186-TP3` &lt;dbl&gt;, `ACR-186-TP4` &lt;dbl&gt;, `ACR-225-TP1` &lt;dbl&gt;,
#   `ACR-225-TP2` &lt;dbl&gt;, `ACR-225-TP3` &lt;dbl&gt;, `ACR-225-TP4` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 40
  group_id gene_id       `POR-216-TP1` `POR-216-TP2` `POR-216-TP3` `POR-216-TP4`
  &lt;chr&gt;    &lt;chr&gt;                 &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 OG_08920 Peve_00000077          2201          1336           752           667
2 OG_08914 Peve_00000084            63            24            26            29
3 OG_12248 Peve_00013346             7            35             0             8
4 OG_11296 Peve_00022433             0            26             3             9
5 OG_03289 Peve_00022425             5            15             6             0
6 OG_03288 Peve_00022430            27            12             0             8
# ‚Ñπ 34 more variables: `POR-236-TP1` &lt;dbl&gt;, `POR-236-TP2` &lt;dbl&gt;,
#   `POR-245-TP1` &lt;dbl&gt;, `POR-245-TP2` &lt;dbl&gt;, `POR-245-TP3` &lt;dbl&gt;,
#   `POR-245-TP4` &lt;dbl&gt;, `POR-260-TP1` &lt;dbl&gt;, `POR-260-TP2` &lt;dbl&gt;,
#   `POR-260-TP3` &lt;dbl&gt;, `POR-260-TP4` &lt;dbl&gt;, `POR-262-TP1` &lt;dbl&gt;,
#   `POR-262-TP2` &lt;dbl&gt;, `POR-262-TP3` &lt;dbl&gt;, `POR-262-TP4` &lt;dbl&gt;,
#   `POR-69-TP1` &lt;dbl&gt;, `POR-69-TP2` &lt;dbl&gt;, `POR-69-TP3` &lt;dbl&gt;,
#   `POR-69-TP4` &lt;dbl&gt;, `POR-72-TP1` &lt;dbl&gt;, `POR-72-TP2` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 41
  group_id gene_id       `POC-201-TP1` `POC-201-TP2` `POC-201-TP3` `POC-219-TP1`
  &lt;chr&gt;    &lt;chr&gt;                 &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 OG_02619 Pocillopora_‚Ä¶            69            15             0            56
2 OG_02666 Pocillopora_‚Ä¶          5719           382           434           564
3 OG_03673 Pocillopora_‚Ä¶          1379           986           298           491
4 OG_03671 Pocillopora_‚Ä¶            12           827           286            35
5 OG_02537 Pocillopora_‚Ä¶            27            56             0            23
6 OG_17556 Pocillopora_‚Ä¶            11            12             0             4
# ‚Ñπ 35 more variables: `POC-219-TP2` &lt;dbl&gt;, `POC-219-TP3` &lt;dbl&gt;,
#   `POC-219-TP4` &lt;dbl&gt;, `POC-222-TP1` &lt;dbl&gt;, `POC-222-TP2` &lt;dbl&gt;,
#   `POC-222-TP3` &lt;dbl&gt;, `POC-222-TP4` &lt;dbl&gt;, `POC-255-TP1` &lt;dbl&gt;,
#   `POC-255-TP2` &lt;dbl&gt;, `POC-255-TP3` &lt;dbl&gt;, `POC-255-TP4` &lt;dbl&gt;,
#   `POC-259-TP1` &lt;dbl&gt;, `POC-259-TP2` &lt;dbl&gt;, `POC-259-TP3` &lt;dbl&gt;,
#   `POC-259-TP4` &lt;dbl&gt;, `POC-40-TP1` &lt;dbl&gt;, `POC-40-TP2` &lt;dbl&gt;,
#   `POC-40-TP3` &lt;dbl&gt;, `POC-40-TP4` &lt;dbl&gt;, `POC-42-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
</div>
</section>
<section id="prepare-data-for-plotting" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-plotting">Prepare Data for Plotting</h2>
<section id="acropora-pulchra" class="level3">
<h3 class="anchored" data-anchor-id="acropora-pulchra">Acropora pulchra</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean expression across samples for each gene</span></span>
<span id="cb23-2">apul_expression_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mean_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb23-7"></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb23-9">apul_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb23-15">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expression_mean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(apul_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb23-17"></span>
<span id="cb23-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs from the gene_id column (second column)</span></span>
<span id="cb23-19">apul_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb23-22"></span>
<span id="cb23-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check how many biomin genes we have</span></span>
<span id="cb23-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of biomin genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(apul_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of biomin genes: 505 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample biomin gene IDs:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample biomin gene IDs:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(apul_biomin_genes)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "FUN_002435" "FUN_002646" "FUN_002648" "FUN_002663" "FUN_002671"
[6] "FUN_002672"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check for matches</span></span>
<span id="cb29-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Number of matches in combined data:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> apul_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of matches in combined data: 485 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb31-2">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> apul_biomin_genes)</span>
<span id="cb31-4"></span>
<span id="cb31-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(apul_combined)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 5
  gene_id    mean_expression log_expression mean_methylation is_biomin
  &lt;chr&gt;                &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;    
1 FUN_000184        1836.            3.26              1.45  FALSE    
2 FUN_000185        1545.            3.19              1.47  FALSE    
3 FUN_000186          53.4           1.74              0.462 FALSE    
4 FUN_000187           0.3           0.114             0.250 FALSE    
5 FUN_000188           0.225         0.0881            0.428 FALSE    
6 FUN_000189        1624.            3.21             54.6   FALSE    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
21136   485 </code></pre>
</div>
</div>
</section>
<section id="porites-evermanni" class="level3">
<h3 class="anchored" data-anchor-id="porites-evermanni">Porites evermanni</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean expression across samples for each gene</span></span>
<span id="cb35-2">peve_expression_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mean_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb35-7"></span>
<span id="cb35-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb35-9">peve_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb35-13"></span>
<span id="cb35-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb35-15">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expression_mean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(peve_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb35-17"></span>
<span id="cb35-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs - add "gene-" prefix to match expression data format</span></span>
<span id="cb35-19">peve_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, .)</span>
<span id="cb35-23"></span>
<span id="cb35-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check how many biomin genes we have</span></span>
<span id="cb35-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of biomin genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(peve_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of biomin genes: 565 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample biomin gene IDs (with prefix):</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample biomin gene IDs (with prefix):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_biomin_genes)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-Peve_00000077" "gene-Peve_00000084" "gene-Peve_00013346"
[4] "gene-Peve_00022433" "gene-Peve_00022425" "gene-Peve_00022430"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Sample expression gene IDs:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample expression gene IDs:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-Peve_00000002" "gene-Peve_00000003" "gene-Peve_00000004"
[4] "gene-Peve_00000005" "gene-Peve_00000006" "gene-Peve_00000007"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Number of matches in combined data:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> peve_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of matches in combined data: 483 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb47-2">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb47-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> peve_biomin_genes)</span>
<span id="cb47-4"></span>
<span id="cb47-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(peve_combined)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 5
  gene_id            mean_expression log_expression mean_methylation is_biomin
  &lt;chr&gt;                        &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;    
1 gene-Peve_00000002            5.74          0.828             54.6 FALSE    
2 gene-Peve_00000003           56.1           1.76              56.4 FALSE    
3 gene-Peve_00000004          212.            2.33              56.8 FALSE    
4 gene-Peve_00000005          173.            2.24              64.7 FALSE    
5 gene-Peve_00000006         2229.            3.35              62.7 FALSE    
6 gene-Peve_00000007          142.            2.15              70.1 FALSE    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
20341   483 </code></pre>
</div>
</div>
</section>
<section id="pocillopora-tuahiniensis" class="level3">
<h3 class="anchored" data-anchor-id="pocillopora-tuahiniensis">Pocillopora tuahiniensis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean expression across samples for each gene</span></span>
<span id="cb51-2">ptua_expression_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"count"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(count, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mean_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb51-7"></span>
<span id="cb51-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate mean methylation across samples for each gene</span></span>
<span id="cb51-9">ptua_methylation_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sample"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb51-13"></span>
<span id="cb51-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join expression and methylation data</span></span>
<span id="cb51-15">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expression_mean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(ptua_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb51-17"></span>
<span id="cb51-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get biomin gene IDs - need to add "gene-" prefix to match expression data format</span></span>
<span id="cb51-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Biomin IDs: Pocillopora_meandrina_HIv1___RNAseq.g21004.t1</span></span>
<span id="cb51-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expression IDs: gene-Pocillopora_meandrina_HIv1___RNAseq.g20905.t1</span></span>
<span id="cb51-21">ptua_biomin_genes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb51-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, .)</span>
<span id="cb51-25"></span>
<span id="cb51-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check how many biomin genes we have</span></span>
<span id="cb51-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of biomin genes:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ptua_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of biomin genes: 483 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample biomin gene IDs (with prefix):</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sample biomin gene IDs (with prefix):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_biomin_genes)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-Pocillopora_meandrina_HIv1___TS.g25680.t1b"   
[2] "gene-Pocillopora_meandrina_HIv1___RNAseq.g21004.t1"
[3] "gene-Pocillopora_meandrina_HIv1___RNAseq.g21081.t1"
[4] "gene-Pocillopora_meandrina_HIv1___RNAseq.g21079.t1"
[5] "gene-Pocillopora_meandrina_HIv1___TS.g26115.t1"    
[6] "gene-Pocillopora_meandrina_HIv1___RNAseq.g21507.t1"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Sample expression gene IDs:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sample expression gene IDs:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "gene-Pocillopora_meandrina_HIv1___RNAseq.10273_t"
[2] "gene-Pocillopora_meandrina_HIv1___RNAseq.10316_t"
[3] "gene-Pocillopora_meandrina_HIv1___RNAseq.10483_t"
[4] "gene-Pocillopora_meandrina_HIv1___RNAseq.10568_t"
[5] "gene-Pocillopora_meandrina_HIv1___RNAseq.10682_t"
[6] "gene-Pocillopora_meandrina_HIv1___RNAseq.10925_t"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Number of matches in combined data:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> ptua_biomin_genes), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of matches in combined data: 459 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add biomin indicator</span></span>
<span id="cb63-2">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb63-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> ptua_biomin_genes)</span>
<span id="cb63-4"></span>
<span id="cb63-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(ptua_combined)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 5
  gene_id              mean_expression log_expression mean_methylation is_biomin
  &lt;chr&gt;                          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;    
1 gene-Pocillopora_me‚Ä¶            25.3           1.42            1.03  FALSE    
2 gene-Pocillopora_me‚Ä¶           109.            2.04            0.421 FALSE    
3 gene-Pocillopora_me‚Ä¶          1700.            3.23            2.72  FALSE    
4 gene-Pocillopora_me‚Ä¶           565.            2.75            0.474 FALSE    
5 gene-Pocillopora_me‚Ä¶            30.1           1.49            0.357 FALSE    
6 gene-Pocillopora_me‚Ä¶           980.            2.99            4.05  FALSE    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">table</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>is_biomin)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
22910   459 </code></pre>
</div>
</div>
</section>
</section>
<section id="create-plots" class="level2">
<h2 class="anchored" data-anchor-id="create-plots">Create Plots</h2>
<section id="acropora-pulchra-1" class="level3">
<h3 class="anchored" data-anchor-id="acropora-pulchra-1">Acropora pulchra</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(apul_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(apul_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>),</span>
<span id="cb67-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb67-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Expression vs Gene Body Methylation - Acropora pulchra"</span>,</span>
<span id="cb67-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb67-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb67-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb67-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/plot-apul-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="porites-evermanni-1" class="level3">
<h3 class="anchored" data-anchor-id="porites-evermanni-1">Porites evermanni</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(peve_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(peve_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>),</span>
<span id="cb68-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb68-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Expression vs Gene Body Methylation - Porites evermanni"</span>,</span>
<span id="cb68-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb68-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb68-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb68-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/plot-peve-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pocillopora-tuahiniensis-1" class="level3">
<h3 class="anchored" data-anchor-id="pocillopora-tuahiniensis-1">Pocillopora tuahiniensis</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(ptua_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ptua_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>),</span>
<span id="cb69-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb69-6">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Expression vs Gene Body Methylation - Pocillopora tuahiniensis"</span>,</span>
<span id="cb69-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb69-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb69-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb69-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/plot-ptua-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="combined-panel-plot" class="level2">
<h2 class="anchored" data-anchor-id="combined-panel-plot">Combined Panel Plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add species identifier to each dataset</span></span>
<span id="cb70-2">apul_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Acropora pulchra"</span>)</span>
<span id="cb70-3">peve_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Porites evermanni"</span>)</span>
<span id="cb70-4">ptua_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pocillopora tuahiniensis"</span>)</span>
<span id="cb70-5"></span>
<span id="cb70-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all data</span></span>
<span id="cb70-7">all_combined <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(apul_combined, peve_combined, ptua_combined)</span>
<span id="cb70-8"></span>
<span id="cb70-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create faceted plot</span></span>
<span id="cb70-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(all_combined, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> is_biomin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(all_combined, is_biomin), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>),</span>
<span id="cb70-14">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FALSE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other genes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TRUE"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization genes"</span>),</span>
<span id="cb70-15">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Type"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>species, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_x"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Expression vs Gene Body Methylation"</span>,</span>
<span id="cb70-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Body Methylation (%)"</span>,</span>
<span id="cb70-19">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb70-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb70-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/combined-plot-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics" class="level2">
<h2 class="anchored" data-anchor-id="summary-statistics">Summary Statistics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary for each species</span></span>
<span id="cb71-2">summary_stats <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb71-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(species, is_biomin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb71-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb71-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb71-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">avg_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb71-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_methylation =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb71-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">avg_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb71-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_expression =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb71-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb71-11">  )</span>
<span id="cb71-12"></span>
<span id="cb71-13">summary_stats <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb71-14">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, </span>
<span id="cb71-15">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomin Gene"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Meth"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SD Meth"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Expr"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SD Expr"</span>))</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 15%">
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: left;">Biomin Gene</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean Meth</th>
<th style="text-align: right;">SD Meth</th>
<th style="text-align: right;">Mean Expr</th>
<th style="text-align: right;">SD Expr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">21136</td>
<td style="text-align: right;">15.675</td>
<td style="text-align: right;">20.938</td>
<td style="text-align: right;">1.782</td>
<td style="text-align: right;">0.999</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acropora pulchra</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">485</td>
<td style="text-align: right;">7.052</td>
<td style="text-align: right;">13.575</td>
<td style="text-align: right;">2.250</td>
<td style="text-align: right;">0.855</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">22910</td>
<td style="text-align: right;">7.470</td>
<td style="text-align: right;">11.702</td>
<td style="text-align: right;">1.788</td>
<td style="text-align: right;">0.956</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pocillopora tuahiniensis</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">459</td>
<td style="text-align: right;">3.735</td>
<td style="text-align: right;">7.958</td>
<td style="text-align: right;">2.406</td>
<td style="text-align: right;">0.906</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">20341</td>
<td style="text-align: right;">14.836</td>
<td style="text-align: right;">21.847</td>
<td style="text-align: right;">1.425</td>
<td style="text-align: right;">0.923</td>
</tr>
<tr class="even">
<td style="text-align: left;">Porites evermanni</td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">483</td>
<td style="text-align: right;">6.711</td>
<td style="text-align: right;">14.332</td>
<td style="text-align: right;">1.974</td>
<td style="text-align: right;">0.930</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ortholog-comparison-across-species" class="level2">
<h2 class="anchored" data-anchor-id="ortholog-comparison-across-species">Ortholog Comparison Across Species</h2>
<p>This section compares biomineralization orthologs (same group_id) across the three species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create biomin data with expression and methylation for each species</span></span>
<span id="cb72-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Include group_id for ortholog matching</span></span>
<span id="cb72-3"></span>
<span id="cb72-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra biomin with expression/methylation</span></span>
<span id="cb72-5">apul_biomin_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(apul_expression_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(apul_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, gene_id, species, mean_expression, log_expression, mean_methylation)</span>
<span id="cb72-11"></span>
<span id="cb72-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni biomin with expression/methylation  </span></span>
<span id="cb72-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need to add "gene-" prefix for matching</span></span>
<span id="cb72-14">peve_biomin_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id_match =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, gene_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(peve_expression_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id_match"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(peve_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id_match"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> gene_id_match, species, mean_expression, log_expression, mean_methylation)</span>
<span id="cb72-21"></span>
<span id="cb72-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis biomin with expression/methylation</span></span>
<span id="cb72-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Need to add "gene-" prefix for matching</span></span>
<span id="cb72-24">ptua_biomin_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_biomin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id_match =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene-"</span>, gene_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(ptua_expression_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id_match"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(ptua_methylation_mean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id_match"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb72-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> gene_id_match, species, mean_expression, log_expression, mean_methylation)</span>
<span id="cb72-31"></span>
<span id="cb72-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all biomin data</span></span>
<span id="cb72-33">all_biomin_orthologs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(apul_biomin_data, peve_biomin_data, ptua_biomin_data)</span>
<span id="cb72-34"></span>
<span id="cb72-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of biomin genes per species:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of biomin genes per species:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1">all_biomin_orthologs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(species)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  species             n
  &lt;chr&gt;           &lt;int&gt;
1 A. pulchra        499
2 P. evermanni      483
3 P. tuahiniensis   459</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find orthologs present in all three species</span></span>
<span id="cb76-2">orthologs_all_species <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_biomin_orthologs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb76-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(group_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb76-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_species =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(species)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb76-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(n_species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb76-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(group_id)</span>
<span id="cb76-7"></span>
<span id="cb76-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Number of ortholog groups present in all 3 species:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(orthologs_all_species), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Number of ortholog groups present in all 3 species: 250 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter to only orthologs in all species</span></span>
<span id="cb78-2">shared_orthologs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_biomin_orthologs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb78-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(group_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> orthologs_all_species)</span>
<span id="cb78-4"></span>
<span id="cb78-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Shared ortholog groups:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Shared ortholog groups:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(orthologs_all_species)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "OG_00030" "OG_00171" "OG_00176" "OG_00246" "OG_00297" "OG_00298"
  [7] "OG_00302" "OG_00305" "OG_00314" "OG_00355" "OG_00378" "OG_00430"
 [13] "OG_00460" "OG_00466" "OG_00510" "OG_00514" "OG_00572" "OG_00643"
 [19] "OG_00752" "OG_00807" "OG_00842" "OG_00843" "OG_01023" "OG_01117"
 [25] "OG_01121" "OG_01147" "OG_01155" "OG_01177" "OG_01223" "OG_01277"
 [31] "OG_01312" "OG_01317" "OG_01353" "OG_01354" "OG_01384" "OG_01414"
 [37] "OG_01452" "OG_01486" "OG_01489" "OG_01579" "OG_01608" "OG_01611"
 [43] "OG_01630" "OG_01724" "OG_01727" "OG_01747" "OG_01748" "OG_01753"
 [49] "OG_01758" "OG_01781" "OG_01981" "OG_01999" "OG_02000" "OG_02012"
 [55] "OG_02088" "OG_02090" "OG_02102" "OG_02124" "OG_02146" "OG_02148"
 [61] "OG_02149" "OG_02163" "OG_02176" "OG_02186" "OG_02219" "OG_02220"
 [67] "OG_02260" "OG_02317" "OG_02358" "OG_02439" "OG_02537" "OG_02619"
 [73] "OG_02666" "OG_02690" "OG_02924" "OG_02935" "OG_02967" "OG_03267"
 [79] "OG_03268" "OG_03269" "OG_03270" "OG_03288" "OG_03289" "OG_03291"
 [85] "OG_03298" "OG_03330" "OG_03429" "OG_03451" "OG_03484" "OG_03626"
 [91] "OG_03628" "OG_03671" "OG_03673" "OG_03780" "OG_03850" "OG_03856"
 [97] "OG_03857" "OG_04165" "OG_04238" "OG_04247" "OG_04327" "OG_04331"
[103] "OG_04372" "OG_04443" "OG_04514" "OG_04515" "OG_04537" "OG_04538"
[109] "OG_04547" "OG_04560" "OG_04651" "OG_04694" "OG_04698" "OG_04723"
[115] "OG_04756" "OG_04789" "OG_04799" "OG_05010" "OG_05087" "OG_05121"
[121] "OG_05228" "OG_05250" "OG_05304" "OG_05308" "OG_05366" "OG_05367"
[127] "OG_05498" "OG_05514" "OG_05568" "OG_05637" "OG_05666" "OG_05713"
[133] "OG_05717" "OG_05718" "OG_05749" "OG_05819" "OG_05856" "OG_05874"
[139] "OG_05875" "OG_05950" "OG_05952" "OG_06004" "OG_06101" "OG_06119"
[145] "OG_06152" "OG_06158" "OG_06181" "OG_06198" "OG_06234" "OG_06236"
[151] "OG_06247" "OG_06279" "OG_06373" "OG_06384" "OG_06592" "OG_06599"
[157] "OG_06607" "OG_06670" "OG_06711" "OG_06712" "OG_06717" "OG_06719"
[163] "OG_06754" "OG_06775" "OG_06875" "OG_06908" "OG_06922" "OG_06931"
[169] "OG_06954" "OG_06955" "OG_06998" "OG_07000" "OG_07042" "OG_07150"
[175] "OG_07153" "OG_07183" "OG_07252" "OG_07265" "OG_07330" "OG_07331"
[181] "OG_07389" "OG_07404" "OG_07508" "OG_07531" "OG_07620" "OG_07641"
[187] "OG_07772" "OG_07821" "OG_07822" "OG_07892" "OG_07958" "OG_08083"
[193] "OG_08096" "OG_08143" "OG_08144" "OG_08145" "OG_08192" "OG_08259"
[199] "OG_08271" "OG_08331" "OG_08347" "OG_08432" "OG_08497" "OG_08528"
[205] "OG_08545" "OG_08622" "OG_08639" "OG_08658" "OG_08663" "OG_08717"
[211] "OG_08768" "OG_08842" "OG_08849" "OG_08856" "OG_08874" "OG_08878"
[217] "OG_08914" "OG_08920" "OG_09003" "OG_09024" "OG_09106" "OG_09174"
[223] "OG_09247" "OG_09310" "OG_09424" "OG_09455" "OG_09486" "OG_09487"
[229] "OG_09511" "OG_09596" "OG_09597" "OG_09598" "OG_09638" "OG_09657"
[235] "OG_09806" "OG_09896" "OG_09897" "OG_09942" "OG_09969" "OG_09986"
[241] "OG_10002" "OG_10004" "OG_10007" "OG_10008" "OG_10039" "OG_10055"
[247] "OG_10109" "OG_10121" "OG_10183" "OG_10205"</code></pre>
</div>
</div>
<section id="ortholog-expression-vs-methylation---connected-by-ortholog-group" class="level3">
<h3 class="anchored" data-anchor-id="ortholog-expression-vs-methylation---connected-by-ortholog-group">Ortholog Expression vs Methylation - Connected by Ortholog Group</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot with lines connecting orthologs across species</span></span>
<span id="cb82-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(shared_orthologs, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_methylation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> log_expression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> species)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray70"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, </span>
<span id="cb82-6">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>, </span>
<span id="cb82-7">                                 <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Biomineralization Orthologs Across Species"</span>,</span>
<span id="cb82-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lines connect the same ortholog group across species"</span>,</span>
<span id="cb82-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean Gene Body Methylation (%)"</span>,</span>
<span id="cb82-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Log10(Mean Expression + 1)"</span>,</span>
<span id="cb82-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb82-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb82-15">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb82-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/ortholog-connected-plot-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pairwise-species-comparisons-for-shared-orthologs" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-species-comparisons-for-shared-orthologs">Pairwise Species Comparisons for Shared Orthologs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to wide format for pairwise comparisons</span></span>
<span id="cb83-2">orthologs_wide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> shared_orthologs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb83-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(group_id, species, log_expression, mean_methylation) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb83-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> species, </span>
<span id="cb83-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(log_expression, mean_methylation),</span>
<span id="cb83-6">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>)</span>
<span id="cb83-7"></span>
<span id="cb83-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(orthologs_wide)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 7
  group_id log_expression_A. pul‚Ä¶¬π log_expression_P. ev‚Ä¶¬≤ log_expression_P. tu‚Ä¶¬≥
  &lt;chr&gt;                      &lt;dbl&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;
1 OG_00752                    2.67                   3.25                   3.04
2 OG_00807                    3.13                   3.10                   2.84
3 OG_00842                    1.61                   1.16                   2.39
4 OG_00843                    4.14                   3.66                   4.76
5 OG_01023                    3.42                   2.40                   3.08
6 OG_01117                    2.79                   2.57                   2.66
# ‚Ñπ abbreviated names: ¬π‚Äã`log_expression_A. pulchra`,
#   ¬≤‚Äã`log_expression_P. evermanni`, ¬≥‚Äã`log_expression_P. tuahiniensis`
# ‚Ñπ 3 more variables: `mean_methylation_A. pulchra` &lt;dbl&gt;,
#   `mean_methylation_P. evermanni` &lt;dbl&gt;,
#   `mean_methylation_P. tuahiniensis` &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expression comparisons</span></span>
<span id="cb85-2">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. evermanni"</span>,</span>
<span id="cb85-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra Expression"</span>,</span>
<span id="cb85-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni Expression"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb85-11"></span>
<span id="cb85-12">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. tuahiniensis"</span>,</span>
<span id="cb85-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra Expression"</span>,</span>
<span id="cb85-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis Expression"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb85-21"></span>
<span id="cb85-22">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cyan4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni vs P. tuahiniensis"</span>,</span>
<span id="cb85-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni Expression"</span>,</span>
<span id="cb85-28">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis Expression"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb85-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb85-31"></span>
<span id="cb85-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine plots</span></span>
<span id="cb85-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb85-34">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb85-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression of Biomineralization Orthologs - Pairwise Comparisons"</span>,</span>
<span id="cb85-36">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/ortholog-expression-comparison-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Methylation comparisons</span></span>
<span id="cb86-2">m1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"purple"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. evermanni"</span>,</span>
<span id="cb86-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra Methylation"</span>,</span>
<span id="cb86-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni Methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb86-11"></span>
<span id="cb86-12">m2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"orange"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. tuahiniensis"</span>,</span>
<span id="cb86-17">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra Methylation"</span>,</span>
<span id="cb86-18">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis Methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb86-21"></span>
<span id="cb86-22">m3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(orthologs_wide, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cyan4"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray50"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni vs P. tuahiniensis"</span>,</span>
<span id="cb86-27">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni Methylation"</span>,</span>
<span id="cb86-28">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. tuahiniensis Methylation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb86-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb86-31"></span>
<span id="cb86-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine plots</span></span>
<span id="cb86-33">m1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb86-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation of Biomineralization Orthologs - Pairwise Comparisons"</span>,</span>
<span id="cb86-35">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/index_files/figure-html/ortholog-methylation-comparison-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlation-statistics-for-orthologs" class="level3">
<h3 class="anchored" data-anchor-id="correlation-statistics-for-orthologs">Correlation Statistics for Orthologs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== EXPRESSION CORRELATIONS ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== EXPRESSION CORRELATIONS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. evermanni:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A. pulchra vs P. evermanni:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1">cor_ap_pe_expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb91-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb91-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb91-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ap_pe_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ap_pe_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.72 , p = 3.67e-41 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. tuahiniensis:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A. pulchra vs P. tuahiniensis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1">cor_ap_pt_expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb95-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb95-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb95-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ap_pt_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ap_pt_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.691 , p = 7.32e-37 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni vs P. tuahiniensis:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P. evermanni vs P. tuahiniensis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1">cor_pe_pt_expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb99-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb99-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb99-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_pe_pt_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_pe_pt_expr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.745 , p = 1.84e-45 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== METHYLATION CORRELATIONS ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== METHYLATION CORRELATIONS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. evermanni:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A. pulchra vs P. evermanni:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1">cor_ap_pe_meth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb105-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb105-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb105-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ap_pe_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ap_pe_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.704 , p = 1.05e-38 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A. pulchra vs P. tuahiniensis:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A. pulchra vs P. tuahiniensis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1">cor_ap_pt_meth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb109-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb109-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb109-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_ap_pt_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_ap_pt_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.7 , p = 3.69e-38 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb111" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P. evermanni vs P. tuahiniensis:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>P. evermanni vs P. tuahiniensis:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1">cor_pe_pt_meth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor.test</span>(orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb113-2">                           orthologs_wide<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, </span>
<span id="cb113-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete.obs"</span>)</span>
<span id="cb113-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"  r ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(cor_pe_pt_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>estimate, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", p ="</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(cor_pe_pt_meth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p.value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  r = 0.665 , p = 3.17e-33 </code></pre>
</div>
</div>
</section>
<section id="ortholog-summary-table" class="level3">
<h3 class="anchored" data-anchor-id="ortholog-summary-table">Ortholog Summary Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb115" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a summary table of all shared orthologs</span></span>
<span id="cb115-2">ortholog_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> orthologs_wide <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb115-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb115-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expr_range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb115-5">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">log_expression_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb115-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">meth_range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmax</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb115-7">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmin</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_A. pulchra</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. evermanni</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_methylation_P. tuahiniensis</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb115-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb115-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(expr_range))</span>
<span id="cb115-10"></span>
<span id="cb115-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shared biomineralization orthologs (sorted by expression variability across species):</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shared biomineralization orthologs (sorted by expression variability across species):</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1">ortholog_summary <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb117-2">  knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kable</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">digits =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">group_id</th>
<th style="text-align: right;">log_expression_A. pulchra</th>
<th style="text-align: right;">log_expression_P. evermanni</th>
<th style="text-align: right;">log_expression_P. tuahiniensis</th>
<th style="text-align: right;">mean_methylation_A. pulchra</th>
<th style="text-align: right;">mean_methylation_P. evermanni</th>
<th style="text-align: right;">mean_methylation_P. tuahiniensis</th>
<th style="text-align: right;">expr_range</th>
<th style="text-align: right;">meth_range</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">OG_02967</td>
<td style="text-align: right;">1.65</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">3.59</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">0.97</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08096</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">1.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01121</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">8.21</td>
<td style="text-align: right;">5.48</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">7.78</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06234</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05250</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09596</td>
<td style="text-align: right;">4.61</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">4.70</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06712</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06101</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">3.64</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">6.21</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">5.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07772</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">1.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00643</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06711</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">0.89</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08849</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03288</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08914</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04514</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">3.01</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06908</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03429</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">1.47</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02163</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">1.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09638</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05304</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">11.17</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">10.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06119</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">46.24</td>
<td style="text-align: right;">54.54</td>
<td style="text-align: right;">8.82</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">45.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07331</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02537</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">0.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08331</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07508</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">40.71</td>
<td style="text-align: right;">51.12</td>
<td style="text-align: right;">24.09</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">27.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01747</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02924</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07153</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03780</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">5.22</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">4.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04372</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_10055</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">12.02</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">5.48</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">11.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08842</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">3.82</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">0.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00842</td>
<td style="text-align: right;">1.61</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06373</td>
<td style="text-align: right;">1.42</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05666</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07958</td>
<td style="text-align: right;">2.01</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">2.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03270</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08528</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08145</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">1.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03850</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">1.72</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02186</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02146</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00246</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10183</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">0.19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09174</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">8.28</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">7.07</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01579</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">36.09</td>
<td style="text-align: right;">57.79</td>
<td style="text-align: right;">7.83</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">49.95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08545</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">0.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00510</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.12</td>
<td style="text-align: right;">0.38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00355</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: right;">3.58</td>
<td style="text-align: right;">19.51</td>
<td style="text-align: right;">15.16</td>
<td style="text-align: right;">23.74</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">8.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01177</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">3.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00843</td>
<td style="text-align: right;">4.14</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: right;">4.76</td>
<td style="text-align: right;">7.97</td>
<td style="text-align: right;">10.14</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">9.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01147</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">2.35</td>
<td style="text-align: right;">11.64</td>
<td style="text-align: right;">39.42</td>
<td style="text-align: right;">15.49</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">27.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02000</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">2.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08083</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08874</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">2.90</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07330</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">16.94</td>
<td style="text-align: right;">38.43</td>
<td style="text-align: right;">5.69</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">32.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02690</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08663</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08717</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">3.70</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">3.28</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09024</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01781</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.23</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01023</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03289</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">1.45</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06875</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03626</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02439</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">3.93</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">3.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04515</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">0.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01727</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04537</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04651</td>
<td style="text-align: right;">2.95</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03298</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">57.92</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">21.17</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">56.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09942</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">13.53</td>
<td style="text-align: right;">8.57</td>
<td style="text-align: right;">6.41</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">7.12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08768</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01223</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03484</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">3.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00314</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">4.19</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">9.17</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">8.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05717</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10002</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02935</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03673</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">14.84</td>
<td style="text-align: right;">11.89</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">11.07</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03451</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">52.99</td>
<td style="text-align: right;">39.88</td>
<td style="text-align: right;">30.77</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">22.22</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07265</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">1.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07822</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10007</td>
<td style="text-align: right;">4.11</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">1.48</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02317</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">3.87</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">5.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02102</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">74.61</td>
<td style="text-align: right;">32.22</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">69.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05950</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03268</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">1.82</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">19.20</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">18.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05087</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06384</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00297</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01277</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">48.47</td>
<td style="text-align: right;">29.80</td>
<td style="text-align: right;">8.06</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">40.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01353</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">1.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04238</td>
<td style="text-align: right;">2.90</td>
<td style="text-align: right;">3.72</td>
<td style="text-align: right;">2.95</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.46</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08432</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">73.44</td>
<td style="text-align: right;">10.04</td>
<td style="text-align: right;">43.17</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">63.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10008</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06279</td>
<td style="text-align: right;">2.92</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">3.72</td>
<td style="text-align: right;">8.10</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">7.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08271</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">10.59</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">9.65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05010</td>
<td style="text-align: right;">2.16</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01753</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05819</td>
<td style="text-align: right;">1.67</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.21</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10039</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03856</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">1.51</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">1.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00302</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">1.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06599</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">3.19</td>
<td style="text-align: right;">43.89</td>
<td style="text-align: right;">55.61</td>
<td style="text-align: right;">27.13</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">28.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09003</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08920</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">32.81</td>
<td style="text-align: right;">32.21</td>
<td style="text-align: right;">15.46</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">17.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07183</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01155</td>
<td style="text-align: right;">3.62</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: right;">5.01</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">3.51</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06931</td>
<td style="text-align: right;">2.36</td>
<td style="text-align: right;">2.19</td>
<td style="text-align: right;">2.95</td>
<td style="text-align: right;">65.91</td>
<td style="text-align: right;">40.83</td>
<td style="text-align: right;">31.13</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">34.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09986</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">3.34</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">1.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05568</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08144</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06152</td>
<td style="text-align: right;">3.43</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">3.95</td>
<td style="text-align: right;">21.13</td>
<td style="text-align: right;">5.32</td>
<td style="text-align: right;">12.28</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">15.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03671</td>
<td style="text-align: right;">4.02</td>
<td style="text-align: right;">3.98</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04723</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">23.10</td>
<td style="text-align: right;">52.55</td>
<td style="text-align: right;">19.78</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">32.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09310</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00430</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: right;">3.01</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05749</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">3.36</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01724</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03267</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">3.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02666</td>
<td style="text-align: right;">3.28</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">3.38</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.82</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09598</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">3.86</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10004</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">50.47</td>
<td style="text-align: right;">58.20</td>
<td style="text-align: right;">14.23</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">43.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06607</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.04</td>
<td style="text-align: right;">15.03</td>
<td style="text-align: right;">5.06</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">14.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09896</td>
<td style="text-align: right;">3.67</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">3.01</td>
<td style="text-align: right;">18.73</td>
<td style="text-align: right;">52.33</td>
<td style="text-align: right;">14.20</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">38.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03269</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">3.19</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01354</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">6.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07389</td>
<td style="text-align: right;">2.92</td>
<td style="text-align: right;">2.33</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04331</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">24.14</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">23.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00466</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">31.30</td>
<td style="text-align: right;">38.40</td>
<td style="text-align: right;">7.49</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">30.91</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01630</td>
<td style="text-align: right;">3.07</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">7.20</td>
<td style="text-align: right;">6.51</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">3.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08259</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.27</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04799</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">3.39</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05228</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">5.47</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">5.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02358</td>
<td style="text-align: right;">2.55</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">2.88</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07892</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">18.46</td>
<td style="text-align: right;">8.48</td>
<td style="text-align: right;">10.84</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">9.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04443</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">2.32</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">7.06</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">5.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01384</td>
<td style="text-align: right;">1.77</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02088</td>
<td style="text-align: right;">4.29</td>
<td style="text-align: right;">4.59</td>
<td style="text-align: right;">3.98</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04538</td>
<td style="text-align: right;">3.12</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07150</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">1.98</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">7.39</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">6.98</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07821</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09969</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05637</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09806</td>
<td style="text-align: right;">3.58</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">4.18</td>
<td style="text-align: right;">12.85</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">11.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05875</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3.40</td>
<td style="text-align: right;">3.84</td>
<td style="text-align: right;">3.80</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">6.77</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">5.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04756</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04698</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">1.87</td>
<td style="text-align: right;">5.39</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">4.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08658</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">68.95</td>
<td style="text-align: right;">28.92</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">40.03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00752</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">3.25</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02176</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">2.13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01486</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">3.92</td>
<td style="text-align: right;">3.87</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01414</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">1.59</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">1.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02220</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">9.29</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">8.05</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00572</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">35.45</td>
<td style="text-align: right;">33.79</td>
<td style="text-align: right;">26.89</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">8.56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09657</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">9.70</td>
<td style="text-align: right;">28.08</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">25.39</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00171</td>
<td style="text-align: right;">3.24</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">54.14</td>
<td style="text-align: right;">33.41</td>
<td style="text-align: right;">42.35</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">20.72</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06592</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">2.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04247</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">2.88</td>
<td style="text-align: right;">2.54</td>
<td style="text-align: right;">28.98</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">27.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09597</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: right;">3.73</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05366</td>
<td style="text-align: right;">2.73</td>
<td style="text-align: right;">2.59</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.76</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06236</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">1.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03330</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.66</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07042</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">2.60</td>
<td style="text-align: right;">6.72</td>
<td style="text-align: right;">14.19</td>
<td style="text-align: right;">7.09</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">7.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00030</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">5.55</td>
<td style="text-align: right;">23.67</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">19.70</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01999</td>
<td style="text-align: right;">2.08</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02260</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">2.44</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">2.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06247</td>
<td style="text-align: right;">1.78</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1.57</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02012</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">26.97</td>
<td style="text-align: right;">40.13</td>
<td style="text-align: right;">7.25</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">32.88</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09455</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">3.51</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">11.94</td>
<td style="text-align: right;">8.12</td>
<td style="text-align: right;">4.18</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">7.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10205</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08639</td>
<td style="text-align: right;">3.70</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">4.06</td>
<td style="text-align: right;">7.24</td>
<td style="text-align: right;">8.82</td>
<td style="text-align: right;">4.48</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">4.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09247</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">4.47</td>
<td style="text-align: right;">4.41</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05952</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05121</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">3.36</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">26.46</td>
<td style="text-align: right;">25.43</td>
<td style="text-align: right;">24.39</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">2.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06719</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02149</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">1.99</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02124</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">3.43</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">55.80</td>
<td style="text-align: right;">35.80</td>
<td style="text-align: right;">23.88</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">31.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05713</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08347</td>
<td style="text-align: right;">3.32</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">25.43</td>
<td style="text-align: right;">36.64</td>
<td style="text-align: right;">7.39</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">29.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06754</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.88</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">18.63</td>
<td style="text-align: right;">31.47</td>
<td style="text-align: right;">15.70</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">15.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05874</td>
<td style="text-align: right;">4.08</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">4.26</td>
<td style="text-align: right;">17.46</td>
<td style="text-align: right;">13.59</td>
<td style="text-align: right;">7.14</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">10.32</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04560</td>
<td style="text-align: right;">4.19</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">4.44</td>
<td style="text-align: right;">36.01</td>
<td style="text-align: right;">21.42</td>
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">22.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05514</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">9.36</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">8.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03291</td>
<td style="text-align: right;">2.61</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">3.07</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">2.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06775</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06198</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">2.92</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">1.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06158</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">2.29</td>
<td style="text-align: right;">45.23</td>
<td style="text-align: right;">14.73</td>
<td style="text-align: right;">10.60</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">34.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_10121</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">7.64</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">5.90</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05308</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">10.30</td>
<td style="text-align: right;">22.79</td>
<td style="text-align: right;">13.55</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">12.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00298</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01317</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01489</td>
<td style="text-align: right;">2.97</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">3.39</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">14.69</td>
<td style="text-align: right;">3.83</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">10.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06670</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">20.64</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">19.85</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07620</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">2.55</td>
<td style="text-align: right;">23.51</td>
<td style="text-align: right;">50.45</td>
<td style="text-align: right;">22.36</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">28.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02619</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06998</td>
<td style="text-align: right;">3.57</td>
<td style="text-align: right;">3.81</td>
<td style="text-align: right;">3.41</td>
<td style="text-align: right;">4.93</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">4.47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_03857</td>
<td style="text-align: right;">1.64</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00176</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">1.43</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08497</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">14.87</td>
<td style="text-align: right;">58.20</td>
<td style="text-align: right;">6.72</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">51.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01608</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">9.00</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">8.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07404</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">13.91</td>
<td style="text-align: right;">13.48</td>
<td style="text-align: right;">7.57</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">6.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04327</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">3.38</td>
<td style="text-align: right;">22.45</td>
<td style="text-align: right;">49.03</td>
<td style="text-align: right;">8.22</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">40.82</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_04547</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">15.58</td>
<td style="text-align: right;">71.36</td>
<td style="text-align: right;">19.69</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">55.79</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00378</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.52</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07252</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05856</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">2.41</td>
<td style="text-align: right;">2.68</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.82</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">1.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08143</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_05718</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">3.12</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">16.07</td>
<td style="text-align: right;">23.32</td>
<td style="text-align: right;">4.89</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">18.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07641</td>
<td style="text-align: right;">3.12</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">3.46</td>
<td style="text-align: right;">34.58</td>
<td style="text-align: right;">35.03</td>
<td style="text-align: right;">39.95</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">5.37</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_00460</td>
<td style="text-align: right;">1.92</td>
<td style="text-align: right;">1.91</td>
<td style="text-align: right;">2.25</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00305</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">21.87</td>
<td style="text-align: right;">23.60</td>
<td style="text-align: right;">16.51</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">7.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04694</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">62.08</td>
<td style="text-align: right;">64.22</td>
<td style="text-align: right;">30.30</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">33.92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_07531</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09486</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: right;">15.16</td>
<td style="text-align: right;">20.17</td>
<td style="text-align: right;">3.56</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">16.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01981</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">1.96</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">1.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_07000</td>
<td style="text-align: right;">3.51</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01748</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">1.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09424</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">49.89</td>
<td style="text-align: right;">36.65</td>
<td style="text-align: right;">4.55</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">45.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08878</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">23.07</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">22.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02219</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">9.82</td>
<td style="text-align: right;">15.83</td>
<td style="text-align: right;">3.47</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">12.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01611</td>
<td style="text-align: right;">2.51</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06922</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00807</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">2.84</td>
<td style="text-align: right;">3.58</td>
<td style="text-align: right;">31.22</td>
<td style="text-align: right;">60.07</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">56.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04789</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">2.96</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01758</td>
<td style="text-align: right;">2.13</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">2.39</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06004</td>
<td style="text-align: right;">2.91</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">3.11</td>
<td style="text-align: right;">9.71</td>
<td style="text-align: right;">11.07</td>
<td style="text-align: right;">7.34</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">3.73</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08622</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">1.76</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06954</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">1.89</td>
<td style="text-align: right;">26.39</td>
<td style="text-align: right;">29.11</td>
<td style="text-align: right;">7.16</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">21.95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_00514</td>
<td style="text-align: right;">1.56</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">44.00</td>
<td style="text-align: right;">18.46</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">41.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_02148</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_01452</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">54.19</td>
<td style="text-align: right;">32.63</td>
<td style="text-align: right;">47.43</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">21.57</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01117</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09487</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.27</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">17.17</td>
<td style="text-align: right;">26.98</td>
<td style="text-align: right;">7.16</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">19.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09106</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">2.71</td>
<td style="text-align: right;">10.32</td>
<td style="text-align: right;">3.02</td>
<td style="text-align: right;">3.09</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">7.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_06717</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">20.24</td>
<td style="text-align: right;">8.38</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">15.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_01312</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">2.87</td>
<td style="text-align: right;">2.77</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_09897</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06955</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: right;">14.63</td>
<td style="text-align: right;">9.93</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">10.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05498</td>
<td style="text-align: right;">2.63</td>
<td style="text-align: right;">2.47</td>
<td style="text-align: right;">2.65</td>
<td style="text-align: right;">27.42</td>
<td style="text-align: right;">12.95</td>
<td style="text-align: right;">13.57</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">14.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_04165</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">2.89</td>
<td style="text-align: right;">2.78</td>
<td style="text-align: right;">23.20</td>
<td style="text-align: right;">23.39</td>
<td style="text-align: right;">16.89</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">6.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_02090</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">2.82</td>
<td style="text-align: right;">2.90</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">2.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_08856</td>
<td style="text-align: right;">2.70</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">6.71</td>
<td style="text-align: right;">13.54</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">11.92</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_05367</td>
<td style="text-align: right;">3.30</td>
<td style="text-align: right;">3.29</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.73</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_09511</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">2.75</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">24.27</td>
<td style="text-align: right;">12.38</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">21.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_10109</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">2.38</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">17.79</td>
<td style="text-align: right;">20.09</td>
<td style="text-align: right;">33.28</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">15.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_03628</td>
<td style="text-align: right;">2.55</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">14.40</td>
<td style="text-align: right;">3.12</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">11.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OG_08192</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">OG_06181</td>
<td style="text-align: right;">3.72</td>
<td style="text-align: right;">3.69</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: right;">37.88</td>
<td style="text-align: right;">47.48</td>
<td style="text-align: right;">4.89</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">42.59</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="data-validation" class="level2">
<h2 class="anchored" data-anchor-id="data-validation">Data Validation</h2>
<p>This section verifies that for each species, a given point in the plot truly represents the same gene from both the expression and methylation datasets.</p>
<section id="acropora-pulchra---validation" class="level3">
<h3 class="anchored" data-anchor-id="acropora-pulchra---validation">Acropora pulchra - Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb118" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick a random gene from the combined dataset</span></span>
<span id="cb118-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb118-3">apul_test_gene <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(apul_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb118-4"></span>
<span id="cb118-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== VALIDATION FOR ACROPORA PULCHRA ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== VALIDATION FOR ACROPORA PULCHRA ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test gene ID:"</span>, apul_test_gene, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test gene ID: FUN_038232 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw expression data for this gene</span></span>
<span id="cb122-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Raw Expression Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Raw Expression Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1">apul_expr_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb124-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> apul_test_gene)</span>
<span id="cb124-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(apul_expr_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 41
  gene_id  `ACR-139-TP1` `ACR-139-TP2` `ACR-139-TP3` `ACR-139-TP4` `ACR-145-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 FUN_038‚Ä¶             0             0             0             0             9
# ‚Ñπ 35 more variables: `ACR-145-TP2` &lt;dbl&gt;, `ACR-145-TP3` &lt;dbl&gt;,
#   `ACR-145-TP4` &lt;dbl&gt;, `ACR-150-TP1` &lt;dbl&gt;, `ACR-150-TP2` &lt;dbl&gt;,
#   `ACR-150-TP3` &lt;dbl&gt;, `ACR-150-TP4` &lt;dbl&gt;, `ACR-173-TP1` &lt;dbl&gt;,
#   `ACR-173-TP2` &lt;dbl&gt;, `ACR-173-TP3` &lt;dbl&gt;, `ACR-173-TP4` &lt;dbl&gt;,
#   `ACR-186-TP1` &lt;dbl&gt;, `ACR-186-TP2` &lt;dbl&gt;, `ACR-186-TP3` &lt;dbl&gt;,
#   `ACR-186-TP4` &lt;dbl&gt;, `ACR-225-TP1` &lt;dbl&gt;, `ACR-225-TP2` &lt;dbl&gt;,
#   `ACR-225-TP3` &lt;dbl&gt;, `ACR-225-TP4` &lt;dbl&gt;, `ACR-229-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw methylation data for this gene</span></span>
<span id="cb126-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Raw Methylation Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Raw Methylation Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1">apul_meth_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb128-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> apul_test_gene)</span>
<span id="cb128-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(apul_meth_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 41
  gene_id  `ACR-139-TP1` `ACR-139-TP2` `ACR-139-TP3` `ACR-139-TP4` `ACR-145-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 FUN_038‚Ä¶          13.9          25.0          13.4          21.2          25.2
# ‚Ñπ 35 more variables: `ACR-145-TP2` &lt;dbl&gt;, `ACR-145-TP3` &lt;dbl&gt;,
#   `ACR-145-TP4` &lt;dbl&gt;, `ACR-150-TP1` &lt;dbl&gt;, `ACR-150-TP2` &lt;dbl&gt;,
#   `ACR-150-TP3` &lt;dbl&gt;, `ACR-150-TP4` &lt;dbl&gt;, `ACR-173-TP1` &lt;dbl&gt;,
#   `ACR-173-TP2` &lt;dbl&gt;, `ACR-173-TP3` &lt;dbl&gt;, `ACR-173-TP4` &lt;dbl&gt;,
#   `ACR-186-TP1` &lt;dbl&gt;, `ACR-186-TP2` &lt;dbl&gt;, `ACR-186-TP3` &lt;dbl&gt;,
#   `ACR-186-TP4` &lt;dbl&gt;, `ACR-225-TP1` &lt;dbl&gt;, `ACR-225-TP2` &lt;dbl&gt;,
#   `ACR-225-TP3` &lt;dbl&gt;, `ACR-225-TP4` &lt;dbl&gt;, `ACR-229-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get processed values from combined dataset</span></span>
<span id="cb130-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Values in Combined Dataset (used for plotting) ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Values in Combined Dataset (used for plotting) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1">apul_combined_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb132-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> apul_test_gene)</span>
<span id="cb132-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(apul_combined_check)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 6
  gene_id    mean_expression log_expression mean_methylation is_biomin species  
  &lt;chr&gt;                &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;     &lt;chr&gt;    
1 FUN_038232            10.8           1.07             28.8 FALSE     Acropora‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manual calculation to verify</span></span>
<span id="cb134-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Manual Verification ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Manual Verification ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1">apul_expr_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_expr_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb136-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb136-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb136-4">apul_meth_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul_meth_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb136-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb136-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb136-7"></span>
<span id="cb136-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean expression:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(apul_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean expression: 10.775 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb138" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual log10(mean + 1):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(apul_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual log10(mean + 1): 1.070961 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset log_expression:"</span>, apul_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset log_expression: 1.070961 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb142" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(apul_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean methylation: 28.83743 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb144" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset mean_methylation:"</span>, apul_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset mean_methylation: 28.83743 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb146" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚úì Values match: Expression ="</span>, </span>
<span id="cb146-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(apul_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(apul_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb146-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", Methylation ="</span>,</span>
<span id="cb146-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(apul_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(apul_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
‚úì Values match: Expression = TRUE , Methylation = TRUE </code></pre>
</div>
</div>
</section>
<section id="porites-evermanni---validation" class="level3">
<h3 class="anchored" data-anchor-id="porites-evermanni---validation">Porites evermanni - Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb148" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick a random gene from the combined dataset</span></span>
<span id="cb148-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb148-3">peve_test_gene <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(peve_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb148-4"></span>
<span id="cb148-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== VALIDATION FOR PORITES EVERMANNI ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== VALIDATION FOR PORITES EVERMANNI ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test gene ID:"</span>, peve_test_gene, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test gene ID: gene-Peve_00040885 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb152" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw expression data for this gene</span></span>
<span id="cb152-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Raw Expression Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Raw Expression Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1">peve_expr_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb154-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> peve_test_gene)</span>
<span id="cb154-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(peve_expr_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 39
  gene_id  `POR-216-TP1` `POR-216-TP2` `POR-216-TP3` `POR-216-TP4` `POR-236-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Pe‚Ä¶             0             4             0             0             2
# ‚Ñπ 33 more variables: `POR-236-TP2` &lt;dbl&gt;, `POR-245-TP1` &lt;dbl&gt;,
#   `POR-245-TP2` &lt;dbl&gt;, `POR-245-TP3` &lt;dbl&gt;, `POR-245-TP4` &lt;dbl&gt;,
#   `POR-260-TP1` &lt;dbl&gt;, `POR-260-TP2` &lt;dbl&gt;, `POR-260-TP3` &lt;dbl&gt;,
#   `POR-260-TP4` &lt;dbl&gt;, `POR-262-TP1` &lt;dbl&gt;, `POR-262-TP2` &lt;dbl&gt;,
#   `POR-262-TP3` &lt;dbl&gt;, `POR-262-TP4` &lt;dbl&gt;, `POR-69-TP1` &lt;dbl&gt;,
#   `POR-69-TP2` &lt;dbl&gt;, `POR-69-TP3` &lt;dbl&gt;, `POR-69-TP4` &lt;dbl&gt;,
#   `POR-72-TP1` &lt;dbl&gt;, `POR-72-TP2` &lt;dbl&gt;, `POR-72-TP3` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw methylation data for this gene</span></span>
<span id="cb156-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Raw Methylation Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Raw Methylation Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1">peve_meth_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb158-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> peve_test_gene)</span>
<span id="cb158-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(peve_meth_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 38
  gene_id  `POR-216-TP1` `POR-216-TP2` `POR-216-TP3` `POR-216-TP4` `POR-236-TP1`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Pe‚Ä¶         0.351         0.105          1.38         0.175          1.83
# ‚Ñπ 32 more variables: `POR-236-TP2` &lt;dbl&gt;, `POR-245-TP1` &lt;dbl&gt;,
#   `POR-245-TP2` &lt;dbl&gt;, `POR-245-TP3` &lt;dbl&gt;, `POR-245-TP4` &lt;dbl&gt;,
#   `POR-260-TP1` &lt;dbl&gt;, `POR-260-TP2` &lt;dbl&gt;, `POR-260-TP3` &lt;dbl&gt;,
#   `POR-260-TP4` &lt;dbl&gt;, `POR-262-TP1` &lt;dbl&gt;, `POR-262-TP2` &lt;dbl&gt;,
#   `POR-262-TP3` &lt;dbl&gt;, `POR-262-TP4` &lt;dbl&gt;, `POR-69-TP1` &lt;dbl&gt;,
#   `POR-69-TP2` &lt;dbl&gt;, `POR-69-TP3` &lt;dbl&gt;, `POR-69-TP4` &lt;dbl&gt;,
#   `POR-72-TP1` &lt;dbl&gt;, `POR-72-TP2` &lt;dbl&gt;, `POR-72-TP3` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get processed values from combined dataset</span></span>
<span id="cb160-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Values in Combined Dataset (used for plotting) ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Values in Combined Dataset (used for plotting) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1">peve_combined_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb162-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> peve_test_gene)</span>
<span id="cb162-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(peve_combined_check)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 6
  gene_id      mean_expression log_expression mean_methylation is_biomin species
  &lt;chr&gt;                  &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;     &lt;chr&gt;  
1 gene-Peve_0‚Ä¶           0.526          0.184            0.631 FALSE     Porite‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manual calculation to verify</span></span>
<span id="cb164-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Manual Verification ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Manual Verification ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1">peve_expr_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_expr_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb166-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb166-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb166-4">peve_meth_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve_meth_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb166-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb166-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb166-7"></span>
<span id="cb166-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean expression:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(peve_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean expression: 0.5263158 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb168" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual log10(mean + 1):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(peve_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual log10(mean + 1): 0.1836444 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb170" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset log_expression:"</span>, peve_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset log_expression: 0.1836444 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb172" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(peve_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean methylation: 0.6312905 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb174" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset mean_methylation:"</span>, peve_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset mean_methylation: 0.6312905 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb176" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚úì Values match: Expression ="</span>, </span>
<span id="cb176-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(peve_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(peve_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb176-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", Methylation ="</span>,</span>
<span id="cb176-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(peve_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(peve_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
‚úì Values match: Expression = TRUE , Methylation = TRUE </code></pre>
</div>
</div>
</section>
<section id="pocillopora-tuahiniensis---validation" class="level3">
<h3 class="anchored" data-anchor-id="pocillopora-tuahiniensis---validation">Pocillopora tuahiniensis - Validation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb178" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick a random gene from the combined dataset</span></span>
<span id="cb178-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb178-3">ptua_test_gene <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(ptua_combined<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb178-4"></span>
<span id="cb178-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== VALIDATION FOR POCILLOPORA TUAHINIENSIS ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== VALIDATION FOR POCILLOPORA TUAHINIENSIS ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Test gene ID:"</span>, ptua_test_gene, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test gene ID: gene-Pocillopora_meandrina_HIv1___RNAseq.g9000.t1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb182" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw expression data for this gene</span></span>
<span id="cb182-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Raw Expression Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Raw Expression Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1">ptua_expr_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expression <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb184-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ptua_test_gene)</span>
<span id="cb184-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(ptua_expr_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 40
  gene_id  `POC-201-TP1` `POC-201-TP2` `POC-201-TP3` `POC-219-TP1` `POC-219-TP2`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Po‚Ä¶          2158          1552           319          1066           803
# ‚Ñπ 34 more variables: `POC-219-TP3` &lt;dbl&gt;, `POC-219-TP4` &lt;dbl&gt;,
#   `POC-222-TP1` &lt;dbl&gt;, `POC-222-TP2` &lt;dbl&gt;, `POC-222-TP3` &lt;dbl&gt;,
#   `POC-222-TP4` &lt;dbl&gt;, `POC-255-TP1` &lt;dbl&gt;, `POC-255-TP2` &lt;dbl&gt;,
#   `POC-255-TP3` &lt;dbl&gt;, `POC-255-TP4` &lt;dbl&gt;, `POC-259-TP1` &lt;dbl&gt;,
#   `POC-259-TP2` &lt;dbl&gt;, `POC-259-TP3` &lt;dbl&gt;, `POC-259-TP4` &lt;dbl&gt;,
#   `POC-40-TP1` &lt;dbl&gt;, `POC-40-TP2` &lt;dbl&gt;, `POC-40-TP3` &lt;dbl&gt;,
#   `POC-40-TP4` &lt;dbl&gt;, `POC-42-TP1` &lt;dbl&gt;, `POC-42-TP2` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get raw methylation data for this gene</span></span>
<span id="cb186-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Raw Methylation Data ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Raw Methylation Data ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1">ptua_meth_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_methylation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb188-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ptua_test_gene)</span>
<span id="cb188-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(ptua_meth_raw)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 33
  gene_id  `POC-201-TP1` `POC-201-TP2` `POC-219-TP1` `POC-219-TP2` `POC-219-TP3`
  &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 gene-Po‚Ä¶          13.0          13.5          11.1          11.8          12.0
# ‚Ñπ 27 more variables: `POC-219-TP4` &lt;dbl&gt;, `POC-222-TP1` &lt;dbl&gt;,
#   `POC-222-TP3` &lt;dbl&gt;, `POC-222-TP4` &lt;dbl&gt;, `POC-255-TP1` &lt;dbl&gt;,
#   `POC-255-TP2` &lt;dbl&gt;, `POC-255-TP3` &lt;dbl&gt;, `POC-259-TP1` &lt;dbl&gt;,
#   `POC-259-TP2` &lt;dbl&gt;, `POC-40-TP1` &lt;dbl&gt;, `POC-40-TP2` &lt;dbl&gt;,
#   `POC-40-TP3` &lt;dbl&gt;, `POC-40-TP4` &lt;dbl&gt;, `POC-42-TP2` &lt;dbl&gt;,
#   `POC-42-TP4` &lt;dbl&gt;, `POC-52-TP1` &lt;dbl&gt;, `POC-52-TP2` &lt;dbl&gt;,
#   `POC-52-TP3` &lt;dbl&gt;, `POC-52-TP4` &lt;dbl&gt;, `POC-53-TP1` &lt;dbl&gt;, ‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get processed values from combined dataset</span></span>
<span id="cb190-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Values in Combined Dataset (used for plotting) ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Values in Combined Dataset (used for plotting) ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1">ptua_combined_check <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_combined <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb192-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(gene_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ptua_test_gene)</span>
<span id="cb192-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(ptua_combined_check)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 6
  gene_id      mean_expression log_expression mean_methylation is_biomin species
  &lt;chr&gt;                  &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt; &lt;lgl&gt;     &lt;chr&gt;  
1 gene-Pocill‚Ä¶           1221.           3.09             12.5 FALSE     Pocill‚Ä¶</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manual calculation to verify</span></span>
<span id="cb194-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">--- Manual Verification ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
--- Manual Verification ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1">ptua_expr_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_expr_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb196-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb196-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb196-4">ptua_meth_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua_meth_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb196-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb196-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>()</span>
<span id="cb196-7"></span>
<span id="cb196-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean expression:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ptua_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean expression: 1221.026 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb198" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual log10(mean + 1):"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ptua_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual log10(mean + 1): 3.08708 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb200" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset log_expression:"</span>, ptua_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset log_expression: 3.08708 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb202" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Manual mean methylation:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ptua_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Manual mean methylation: 12.50447 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb204" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Combined dataset mean_methylation:"</span>, ptua_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Combined dataset mean_methylation: 12.50447 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚úì Values match: Expression ="</span>, </span>
<span id="cb206-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ptua_expr_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(ptua_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>log_expression, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb206-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", Methylation ="</span>,</span>
<span id="cb206-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(ptua_meth_values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(ptua_combined_check<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mean_methylation, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
‚úì Values match: Expression = TRUE , Methylation = TRUE </code></pre>
</div>
</div>
</section>
<section id="sample-level-verification" class="level3">
<h3 class="anchored" data-anchor-id="sample-level-verification">Sample-Level Verification</h3>
<p>This demonstrates that the same sample IDs exist in both expression and methylation datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== SAMPLE ID VERIFICATION ===</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== SAMPLE ID VERIFICATION ===</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Acropora pulchra</span></span>
<span id="cb210-2">apul_expr_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(apul_expression)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb210-3">apul_meth_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(apul_methylation)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb210-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Acropora pulchra ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Acropora pulchra ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(apul_expr_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression samples: 40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb214" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(apul_meth_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation samples: 40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb216" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shared samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(apul_expr_samples, apul_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shared samples: 40 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb218" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(apul_expr_samples, apul_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression-only samples: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb220" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(apul_meth_samples, apul_expr_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation-only samples: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb222" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Porites evermanni</span></span>
<span id="cb222-2">peve_expr_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(peve_expression)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb222-3">peve_meth_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(peve_methylation)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb222-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Porites evermanni ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Porites evermanni ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(peve_expr_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression samples: 38 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb226" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(peve_meth_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation samples: 37 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb228" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shared samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(peve_expr_samples, peve_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shared samples: 37 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb230" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(peve_expr_samples, peve_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression-only samples: 1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(peve_meth_samples, peve_expr_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation-only samples: 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb234" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pocillopora tuahiniensis</span></span>
<span id="cb234-2">ptua_expr_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(ptua_expression)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb234-3">ptua_meth_samples <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(ptua_methylation)[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb234-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--- Pocillopora tuahiniensis ---</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Pocillopora tuahiniensis ---</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ptua_expr_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression samples: 39 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb238" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ptua_meth_samples), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation samples: 32 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb240" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shared samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(ptua_expr_samples, ptua_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Shared samples: 32 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb242" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Expression-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(ptua_expr_samples, ptua_meth_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expression-only samples: 7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb244" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Methylation-only samples:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(ptua_meth_samples, ptua_expr_samples)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Methylation-only samples: 0 </code></pre>
</div>
</div>
</section>
</section>
<section id="session-info" class="level2">
<h2 class="anchored" data-anchor-id="session-info">Session Info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb246" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sessionInfo</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.1 (2025-06-13)
Platform: aarch64-apple-darwin20
Running under: macOS Tahoe 26.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] patchwork_1.3.2 lubridate_1.9.4 forcats_1.0.1   stringr_1.5.2  
 [5] dplyr_1.1.4     purrr_1.1.0     readr_2.1.5     tidyr_1.3.1    
 [9] tibble_3.3.0    ggplot2_4.0.0   tidyverse_2.0.0

loaded via a namespace (and not attached):
 [1] utf8_1.2.6         generics_0.1.4     lattice_0.22-7     stringi_1.8.7     
 [5] hms_1.1.3          digest_0.6.37      magrittr_2.0.4     evaluate_1.0.5    
 [9] grid_4.5.1         timechange_0.3.0   RColorBrewer_1.1-3 fastmap_1.2.0     
[13] Matrix_1.7-3       jsonlite_2.0.0     mgcv_1.9-3         scales_1.4.0      
[17] cli_3.6.5          rlang_1.1.6        crayon_1.5.3       bit64_4.6.0-1     
[21] splines_4.5.1      withr_3.0.2        yaml_2.3.10        tools_4.5.1       
[25] parallel_4.5.1     tzdb_0.5.0         curl_7.0.0         vctrs_0.6.5       
[29] R6_2.6.1           lifecycle_1.0.4    htmlwidgets_1.6.4  bit_4.6.0         
[33] vroom_1.6.6        pkgconfig_2.0.3    pillar_1.11.1      gtable_0.3.6      
[37] glue_1.8.0         xfun_0.54          tidyselect_1.2.1   rstudioapi_0.17.1 
[41] knitr_1.50         farver_2.1.2       nlme_3.1-168       htmltools_0.5.8.1 
[45] rmarkdown_2.30     labeling_0.4.3     compiler_4.5.1     S7_0.2.0          </code></pre>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/65-gbm-plots/</guid>
  <pubDate>Mon, 01 Dec 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-12-01_18-55-45.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Barnacle</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/64-barnacle/</link>
  <description><![CDATA[ 





<section id="trying-to-build-alternative-tensor" class="level2">
<h2 class="anchored" data-anchor-id="trying-to-build-alternative-tensor">Trying to build alternative tensor</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/usr/bin/env python3</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Alternative tensor construction: (genes √ó timepoints √ó samples)</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">Each sample becomes a separate slice instead of grouping by species.</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> argparse</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datetime <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Dict, List, Tuple</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> barnacle.decomposition <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SparseCP</span>
<span id="cb1-17"></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> read_normalized_csv(path: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> pd.DataFrame:</span>
<span id="cb1-20">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(path)</span>
<span id="cb1-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'group_id'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df.columns:</span>
<span id="cb1-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Expected 'group_id' column in </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-23">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.set_index(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'group_id'</span>)</span>
<span id="cb1-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> df</span>
<span id="cb1-25"></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> parse_sample_timepoint(column_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Tuple[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>]:</span>
<span id="cb1-28">    tp_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> column_name.rfind(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-TP'</span>)</span>
<span id="cb1-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb1-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Expected TP# token at end of column: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>column_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-31"></span>
<span id="cb1-32">    time_token <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> column_name[tp_index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]</span>
<span id="cb1-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> time_token.startswith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'TP'</span>):</span>
<span id="cb1-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Expected TP# token at end of column: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>column_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-36">        tp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(time_token.replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'TP'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>))</span>
<span id="cb1-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> exc:</span>
<span id="cb1-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Failed to parse timepoint from </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>column_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> exc</span>
<span id="cb1-39"></span>
<span id="cb1-40">    sample_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> column_name[:tp_index]</span>
<span id="cb1-41">    sample_prefix <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_id.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-42">    species_map <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ACR'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'apul'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'POR'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'peve'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'POC'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ptua'</span>}</span>
<span id="cb1-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sample_prefix <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> species_map:</span>
<span id="cb1-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Unknown species prefix in column: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>column_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-45"></span>
<span id="cb1-46">    species <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> species_map[sample_prefix]</span>
<span id="cb1-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> species, sample_id, tp</span>
<span id="cb1-48"></span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> build_tensor_by_sample(</span>
<span id="cb1-51">    df: pd.DataFrame,</span>
<span id="cb1-52">    expected_timepoints: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>],</span>
<span id="cb1-53">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Tuple[np.ndarray, List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>], Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]], List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]]:</span>
<span id="cb1-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Build tensor with shape (genes, timepoints, samples).</span></span>
<span id="cb1-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Each unique sample becomes a slice, with timepoints as rows.</span></span>
<span id="cb1-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb1-58">    common_genes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(df.index))</span>
<span id="cb1-59"></span>
<span id="cb1-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Collect all unique samples across all species</span></span>
<span id="cb1-61">    sample_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># {sample_id: {species: str, columns: {tp: col_name</span><span class="re">}}}</span></span>
<span id="cb1-62">    </span>
<span id="cb1-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> col <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df.columns:</span>
<span id="cb1-64">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-65">            species, sample_id, tp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parse_sample_timepoint(col)</span>
<span id="cb1-66">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> expected_timepoints:</span>
<span id="cb1-67">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sample_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sample_data:</span>
<span id="cb1-68">                    sample_data[sample_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-69">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>: species,</span>
<span id="cb1-70">                        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'columns'</span>: {}</span>
<span id="cb1-71">                    }</span>
<span id="cb1-72">                sample_data[sample_id][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'columns'</span>][tp] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> col</span>
<span id="cb1-73">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>:</span>
<span id="cb1-74">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb1-75"></span>
<span id="cb1-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort samples by species, then by sample_id</span></span>
<span id="cb1-77">    sorted_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(</span>
<span id="cb1-78">        sample_data.keys(),</span>
<span id="cb1-79">        key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> sid: (sample_data[sid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>], sid)</span>
<span id="cb1-80">    )</span>
<span id="cb1-81"></span>
<span id="cb1-82">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build sample labels and metadata</span></span>
<span id="cb1-83">    sample_labels: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-84">    sample_metadata: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb1-85">    </span>
<span id="cb1-86">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, sample_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sorted_samples):</span>
<span id="cb1-87">        species <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_data[sample_id][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>]</span>
<span id="cb1-88">        sample_labels.append(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>species<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>sample_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-89">        sample_metadata[idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-90">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>: species,</span>
<span id="cb1-91">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>: sample_id,</span>
<span id="cb1-92">        }</span>
<span id="cb1-93"></span>
<span id="cb1-94">    n_genes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(common_genes)</span>
<span id="cb1-95">    n_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(expected_timepoints)</span>
<span id="cb1-96">    n_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sorted_samples)</span>
<span id="cb1-97"></span>
<span id="cb1-98">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> n_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb1-99">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No samples with valid timepoints found"</span>)</span>
<span id="cb1-100"></span>
<span id="cb1-101">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tensor shape: (genes, timepoints, samples)</span></span>
<span id="cb1-102">    tensor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.empty((n_genes, n_time, n_samples), dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)</span>
<span id="cb1-103">    tensor[:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan</span>
<span id="cb1-104"></span>
<span id="cb1-105">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill tensor</span></span>
<span id="cb1-106">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> s_idx, sample_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sorted_samples):</span>
<span id="cb1-107">        columns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_data[sample_id][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'columns'</span>]</span>
<span id="cb1-108">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t_idx, tp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(expected_timepoints):</span>
<span id="cb1-109">            col <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> columns.get(tp)</span>
<span id="cb1-110">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> col <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-111">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb1-112">            values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.loc[common_genes, col].to_numpy(dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)</span>
<span id="cb1-113">            tensor[:, t_idx, s_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> values</span>
<span id="cb1-114"></span>
<span id="cb1-115">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace NaNs with zeros</span></span>
<span id="cb1-116">    tensor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.nan_to_num(tensor, nan<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>)</span>
<span id="cb1-117">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> tensor, sample_labels, sample_metadata, common_genes</span>
<span id="cb1-118"></span>
<span id="cb1-119"></span>
<span id="cb1-120"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> run_sparse_cp(</span>
<span id="cb1-121">    tensor: np.ndarray,</span>
<span id="cb1-122">    rank: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb1-123">    lambda_gene: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb1-124">    lambda_time: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb1-125">    lambda_sample: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb1-126">    max_iter: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb1-127">    tol: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb1-128">    seed: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb1-129">):</span>
<span id="cb1-130">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb1-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Note: lambda order now matches tensor dimensions: [gene, time, sample]</span></span>
<span id="cb1-132"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb1-133">    model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SparseCP(</span>
<span id="cb1-134">        rank<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>rank,</span>
<span id="cb1-135">        lambdas<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[lambda_gene, lambda_time, lambda_sample],</span>
<span id="cb1-136">        nonneg_modes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb1-137">        n_initializations<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb1-138">        random_state<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb1-139">        n_iter_max<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_iter,</span>
<span id="cb1-140">        tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tol,</span>
<span id="cb1-141">    )</span>
<span id="cb1-142">    decomposition <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.fit_transform(tensor, verbose<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-143">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> model, decomposition</span>
<span id="cb1-144"></span>
<span id="cb1-145"></span>
<span id="cb1-146"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> save_outputs(</span>
<span id="cb1-147">    output_dir: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>,</span>
<span id="cb1-148">    tensor: np.ndarray,</span>
<span id="cb1-149">    sample_labels: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>],</span>
<span id="cb1-150">    sample_metadata: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]],</span>
<span id="cb1-151">    genes: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>],</span>
<span id="cb1-152">    model,</span>
<span id="cb1-153">    decomposition,</span>
<span id="cb1-154">):</span>
<span id="cb1-155">    os.makedirs(output_dir, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-156">    factors_dir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'barnacle_factors'</span>)</span>
<span id="cb1-157">    figs_dir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'figures'</span>)</span>
<span id="cb1-158">    os.makedirs(factors_dir, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-159">    os.makedirs(figs_dir, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-160"></span>
<span id="cb1-161">    np.save(os.path.join(output_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'multiomics_tensor.npy'</span>), tensor)</span>
<span id="cb1-162"></span>
<span id="cb1-163">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract factors: order is [genes, timepoints, samples]</span></span>
<span id="cb1-164">    gene_factors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(decomposition.factors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>genes)</span>
<span id="cb1-165">    time_factors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(decomposition.factors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], </span>
<span id="cb1-166">                               index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'TP</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, tensor.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)])</span>
<span id="cb1-167">    sample_factors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(decomposition.factors[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sample_labels)</span>
<span id="cb1-168"></span>
<span id="cb1-169">    gene_factors.to_csv(os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gene_factors.csv'</span>))</span>
<span id="cb1-170">    time_factors.to_csv(os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'time_factors.csv'</span>))</span>
<span id="cb1-171">    sample_factors.to_csv(os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_factors.csv'</span>))</span>
<span id="cb1-172"></span>
<span id="cb1-173">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute component weights</span></span>
<span id="cb1-174">    weights_attr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">getattr</span>(decomposition, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weights'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb1-175">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> weights_attr <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-176">        weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.asarray(weights_attr).astype(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>).ravel()</span>
<span id="cb1-177">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> np.allclose(weights, weights[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(weights) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>:</span>
<span id="cb1-178">            weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-179">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-180">        weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-181"></span>
<span id="cb1-182">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> weights <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-183">        gene_norms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(gene_factors.values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-184">        time_norms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(time_factors.values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-185">        sample_norms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.linalg.norm(sample_factors.values, axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb1-186">        weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gene_norms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> time_norms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> sample_norms</span>
<span id="cb1-187"></span>
<span id="cb1-188">    pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'weight'</span>: weights}).to_csv(</span>
<span id="cb1-189">        os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'component_weights.csv'</span>), index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-190"></span>
<span id="cb1-191">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample mapping</span></span>
<span id="cb1-192">    mapping_rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb1-193">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, label <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sample_labels):</span>
<span id="cb1-194">        mapping_rows.append({</span>
<span id="cb1-195">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_index'</span>: idx,</span>
<span id="cb1-196">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'label'</span>: label,</span>
<span id="cb1-197">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>: sample_metadata[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>],</span>
<span id="cb1-198">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>: sample_metadata[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_id'</span>],</span>
<span id="cb1-199">        })</span>
<span id="cb1-200">    pd.DataFrame(mapping_rows).to_csv(</span>
<span id="cb1-201">        os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_mapping.csv'</span>), index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-202"></span>
<span id="cb1-203">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Metadata</span></span>
<span id="cb1-204">    raw_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">getattr</span>(model, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss_'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb1-205">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> raw_loss <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-206">        final_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-207">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-208">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb1-209">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(raw_loss, (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>, np.ndarray)) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(raw_loss) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb1-210">                final_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(raw_loss[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb1-211">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb1-212">                final_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(raw_loss)</span>
<span id="cb1-213">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>:</span>
<span id="cb1-214">            final_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-215"></span>
<span id="cb1-216">    metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb1-217">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'timestamp'</span>: datetime.utcnow().isoformat() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Z'</span>,</span>
<span id="cb1-218">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensor_shape'</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, tensor.shape)),</span>
<span id="cb1-219">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tensor_structure'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'(genes, timepoints, samples)'</span>,</span>
<span id="cb1-220">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'n_components'</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(gene_factors.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb1-221">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'model_converged'</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">getattr</span>(model, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'converged_'</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)),</span>
<span id="cb1-222">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'final_loss'</span>: final_loss,</span>
<span id="cb1-223">    }</span>
<span id="cb1-224">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(os.path.join(factors_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'metadata.json'</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> fh:</span>
<span id="cb1-225">        json.dump(metadata, fh, indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb1-226"></span>
<span id="cb1-227">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Figures</span></span>
<span id="cb1-228">    plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-229">    plt.bar(np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(weights)), weights)</span>
<span id="cb1-230">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Component'</span>)</span>
<span id="cb1-231">    plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Weight'</span>)</span>
<span id="cb1-232">    plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Component Weights'</span>)</span>
<span id="cb1-233">    plt.tight_layout()</span>
<span id="cb1-234">    plt.savefig(os.path.join(figs_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'component_weights.png'</span>), dpi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-235">    plt.close()</span>
<span id="cb1-236"></span>
<span id="cb1-237">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Time loadings across components</span></span>
<span id="cb1-238">    plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-239">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(time_factors.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]):</span>
<span id="cb1-240">        plt.plot(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, time_factors.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb1-241">                time_factors.iloc[:, k], marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'o'</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'C</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb1-242">    plt.xticks(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, time_factors.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-243">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Timepoint'</span>)</span>
<span id="cb1-244">    plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Loading'</span>)</span>
<span id="cb1-245">    plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time Loadings by Component'</span>)</span>
<span id="cb1-246">    plt.legend(ncols<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, fontsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb1-247">    plt.tight_layout()</span>
<span id="cb1-248">    plt.savefig(os.path.join(figs_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'time_loadings.png'</span>), dpi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-249">    plt.close()</span>
<span id="cb1-250"></span>
<span id="cb1-251">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sample loadings colored by species</span></span>
<span id="cb1-252">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb1-253">    species_colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'apul'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'peve'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ptua'</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>}</span>
<span id="cb1-254">    </span>
<span id="cb1-255">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(sample_factors.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]):</span>
<span id="cb1-256">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, label <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(sample_labels):</span>
<span id="cb1-257">            species <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_metadata[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'species'</span>]</span>
<span id="cb1-258">            ax.scatter(k, sample_factors.iloc[idx, k], </span>
<span id="cb1-259">                      c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>species_colors[species], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb1-260">    </span>
<span id="cb1-261">    ax.set_xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Component'</span>)</span>
<span id="cb1-262">    ax.set_ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sample Loading'</span>)</span>
<span id="cb1-263">    ax.set_title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sample Loadings by Component and Species'</span>)</span>
<span id="cb1-264">    </span>
<span id="cb1-265">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legend</span></span>
<span id="cb1-266">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Patch</span>
<span id="cb1-267">    legend_elements <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Patch(facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>species_colors[sp], label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sp) </span>
<span id="cb1-268">                      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'apul'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'peve'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ptua'</span>]]</span>
<span id="cb1-269">    ax.legend(handles<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legend_elements)</span>
<span id="cb1-270">    plt.tight_layout()</span>
<span id="cb1-271">    plt.savefig(os.path.join(figs_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sample_loadings.png'</span>), dpi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb1-272">    plt.close()</span>
<span id="cb1-273"></span>
<span id="cb1-274"></span>
<span id="cb1-275"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-276">    parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> argparse.ArgumentParser(</span>
<span id="cb1-277">        description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Build tensor (genes √ó timepoints √ó samples) and run Barnacle SparseCP'</span>)</span>
<span id="cb1-278">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--input-file'</span>, required<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb1-279">                       <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Path to merged vst_counts_matrix.csv file'</span>)</span>
<span id="cb1-280">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--output-dir'</span>, required<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, </span>
<span id="cb1-281">                       <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Output directory for results'</span>)</span>
<span id="cb1-282">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--rank'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-283">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--lambda-gene'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb1-284">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--lambda-time'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span>
<span id="cb1-285">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--lambda-sample'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb1-286">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--max-iter'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb1-287">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--tol'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>)</span>
<span id="cb1-288">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--seed'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb1-289">    args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parser.parse_args()</span>
<span id="cb1-290"></span>
<span id="cb1-291">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> os.path.exists(args.input_file):</span>
<span id="cb1-292">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">FileNotFoundError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Input file not found: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>args<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>input_file<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-293"></span>
<span id="cb1-294">    df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> read_normalized_csv(args.input_file)</span>
<span id="cb1-295">    tensor, sample_labels, sample_metadata, genes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> build_tensor_by_sample(</span>
<span id="cb1-296">        df, expected_timepoints<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>])</span>
<span id="cb1-297"></span>
<span id="cb1-298">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Tensor shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tensor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-299">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  Genes: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tensor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-300">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  Timepoints: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tensor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-301">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  Samples: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>tensor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-302"></span>
<span id="cb1-303">    model, decomposition <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run_sparse_cp(</span>
<span id="cb1-304">        tensor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tensor,</span>
<span id="cb1-305">        rank<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.rank,</span>
<span id="cb1-306">        lambda_gene<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.lambda_gene,</span>
<span id="cb1-307">        lambda_time<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.lambda_time,</span>
<span id="cb1-308">        lambda_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.lambda_sample,</span>
<span id="cb1-309">        max_iter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.max_iter,</span>
<span id="cb1-310">        tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.tol,</span>
<span id="cb1-311">        seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>args.seed,</span>
<span id="cb1-312">    )</span>
<span id="cb1-313"></span>
<span id="cb1-314">    save_outputs(args.output_dir, tensor, sample_labels, sample_metadata, </span>
<span id="cb1-315">                genes, model, decomposition)</span>
<span id="cb1-316"></span>
<span id="cb1-317"></span>
<span id="cb1-318"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'__main__'</span>:</span>
<span id="cb1-319">    main()</span></code></pre></div>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">Output</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.4     ‚úî purrr     1.1.0
‚úî forcats   1.0.1     ‚úî stringr   1.5.2
‚úî ggplot2   4.0.0     ‚úî tibble    3.3.0
‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">gene_csv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/50-tensor-alternative/barnacle_factors/gene_factors.csv"</span>,</span>
<span id="cb4-2">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace column names</span></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_csv) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OG_ID"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_csv)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">time_csv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/50-tensor-alternative/barnacle_factors/time_factors.csv"</span>,</span>
<span id="cb5-2">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace column names</span></span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(time_csv) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time_ID"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(time_csv)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Path to your CSV file</span></span>
<span id="cb6-2">sample_csv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/50-tensor-alternative/barnacle_factors/sample_factors.csv"</span>,</span>
<span id="cb6-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace column names</span></span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(sample_csv) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(sample_csv)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load required libraries</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb7-4"></span>
<span id="cb7-5"></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the first column row names</span></span>
<span id="cb7-8">df_mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sample_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(sample_csv)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional: scale rows or columns for better contrast</span></span>
<span id="cb7-13">df_scaled <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(df_mat)</span>
<span id="cb7-14"></span>
<span id="cb7-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot heatmap</span></span>
<span id="cb7-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(df_scaled,</span>
<span id="cb7-17">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick3"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb7-18">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb7-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-20">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_colnames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-21">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Heatmap of Samples vs Features"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pivot to long format for plotting</span></span>
<span id="cb8-4">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> time_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb8-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb8-9">  )</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line plot</span></span>
<span id="cb8-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> Component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Component)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span></span>
<span id="cb8-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Factor Loadings Across Components"</span>,</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb8-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loading Value"</span></span>
<span id="cb8-24">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb9-2"></span>
<span id="cb9-3"></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute variance of each component across timepoints</span></span>
<span id="cb9-6">var_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> time_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb9-8">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb9-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Component) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Variance))</span>
<span id="cb9-13"></span>
<span id="cb9-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select top 10 most variable components</span></span>
<span id="cb9-15">top10_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_components <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(Variance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(Component)</span>
<span id="cb9-16"></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare data for plotting</span></span>
<span id="cb9-18">time_csv_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> time_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb9-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb9-21">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> top10_components)</span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line plot</span></span>
<span id="cb9-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(time_csv_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> Component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Component)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb9-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Top 10 Most Variable Components Across Timepoints"</span>,</span>
<span id="cb9-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb9-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component Value"</span></span>
<span id="cb9-34">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb10-2"></span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- USER INPUT ----</span></span>
<span id="cb10-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick the component you want to plot (e.g., "Component_5")</span></span>
<span id="cb10-6">selected_component <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_5"</span></span>
<span id="cb10-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------</span></span>
<span id="cb10-8"></span>
<span id="cb10-9"></span>
<span id="cb10-10"></span>
<span id="cb10-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to long format</span></span>
<span id="cb10-12">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> time_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb10-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb10-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb10-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb10-17">  )</span>
<span id="cb10-18"></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check that the chosen component exists</span></span>
<span id="cb10-20"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(selected_component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(df_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Component))) {</span>
<span id="cb10-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>, selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not found in data!"</span>))</span>
<span id="cb10-22">}</span>
<span id="cb10-23"></span>
<span id="cb10-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the selected component</span></span>
<span id="cb10-25">df_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> selected_component)</span>
<span id="cb10-26"></span>
<span id="cb10-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot single component across timepoints</span></span>
<span id="cb10-28"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_sel, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Time_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb10-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Across Timepoints"</span>),</span>
<span id="cb10-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb10-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loading Value"</span></span>
<span id="cb10-37">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb11-3"></span>
<span id="cb11-4"></span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to matrix (remove OG_ID column)</span></span>
<span id="cb11-7">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OG_ID"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb11-10"></span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional: scale rows (genes) so colors represent relative loadings per gene</span></span>
<span id="cb11-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb11-14">  mat,</span>
<span id="cb11-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"row"</span>,</span>
<span id="cb11-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick3"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),</span>
<span id="cb11-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb11-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb11-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Factor Loadings (All Components)"</span></span>
<span id="cb11-20">)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb12-3"></span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to numeric matrix</span></span>
<span id="cb12-6">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_csv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"OG_ID"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb12-9"></span>
<span id="cb12-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heatmap of actual (unscaled) values</span></span>
<span id="cb12-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb12-12">  mat,</span>
<span id="cb12-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do not scale</span></span>
<span id="cb12-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick3"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb12-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb12-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb12-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Factor Loadings (Actual Values)"</span></span>
<span id="cb12-18">)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="more-lamda-testing" class="level2">
<h2 class="anchored" data-anchor-id="more-lamda-testing">More lamda testing</h2>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDAS_GENE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.00 0.1 0.2 0.4 0.8 1.0 10 40 100 1000"</span></span>
<span id="cb13-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_SAMPLE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.1</span>
<span id="cb13-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_TIME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.05</span>
<span id="cb13-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RANK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>35</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/40-rank35-optimization</span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR_BASE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>../output/40-rank35-optimization</span>
<span id="cb13-9"></span>
<span id="cb13-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> LG <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDAS_GENE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-11">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTDIR_BASE}</span>/lambda_gene_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${LG}</span></span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-13"></span>
<span id="cb13-14">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">uv</span> run python ../scripts/14.1-barnacle/build_tensor_and_run.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--input-file</span> ../output/14-pca-orthologs/vst_counts_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output-dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rank</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$RANK</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-gene</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-sample</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_SAMPLE</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-time</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_TIME</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-iter</span> 1000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tol</span> 1e-5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seed</span> 92</span>
<span id="cb13-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb14-2"></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SETTINGS</span></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-6"></span>
<span id="cb14-7">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization"</span></span>
<span id="cb14-8"></span>
<span id="cb14-9">lambda_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.00"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.2"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.4"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.8"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.0"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1000"</span>)</span>
<span id="cb14-10"></span>
<span id="cb14-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FUNCTION: read gene_factors.csv AND FIX HEADER</span></span>
<span id="cb14-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-14">read_gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(lambda) {</span>
<span id="cb14-15">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s/lambda_gene_%s/barnacle_factors/gene_factors.csv"</span>,</span>
<span id="cb14-16">                 base_url, lambda)</span>
<span id="cb14-17"></span>
<span id="cb14-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Reading: "</span>, url)</span>
<span id="cb14-19">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb14-20"></span>
<span id="cb14-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fix the shifted header here</span></span>
<span id="cb14-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First column should be "gene", others "comp1..compN"</span></span>
<span id="cb14-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(df)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb14-24"></span>
<span id="cb14-25">  df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lambda_gene <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lambda</span>
<span id="cb14-26">  df</span>
<span id="cb14-27">}</span>
<span id="cb14-28"></span>
<span id="cb14-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># READ ALL RUNS</span></span>
<span id="cb14-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-32">all_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(lambda_vals, read_gene_factors)</span>
<span id="cb14-33"></span>
<span id="cb14-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LONG FORMAT FOR ANALYSIS</span></span>
<span id="cb14-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------</span></span>
<span id="cb14-37">factor_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb14-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>),</span>
<span id="cb14-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>,</span>
<span id="cb14-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span></span>
<span id="cb14-42">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">sparsity_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> factor_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb15-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb15-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_zero =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(loading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(loading) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-12</span>),</span>
<span id="cb15-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sparsity =</span> n_zero <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_values</span>
<span id="cb15-7">  )</span>
<span id="cb15-8"></span>
<span id="cb15-9">sparsity_tbl </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 4
   lambda_gene n_values n_zero sparsity
   &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1 0.00          343000   1738  0.00507
 2 0.1           343000   1984  0.00578
 3 0.2           343000   2396  0.00699
 4 0.4           343000   2209  0.00644
 5 0.8           343000   3060  0.00892
 6 1.0           343000   3079  0.00898
 7 10            343000  25244  0.0736 
 8 100           343000 274854  0.801  
 9 1000          343000 333200  0.971  
10 40            343000 201967  0.589  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">gene_component_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> factor_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(loading <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene, gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb17-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb17-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_components =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(component),</span>
<span id="cb17-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb17-7">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">multi_component_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_component_counts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene, n_components) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span>)</span>
<span id="cb18-4"></span>
<span id="cb18-5">multi_component_summary</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 √ó 3
   lambda_gene n_components n_genes
   &lt;chr&gt;              &lt;int&gt;   &lt;int&gt;
 1 0.00                  27       1
 2 0.00                  28       1
 3 0.00                  29       5
 4 0.00                  30       6
 5 0.00                  31      23
 6 0.00                  32      75
 7 0.00                  33     205
 8 0.00                  34     936
 9 0.00                  35    8548
10 0.1                   28       1
# ‚Ñπ 65 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">summary_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sparsity_tbl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb20-3">    gene_component_counts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-4">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lambda_gene) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-5">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(</span>
<span id="cb20-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_components =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(n_components),</span>
<span id="cb20-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frac_multi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(n_components <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb20-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb20-9">      ),</span>
<span id="cb20-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lambda_gene"</span></span>
<span id="cb20-11">  )</span>
<span id="cb20-12"></span>
<span id="cb20-13">summary_tbl</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 √ó 6
   lambda_gene n_values n_zero sparsity mean_components frac_multi
   &lt;chr&gt;          &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;           &lt;dbl&gt;      &lt;dbl&gt;
 1 0.00          343000   1738  0.00507           34.8           1
 2 0.1           343000   1984  0.00578           34.8           1
 3 0.2           343000   2396  0.00699           34.8           1
 4 0.4           343000   2209  0.00644           34.8           1
 5 0.8           343000   3060  0.00892           34.7           1
 6 1.0           343000   3079  0.00898           34.7           1
 7 10            343000  25244  0.0736            32.4           1
 8 100           343000 274854  0.801              6.95          1
 9 1000          343000 333200  0.971              1             0
10 40            343000 201967  0.589             14.4           1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb22-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_0.00/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb22-3"></span>
<span id="cb22-4"></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb22-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb22-7"></span>
<span id="cb22-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb22-9">  </span>
<span id="cb22-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb22-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb22-12">  </span>
<span id="cb22-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb22-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb22-16">  </span>
<span id="cb22-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb22-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb22-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb22-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb22-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb23-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_0.1/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb23-3"></span>
<span id="cb23-4"></span>
<span id="cb23-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb23-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb23-7"></span>
<span id="cb23-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb23-9">  </span>
<span id="cb23-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb23-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb23-12">  </span>
<span id="cb23-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb23-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb23-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb23-16">  </span>
<span id="cb23-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb23-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb23-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb23-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb23-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb24-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_0.2/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb24-3"></span>
<span id="cb24-4"></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb24-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb24-7"></span>
<span id="cb24-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb24-9">  </span>
<span id="cb24-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb24-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb24-12">  </span>
<span id="cb24-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb24-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb24-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb24-16">  </span>
<span id="cb24-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb24-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb24-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb24-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb25-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_0.4/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb25-3"></span>
<span id="cb25-4"></span>
<span id="cb25-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb25-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb25-7"></span>
<span id="cb25-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb25-9">  </span>
<span id="cb25-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb25-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb25-12">  </span>
<span id="cb25-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb25-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb25-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb25-16">  </span>
<span id="cb25-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb25-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb25-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb25-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb26-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_0.8/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb26-3"></span>
<span id="cb26-4"></span>
<span id="cb26-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb26-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb26-7"></span>
<span id="cb26-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb26-9">  </span>
<span id="cb26-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb26-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb26-12">  </span>
<span id="cb26-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb26-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb26-16">  </span>
<span id="cb26-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb26-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb26-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb26-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb26-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb27-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_1.0/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb27-3"></span>
<span id="cb27-4"></span>
<span id="cb27-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb27-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb27-7"></span>
<span id="cb27-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb27-9">  </span>
<span id="cb27-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb27-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb27-12">  </span>
<span id="cb27-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb27-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb27-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb27-16">  </span>
<span id="cb27-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb27-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb27-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb27-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb27-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb28-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_10/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb28-3"></span>
<span id="cb28-4"></span>
<span id="cb28-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb28-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb28-7"></span>
<span id="cb28-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb28-9">  </span>
<span id="cb28-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb28-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb28-12">  </span>
<span id="cb28-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb28-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb28-16">  </span>
<span id="cb28-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb28-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb28-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb28-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb29-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_40/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb29-3"></span>
<span id="cb29-4"></span>
<span id="cb29-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb29-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb29-7"></span>
<span id="cb29-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb29-9">  </span>
<span id="cb29-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb29-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb29-12">  </span>
<span id="cb29-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb29-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb29-16">  </span>
<span id="cb29-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb29-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb29-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb29-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb30-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_100/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb30-3"></span>
<span id="cb30-4"></span>
<span id="cb30-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb30-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb30-7"></span>
<span id="cb30-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb30-9">  </span>
<span id="cb30-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb30-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb30-12">  </span>
<span id="cb30-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb30-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb30-16">  </span>
<span id="cb30-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb30-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb30-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb30-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb30-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb31-2">  gene_factors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/output/40-rank35-optimization/lambda_gene_1000/barnacle_factors/gene_factors.csv"</span>)</span>
<span id="cb31-3"></span>
<span id="cb31-4"></span>
<span id="cb31-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#edit so columns names are shifted 1 to the left</span></span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_factors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"comp"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ncol</span>(gene_factors)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb31-7"></span>
<span id="cb31-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#code to create histogram of gene_factors:</span></span>
<span id="cb31-9">  </span>
<span id="cb31-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb31-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb31-12">  </span>
<span id="cb31-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reshape data to long format </span></span>
<span id="cb31-14">  gene_factors_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gene_factors <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"component"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"loading"</span>)</span>
<span id="cb31-16">  </span>
<span id="cb31-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot histogram</span></span>
<span id="cb31-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(gene_factors_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> loading)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bins =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distribution of Gene Loadings for Rank 35 Components"</span>,</span>
<span id="cb31-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene Loading"</span>,</span>
<span id="cb31-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Count"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://sr320.github.io/tumbling-oysters/posts/64-barnacle/index_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/64-barnacle/</guid>
  <pubDate>Sat, 29 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_15-34-25.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Calcifying Contra</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/63-contra/</link>
  <description><![CDATA[ 





<p>First off in time-series-calcification</p>
<p>https://github.com/urol-e5/timeseries-molecular-calcification/blob/main/M-multi-species/scripts/34-biomin-pathway-compare.rmd</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-22-16.png" class="img-fluid"> <img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-23-06.png" class="img-fluid" alt="ortho-spread"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-23-48.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/000010.png" class="img-fluid" alt="genelevel"> <img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-25-38.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-26-36.png" class="img-fluid"></p>
<section id="contra" class="level1">
<h1>Contra</h1>
<p>Then took onto ConTra‚Ä¶ with new script</p>
<pre><code>Duro:ConTra sr320$ python3 code/run_biomin_species_comparison.py                                         ======================================================================
üß¨ CROSS-SPECIES BIOMIN CONTEXT-DEPENDENT ANALYSIS
======================================================================
Workspace: /Users/sr320/GitHub/ConTra
Comparison output: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251129_144655
======================================================================</code></pre>
<pre><code> Using context_dependent_analysis_20251129_192544 for apul
  Using context_dependent_analysis_20251129_162258 for peve
  Using context_dependent_analysis_20251129_144655 for ptua

============================================================
LOADING SPECIES RESULTS
============================================================

üìÇ Loading A. pulchra...
  ‚úÖ Loaded methylation_mirna_context.csv: 33270 rows

üìÇ Loading P. evermanni...
  ‚úÖ Loaded methylation_mirna_context.csv: 27150 rows

üìÇ Loading P. tuahiniensis...
  ‚úÖ Loaded methylation_mirna_context.csv: 51150 rows

============================================================
COMPARING METHYLATION-MIRNA CONTEXT ACROSS SPECIES
============================================================

üìä Summary:
  Total unique OGs across all species: 611
  OGs in 2+ species: 358
  OGs in all 3 species: 100

‚úÖ Saved comparison table: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/cross_species_methylation_mirna_comparison.csv

üèÜ Top 15 Conserved Context-Dependent OGs (in 2+ species):
   og_id  n_species  mean_context_strength  apul_context_strength  peve_context_strength  ptua_context_strength
OG_01155          3               1.310726               1.521005               0.996267               1.414906
OG_02619          3               1.295301               1.468612               1.024492               1.392800
OG_06119          3               1.236816               0.971755               1.252635               1.486059
OG_08793          3               1.236346               0.808764               1.450764               1.449511
OG_05366          3               1.199557               0.939276               1.174450               1.484946
OG_03291          3               1.199266               1.186752               0.799569               1.611478
OG_05637          3               1.192262               1.166134               1.165108               1.245543
OG_01452          3               1.191146               1.526632               0.922735               1.124072
OG_07153          3               1.174770               0.979025               1.358085               1.187201
OG_01414          3               1.161650               1.680689               0.775683               1.028577
OG_01753          3               1.160818               1.140792               1.097454               1.244207
OG_08663          3               1.138407               0.935220               1.247335               1.232668
OG_09796          3               1.133137               1.016265               1.074893               1.308253
OG_04467          3               1.121429               1.075908               1.254588               1.033790
OG_07892          3               1.113713               1.090661               0.877698               1.372780

============================================================
GENERATING VISUALIZATIONS
============================================================
/Users/sr320/GitHub/ConTra/code/run_biomin_species_comparison.py:397: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.violinplot(data=strength_df, x='species', y='context_strength',
‚úÖ Saved comparison plots: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/plots/species_comparison_overview.png
‚úÖ Saved comparison report: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/cross_species_comparison_report.md

======================================================================
üéâ CROSS-SPECIES COMPARISON COMPLETE!
======================================================================
Results saved to: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506
======================================================================</code></pre>
<section id="what-the-script-does" class="level2">
<h2 class="anchored" data-anchor-id="what-the-script-does"><strong>What the script does:</strong></h2>
<ol type="1">
<li><p><strong>Runs analysis on all 3 species</strong> in <a href="vscode-file://vscode-app/Applications/Visual Studio Code.app/Contents/Resources/app/out/vs/code/electron-browser/workbench/workbench.html">full-species-biomin</a>:</p>
<ul>
<li><p>A. pulchra (apul)</p></li>
<li><p>P. evermanni (peve)</p></li>
<li><p>P. tuahiniensis (ptua)</p></li>
</ul></li>
<li><p><strong>Extracts OG IDs</strong> from the results using regex to parse formats like:</p>
<ul>
<li><p><code>"('OG_13910', 'FUN_002435')"</code></p></li>
<li><p><code>OG_13910</code></p></li>
</ul></li>
<li><p><strong>Compares results across species</strong>:</p>
<ul>
<li><p>Finds OGs present in 2+ species</p></li>
<li><p>Ranks by conservation and context strength</p></li>
<li><p>Calculates correlations between species</p></li>
</ul></li>
<li><p><strong>Generates outputs</strong>:</p>
<ul>
<li><p><code>cross_species_methylation_mirna_comparison.csv</code> - Full comparison table</p></li>
<li><p><code>plots/species_comparison_overview.png</code> - 4-panel visualization</p></li>
<li><p><code>cross_species_comparison_report.md</code> - Summary report</p></li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="cross-species-biomin-context-dependent-analysis-comparison" class="level1">
<h1>Cross-Species Biomin Context-Dependent Analysis Comparison</h1>
<p><strong>Generated:</strong> 2025-11-30 05:25:07</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This report compares context-dependent regulatory interactions across three coral species:</p>
<ul>
<li><strong>A. pulchra</strong> (<code>apul</code>)</li>
<li><strong>P. evermanni</strong> (<code>peve</code>)</li>
<li><strong>P. tuahiniensis</strong> (<code>ptua</code>)</li>
</ul>
</section>
<section id="per-species-summary" class="level2">
<h2 class="anchored" data-anchor-id="per-species-summary">Per-Species Summary</h2>
<section id="a.-pulchra-apul" class="level3">
<h3 class="anchored" data-anchor-id="a.-pulchra-apul">A. pulchra (apul)</h3>
<ul>
<li>Total methylation-miRNA interactions: 33270</li>
<li>Context-dependent interactions: 3039</li>
<li>Mean context strength: 0.311</li>
<li>Unique OGs: 334</li>
</ul>
</section>
<section id="p.-evermanni-peve" class="level3">
<h3 class="anchored" data-anchor-id="p.-evermanni-peve">P. evermanni (peve)</h3>
<ul>
<li>Total methylation-miRNA interactions: 27150</li>
<li>Context-dependent interactions: 3935</li>
<li>Mean context strength: 0.371</li>
<li>Unique OGs: 309</li>
</ul>
</section>
<section id="p.-tuahiniensis-ptua" class="level3">
<h3 class="anchored" data-anchor-id="p.-tuahiniensis-ptua">P. tuahiniensis (ptua)</h3>
<ul>
<li>Total methylation-miRNA interactions: 51150</li>
<li>Context-dependent interactions: 8765</li>
<li>Mean context strength: 0.346</li>
<li>Unique OGs: 474</li>
</ul>
</section>
</section>
<section id="cross-species-conservation" class="level2">
<h2 class="anchored" data-anchor-id="cross-species-conservation">Cross-Species Conservation</h2>
<ul>
<li><strong>Total unique OGs:</strong> 611</li>
<li><strong>OGs in 2+ species:</strong> 358 (58.6%)</li>
<li><strong>OGs in all 3 species:</strong> 100 (16.4%)</li>
</ul>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>OGs (orthologous groups) that show context-dependent regulation in multiple species suggest:</p>
<ol type="1">
<li><strong>Conserved regulatory mechanisms</strong> - These genes may have fundamental roles where regulation is evolutionarily maintained</li>
<li><strong>Robust biological signals</strong> - Conservation across species reduces the likelihood of false positives</li>
<li><strong>Candidates for functional validation</strong> - These genes are high-priority targets for experimental follow-up</li>
</ol>
</section>
<section id="files-generated" class="level2">
<h2 class="anchored" data-anchor-id="files-generated">Files Generated</h2>
<ul>
<li><code>cross_species_methylation_mirna_comparison.csv</code> - Full comparison table</li>
<li><code>plots/species_comparison_overview.png</code> - Visualization of cross-species patterns</li>
<li><code>cross_species_comparison_report.md</code> - This report</li>
</ul>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.4     ‚úî readr     2.1.5
‚úî forcats   1.0.1     ‚úî stringr   1.5.2
‚úî ggplot2   4.0.0     ‚úî tibble    3.3.0
‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1
‚úî purrr     1.1.0     
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(reactable)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(htmltools)</span>
<span id="cb5-3"></span>
<span id="cb5-4">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/biomin_comparison_20251130_052506/cross_species_methylation_mirna_comparison.csv"</span></span>
<span id="cb5-5">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Format all numeric columns to 2 digits after decimal</span></span>
<span id="cb5-8">df_fmt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%.2f"</span>, .x)))</span>
<span id="cb5-10"></span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactable</span>(</span>
<span id="cb5-12">  df_fmt,</span>
<span id="cb5-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">searchable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filterable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pagination =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">striped =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">defaultPageSize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb5-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sortable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> reactable<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactableTheme</span>(</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlightColor =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EAF2F8"</span></span>
<span id="cb5-22">  )</span>
<span id="cb5-23">)</span></code></pre></div>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-6eee9f36b732f7c305de" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6eee9f36b732f7c305de">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"og_id":["OG_01155","OG_02619","OG_06119","OG_08793","OG_05366","OG_03291","OG_05637","OG_01452","OG_07153","OG_01414","OG_01753","OG_08663","OG_09796","OG_04467","OG_07892","OG_07150","OG_02190","OG_00355","OG_06712","OG_08849","OG_09106","OG_08920","OG_08192","OG_06616","OG_04799","OG_09596","OG_01177","OG_09310","OG_05718","OG_01630","OG_06592","OG_10121","OG_03673","OG_01611","OG_07252","OG_10205","OG_09174","OG_06955","OG_01384","OG_03484","OG_00752","OG_03330","OG_08259","OG_06999","OG_00297","OG_04165","OG_03857","OG_02666","OG_07958","OG_05666","OG_06908","OG_06430","OG_07389","OG_07404","OG_07821","OG_00171","OG_03628","OG_02090","OG_08545","OG_02124","OG_08842","OG_06247","OG_08874","OG_09511","OG_06599","OG_01023","OG_09455","OG_01317","OG_04789","OG_03429","OG_02088","OG_05819","OG_04694","OG_08144","OG_05514","OG_05304","OG_10004","OG_10039","OG_00176","OG_03451","OG_04243","OG_00460","OG_06004","OG_06655","OG_00378","OG_02176","OG_09024","OG_06775","OG_09003","OG_06198","OG_02317","OG_09423","OG_02148","OG_05952","OG_00466","OG_05856","OG_01748","OG_05713","OG_06875","OG_07042","OG_06610","OG_11813","OG_05250","OG_13910","OG_11360","OG_02000","OG_15303","OG_02408","OG_05303","OG_10758","OG_14180","OG_02537","OG_14711","OG_15374","OG_10515","OG_05010","OG_14803","OG_16627","OG_13792","OG_12611","OG_06152","OG_06998","OG_04756","OG_00643","OG_11957","OG_10472","OG_11234","OG_02163","OG_02220","OG_18223","OG_16000","OG_09598","OG_01121","OG_12050","OG_08331","OG_13882","OG_05749","OG_12722","OG_02186","OG_14612","OG_15877","OG_13886","OG_00842","OG_08528","OG_07508","OG_14257","OG_05717","OG_12990","OG_10936","OG_00807","OG_07620","OG_10522","OG_15086","OG_08622","OG_06279","OG_14674","OG_13201","OG_18057","OG_14804","OG_14279","OG_14623","OG_13877","OG_03288","OG_11381","OG_17186","OG_04698","OG_14915","OG_08083","OG_04651","OG_18058","OG_06373","OG_04515","OG_08856","OG_12320","OG_05950","OG_10814","OG_11907","OG_14262","OG_15009","OG_05498","OG_13451","OG_10251","OG_16489","OG_04327","OG_16307","OG_11964","OG_16092","OG_02012","OG_12880","OG_15020","OG_09897","OG_06719","OG_08145","OG_14322","OG_06158","OG_15375","OG_17157","OG_11984","OG_16573","OG_08768","OG_12878","OG_02184","OG_08878","OG_03856","OG_10811","OG_14140","OG_15087","OG_04723","OG_12805","OG_01117","OG_13197","OG_01147","OG_14037","OG_00514","OG_13016","OG_01353","OG_07641","OG_01608","OG_08497","OG_12646","OG_14189","OG_18262","OG_08432","OG_07531","OG_00246","OG_13026","OG_03269","OG_06717","OG_07183","OG_08096","OG_14382","OG_11852","OG_06754","OG_14540","OG_11839","OG_17479","OG_13154","OG_13050","OG_14563","OG_18258","OG_10109","OG_14793","OG_14500","OG_17098","OG_14615","OG_08639","OG_01579","OG_06234","OG_00510","OG_14206","OG_01724","OG_11359","OG_01475","OG_15334","OG_11833","OG_11642","OG_09986","OG_11019","OG_08717","OG_06711","OG_15550","OG_15459","OG_03289","OG_01781","OG_10988","OG_17286","OG_02102","OG_11870","OG_03671","OG_08658","OG_13066","OG_05087","OG_01758","OG_10055","OG_14038","OG_10759","OG_11084","OG_10675","OG_16539","OG_04209","OG_02924","OG_11307","OG_16856","OG_04115","OG_16980","OG_00572","OG_14627","OG_06101","OG_01354","OG_11423","OG_13916","OG_09657","OG_18229","OG_03267","OG_06181","OG_03850","OG_00030","OG_12318","OG_05121","OG_16011","OG_14276","OG_04443","OG_16192","OG_14710","OG_03626","OG_06931","OG_15383","OG_10938","OG_10367","OG_14505","OG_06954","OG_10579","OG_02690","OG_00632","OG_01999","OG_01223","OG_01312","OG_06922","OG_08077","OG_12248","OG_12286","OG_09487","OG_12683","OG_14094","OG_16585","OG_12888","OG_14380","OG_16862","OG_17751","OG_17245","OG_16158","OG_14626","OG_09424","OG_12162","OG_04537","OG_03298","OG_17389","OG_01489","OG_16209","OG_14100","OG_08271","OG_15312","OG_06670","OG_12166","OG_16592","OG_09806","OG_05568","OG_11983","OG_08143","OG_07772","OG_02358","OG_07000","OG_17015","OG_12165","OG_00298","OG_03780","OG_17012","OG_13428","OG_07265","OG_14547","OG_10509","OG_12496","OG_12612","OG_12102","OG_12406","OG_12447","OG_12616","OG_16747","OG_15816","OG_16145","OG_13032","OG_10818","OG_17106","OG_10355","OG_14588","OG_08347","OG_11365","OG_11379","OG_14381","OG_11429","OG_04247","OG_11038","OG_09969","OG_13481","OG_10838","OG_10516","OG_16122","OG_10008","OG_09896","OG_12125","OG_10480","OG_10183","OG_10937","OG_13239","OG_10520","OG_12785","OG_11156","OG_10267","OG_00843","OG_16469","OG_03268","OG_11653","OG_11292","OG_12007","OG_17347","OG_10475","OG_13033","OG_14685","OG_15544","OG_15070","OG_13684","OG_11794","OG_15594","OG_16944","OG_10007","OG_00314","OG_16389","OG_12331","OG_18159","OG_12475","OG_05210","OG_15754","OG_15604","OG_13091","OG_15021","OG_14455","OG_15551","OG_09597","OG_09942","OG_15648","OG_13215","OG_04331","OG_11380","OG_16359","OG_16883","OG_07394","OG_16383","OG_17150","OG_07331","OG_10002","OG_15121","OG_14681","OG_15644","OG_12476","OG_16485","OG_13465","OG_12107","OG_10523","OG_06236","OG_12371","OG_16279","OG_13466","OG_17806","OG_04514","OG_15815","OG_12032","OG_12046","OG_11420","OG_15089","OG_12647","OG_10681","OG_14790","OG_01568","OG_16544","OG_14407","OG_13013","OG_11899","OG_15906","OG_12242","OG_17596","OG_11017","OG_02070","OG_15796","OG_07807","OG_02146","OG_11541","OG_14066","OG_06384","OG_15137","OG_07330","OG_03270","OG_02439","OG_13149","OG_01486","OG_12844","OG_01747","OG_00305","OG_00430","OG_12160","OG_11171","OG_17591","OG_00302","OG_14514","OG_12108","OG_13484","OG_12889","OG_10907","OG_17285","OG_12019","OG_10815","OG_18263","OG_15682","OG_02316","OG_17600","OG_14012","OG_17045","OG_04538","OG_14792","OG_10584","OG_13190","OG_05875","OG_12952","OG_17058","OG_02967","OG_14994","OG_15060","OG_11215","OG_13059","OG_05874","OG_11296","OG_17533","OG_16586","OG_01981","OG_05308","OG_04238","OG_17027","OG_15617","OG_15140","OG_17497","OG_11831","OG_17666","OG_09638","OG_13153","OG_12163","OG_17646","OG_02260","OG_11245","OG_13191","OG_18275","OG_16159","OG_17124","OG_10274","OG_07822","OG_11291","OG_13685","OG_14408","OG_15831","OG_13594","OG_13211","OG_11419","OG_10450","OG_10265","OG_13031","OG_01277","OG_14889","OG_12109","OG_18078","OG_11644","OG_18224","OG_14156","OG_12424","OG_14158","OG_04560","OG_18118","OG_16654","OG_12568","OG_17739","OG_12518","OG_02935","OG_15759","OG_16380","OG_12837","OG_18325","OG_17961","OG_13334","OG_15462","OG_01727","OG_12927","OG_15208","OG_12972","OG_10812","OG_09486","OG_11762","OG_07836","OG_17800","OG_02149","OG_10525","OG_16879","OG_08914","OG_02219","OG_17222","OG_17483","OG_10350","OG_04547","OG_06607","OG_17176","OG_12560","OG_17014","OG_18285","OG_16707","OG_16139","OG_16270","OG_05228","OG_16789","OG_05367","OG_11812","OG_11074","OG_12645","OG_16665","OG_17453","OG_14295"],"n_species":["3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"apul_context_strength":["1.52","1.47","0.97","0.81","0.94","1.19","1.17","1.53","0.98","1.68","1.14","0.94","1.02","1.08","1.09","0.80","1.23","1.06","1.35","1.01","0.68","1.77","0.98","0.70","0.97","0.98","1.18","0.89","0.84","0.75","0.97","1.30","1.30","1.26","1.21","1.17","0.48","0.91","1.07","1.03","0.70","1.11","0.61","0.98","0.80","0.90","0.95","0.39","0.81","0.70","0.68","1.04","1.02","0.85","0.60","0.77","0.98","1.30","0.72","0.73","0.97","0.57","0.99","0.93","0.67","0.80","1.26","0.98","0.69","0.40","0.89","0.91","1.03","0.94","0.81","1.13","0.87","0.89","0.26","1.05","0.64","0.72","0.90","0.89","0.51","1.06","0.92","0.64","0.95","0.91","0.99","0.62","0.72","0.55","0.33","0.73","0.67","0.42","0.40","0.59","1.27","NA","1.38","1.56","NA","NA","1.58","1.18","0.92","NA","1.45","1.81","1.01","1.14","NA","1.15","1.34","1.29","1.15","NA","1.02","NA","1.31","1.19","NA","NA","NA","0.88","1.01","1.37","1.19","NA","1.51","NA","0.88","1.18","1.13","NA","NA","1.20","1.24","1.05","0.83","1.11","0.85","0.96","NA","NA","NA","NA","NA","NA","1.19","1.49","NA","1.17","NA","1.02","1.56","1.27","1.29","1.02","0.82","NA","1.19","NA","1.21","1.30","0.73","1.05","1.17","1.42","1.19","NA","1.03","NA","NA","1.16","0.97","1.09","NA","0.88","1.13","NA","1.08","NA","0.96","NA","NA","0.87","0.85","NA","1.36","1.13","1.25","0.99","1.05","NA","0.96","1.15","NA","0.94","1.29","0.85","NA","0.86","0.69","1.60","NA","0.53","NA","NA","0.73","1.05","NA","NA","1.15","1.20","0.99","NA","0.91","0.85","NA","0.86","NA","NA","0.66","1.20","NA","0.76","0.66","NA","1.00","0.88","NA","0.85","NA","NA","1.20","1.25","1.11","1.19","1.08","1.25","1.39","0.95","0.92","0.62","0.87","0.79","0.51","NA","0.75","0.75","NA","NA","NA","NA","0.91","0.51","1.05","0.64","NA","NA","NA","0.69","0.74","NA","0.94","NA","NA","0.60","0.82","0.67","0.79","NA","NA","NA","0.57","0.62","1.05","NA","0.85","NA","0.97","0.99","0.84","NA","1.11","NA","0.91","0.93","0.54","NA","1.26","0.57","NA","NA","NA","1.39","0.58","0.61","1.26","0.78","NA","0.93","0.46","NA","NA","0.98","0.92","NA","0.49","0.50","0.89","0.90","0.76","NA","0.75","NA","NA","0.64","NA","0.77","0.90","NA","0.70","0.77","0.92","0.46","0.65","1.03","0.69","NA","0.57","0.42","0.60","0.84","0.73","0.29","NA","0.65","NA","NA","0.77","0.49","0.72","NA","0.55","0.61","0.42","0.40","0.57","NA","0.53","0.10","0.95","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.48","1.47","1.44","NA","NA","1.40","NA","NA","NA","NA","NA","NA","NA","1.37","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.30","NA","NA","NA","NA","1.28","NA","NA","NA","NA","NA","NA","NA","1.24","1.24","NA","NA","1.23","NA","1.23","NA","NA","1.21","1.21","NA","1.21","NA","NA","NA","NA","1.20","NA","NA","NA","NA","1.19","NA","1.19","1.18","NA","NA","NA","NA","1.16","NA","1.16","NA","NA","NA","NA","NA","1.14","NA","NA","1.14","1.13","NA","NA","NA","1.13","NA","NA","NA","NA","1.11","NA","NA","NA","1.10","NA","1.09","NA","NA","1.08","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.02","NA","NA","1.01","1.01","NA","1.01","1.01","1.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.97","0.97","0.96","NA","NA","0.96","0.96","NA","0.96","NA","0.95","NA","NA","NA","0.94","0.94","NA","NA","0.93","NA","NA","NA","0.92","NA","NA","NA","NA","NA","NA","NA","NA","0.88","NA","NA","NA","NA","NA","NA","0.83","NA","NA","NA","NA","0.81","0.81","NA","0.80","NA","NA","NA","NA","NA","NA","0.72","NA","NA","NA","NA","0.70","NA","NA","0.66","NA","NA","0.64","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.51","0.51","NA","0.51","NA","NA","0.48","NA","NA","NA","NA","0.32","0.27","0.14"],"apul_context_dependent":[false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,true,true,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,true,null,false,false,null,null,false,false,false,null,true,true,false,false,null,false,true,false,false,null,false,null,false,false,null,null,null,false,false,true,false,null,false,null,true,true,false,null,null,true,false,false,false,false,false,false,null,null,null,null,null,null,true,false,null,false,null,false,false,false,false,false,false,null,false,null,false,false,false,false,false,false,false,null,false,null,null,true,false,false,null,false,false,null,false,null,false,null,null,false,false,null,false,false,false,false,false,null,false,false,null,false,false,false,null,true,false,true,null,false,null,null,false,false,null,null,false,false,false,null,false,true,null,false,null,null,true,false,null,false,false,null,false,false,null,false,null,null,true,false,true,false,false,false,false,false,false,false,false,false,false,null,false,false,null,null,null,null,false,false,false,false,null,null,null,false,false,null,false,null,null,false,false,false,true,null,null,null,false,false,true,null,false,null,true,false,false,null,false,null,false,false,false,null,false,false,null,null,null,true,false,false,false,false,null,false,false,null,null,false,false,null,false,false,false,false,false,null,false,null,null,false,null,false,false,null,false,false,false,true,false,false,false,null,false,false,false,false,false,false,null,false,null,null,false,false,false,null,false,false,false,false,false,null,false,false,false,null,null,null,null,null,null,null,null,null,null,false,false,true,null,null,true,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,false,null,null,null,null,null,null,null,false,false,null,null,false,null,false,null,null,true,false,null,false,null,null,null,null,false,null,null,null,null,false,null,false,false,null,null,null,null,true,null,false,null,null,null,null,null,true,null,null,false,false,null,null,null,false,null,null,null,null,false,null,null,null,false,null,true,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,null,null,true,true,null,false,false,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,false,false,null,null,false,false,null,false,null,false,null,null,null,false,false,null,null,false,null,null,null,false,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,false,null,null,null,null,true,false,null,true,null,null,null,null,null,null,false,null,null,null,null,false,null,null,false,null,null,false,null,null,false,null,null,null,null,null,null,null,null,null,false,false,null,false,null,null,false,null,null,null,null,false,true,true],"apul_improvement":["0.05","0.00","0.01","0.01","0.02","0.01","0.00","0.26","0.00","0.02","0.03","0.01","0.01","0.00","0.01","0.00","0.06","0.00","0.03","0.00","0.01","0.02","0.01","0.17","0.00","0.01","0.00","0.00","0.00","0.01","0.04","0.08","0.00","0.05","0.00","0.06","0.00","0.04","0.01","0.04","0.04","0.01","0.00","0.00","0.03","0.00","0.00","0.07","0.02","0.01","0.03","0.11","0.00","0.04","0.00","0.02","0.00","0.00","0.00","0.05","0.01","0.01","0.04","0.00","0.03","0.00","0.01","0.06","0.00","0.01","0.08","0.02","0.01","0.04","0.01","0.00","0.02","0.00","0.00","0.00","0.13","0.08","0.01","0.00","0.00","0.01","0.05","0.01","0.00","0.00","0.03","0.00","0.08","0.00","0.00","0.01","0.00","0.00","0.01","0.00","0.09","NA","0.01","0.00","NA","NA","0.00","0.00","0.04","NA","0.10","0.04","0.00","0.01","NA","0.00","0.05","0.00","0.01","NA","0.00","NA","0.01","0.00","NA","NA","NA","0.00","0.02","0.07","0.01","NA","0.02","NA","0.08","0.15","0.00","NA","NA","0.15","0.04","0.03","0.05","0.02","0.01","0.03","NA","NA","NA","NA","NA","NA","0.09","0.03","NA","0.00","NA","0.01","0.00","0.01","0.01","0.00","0.01","NA","0.02","NA","0.00","0.00","0.03","0.01","0.00","0.04","0.01","NA","0.00","NA","NA","0.07","0.02","0.02","NA","0.00","0.00","NA","0.00","NA","0.01","NA","NA","0.00","0.00","NA","0.05","0.00","0.01","0.01","0.01","NA","0.00","0.00","NA","0.00","0.01","0.05","NA","0.06","0.00","0.13","NA","0.03","NA","NA","0.03","0.00","NA","NA","0.00","0.01","0.00","NA","0.05","0.09","NA","0.01","NA","NA","0.09","0.00","NA","0.01","0.06","NA","0.02","0.00","NA","0.03","NA","NA","0.05","0.02","0.03","0.03","0.01","0.00","0.01","0.04","0.02","0.02","0.00","0.04","0.01","NA","0.01","0.02","NA","NA","NA","NA","0.00","0.00","0.01","0.00","NA","NA","NA","0.00","0.01","NA","0.00","NA","NA","0.00","0.01","0.01","0.08","NA","NA","NA","0.00","0.00","0.04","NA","0.00","NA","0.02","0.00","0.01","NA","0.01","NA","0.01","0.00","0.06","NA","0.01","0.01","NA","NA","NA","0.04","0.00","0.01","0.00","0.00","NA","0.03","0.00","NA","NA","0.01","0.03","NA","0.01","0.01","0.01","0.04","0.00","NA","0.03","NA","NA","0.02","NA","0.01","0.00","NA","0.01","0.02","0.00","0.06","0.00","0.01","0.02","NA","0.01","0.05","0.04","0.02","0.02","0.00","NA","0.00","NA","NA","0.00","0.00","0.00","NA","0.00","0.00","0.00","0.02","0.00","NA","0.01","0.02","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.02","0.01","0.10","NA","NA","0.06","NA","NA","NA","NA","NA","NA","NA","0.03","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.00","0.02","NA","NA","0.00","NA","0.00","NA","NA","0.10","0.01","NA","0.02","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.00","NA","0.02","0.04","NA","NA","NA","NA","0.05","NA","0.00","NA","NA","NA","NA","NA","0.05","NA","NA","0.00","0.00","NA","NA","NA","0.00","NA","NA","NA","NA","0.01","NA","NA","NA","0.00","NA","0.09","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.03","NA","NA","0.13","0.10","NA","0.00","0.00","0.07","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","0.00","0.00","NA","NA","0.00","0.01","NA","0.01","NA","0.01","NA","NA","NA","0.02","0.00","NA","NA","0.00","NA","NA","NA","0.02","NA","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","0.02","NA","NA","NA","NA","0.09","0.00","NA","0.10","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.00","NA","NA","0.00","NA","NA","0.00","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","0.06","NA","0.00","NA","NA","0.01","NA","NA","NA","NA","0.01","0.02","0.03"],"apul_r2":["0.55","0.60","0.56","0.62","0.50","0.71","0.56","0.66","0.58","0.52","0.69","0.75","0.59","0.52","0.48","0.69","0.70","0.52","0.68","0.68","0.42","0.57","0.48","0.70","0.62","0.48","0.81","0.73","0.58","0.65","0.73","0.80","0.70","0.64","0.63","0.76","0.63","0.54","0.48","0.65","0.51","0.72","0.55","0.59","0.47","0.69","0.54","0.62","0.56","0.47","0.55","0.52","0.50","0.64","0.54","0.46","0.53","0.61","0.41","0.50","0.68","0.56","0.58","0.49","0.53","0.56","0.56","0.66","0.46","0.49","0.68","0.51","0.56","0.53","0.45","0.61","0.58","0.45","0.60","0.53","0.68","0.53","0.61","0.66","0.60","0.66","0.46","0.43","0.43","0.51","0.50","0.48","0.55","0.88","0.51","0.49","0.50","0.47","0.46","0.44","0.47","NA","0.72","0.50","NA","NA","0.54","0.72","0.59","NA","0.79","0.77","0.68","0.64","NA","0.62","0.70","0.71","0.63","NA","0.59","NA","0.61","0.97","NA","NA","NA","0.46","0.55","0.58","0.58","NA","0.53","NA","0.56","0.60","0.67","NA","NA","0.60","0.62","0.52","0.56","0.55","0.48","0.70","NA","NA","NA","NA","NA","NA","0.59","0.58","NA","0.58","NA","0.78","0.72","0.52","0.53","0.69","0.57","NA","0.87","NA","0.88","0.44","0.48","0.66","0.50","0.52","0.67","NA","0.60","NA","NA","0.74","0.58","0.53","NA","0.78","0.63","NA","0.54","NA","0.51","NA","NA","0.51","0.63","NA","0.57","0.62","0.77","0.64","0.65","NA","0.55","0.71","NA","0.42","0.80","0.51","NA","0.83","0.60","0.55","NA","0.64","NA","NA","0.48","0.48","NA","NA","0.73","0.64","0.55","NA","0.63","0.54","NA","0.62","NA","NA","0.69","0.58","NA","0.69","0.54","NA","0.65","0.51","NA","0.52","NA","NA","0.68","0.62","0.83","0.68","0.57","0.62","0.59","0.49","0.50","0.76","0.56","0.65","0.90","NA","0.82","0.57","NA","NA","NA","NA","0.47","0.43","0.42","0.75","NA","NA","NA","0.58","0.49","NA","0.87","NA","NA","0.47","0.59","0.60","0.62","NA","NA","NA","0.51","0.48","0.72","NA","0.79","NA","0.93","0.55","0.67","NA","0.81","NA","0.52","0.54","0.52","NA","0.45","0.49","NA","NA","NA","0.80","0.42","0.55","0.64","0.47","NA","0.61","0.59","NA","NA","0.58","0.69","NA","0.69","0.48","0.45","0.63","0.49","NA","0.49","NA","NA","0.57","NA","0.69","0.68","NA","0.56","0.62","0.46","0.69","0.58","0.67","0.49","NA","0.74","0.60","0.67","0.47","0.54","0.69","NA","0.60","NA","NA","0.48","0.69","0.50","NA","0.49","0.53","0.41","0.72","0.49","NA","0.55","0.84","0.78","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.54","0.56","0.50","NA","NA","0.81","NA","NA","NA","NA","NA","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.70","NA","NA","NA","NA","0.54","NA","NA","NA","NA","NA","NA","NA","0.66","0.73","NA","NA","0.52","NA","0.91","NA","NA","0.86","0.74","NA","0.49","NA","NA","NA","NA","0.77","NA","NA","NA","NA","0.57","NA","0.57","0.64","NA","NA","NA","NA","0.76","NA","0.61","NA","NA","NA","NA","NA","0.84","NA","NA","0.47","0.75","NA","NA","NA","0.52","NA","NA","NA","NA","0.56","NA","NA","NA","0.75","NA","0.65","NA","NA","0.89","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","0.71","0.66","NA","0.47","0.69","0.63","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.56","0.62","0.68","NA","NA","0.58","0.72","NA","0.45","NA","0.63","NA","NA","NA","0.64","0.43","NA","NA","0.51","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","0.55","NA","NA","NA","NA","NA","NA","0.55","NA","NA","NA","NA","0.57","0.50","NA","0.75","NA","NA","NA","NA","NA","NA","0.53","NA","NA","NA","NA","0.49","NA","NA","0.56","NA","NA","0.67","NA","NA","0.51","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.40","0.56","NA","0.72","NA","NA","0.47","NA","NA","NA","NA","0.50","0.88","0.88"],"peve_context_strength":["1.00","1.02","1.25","1.45","1.17","0.80","1.17","0.92","1.36","0.78","1.10","1.25","1.07","1.25","0.88","1.34","1.20","1.24","0.62","1.05","0.93","0.93","1.08","1.00","1.29","0.93","0.78","1.34","1.26","1.20","0.70","1.02","1.01","1.13","0.65","0.95","1.34","0.90","1.01","0.75","0.88","1.11","0.94","1.30","0.73","0.98","0.84","1.33","0.82","1.00","1.12","1.11","0.93","0.79","1.18","0.86","0.85","0.39","0.93","0.62","0.52","0.64","0.91","0.72","1.37","0.79","0.48","0.73","0.77","1.14","0.44","0.45","0.73","0.82","1.23","0.59","0.63","0.77","1.09","0.46","1.17","0.65","0.85","0.27","0.90","1.03","0.95","1.02","0.39","0.50","0.68","1.09","1.08","0.75","0.75","0.30","0.59","0.47","0.37","0.73","NA","1.52","NA","NA","1.39","1.34","NA","NA","NA","1.32","NA","NA","NA","NA","1.16","NA","NA","1.28","NA","1.22","NA","1.22","NA","NA","1.20","1.11","1.24","NA","NA","1.06","1.22","1.19","NA","1.25","NA","NA","NA","1.19","1.20","NA","1.11","NA","NA","NA","NA","NA","1.07","0.91","0.91","1.18","1.20","1.30","NA","NA","1.13","NA","0.85","1.24","NA","NA","NA","NA","NA","0.97","1.05","1.19","NA","NA","NA","1.18","NA","NA","NA","1.21","NA","1.14","1.03","NA","NA","NA","1.15","1.29","1.04","0.84","1.07","1.08","1.17","0.90","1.04","NA","NA","1.32","NA","NA","NA","NA","1.04","1.20","1.12","NA","0.89","1.13","NA","NA","0.31","NA","NA","NA","0.77","NA","0.92","1.21","NA","NA","0.87","1.15","NA","NA","NA","1.13","NA","1.12","0.45","NA","0.89","0.97","NA","NA","1.20","1.17","NA","0.65","NA","NA","0.92","1.06","0.92","0.79","NA","0.64","NA","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","0.67","NA","NA","0.42","0.77","0.80","0.80","NA","NA","NA","NA","0.54","1.03","1.12","1.08","NA","0.55","NA","0.83","0.69","1.15","NA","NA","NA","1.23","0.33","0.66","1.15","NA","NA","0.58","0.86","0.92","0.73","NA","NA","1.01","NA","0.78","NA","NA","1.13","0.68","NA","NA","0.61","0.50","0.78","0.25","NA","NA","0.37","NA","0.89","NA","NA","0.65","0.54","NA","NA","0.29","NA","NA","NA","NA","NA","0.38","NA","0.44","0.53","NA","0.49","NA","0.61","0.85","NA","0.71","0.56","0.99","0.79","NA","NA","0.49","NA","NA","0.79","NA","0.62","NA","0.68","NA","0.53","0.16","0.51","NA","0.48","0.40","0.64","NA","NA","NA","0.53","0.43","0.51","NA","0.07","0.58","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.34","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.31","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.24","1.24","NA","NA","NA","NA","NA","1.23","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.19","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.15","NA","1.15","NA","NA","NA","1.14","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.11","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.06","NA","NA","NA","1.05","NA","NA","1.04","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.92","0.92","0.92","NA","NA","0.91","NA","0.90","0.90","0.90","NA","NA","NA","NA","NA","NA","NA","0.85","0.84","NA","NA","NA","NA","NA","NA","NA","0.81","NA","NA","NA","0.75","0.75","NA","0.73","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","NA","NA","NA","NA","0.60","0.59","NA","NA","NA","0.54","NA","NA","NA","0.51","NA","0.49","0.48","NA","NA","NA","NA","0.32","NA","NA","NA"],"peve_context_dependent":[false,false,true,false,false,false,false,false,true,false,true,false,false,true,false,true,false,false,true,true,false,false,false,false,true,false,false,true,true,true,true,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,true,true,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,true,false,false,false,true,true,false,false,true,false,false,true,false,true,false,false,true,false,false,false,false,false,true,false,false,false,false,false,false,false,false,null,false,null,null,true,false,null,null,null,true,null,null,null,null,false,null,null,true,null,true,null,false,null,null,true,true,true,null,null,true,false,true,null,false,null,null,null,true,true,null,false,null,null,null,null,null,false,false,false,false,false,false,null,null,true,null,false,false,null,null,null,null,null,false,false,true,null,null,null,false,null,null,null,true,null,false,false,null,null,null,false,false,false,true,false,false,true,false,false,null,null,false,null,null,null,null,true,false,false,null,false,false,null,null,false,null,null,null,false,null,false,false,null,null,false,false,null,null,null,true,null,true,false,null,false,false,null,null,false,false,null,false,null,null,false,false,false,false,null,false,null,null,null,false,null,null,null,null,null,null,null,false,null,null,false,true,false,true,null,null,null,null,false,false,false,true,null,false,null,false,false,true,null,null,null,false,false,false,false,null,null,false,true,true,true,null,null,false,null,false,null,null,true,false,null,null,false,false,false,false,null,null,true,null,false,null,null,false,false,null,null,false,null,null,null,null,null,false,null,false,true,null,false,null,false,true,null,true,false,false,false,null,null,false,null,null,true,null,false,null,false,null,false,false,false,null,false,true,false,null,null,null,false,false,false,null,true,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,true,false,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,true,null,false,null,null,null,false,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,false,null,null,false,null,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,false,false,null,null,false,null,false,false,false,null,null,null,null,null,null,null,false,true,null,null,null,null,null,null,null,false,null,null,null,false,false,null,false,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,false,false,null,null,null,false,null,null,null,false,null,false,false,null,null,null,null,false,null,null,null],"peve_improvement":["0.03","0.04","0.06","0.03","0.00","0.00","0.02","0.02","0.08","0.02","0.03","0.04","0.01","0.17","0.03","0.06","0.00","0.03","0.08","0.14","0.03","0.00","0.02","0.02","0.08","0.02","0.05","0.13","0.05","0.14","0.06","0.00","0.02","0.12","0.05","0.00","0.13","0.00","0.05","0.02","0.01","0.01","0.01","0.00","0.03","0.01","0.00","0.01","0.01","0.06","0.05","0.02","0.08","0.10","0.02","0.05","0.06","0.00","0.00","0.04","0.00","0.01","0.00","0.08","0.00","0.00","0.00","0.05","0.00","0.08","0.00","0.01","0.02","0.13","0.08","0.01","0.06","0.08","0.00","0.02","0.09","0.00","0.07","0.00","0.01","0.07","0.04","0.00","0.01","0.03","0.00","0.08","0.03","0.00","0.04","0.00","0.01","0.01","0.01","0.04","NA","0.03","NA","NA","0.13","0.05","NA","NA","NA","0.09","NA","NA","NA","NA","0.02","NA","NA","0.07","NA","0.12","NA","0.00","NA","NA","0.09","0.07","0.07","NA","NA","0.15","0.00","0.09","NA","0.03","NA","NA","NA","0.10","0.05","NA","0.01","NA","NA","NA","NA","NA","0.03","0.00","0.04","0.03","0.04","0.00","NA","NA","0.07","NA","0.01","0.01","NA","NA","NA","NA","NA","0.00","0.01","0.07","NA","NA","NA","0.03","NA","NA","NA","0.09","NA","0.03","0.02","NA","NA","NA","0.01","0.01","0.02","0.12","0.00","0.01","0.12","0.06","0.06","NA","NA","0.00","NA","NA","NA","NA","0.04","0.00","0.00","NA","0.00","0.01","NA","NA","0.00","NA","NA","NA","0.00","NA","0.02","0.02","NA","NA","0.01","0.00","NA","NA","NA","0.09","NA","0.07","0.03","NA","0.05","0.00","NA","NA","0.04","0.00","NA","0.04","NA","NA","0.00","0.03","0.02","0.03","NA","0.04","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","0.00","0.12","0.04","0.10","NA","NA","NA","NA","0.02","0.04","0.00","0.08","NA","0.00","NA","0.01","0.01","0.04","NA","NA","NA","0.00","0.01","0.01","0.00","NA","NA","0.06","0.05","0.09","0.06","NA","NA","0.02","NA","0.00","NA","NA","0.04","0.05","NA","NA","0.02","0.01","0.00","0.01","NA","NA","0.05","NA","0.04","NA","NA","0.01","0.02","NA","NA","0.06","NA","NA","NA","NA","NA","0.00","NA","0.01","0.05","NA","0.03","NA","0.07","0.09","NA","0.10","0.01","0.01","0.00","NA","NA","0.00","NA","NA","0.10","NA","0.04","NA","0.02","NA","0.02","0.00","0.01","NA","0.02","0.09","0.00","NA","NA","NA","0.00","0.01","0.01","NA","0.01","0.02","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.05","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.03","0.02","NA","NA","NA","NA","NA","0.16","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.08","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.09","NA","0.02","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.08","NA","NA","NA","0.05","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.09","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","0.03","0.03","NA","NA","0.04","NA","0.01","0.04","0.03","NA","NA","NA","NA","NA","NA","NA","0.02","0.07","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","0.03","0.01","NA","0.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","0.00","0.01","NA","NA","NA","0.03","NA","NA","NA","0.00","NA","0.04","0.00","NA","NA","NA","NA","0.01","NA","NA","NA"],"peve_r2":["0.52","0.49","0.75","0.59","0.68","0.68","0.68","0.59","0.67","0.52","0.80","0.50","0.45","0.84","0.51","0.74","0.65","0.74","0.55","0.67","0.39","0.36","0.72","0.59","0.65","0.76","0.53","0.69","0.73","0.77","0.54","0.55","0.56","0.56","0.49","0.46","0.54","0.32","0.52","0.47","0.43","0.53","0.43","0.64","0.49","0.58","0.37","0.51","0.82","0.55","0.93","0.46","0.44","0.51","0.50","0.42","0.51","0.61","0.39","0.45","0.48","0.45","0.47","0.49","0.55","0.45","0.43","0.45","0.46","0.68","0.48","0.48","0.39","0.55","0.63","0.45","0.48","0.47","0.44","0.43","0.70","0.43","0.55","0.75","0.42","0.69","0.57","0.46","0.44","0.57","0.50","0.68","0.48","0.48","0.43","0.57","0.59","0.39","0.50","0.47","NA","0.45","NA","NA","0.52","0.57","NA","NA","NA","0.70","NA","NA","NA","NA","0.45","NA","NA","0.62","NA","0.60","NA","0.52","NA","NA","0.59","0.99","0.75","NA","NA","0.65","0.57","0.73","NA","0.41","NA","NA","NA","0.59","0.63","NA","0.49","NA","NA","NA","NA","NA","0.61","0.60","0.65","0.61","0.67","0.72","NA","NA","0.51","NA","0.44","0.60","NA","NA","NA","NA","NA","0.72","0.62","0.46","NA","NA","NA","0.55","NA","NA","NA","0.99","NA","0.63","0.48","NA","NA","NA","0.53","0.46","0.74","0.46","0.44","0.61","0.77","0.49","0.54","NA","NA","0.54","NA","NA","NA","NA","0.82","0.59","0.75","NA","0.42","0.73","NA","NA","0.62","NA","NA","NA","0.44","NA","0.52","0.53","NA","NA","0.41","0.47","NA","NA","NA","0.63","NA","0.85","0.45","NA","0.42","0.53","NA","NA","0.68","0.46","NA","0.44","NA","NA","0.41","0.50","0.53","0.45","NA","0.51","NA","NA","NA","0.45","NA","NA","NA","NA","NA","NA","NA","0.38","NA","NA","0.78","0.62","0.44","0.57","NA","NA","NA","NA","0.39","0.47","0.73","0.96","NA","0.46","NA","0.40","0.42","0.73","NA","NA","NA","0.66","0.42","0.53","0.82","NA","NA","0.46","0.75","0.51","0.69","NA","NA","0.47","NA","0.35","NA","NA","0.78","0.50","NA","NA","0.47","0.66","0.47","0.51","NA","NA","0.74","NA","0.51","NA","NA","0.59","0.43","NA","NA","0.45","NA","NA","NA","NA","NA","0.42","NA","0.55","0.71","NA","0.42","NA","0.45","0.51","NA","0.59","0.48","0.58","0.42","NA","NA","0.67","NA","NA","0.53","NA","0.50","NA","0.39","NA","0.43","0.78","0.57","NA","0.39","0.68","0.45","NA","NA","NA","0.53","0.63","0.49","NA","0.93","0.37","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.79","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.39","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.91","0.68","NA","NA","NA","NA","NA","0.79","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.92","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.73","NA","0.46","NA","NA","NA","0.65","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","NA","0.47","NA","NA","0.66","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.69","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.51","0.41","0.55","NA","NA","0.53","NA","0.44","0.51","0.51","NA","NA","NA","NA","NA","NA","NA","0.39","0.54","NA","NA","NA","NA","NA","NA","NA","0.41","NA","NA","NA","0.42","0.52","NA","0.63","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.59","NA","NA","NA","NA","NA","NA","0.43","0.44","NA","NA","NA","0.46","NA","NA","NA","0.39","NA","0.48","0.57","NA","NA","NA","NA","0.73","NA","NA","NA"],"ptua_context_strength":["1.41","1.39","1.49","1.45","1.48","1.61","1.25","1.12","1.19","1.03","1.24","1.23","1.31","1.03","1.37","1.20","0.89","0.99","1.26","1.16","1.61","0.50","1.14","1.50","0.93","1.27","1.21","0.93","1.07","1.20","1.44","0.80","0.79","0.69","1.18","0.90","1.19","1.18","0.88","1.18","1.37","0.73","1.35","0.62","1.35","1.01","1.10","1.15","1.24","1.15","1.03","0.68","0.87","1.16","1.02","1.16","0.95","1.09","1.11","1.42","1.27","1.54","0.85","1.07","0.67","1.10","0.94","0.96","1.18","1.06","1.27","1.22","0.82","0.82","0.53","0.81","1.02","0.87","1.18","1.01","0.71","1.07","0.69","1.24","0.98","0.27","0.46","0.64","0.95","0.85","0.57","0.51","0.36","0.82","1.00","1.04","0.80","0.98","1.08","0.43","1.83","1.50","1.60","1.40","1.51","1.55","1.26","1.63","1.88","1.47","1.32","0.89","1.67","1.49","1.43","1.44","1.24","NA","1.39","1.31","1.50","1.28","1.19","1.31","1.28","1.37","1.21","1.57","1.43","NA","NA","1.21","0.88","1.14","1.51","1.19","1.24","1.17","1.16","1.16","NA","1.29","1.51","1.22","1.47","1.36","1.25","1.40","1.40","1.13","1.10","1.00","1.11","0.78","1.14","1.10","1.41","NA","0.69","0.99","0.96","1.23","1.43","1.27","NA","1.05","1.03","0.93","1.50","NA","1.06","0.81","1.03","1.00","1.19","1.08","1.17","1.04","1.23","1.09","1.03","NA","NA","1.32","NA","1.06","NA","1.24","1.08","1.25","1.26","0.79","0.75","0.97","0.85","1.10","NA","0.88","NA","0.93","1.19","NA","0.78","1.23","1.76","1.20","1.37","0.45","1.26","1.50","1.09","0.81","1.28","0.96","1.14","0.86","0.85","0.80","1.00","0.86","1.08","NA","1.53","1.11","1.08","1.00","1.29","0.75","0.74","NA","1.26","1.27","0.91","1.04","0.99","NA","0.98","1.11","0.70","NA","0.77","0.68","0.78","NA","0.46","0.90","0.91","1.21","0.96","1.05","1.32","1.15","1.08","1.07","1.40","1.04","0.99","0.99","0.88","1.29","0.74","1.14","1.25","0.75","0.66","NA","1.04","1.22","0.82","0.93","1.06","NA","0.93","1.08","0.95","0.51","1.41","1.08","NA","1.10","0.67","1.14","NA","0.79","NA","0.71","0.85","0.69","0.58","0.91","0.77","0.74","NA","0.99","0.41","1.09","1.05","1.15","0.88","NA","1.07","1.04","NA","0.85","0.73","0.69","1.17","0.97","1.08","0.62","0.68","1.31","1.10","1.10","0.69","0.67","0.81","1.19","0.81","1.10","1.00","0.89","1.03","0.74","NA","0.65","0.80","NA","NA","NA","NA","0.41","0.75","0.94","0.85","1.00","NA","0.54","NA","1.06","0.64","0.67","0.79","1.15","NA","0.78","NA","0.80","NA","0.57","0.75","0.73","NA","0.65","NA","0.94","NA","0.39","1.88","1.87","1.84","1.63","1.59","1.53","1.53","1.51","1.48","NA","NA","NA","1.44","1.43","NA","1.39","1.38","1.38","1.38","1.37","1.37","1.37","NA","1.36","1.36","1.36","1.35","1.35","NA","1.34","1.34","1.33","1.33","1.33","1.32","1.32","1.32","1.31","1.31","NA","1.31","NA","1.30","1.30","1.29","1.28","NA","1.28","1.27","1.27","1.26","1.25","NA","NA","NA","NA","1.24","1.24","NA","NA","NA","1.21","1.21","NA","NA","1.21","NA","1.21","1.20","1.20","1.20","NA","1.20","1.20","1.20","NA","NA","1.19","NA","NA","1.18","1.17","1.17","1.17","NA","1.16","NA","1.16","NA","1.15","NA","1.15","NA","1.14","NA","NA","NA","1.13","1.13","1.13","NA","1.12","1.12","1.11","NA","NA","1.11","1.11","1.10","NA","1.09","NA","1.09","1.08","NA","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","NA","1.06","1.05","1.05","NA","1.05","1.04","NA","1.03","1.03","1.03","1.03","1.03","1.02","NA","1.02","1.02","NA","NA","NA","NA","NA","NA","1.01","1.00","1.00","1.00","1.00","1.00","NA","0.99","0.99","0.99","0.99","0.98","0.98","0.97","NA","NA","NA","0.96","0.96","NA","NA","0.96","NA","0.96","NA","0.95","0.95","0.94","NA","NA","0.93","0.93","NA","NA","NA","NA","NA","0.92","NA","0.91","NA","NA","NA","0.89","0.88","NA","0.86","0.85","0.85","0.85","NA","NA","NA","0.82","0.82","0.82","0.82","NA","NA","NA","NA","0.76","0.76","NA","NA","0.74","NA","NA","0.72","0.72","0.71","0.70","NA","0.68","0.67","NA","0.66","NA","NA","0.63","0.62","NA","0.61","0.61","NA","NA","0.59","0.58","0.55","NA","0.53","NA","NA","NA","NA","NA","NA","NA","0.47","0.46","0.33","NA","NA","NA","NA"],"ptua_context_dependent":[false,true,true,false,false,false,true,false,true,true,false,true,true,true,false,true,true,false,false,true,false,true,true,true,false,false,true,false,false,false,true,false,false,true,false,false,false,true,false,false,false,false,false,false,false,true,false,true,false,true,true,false,false,false,true,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,true,true,false,false,false,false,true,false,true,false,true,true,false,true,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,true,true,true,false,false,false,false,true,true,true,true,false,false,false,true,false,null,false,false,false,true,true,true,false,true,false,false,false,null,null,false,true,true,false,true,true,false,false,true,null,true,false,true,false,false,true,true,false,true,false,true,true,false,true,false,true,null,false,false,true,true,false,true,null,false,false,false,false,null,false,false,false,false,false,true,false,false,true,false,false,null,null,true,null,false,null,false,true,true,true,true,false,false,false,true,null,false,null,false,false,null,false,false,false,true,true,true,false,false,false,false,false,false,false,true,false,true,true,false,true,null,false,false,false,false,false,false,true,null,true,true,false,false,false,null,false,false,false,null,false,false,true,null,false,false,false,true,false,true,true,true,false,false,false,false,true,true,false,true,false,false,false,false,false,null,false,false,false,false,false,null,true,true,false,true,true,false,null,false,true,false,null,false,null,false,true,false,false,true,false,false,null,true,false,false,true,false,false,null,false,false,null,false,false,false,true,false,false,true,false,true,false,true,false,false,false,false,false,false,false,false,true,false,null,true,false,null,null,null,null,false,false,false,false,false,null,false,null,false,false,false,false,false,null,false,null,true,null,false,false,false,null,false,null,false,null,false,false,false,false,false,false,false,true,true,true,null,null,null,true,true,null,false,true,true,false,true,true,true,null,true,false,false,false,true,null,true,true,true,true,false,true,false,false,false,false,null,true,null,true,false,false,false,null,true,true,true,false,true,null,null,null,null,true,true,null,null,null,false,true,null,null,false,null,true,false,false,true,null,true,false,false,null,null,true,null,null,false,false,false,false,null,true,null,false,null,false,null,false,null,false,null,null,null,true,false,false,null,false,true,false,null,null,true,false,false,null,false,null,true,false,null,true,false,false,false,false,false,true,true,false,true,null,false,true,false,null,false,false,null,false,false,true,true,false,false,null,false,true,null,null,null,null,null,null,true,true,true,true,false,true,null,true,false,false,false,false,false,false,null,null,null,true,false,null,null,false,null,true,null,false,false,false,null,null,false,false,null,null,null,null,null,false,null,true,null,null,null,false,false,null,false,false,false,true,null,null,null,true,false,false,false,null,null,null,null,false,false,null,null,false,null,null,false,false,false,false,null,false,false,null,false,null,null,false,false,null,false,false,null,null,false,false,false,null,false,null,null,null,null,null,null,null,false,false,false,null,null,null,null],"ptua_improvement":["0.03","0.06","0.11","0.00","0.01","0.06","0.11","0.00","0.13","0.10","0.00","0.05","0.14","0.10","0.03","0.04","0.12","0.00","0.00","0.08","0.06","0.08","0.09","0.15","0.03","0.00","0.10","0.02","0.01","0.02","0.14","0.01","0.02","0.08","0.06","0.00","0.01","0.08","0.01","0.02","0.04","0.00","0.03","0.00","0.06","0.20","0.01","0.07","0.00","0.06","0.07","0.03","0.01","0.04","0.06","0.01","0.02","0.00","0.01","0.02","0.05","0.01","0.03","0.07","0.02","0.00","0.02","0.04","0.00","0.04","0.07","0.12","0.01","0.01","0.00","0.00","0.08","0.00","0.15","0.05","0.13","0.08","0.05","0.18","0.01","0.02","0.01","0.02","0.00","0.05","0.04","0.00","0.05","0.13","0.09","0.00","0.00","0.02","0.01","0.01","0.00","0.09","0.34","0.08","0.05","0.01","0.02","0.03","0.06","0.13","0.18","0.06","0.04","0.01","0.02","0.12","0.02","NA","0.04","0.00","0.00","0.06","0.10","0.10","0.00","0.17","0.01","0.00","0.06","NA","NA","0.04","0.09","0.10","0.00","0.18","0.11","0.03","0.02","0.08","NA","0.09","0.03","0.11","0.02","0.02","0.09","0.07","0.02","0.08","0.01","0.09","0.07","0.01","0.15","0.03","0.06","NA","0.02","0.02","0.10","0.21","0.01","0.10","NA","0.04","0.05","0.00","0.04","NA","0.03","0.01","0.01","0.05","0.03","0.05","0.02","0.04","0.20","0.00","0.01","NA","NA","0.14","NA","0.01","NA","0.03","0.07","0.09","0.09","0.08","0.02","0.00","0.02","0.07","NA","0.00","NA","0.03","0.03","NA","0.03","0.00","0.01","0.07","0.24","0.06","0.03","0.02","0.02","0.01","0.01","0.06","0.04","0.12","0.01","0.09","0.18","0.01","0.08","NA","0.01","0.03","0.01","0.01","0.04","0.01","0.08","NA","0.06","0.19","0.04","0.03","0.01","NA","0.01","0.04","0.01","NA","0.04","0.00","0.06","NA","0.01","0.00","0.03","0.05","0.03","0.14","0.08","0.13","0.03","0.05","0.00","0.03","0.12","0.09","0.03","0.05","0.02","0.05","0.00","0.02","0.01","NA","0.04","0.02","0.03","0.01","0.05","NA","0.19","0.13","0.00","0.04","0.12","0.01","NA","0.01","0.08","0.04","NA","0.01","NA","0.02","0.07","0.01","0.00","0.08","0.02","0.03","NA","0.11","0.04","0.02","0.10","0.05","0.05","NA","0.02","0.03","NA","0.02","0.03","0.05","0.21","0.02","0.03","0.06","0.00","0.12","0.00","0.13","0.00","0.00","0.01","0.03","0.00","0.01","0.02","0.01","0.14","0.01","NA","0.11","0.00","NA","NA","NA","NA","0.02","0.00","0.03","0.02","0.03","NA","0.00","NA","0.05","0.01","0.06","0.04","0.00","NA","0.00","NA","0.08","NA","0.01","0.02","0.02","NA","0.05","NA","0.01","NA","0.02","0.02","0.02","0.00","0.02","0.01","0.06","0.18","0.11","0.23","NA","NA","NA","0.07","0.04","NA","0.04","0.16","0.07","0.03","0.21","0.21","0.05","NA","0.14","0.05","0.03","0.00","0.08","NA","0.10","0.11","0.03","0.12","0.00","0.06","0.01","0.00","0.00","0.03","NA","0.15","NA","0.12","0.01","0.05","0.01","NA","0.11","0.15","0.07","0.00","0.06","NA","NA","NA","NA","0.06","0.07","NA","NA","NA","0.05","0.11","NA","NA","0.00","NA","0.08","0.04","0.03","0.07","NA","0.17","0.07","0.00","NA","NA","0.14","NA","NA","0.03","0.02","0.03","0.01","NA","0.10","NA","0.01","NA","0.04","NA","0.00","NA","0.01","NA","NA","NA","0.24","0.00","0.03","NA","0.01","0.09","0.05","NA","NA","0.06","0.00","0.03","NA","0.01","NA","0.08","0.01","NA","0.17","0.02","0.01","0.00","0.00","0.02","0.09","0.09","0.03","0.13","NA","0.06","0.20","0.04","NA","0.00","0.04","NA","0.06","0.00","0.14","0.07","0.00","0.01","NA","0.03","0.11","NA","NA","NA","NA","NA","NA","0.13","0.15","0.15","0.07","0.01","0.09","NA","0.16","0.05","0.03","0.02","0.05","0.03","0.00","NA","NA","NA","0.09","0.05","NA","NA","0.01","NA","0.10","NA","0.02","0.05","0.03","NA","NA","0.02","0.03","NA","NA","NA","NA","NA","0.02","NA","0.08","NA","NA","NA","0.02","0.02","NA","0.02","0.00","0.03","0.16","NA","NA","NA","0.07","0.01","0.00","0.04","NA","NA","NA","NA","0.02","0.00","NA","NA","0.01","NA","NA","0.06","0.06","0.01","0.00","NA","0.03","0.05","NA","0.00","NA","NA","0.00","0.00","NA","0.00","0.02","NA","NA","0.01","0.00","0.00","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.00","0.01","0.00","NA","NA","NA","NA"],"ptua_r2":["0.56","0.50","0.55","0.61","0.43","0.46","0.82","0.44","0.63","0.64","0.58","0.76","0.56","0.54","0.38","0.70","0.48","0.62","0.47","0.64","0.50","0.51","0.48","0.54","0.46","0.35","0.59","0.40","0.44","0.44","0.66","0.44","0.44","0.44","0.42","0.47","0.48","0.63","0.45","0.65","0.63","0.30","0.56","0.50","0.48","0.58","0.40","0.46","0.57","0.75","0.53","0.46","0.33","0.49","0.53","0.56","0.40","0.53","0.43","0.45","0.66","0.47","0.36","0.45","0.46","0.55","0.52","0.50","0.59","0.54","0.51","0.56","0.54","0.36","0.46","0.65","0.71","0.54","0.47","0.51","0.50","0.54","0.49","0.74","0.49","0.67","0.47","0.48","0.43","0.49","0.41","0.44","0.45","0.49","0.63","0.38","0.52","0.49","0.55","0.43","0.58","0.78","0.79","0.46","0.51","0.50","0.68","0.67","0.58","0.73","0.68","0.53","0.51","0.69","0.43","0.76","0.59","NA","0.68","0.47","0.52","0.72","0.47","0.66","0.47","0.90","0.38","0.78","0.45","NA","NA","0.42","0.60","0.63","0.61","0.59","0.62","0.43","0.60","0.51","NA","0.54","0.59","0.63","0.39","0.54","0.57","0.50","0.56","0.54","0.59","0.69","0.46","0.40","0.64","0.35","0.93","NA","0.84","0.34","0.51","0.97","0.46","0.70","NA","0.45","0.43","0.47","0.56","NA","0.42","0.37","0.47","0.53","0.45","0.62","0.43","0.59","0.62","0.62","0.47","NA","NA","0.48","NA","0.59","NA","0.56","0.47","0.65","0.63","0.65","0.50","0.56","0.40","0.61","NA","0.62","NA","0.40","0.50","NA","0.55","0.43","0.54","0.82","0.73","0.49","0.39","0.39","0.62","0.47","0.53","0.46","0.48","0.50","0.47","0.45","0.56","0.43","0.55","NA","0.65","0.43","0.51","0.39","0.45","0.51","0.54","NA","0.68","0.78","0.61","0.51","0.62","NA","0.58","0.46","0.49","NA","0.54","0.57","0.58","NA","0.51","0.41","0.47","0.89","0.50","0.52","0.43","0.62","0.45","0.47","0.39","0.49","0.45","0.44","0.46","0.66","0.35","0.42","0.60","0.45","0.45","NA","0.50","0.56","0.40","0.42","0.47","NA","0.75","0.63","0.41","0.76","0.60","0.71","NA","0.57","0.51","0.61","NA","0.58","NA","0.38","0.48","0.59","0.39","0.53","0.48","0.45","NA","0.57","0.48","0.48","0.52","0.41","0.51","NA","0.33","0.51","NA","0.49","0.38","0.57","0.59","0.44","0.40","0.56","0.49","0.82","0.50","0.56","0.38","0.37","0.44","0.49","0.43","0.43","0.41","0.32","0.50","0.39","NA","0.58","0.37","NA","NA","NA","NA","0.50","0.56","0.67","0.44","0.47","NA","0.44","NA","0.51","0.50","0.42","0.49","0.52","NA","0.33","NA","0.58","NA","0.54","0.37","0.40","NA","0.48","NA","0.45","NA","0.69","0.47","0.58","0.74","0.82","0.61","0.44","0.79","0.63","0.84","NA","NA","NA","0.63","0.66","NA","0.68","0.72","0.48","0.66","0.74","0.74","0.79","NA","0.73","0.42","0.51","0.38","0.83","NA","0.52","0.58","0.78","0.71","0.46","0.75","0.42","0.74","0.81","0.48","NA","0.76","NA","0.88","0.69","0.61","0.51","NA","0.66","0.96","0.51","0.69","0.79","NA","NA","NA","NA","0.57","0.45","NA","NA","NA","0.56","0.52","NA","NA","0.57","NA","0.44","0.57","0.44","0.50","NA","0.75","0.37","0.40","NA","NA","0.66","NA","NA","0.41","0.40","0.43","0.59","NA","0.69","NA","0.52","NA","0.47","NA","0.60","NA","0.46","NA","NA","NA","0.72","0.71","0.59","NA","0.54","0.50","0.42","NA","NA","0.52","0.37","0.35","NA","0.65","NA","0.51","0.48","NA","0.63","0.40","0.49","0.64","0.40","0.46","0.42","0.59","0.68","0.60","NA","0.46","0.60","0.45","NA","0.39","0.59","NA","0.42","0.39","0.47","0.65","0.47","0.50","NA","0.40","0.63","NA","NA","NA","NA","NA","NA","0.64","0.51","0.59","0.52","0.35","0.38","NA","0.58","0.51","0.36","0.34","0.46","0.42","0.56","NA","NA","NA","0.40","0.46","NA","NA","0.53","NA","0.51","NA","0.41","0.61","0.67","NA","NA","0.50","0.51","NA","NA","NA","NA","NA","0.40","NA","0.53","NA","NA","NA","0.55","0.51","NA","0.48","0.41","0.59","0.50","NA","NA","NA","0.90","0.52","0.60","0.41","NA","NA","NA","NA","0.48","0.35","NA","NA","0.42","NA","NA","0.43","0.43","0.48","0.40","NA","0.55","0.44","NA","0.42","NA","NA","0.40","0.47","NA","0.56","0.41","NA","NA","0.61","0.48","0.36","NA","0.45","NA","NA","NA","NA","NA","NA","NA","0.39","0.51","0.66","NA","NA","NA","NA"],"mean_context_strength":["1.31","1.30","1.24","1.24","1.20","1.20","1.19","1.19","1.17","1.16","1.16","1.14","1.13","1.12","1.11","1.11","1.11","1.10","1.08","1.07","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.05","1.04","1.04","1.03","1.02","1.01","1.01","1.01","1.00","0.99","0.99","0.99","0.98","0.97","0.97","0.96","0.96","0.96","0.96","0.96","0.95","0.94","0.94","0.94","0.94","0.94","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.91","0.91","0.90","0.90","0.90","0.89","0.88","0.87","0.87","0.86","0.86","0.86","0.86","0.84","0.84","0.84","0.84","0.84","0.84","0.81","0.81","0.80","0.80","0.79","0.78","0.77","0.76","0.75","0.75","0.74","0.72","0.71","0.69","0.69","0.69","0.62","0.62","0.58","1.55","1.51","1.49","1.48","1.45","1.44","1.42","1.41","1.40","1.39","1.38","1.35","1.34","1.31","1.30","1.30","1.29","1.28","1.27","1.27","1.26","1.25","1.25","1.25","1.24","1.24","1.22","1.22","1.22","1.21","1.20","1.20","1.20","1.20","1.20","1.19","1.18","1.18","1.18","1.18","1.17","1.17","1.17","1.17","1.16","1.16","1.16","1.16","1.15","1.15","1.15","1.15","1.15","1.14","1.14","1.14","1.13","1.13","1.13","1.13","1.13","1.13","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.11","1.11","1.11","1.11","1.11","1.10","1.10","1.10","1.09","1.09","1.09","1.08","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.05","1.05","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.03","1.03","1.02","1.02","1.01","1.01","1.01","1.01","1.00","1.00","1.00","1.00","1.00","1.00","0.99","0.99","0.99","0.99","0.99","0.98","0.98","0.98","0.98","0.97","0.96","0.96","0.96","0.96","0.96","0.96","0.95","0.95","0.95","0.95","0.95","0.94","0.94","0.93","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.91","0.91","0.91","0.91","0.91","0.91","0.90","0.90","0.90","0.90","0.89","0.89","0.89","0.89","0.89","0.89","0.89","0.88","0.88","0.88","0.88","0.88","0.87","0.87","0.87","0.87","0.87","0.87","0.86","0.86","0.86","0.86","0.86","0.85","0.85","0.85","0.85","0.85","0.85","0.85","0.84","0.84","0.84","0.84","0.83","0.83","0.83","0.83","0.83","0.82","0.82","0.82","0.82","0.81","0.81","0.81","0.81","0.81","0.81","0.80","0.80","0.80","0.80","0.80","0.79","0.79","0.79","0.79","0.78","0.77","0.76","0.76","0.76","0.76","0.75","0.75","0.75","0.74","0.74","0.73","0.72","0.72","0.72","0.72","0.71","0.71","0.69","0.69","0.68","0.67","0.66","0.66","0.66","0.65","0.64","0.63","0.60","0.60","0.59","0.59","0.58","0.56","0.55","0.54","0.52","0.52","0.51","0.49","1.88","1.87","1.84","1.63","1.59","1.53","1.53","1.51","1.48","1.48","1.47","1.44","1.44","1.43","1.40","1.39","1.38","1.38","1.38","1.37","1.37","1.37","1.37","1.36","1.36","1.36","1.35","1.35","1.34","1.34","1.34","1.33","1.33","1.33","1.32","1.32","1.32","1.31","1.31","1.31","1.31","1.30","1.30","1.30","1.29","1.28","1.28","1.28","1.27","1.27","1.26","1.25","1.24","1.24","1.24","1.24","1.24","1.24","1.23","1.23","1.23","1.21","1.21","1.21","1.21","1.21","1.21","1.21","1.20","1.20","1.20","1.20","1.20","1.20","1.20","1.19","1.19","1.19","1.19","1.18","1.18","1.17","1.17","1.17","1.16","1.16","1.16","1.16","1.15","1.15","1.15","1.15","1.14","1.14","1.14","1.14","1.13","1.13","1.13","1.13","1.13","1.12","1.12","1.11","1.11","1.11","1.11","1.11","1.10","1.10","1.09","1.09","1.09","1.08","1.08","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.06","1.06","1.05","1.05","1.05","1.05","1.04","1.04","1.03","1.03","1.03","1.03","1.03","1.02","1.02","1.02","1.02","1.01","1.01","1.01","1.01","1.01","1.01","1.01","1.00","1.00","1.00","1.00","1.00","1.00","0.99","0.99","0.99","0.99","0.98","0.98","0.97","0.97","0.97","0.96","0.96","0.96","0.96","0.96","0.96","0.96","0.96","0.95","0.95","0.95","0.94","0.94","0.94","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.92","0.91","0.91","0.90","0.90","0.90","0.89","0.88","0.88","0.86","0.85","0.85","0.85","0.85","0.84","0.83","0.82","0.82","0.82","0.82","0.81","0.81","0.81","0.80","0.76","0.76","0.75","0.75","0.74","0.73","0.72","0.72","0.72","0.71","0.70","0.70","0.68","0.67","0.66","0.66","0.65","0.64","0.63","0.62","0.61","0.61","0.61","0.60","0.59","0.59","0.58","0.55","0.54","0.53","0.51","0.51","0.51","0.51","0.49","0.48","0.48","0.47","0.46","0.33","0.32","0.32","0.27","0.14"]},"columns":[{"id":"og_id","name":"og_id","type":"character"},{"id":"n_species","name":"n_species","type":"character"},{"id":"apul_context_strength","name":"apul_context_strength","type":"character"},{"id":"apul_context_dependent","name":"apul_context_dependent","type":"logical"},{"id":"apul_improvement","name":"apul_improvement","type":"character"},{"id":"apul_r2","name":"apul_r2","type":"character"},{"id":"peve_context_strength","name":"peve_context_strength","type":"character"},{"id":"peve_context_dependent","name":"peve_context_dependent","type":"logical"},{"id":"peve_improvement","name":"peve_improvement","type":"character"},{"id":"peve_r2","name":"peve_r2","type":"character"},{"id":"ptua_context_strength","name":"ptua_context_strength","type":"character"},{"id":"ptua_context_dependent","name":"ptua_context_dependent","type":"logical"},{"id":"ptua_improvement","name":"ptua_improvement","type":"character"},{"id":"ptua_r2","name":"ptua_r2","type":"character"},{"id":"mean_context_strength","name":"mean_context_strength","type":"character"}],"filterable":true,"searchable":true,"defaultPageSize":20,"highlight":true,"striped":true,"theme":{"highlightColor":"#EAF2F8"},"dataKey":"ce6bba268a40618e309dde535081d2dc"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="ptua-context-dependent-regulation-analysis-report" class="level1">
<h1>Ptua Context-Dependent Regulation Analysis Report</h1>
<p><strong>Generated:</strong> 2025-12-02 12:52:16 <strong>Analysis ID:</strong> 20251201_160901</p>
<section id="executive-summary" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary">Executive Summary</h2>
<p>This report presents the results of context-dependent regulatory interaction analysis between: - Gene expression - miRNA expression - lncRNA expression - DNA methylation</p>
</section>
<section id="analysis-overview" class="level2">
<h2 class="anchored" data-anchor-id="analysis-overview">Analysis Overview</h2>
<ul>
<li><strong>Parallel Processing:</strong> 192 CPU cores</li>
<li><strong>Available RAM:</strong> 2941.9 GB</li>
<li><strong>Datasets Loaded:</strong> 4 data types
<ul>
<li>Gene: 32 samples √ó 483 features</li>
<li>Lncrna: 32 samples √ó 11236 features</li>
<li>Mirna: 32 samples √ó 40 features</li>
<li>Methylation: 32 samples √ó 263324 features</li>
</ul></li>
</ul>
</section>
<section id="results-summary" class="level2">
<h2 class="anchored" data-anchor-id="results-summary">Results Summary</h2>
<section id="methylation-mirna-context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="methylation-mirna-context-analysis">Methylation-miRNA Context Analysis</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 33270</li>
<li><strong>Context-dependent interactions (F-test):</strong> 3039</li>
<li><strong>Mean improvement from interaction:</strong> 0.017</li>
<li><strong>Mean context strength:</strong> 0.311</li>
</ul>
<section id="top-10-methylation-mirna-interactions-by-context-strength" class="level4">
<h4 class="anchored" data-anchor-id="top-10-methylation-mirna-interactions-by-context-strength">Top 10 Methylation-miRNA Interactions (by Context Strength)</h4>
<p><em>This table shows genes whose regulation by DNA methylation is context-dependent on miRNA expression levels, ranked by context strength.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Methylation</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
<th>Empirical FDR Sig.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_02537‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g26115.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000010_2525456</td>
<td>mirna_Cluster_4609</td>
<td>0.043</td>
<td>1.805</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_08920‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g1090.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000017_5066475</td>
<td>mirna_Cluster_4094</td>
<td>0.016</td>
<td>1.770</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_01414‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g28923.t1a‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000003_1369854</td>
<td>mirna_Cluster_4826</td>
<td>0.015</td>
<td>1.681</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_04723‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g4434.t2‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000000_18894187</td>
<td>mirna_Cluster_4826</td>
<td>0.131</td>
<td>1.600</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_15303‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g5438.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000018_8279715</td>
<td>mirna_Cluster_6807</td>
<td>0.004</td>
<td>1.583</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_14804‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g24442.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000006_12397256</td>
<td>mirna_Cluster_4485</td>
<td>0.005</td>
<td>1.562</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_13910‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g778.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000010_5065428</td>
<td>mirna_Cluster_3415</td>
<td>0.002</td>
<td>1.561</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_08920‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g1090.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000017_5066475</td>
<td>mirna_Cluster_5123</td>
<td>0.040</td>
<td>1.545</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_01452‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g19573.t1‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000000_10732016</td>
<td>mirna_Cluster_4826</td>
<td>0.265</td>
<td>1.527</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_01155‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g6698.t2‚Äô)</td>
<td>methylation_CpG_Pocillopora_meandrina_HIv1___Sc0000011_3176997</td>
<td>mirna_Cluster_4485</td>
<td>0.045</td>
<td>1.521</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="lncrna-mirna-context-analysis-exploratory" class="level3">
<h3 class="anchored" data-anchor-id="lncrna-mirna-context-analysis-exploratory">lncRNA-miRNA Context Analysis (Exploratory)</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 33270</li>
<li><strong>Context-dependent interactions (F-test):</strong> 4724</li>
<li><strong>Mean improvement from interaction:</strong> 0.018</li>
<li><strong>Mean context strength:</strong> 0.229</li>
</ul>
<section id="top-10-lncrna-mirna-interactions-exploratory" class="level4">
<h4 class="anchored" data-anchor-id="top-10-lncrna-mirna-interactions-exploratory">Top 10 lncRNA-miRNA Interactions (Exploratory)</h4>
<p><em>This table identifies genes whose lncRNA-mediated regulation varies depending on miRNA expression. Note that current interaction metrics behave similarly or more strongly under randomized data and should be interpreted cautiously.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 22%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>lncRNA</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_14763‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g13186.t1‚Äô)</td>
<td>lncrna_lncRNA_12271</td>
<td>mirna_Cluster_6456</td>
<td>0.376</td>
<td>nan</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_14681‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g17155.t1‚Äô)</td>
<td>lncrna_lncRNA_30484</td>
<td>mirna_Cluster_1159</td>
<td>0.360</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_14763‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g13186.t1‚Äô)</td>
<td>lncrna_lncRNA_12271</td>
<td>mirna_Cluster_4</td>
<td>0.356</td>
<td>nan</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_14681‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g17155.t1‚Äô)</td>
<td>lncrna_lncRNA_5394</td>
<td>mirna_Cluster_1159</td>
<td>0.354</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_14681‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g17155.t1‚Äô)</td>
<td>lncrna_lncRNA_5394</td>
<td>mirna_Cluster_3713</td>
<td>0.340</td>
<td>nan</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_14763‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g13186.t1‚Äô)</td>
<td>lncrna_lncRNA_29138</td>
<td>mirna_Cluster_6456</td>
<td>0.334</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_14681‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g17155.t1‚Äô)</td>
<td>lncrna_lncRNA_30480</td>
<td>mirna_Cluster_3713</td>
<td>0.333</td>
<td>nan</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_14763‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g13186.t1‚Äô)</td>
<td>lncrna_lncRNA_29138</td>
<td>mirna_Cluster_4</td>
<td>0.332</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_14681‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g17155.t1‚Äô)</td>
<td>lncrna_lncRNA_30481</td>
<td>mirna_Cluster_3713</td>
<td>0.329</td>
<td>nan</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_14763‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g13186.t1‚Äô)</td>
<td>lncrna_lncRNA_29132</td>
<td>mirna_Cluster_6456</td>
<td>0.326</td>
<td>nan</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="multi-way-interaction-analysis-exploratory" class="level3">
<h3 class="anchored" data-anchor-id="multi-way-interaction-analysis-exploratory">Multi-Way Interaction Analysis (Exploratory)</h3>
<ul>
<li><strong>Total genes analyzed:</strong> 483</li>
<li><strong>Genes with significant interactions (F-test):</strong> 0</li>
<li><strong>Mean improvement from interactions:</strong> 0.597</li>
</ul>
<section id="top-10-multi-way-interactions-exploratory" class="level4">
<h4 class="anchored" data-anchor-id="top-10-multi-way-interactions-exploratory">Top 10 Multi-Way Interactions (Exploratory)</h4>
<p><em>This table shows genes with the largest multi-regulator improvements. Current evidence suggests similar improvements can arise under randomized data; treat these results as hypothesis-generating rather than definitive.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 26%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Improvement</th>
<th>Significant Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_07000‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g5328.t1‚Äô)</td>
<td>0.912</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_02317‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g30016.t1‚Äô)</td>
<td>0.912</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_08545‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g1314.t1‚Äô)</td>
<td>0.912</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_00466‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g4618.t1‚Äô)</td>
<td>0.911</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_07822‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g27709.t1‚Äô)</td>
<td>0.910</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_04209‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g10045.t1‚Äô)</td>
<td>0.908</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_01117‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g20470.t1‚Äô)</td>
<td>0.907</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_17014‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g15484.t1‚Äô)</td>
<td>0.907</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_02666‚Äô, ‚ÄôPocillopora_meandrina_HIv1___RNAseq.g21004.t1‚Äô)</td>
<td>0.906</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_07042‚Äô, ‚ÄôPocillopora_meandrina_HIv1___TS.g12785.t1‚Äô)</td>
<td>0.906</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="data-files" class="level2">
<h2 class="anchored" data-anchor-id="data-files">Data Files</h2>
<p><a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251201_160901/tables/" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251201_160901/tables/</a></p>
<p>The following data files were generated:</p>
<p>These CSV files contain the detailed results of context-dependent regulatory analysis, including interaction statistics, p-values, context strengths, and regulatory relationships for each analyzed gene-regulator pair.</p>
<ul>
<li><strong>high_methylation_gene_lncrna_correlations.csv</strong> (130713.8 KB)</li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> (1814558.8 KB)</li>
<li><strong>high_methylation_gene_mirna_correlations.csv</strong> (394.4 KB)</li>
<li><strong>high_mirna_gene_lncrna_correlations.csv</strong> (88440.6 KB)</li>
<li><strong>high_mirna_gene_methylation_correlations.csv</strong> (1713259.1 KB)</li>
<li><strong>high_mirna_gene_mirna_correlations.csv</strong> (377.4 KB)</li>
<li><strong>lncrna_mirna_context.csv</strong> (9879.4 KB)</li>
<li><strong>low_mirna_gene_lncrna_correlations.csv</strong> (187585.6 KB)</li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> (1766258.4 KB)</li>
<li><strong>low_mirna_gene_mirna_correlations.csv</strong> (966.3 KB)</li>
<li><strong>methylation_mirna_context.csv</strong> (11173.1 KB)</li>
<li><strong>multi_way_interactions.csv</strong> (1218.8 KB)</li>
</ul>
<section id="table-definitions-and-statistical-confidence" class="level3">
<h3 class="anchored" data-anchor-id="table-definitions-and-statistical-confidence">Table Definitions and Statistical Confidence</h3>
<p>Below is a brief description of the main table types and how to assess statistical confidence for each:</p>
<ul>
<li><strong>methylation_mirna_context.csv</strong>:
<ul>
<li>One row per gene‚ÄìCpG‚ÄìmiRNA triplet.</li>
<li>Contains regression-based metrics (<code>r2_*</code>, <code>improvement_from_regulator2</code>, <code>improvement_from_interaction</code>), conditional correlations (<code>corr_high_regulator2</code>, <code>corr_low_regulator2</code>), and <code>context_strength</code>.</li>
<li>When empirical FDR is enabled, includes <code>empirical_fdr_threshold</code>, <code>empirical_fdr_estimated</code>, and <code>empirical_fdr_significant</code>.</li>
<li><strong>How to assess confidence</strong>: prioritize interactions with <code>empirical_fdr_significant == True</code> (if available); otherwise, use <code>context_strength</code> as the primary effect-size metric, ideally cross-referenced against random-data null runs.</li>
</ul></li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> / <strong>high_methylation_gene_mirna_correlations.csv</strong> / <strong>high_methylation_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>high-methylation context</strong>, defined using a sentinel CpG site.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within high-methylation samples.</li>
<li><strong>How to assess confidence</strong>: these p-values are not corrected for multiple testing; treat them as exploratory. For higher confidence, focus on strong effect sizes (|correlation| close to 1) and/or overlap with FDR-supported context interactions from <code>methylation_mirna_context.csv</code>.</li>
</ul></li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> / <strong>low_mirna_gene_mirna_correlations.csv</strong> / <strong>low_mirna_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>low-miRNA context</strong>, using a sentinel miRNA as the context-defining variable.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within low-miRNA samples.</li>
<li><strong>How to assess confidence</strong>: as above, p-values are unadjusted across many tests; use them as a guide for ranking, not strict significance. Strong |correlation| and consistency with patterns seen in <code>methylation_mirna_context.csv</code> or across contexts provide more persuasive evidence.</li>
</ul></li>
<li><strong>lncrna_mirna_context.csv</strong> (if lncRNA context module is enabled):
<ul>
<li>Regression-based lncRNA‚ÄìmiRNA‚Äìgene context metrics analogous to <code>methylation_mirna_context.csv</code>.</li>
<li>Empirical comparisons with randomized data suggest that current interaction metrics here are more exploratory; interpret ‚Äúcontext-dependent‚Äù calls cautiously.</li>
<li><strong>How to assess confidence</strong>: use this table primarily for hypothesis generation or to find lncRNAs associated with genes that already have strong methylation‚ÄìmiRNA context signals.</li>
</ul></li>
<li><strong>multi_way_interactions.csv</strong> (if multi-way module is enabled):
<ul>
<li>Summarizes multi-regulator regression models for each gene, comparing a simple model to a full model with many regulators.</li>
<li>Contains <code>improvement_from_regulators</code> and an F-test <code>interaction_p_value</code> with a boolean <code>has_significant_interactions</code>.</li>
<li><strong>How to assess confidence</strong>: current evidence shows that large improvements can also arise in randomized data; treat these results as exploratory and consider additional validation (e.g., overlap with simpler context metrics or external datasets).</li>
</ul></li>
</ul>
</section>
</section>
<section id="analysis-parameters" class="level2">
<h2 class="anchored" data-anchor-id="analysis-parameters">Analysis Parameters</h2>
<ul>
<li><strong>Parallel workers:</strong> 192</li>
<li><strong>Data directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/data/full-species-biomin/cleaned_ptua</li>
<li><strong>Output directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/output/context_dependent_analysis_20251201_160901</li>
<li><strong>Analysis timestamp:</strong> 20251201_160901</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This analysis successfully identified context-dependent regulatory interactions using optimized parallel processing. The results provide insights into how different regulatory layers interact in a context-specific manner.</p>
<p><em>Report generated by OptimizedContextDependentRegulationAnalysis on 2025-12-02 12:52:16</em></p>
</section>
</section>
<section id="peve-context-dependent-regulation-analysis-report" class="level1">
<h1>Peve Context-Dependent Regulation Analysis Report</h1>
<p><strong>Generated:</strong> 2025-11-30 19:41:04 <strong>Analysis ID:</strong> 20251130_091333</p>
<section id="executive-summary-1" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary-1">Executive Summary</h2>
<p>This report presents the results of context-dependent regulatory interaction analysis between: - Gene expression - miRNA expression - lncRNA expression - DNA methylation</p>
</section>
<section id="analysis-overview-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-overview-1">Analysis Overview</h2>
<ul>
<li><strong>Parallel Processing:</strong> 192 CPU cores</li>
<li><strong>Available RAM:</strong> 2930.5 GB</li>
<li><strong>Datasets Loaded:</strong> 4 data types
<ul>
<li>Gene: 36 samples √ó 553 features</li>
<li>Lncrna: 36 samples √ó 8319 features</li>
<li>Mirna: 36 samples √ó 48 features</li>
<li>Methylation: 36 samples √ó 104459 features</li>
</ul></li>
</ul>
</section>
<section id="results-summary-1" class="level2">
<h2 class="anchored" data-anchor-id="results-summary-1">Results Summary</h2>
<section id="methylation-mirna-context-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="methylation-mirna-context-analysis-1">Methylation-miRNA Context Analysis</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 27150</li>
<li><strong>Context-dependent interactions (F-test):</strong> 3935</li>
<li><strong>Mean improvement from interaction:</strong> 0.022</li>
<li><strong>Mean context strength:</strong> 0.371</li>
</ul>
<section id="top-10-methylation-mirna-interactions-by-context-strength-1" class="level4">
<h4 class="anchored" data-anchor-id="top-10-methylation-mirna-interactions-by-context-strength-1">Top 10 Methylation-miRNA Interactions (by Context Strength)</h4>
<p><em>This table shows genes whose regulation by DNA methylation is context-dependent on miRNA expression levels, ranked by context strength.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Methylation</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
<th>Empirical FDR Sig.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_11813‚Äô, ‚ÄòPeve_00021937‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_3933_26651</td>
<td>mirna_Cluster_1004</td>
<td>0.028</td>
<td>1.523</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_11813‚Äô, ‚ÄòPeve_00021937‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_2342_55729</td>
<td>mirna_Cluster_1004</td>
<td>0.043</td>
<td>1.513</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_11813‚Äô, ‚ÄòPeve_00021937‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_3933_26651</td>
<td>mirna_Cluster_6236</td>
<td>0.052</td>
<td>1.455</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_08793‚Äô, ‚ÄòPeve_00007107‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_865_27253</td>
<td>mirna_Cluster_3165</td>
<td>0.032</td>
<td>1.451</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_11813‚Äô, ‚ÄòPeve_00021937‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_3933_26651</td>
<td>mirna_Cluster_4247</td>
<td>0.038</td>
<td>1.437</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_11360‚Äô, ‚ÄòPeve_00001484‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_325_68647</td>
<td>mirna_Cluster_6234</td>
<td>0.130</td>
<td>1.388</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_06599‚Äô, ‚ÄòPeve_00038759‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_259_87918</td>
<td>mirna_Cluster_9197</td>
<td>0.000</td>
<td>1.369</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_11360‚Äô, ‚ÄòPeve_00001484‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_325_68647</td>
<td>mirna_Cluster_3165</td>
<td>0.164</td>
<td>1.362</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_11813‚Äô, ‚ÄòPeve_00021937‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_1152_147508</td>
<td>mirna_Cluster_1004</td>
<td>0.054</td>
<td>1.360</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_07153‚Äô, ‚ÄòPeve_00000682‚Äô)</td>
<td>methylation_CpG_Porites_evermani_scaffold_910_155276</td>
<td>mirna_Cluster_5058</td>
<td>0.078</td>
<td>1.358</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="lncrna-mirna-context-analysis-exploratory-1" class="level3">
<h3 class="anchored" data-anchor-id="lncrna-mirna-context-analysis-exploratory-1">lncRNA-miRNA Context Analysis (Exploratory)</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 27150</li>
<li><strong>Context-dependent interactions (F-test):</strong> 5550</li>
<li><strong>Mean improvement from interaction:</strong> 0.029</li>
<li><strong>Mean context strength:</strong> 0.282</li>
</ul>
<section id="top-10-lncrna-mirna-interactions-exploratory-1" class="level4">
<h4 class="anchored" data-anchor-id="top-10-lncrna-mirna-interactions-exploratory-1">Top 10 lncRNA-miRNA Interactions (Exploratory)</h4>
<p><em>This table identifies genes whose lncRNA-mediated regulation varies depending on miRNA expression. Note that current interaction metrics behave similarly or more strongly under randomized data and should be interpreted cautiously.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 22%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>lncRNA</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_18262‚Äô, ‚ÄòPeve_00044240‚Äô)</td>
<td>lncrna_lncRNA_10659</td>
<td>mirna_Cluster_6099</td>
<td>0.469</td>
<td>1.007</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_18262‚Äô, ‚ÄòPeve_00044240‚Äô)</td>
<td>lncrna_lncRNA_10659</td>
<td>mirna_Cluster_6918</td>
<td>0.458</td>
<td>0.989</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_13684‚Äô, ‚ÄòPeve_00018981‚Äô)</td>
<td>lncrna_lncRNA_12581</td>
<td>mirna_Cluster_6234</td>
<td>0.444</td>
<td>0.898</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_12320‚Äô, ‚ÄòPeve_00024570‚Äô)</td>
<td>lncrna_lncRNA_19767</td>
<td>mirna_Cluster_670</td>
<td>0.440</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_12320‚Äô, ‚ÄòPeve_00024570‚Äô)</td>
<td>lncrna_lncRNA_19765</td>
<td>mirna_Cluster_670</td>
<td>0.439</td>
<td>nan</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_13526‚Äô, ‚ÄòPeve_00019641‚Äô)</td>
<td>lncrna_lncRNA_20807</td>
<td>mirna_Cluster_670</td>
<td>0.437</td>
<td>nan</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_13526‚Äô, ‚ÄòPeve_00019641‚Äô)</td>
<td>lncrna_lncRNA_23227</td>
<td>mirna_Cluster_670</td>
<td>0.437</td>
<td>nan</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_13684‚Äô, ‚ÄòPeve_00018981‚Äô)</td>
<td>lncrna_lncRNA_23131</td>
<td>mirna_Cluster_981</td>
<td>0.433</td>
<td>0.861</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_13684‚Äô, ‚ÄòPeve_00018981‚Äô)</td>
<td>lncrna_lncRNA_12581</td>
<td>mirna_Cluster_5257</td>
<td>0.433</td>
<td>0.975</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_13684‚Äô, ‚ÄòPeve_00018981‚Äô)</td>
<td>lncrna_lncRNA_12581</td>
<td>mirna_Cluster_6235</td>
<td>0.432</td>
<td>0.987</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="multi-way-interaction-analysis-exploratory-1" class="level3">
<h3 class="anchored" data-anchor-id="multi-way-interaction-analysis-exploratory-1">Multi-Way Interaction Analysis (Exploratory)</h3>
<ul>
<li><strong>Total genes analyzed:</strong> 553</li>
<li><strong>Genes with significant interactions (F-test):</strong> 0</li>
<li><strong>Mean improvement from interactions:</strong> 0.574</li>
</ul>
<section id="top-10-multi-way-interactions-exploratory-1" class="level4">
<h4 class="anchored" data-anchor-id="top-10-multi-way-interactions-exploratory-1">Top 10 Multi-Way Interactions (Exploratory)</h4>
<p><em>This table shows genes with the largest multi-regulator improvements. Current evidence suggests similar improvements can arise under randomized data; treat these results as hypothesis-generating rather than definitive.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Improvement</th>
<th>Significant Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_13066‚Äô, ‚ÄòPeve_00003034‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_13685‚Äô, ‚ÄòPeve_00034973‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_10907‚Äô, ‚ÄòPeve_00033654‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_05950‚Äô, ‚ÄòPeve_00044664‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_01981‚Äô, ‚ÄòPeve_00033650‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_03267‚Äô, ‚ÄòPeve_00013805‚Äô)</td>
<td>0.920</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_17015‚Äô, ‚ÄòPeve_00023327‚Äô)</td>
<td>0.919</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_02088‚Äô, ‚ÄòPeve_00026747‚Äô)</td>
<td>0.919</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_05713‚Äô, ‚ÄòPeve_00041095‚Äô)</td>
<td>0.919</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_12805‚Äô, ‚ÄòPeve_00005899‚Äô)</td>
<td>0.919</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="data-files-1" class="level2">
<h2 class="anchored" data-anchor-id="data-files-1">Data Files</h2>
<p><a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251130_091333/tables/" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251130_091333/tables/</a></p>
<p>The following data files were generated:</p>
<p>These CSV files contain the detailed results of context-dependent regulatory analysis, including interaction statistics, p-values, context strengths, and regulatory relationships for each analyzed gene-regulator pair.</p>
<ul>
<li><strong>high_methylation_gene_lncrna_correlations.csv</strong> (69461.9 KB)</li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> (675831.9 KB)</li>
<li><strong>high_methylation_gene_mirna_correlations.csv</strong> (262.4 KB)</li>
<li><strong>high_mirna_gene_lncrna_correlations.csv</strong> (65272.2 KB)</li>
<li><strong>high_mirna_gene_methylation_correlations.csv</strong> (604621.8 KB)</li>
<li><strong>high_mirna_gene_mirna_correlations.csv</strong> (144.7 KB)</li>
<li><strong>lncrna_mirna_context.csv</strong> (6740.5 KB)</li>
<li><strong>low_mirna_gene_lncrna_correlations.csv</strong> (111381.4 KB)</li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> (641498.3 KB)</li>
<li><strong>low_mirna_gene_mirna_correlations.csv</strong> (171.5 KB)</li>
<li><strong>methylation_mirna_context.csv</strong> (7651.1 KB)</li>
<li><strong>multi_way_interactions.csv</strong> (1213.2 KB)</li>
</ul>
<section id="table-definitions-and-statistical-confidence-1" class="level3">
<h3 class="anchored" data-anchor-id="table-definitions-and-statistical-confidence-1">Table Definitions and Statistical Confidence</h3>
<p>Below is a brief description of the main table types and how to assess statistical confidence for each:</p>
<ul>
<li><strong>methylation_mirna_context.csv</strong>:
<ul>
<li>One row per gene‚ÄìCpG‚ÄìmiRNA triplet.</li>
<li>Contains regression-based metrics (<code>r2_*</code>, <code>improvement_from_regulator2</code>, <code>improvement_from_interaction</code>), conditional correlations (<code>corr_high_regulator2</code>, <code>corr_low_regulator2</code>), and <code>context_strength</code>.</li>
<li>When empirical FDR is enabled, includes <code>empirical_fdr_threshold</code>, <code>empirical_fdr_estimated</code>, and <code>empirical_fdr_significant</code>.</li>
<li><strong>How to assess confidence</strong>: prioritize interactions with <code>empirical_fdr_significant == True</code> (if available); otherwise, use <code>context_strength</code> as the primary effect-size metric, ideally cross-referenced against random-data null runs.</li>
</ul></li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> / <strong>high_methylation_gene_mirna_correlations.csv</strong> / <strong>high_methylation_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>high-methylation context</strong>, defined using a sentinel CpG site.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within high-methylation samples.</li>
<li><strong>How to assess confidence</strong>: these p-values are not corrected for multiple testing; treat them as exploratory. For higher confidence, focus on strong effect sizes (|correlation| close to 1) and/or overlap with FDR-supported context interactions from <code>methylation_mirna_context.csv</code>.</li>
</ul></li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> / <strong>low_mirna_gene_mirna_correlations.csv</strong> / <strong>low_mirna_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>low-miRNA context</strong>, using a sentinel miRNA as the context-defining variable.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within low-miRNA samples.</li>
<li><strong>How to assess confidence</strong>: as above, p-values are unadjusted across many tests; use them as a guide for ranking, not strict significance. Strong |correlation| and consistency with patterns seen in <code>methylation_mirna_context.csv</code> or across contexts provide more persuasive evidence.</li>
</ul></li>
<li><strong>lncrna_mirna_context.csv</strong> (if lncRNA context module is enabled):
<ul>
<li>Regression-based lncRNA‚ÄìmiRNA‚Äìgene context metrics analogous to <code>methylation_mirna_context.csv</code>.</li>
<li>Empirical comparisons with randomized data suggest that current interaction metrics here are more exploratory; interpret ‚Äúcontext-dependent‚Äù calls cautiously.</li>
<li><strong>How to assess confidence</strong>: use this table primarily for hypothesis generation or to find lncRNAs associated with genes that already have strong methylation‚ÄìmiRNA context signals.</li>
</ul></li>
<li><strong>multi_way_interactions.csv</strong> (if multi-way module is enabled):
<ul>
<li>Summarizes multi-regulator regression models for each gene, comparing a simple model to a full model with many regulators.</li>
<li>Contains <code>improvement_from_regulators</code> and an F-test <code>interaction_p_value</code> with a boolean <code>has_significant_interactions</code>.</li>
<li><strong>How to assess confidence</strong>: current evidence shows that large improvements can also arise in randomized data; treat these results as exploratory and consider additional validation (e.g., overlap with simpler context metrics or external datasets).</li>
</ul></li>
</ul>
</section>
</section>
<section id="analysis-parameters-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-parameters-1">Analysis Parameters</h2>
<ul>
<li><strong>Parallel workers:</strong> 192</li>
<li><strong>Data directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/data/full-species-biomin/cleaned_peve</li>
<li><strong>Output directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/output/context_dependent_analysis_20251130_091333</li>
<li><strong>Analysis timestamp:</strong> 20251130_091333</li>
</ul>
</section>
<section id="conclusion-1" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-1">Conclusion</h2>
<p>This analysis successfully identified context-dependent regulatory interactions using optimized parallel processing. The results provide insights into how different regulatory layers interact in a context-specific manner.</p>
<p><em>Report generated by OptimizedContextDependentRegulationAnalysis on 2025-11-30 19:41:04</em></p>
</section>
</section>
<section id="apul-context-dependent-regulation-analysis-report" class="level1">
<h1>Apul Context-Dependent Regulation Analysis Report</h1>
<p><strong>Generated:</strong> 2025-12-01 11:13:07 <strong>Analysis ID:</strong> 20251201_061836</p>
<section id="executive-summary-2" class="level2">
<h2 class="anchored" data-anchor-id="executive-summary-2">Executive Summary</h2>
<p>This report presents the results of context-dependent regulatory interaction analysis between: - Gene expression - miRNA expression - lncRNA expression - DNA methylation</p>
</section>
<section id="analysis-overview-2" class="level2">
<h2 class="anchored" data-anchor-id="analysis-overview-2">Analysis Overview</h2>
<ul>
<li><strong>Parallel Processing:</strong> 192 CPU cores</li>
<li><strong>Available RAM:</strong> 2940.2 GB</li>
<li><strong>Datasets Loaded:</strong> 4 data types
<ul>
<li>Gene: 39 samples √ó 517 features</li>
<li>Lncrna: 39 samples √ó 15559 features</li>
<li>Mirna: 39 samples √ó 51 features</li>
<li>Methylation: 39 samples √ó 66428 features</li>
</ul></li>
</ul>
</section>
<section id="results-summary-2" class="level2">
<h2 class="anchored" data-anchor-id="results-summary-2">Results Summary</h2>
<section id="methylation-mirna-context-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="methylation-mirna-context-analysis-2">Methylation-miRNA Context Analysis</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 51150</li>
<li><strong>Context-dependent interactions (F-test):</strong> 8765</li>
<li><strong>Mean improvement from interaction:</strong> 0.027</li>
<li><strong>Mean context strength:</strong> 0.346</li>
</ul>
<section id="top-10-methylation-mirna-interactions-by-context-strength-2" class="level4">
<h4 class="anchored" data-anchor-id="top-10-methylation-mirna-interactions-by-context-strength-2">Top 10 Methylation-miRNA Interactions (by Context Strength)</h4>
<p><em>This table shows genes whose regulation by DNA methylation is context-dependent on miRNA expression levels, ranked by context strength.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 21%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Methylation</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
<th>Empirical FDR Sig.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_05303‚Äô, ‚ÄòFUN_023974‚Äô)</td>
<td>methylation_CpG_ptg000001l_9710125</td>
<td>mirna_Cluster_3109</td>
<td>0.060</td>
<td>1.881</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_07265‚Äô, ‚ÄòFUN_033056‚Äô)</td>
<td>methylation_CpG_ptg000021l_10139814</td>
<td>mirna_Cluster_3109</td>
<td>0.018</td>
<td>1.875</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_14547‚Äô, ‚ÄòFUN_019026‚Äô)</td>
<td>methylation_CpG_ptg000023l_11736283</td>
<td>mirna_Cluster_3109</td>
<td>0.023</td>
<td>1.875</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_07265‚Äô, ‚ÄòFUN_033056‚Äô)</td>
<td>methylation_CpG_ptg000018l_7377398</td>
<td>mirna_Cluster_3109</td>
<td>0.067</td>
<td>1.854</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_10509‚Äô, ‚ÄòFUN_002531‚Äô)</td>
<td>methylation_CpG_ptg000031l_5310815</td>
<td>mirna_Cluster_3109</td>
<td>0.004</td>
<td>1.837</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_06610‚Äô, ‚ÄòFUN_029760‚Äô)</td>
<td>methylation_CpG_ptg000031l_5310762</td>
<td>mirna_Cluster_3109</td>
<td>0.004</td>
<td>1.833</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_10811‚Äô, ‚ÄòFUN_006888‚Äô)</td>
<td>methylation_CpG_ptg000023l_8252944</td>
<td>mirna_Cluster_3109</td>
<td>0.006</td>
<td>1.756</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_14711‚Äô, ‚ÄòFUN_024326‚Äô)</td>
<td>methylation_CpG_ptg000012l_17885415</td>
<td>mirna_Cluster_3109</td>
<td>0.045</td>
<td>1.672</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_10811‚Äô, ‚ÄòFUN_006888‚Äô)</td>
<td>methylation_CpG_ptg000027l_7575122</td>
<td>mirna_Cluster_3109</td>
<td>0.015</td>
<td>1.660</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_06610‚Äô, ‚ÄòFUN_029760‚Äô)</td>
<td>methylation_CpG_ptg000021l_6263529</td>
<td>mirna_Cluster_3109</td>
<td>0.012</td>
<td>1.657</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="lncrna-mirna-context-analysis-exploratory-2" class="level3">
<h3 class="anchored" data-anchor-id="lncrna-mirna-context-analysis-exploratory-2">lncRNA-miRNA Context Analysis (Exploratory)</h3>
<ul>
<li><strong>Total interactions analyzed:</strong> 51150</li>
<li><strong>Context-dependent interactions (F-test):</strong> 8365</li>
<li><strong>Mean improvement from interaction:</strong> 0.021</li>
<li><strong>Mean context strength:</strong> 0.270</li>
</ul>
<section id="top-10-lncrna-mirna-interactions-exploratory-2" class="level4">
<h4 class="anchored" data-anchor-id="top-10-lncrna-mirna-interactions-exploratory-2">Top 10 lncRNA-miRNA Interactions (Exploratory)</h4>
<p><em>This table identifies genes whose lncRNA-mediated regulation varies depending on miRNA expression. Note that current interaction metrics behave similarly or more strongly under randomized data and should be interpreted cautiously.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 22%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>lncRNA</th>
<th>miRNA</th>
<th>Improvement</th>
<th>Context Strength</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_48837</td>
<td>mirna_Cluster_14165</td>
<td>0.420</td>
<td>1.162</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_48837</td>
<td>mirna_Cluster_14146</td>
<td>0.407</td>
<td>1.082</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_48837</td>
<td>mirna_Cluster_3226</td>
<td>0.406</td>
<td>0.969</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_48837</td>
<td>mirna_Cluster_10452</td>
<td>0.400</td>
<td>0.910</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_23415</td>
<td>mirna_Cluster_9512</td>
<td>0.394</td>
<td>1.033</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_23414</td>
<td>mirna_Cluster_9512</td>
<td>0.392</td>
<td>1.021</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_23416</td>
<td>mirna_Cluster_9512</td>
<td>0.391</td>
<td>1.028</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_54028</td>
<td>mirna_Cluster_4752</td>
<td>0.387</td>
<td>0.966</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_48837</td>
<td>mirna_Cluster_4752</td>
<td>0.379</td>
<td>1.288</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_10579‚Äô, ‚ÄòFUN_003891‚Äô)</td>
<td>lncrna_lncRNA_44695</td>
<td>mirna_Cluster_4752</td>
<td>0.377</td>
<td>0.834</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="multi-way-interaction-analysis-exploratory-2" class="level3">
<h3 class="anchored" data-anchor-id="multi-way-interaction-analysis-exploratory-2">Multi-Way Interaction Analysis (Exploratory)</h3>
<ul>
<li><strong>Total genes analyzed:</strong> 517</li>
<li><strong>Genes with significant interactions (F-test):</strong> 0</li>
<li><strong>Mean improvement from interactions:</strong> 0.750</li>
</ul>
<section id="top-10-multi-way-interactions-exploratory-2" class="level4">
<h4 class="anchored" data-anchor-id="top-10-multi-way-interactions-exploratory-2">Top 10 Multi-Way Interactions (Exploratory)</h4>
<p><em>This table shows genes with the largest multi-regulator improvements. Current evidence suggests similar improvements can arise under randomized data; treat these results as hypothesis-generating rather than definitive.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Rank</th>
<th>Gene</th>
<th>Improvement</th>
<th>Significant Interactions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>(‚ÄòOG_10450‚Äô, ‚ÄòFUN_001498‚Äô)</td>
<td>0.928</td>
<td>False</td>
</tr>
<tr class="even">
<td>2</td>
<td>(‚ÄòOG_12424‚Äô, ‚ÄòFUN_030063‚Äô)</td>
<td>0.928</td>
<td>False</td>
</tr>
<tr class="odd">
<td>3</td>
<td>(‚ÄòOG_10523‚Äô, ‚ÄòFUN_002672‚Äô)</td>
<td>0.928</td>
<td>False</td>
</tr>
<tr class="even">
<td>4</td>
<td>(‚ÄòOG_12286‚Äô, ‚ÄòFUN_028190‚Äô)</td>
<td>0.926</td>
<td>False</td>
</tr>
<tr class="odd">
<td>5</td>
<td>(‚ÄòOG_09897‚Äô, ‚ÄòFUN_042992‚Äô)</td>
<td>0.925</td>
<td>False</td>
</tr>
<tr class="even">
<td>6</td>
<td>(‚ÄòOG_14500‚Äô, ‚ÄòFUN_017790‚Äô)</td>
<td>0.925</td>
<td>False</td>
</tr>
<tr class="odd">
<td>7</td>
<td>(‚ÄòOG_04209‚Äô, ‚ÄòFUN_016791‚Äô)</td>
<td>0.923</td>
<td>False</td>
</tr>
<tr class="even">
<td>8</td>
<td>(‚ÄòOG_10759‚Äô, ‚ÄòFUN_006140‚Äô)</td>
<td>0.922</td>
<td>False</td>
</tr>
<tr class="odd">
<td>9</td>
<td>(‚ÄòOG_08920‚Äô, ‚ÄòFUN_038376‚Äô)</td>
<td>0.921</td>
<td>False</td>
</tr>
<tr class="even">
<td>10</td>
<td>(‚ÄòOG_02176‚Äô, ‚ÄòFUN_008525‚Äô)</td>
<td>0.920</td>
<td>False</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="data-files-2" class="level2">
<h2 class="anchored" data-anchor-id="data-files-2">Data Files</h2>
<p><a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251201_061836/tables/" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251201_061836/tables/</a></p>
<p>The following data files were generated:</p>
<p>These CSV files contain the detailed results of context-dependent regulatory analysis, including interaction statistics, p-values, context strengths, and regulatory relationships for each analyzed gene-regulator pair.</p>
<ul>
<li><strong>high_methylation_gene_lncrna_correlations.csv</strong> (130703.2 KB)</li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> (284276.8 KB)</li>
<li><strong>high_methylation_gene_mirna_correlations.csv</strong> (177.7 KB)</li>
<li><strong>lncrna_mirna_context.csv</strong> (13579.9 KB)</li>
<li><strong>low_mirna_gene_lncrna_correlations.csv</strong> (96572.2 KB)</li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> (343631.8 KB)</li>
<li><strong>low_mirna_gene_mirna_correlations.csv</strong> (266.4 KB)</li>
<li><strong>methylation_mirna_context.csv</strong> (14423.3 KB)</li>
<li><strong>multi_way_interactions.csv</strong> (968.1 KB)</li>
</ul>
<section id="table-definitions-and-statistical-confidence-2" class="level3">
<h3 class="anchored" data-anchor-id="table-definitions-and-statistical-confidence-2">Table Definitions and Statistical Confidence</h3>
<p>Below is a brief description of the main table types and how to assess statistical confidence for each:</p>
<ul>
<li><strong>methylation_mirna_context.csv</strong>:
<ul>
<li>One row per gene‚ÄìCpG‚ÄìmiRNA triplet.</li>
<li>Contains regression-based metrics (<code>r2_*</code>, <code>improvement_from_regulator2</code>, <code>improvement_from_interaction</code>), conditional correlations (<code>corr_high_regulator2</code>, <code>corr_low_regulator2</code>), and <code>context_strength</code>.</li>
<li>When empirical FDR is enabled, includes <code>empirical_fdr_threshold</code>, <code>empirical_fdr_estimated</code>, and <code>empirical_fdr_significant</code>.</li>
<li><strong>How to assess confidence</strong>: prioritize interactions with <code>empirical_fdr_significant == True</code> (if available); otherwise, use <code>context_strength</code> as the primary effect-size metric, ideally cross-referenced against random-data null runs.</li>
</ul></li>
<li><strong>high_methylation_gene_methylation_correlations.csv</strong> / <strong>high_methylation_gene_mirna_correlations.csv</strong> / <strong>high_methylation_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>high-methylation context</strong>, defined using a sentinel CpG site.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within high-methylation samples.</li>
<li><strong>How to assess confidence</strong>: these p-values are not corrected for multiple testing; treat them as exploratory. For higher confidence, focus on strong effect sizes (|correlation| close to 1) and/or overlap with FDR-supported context interactions from <code>methylation_mirna_context.csv</code>.</li>
</ul></li>
<li><strong>low_mirna_gene_methylation_correlations.csv</strong> / <strong>low_mirna_gene_mirna_correlations.csv</strong> / <strong>low_mirna_gene_lncrna_correlations.csv</strong>:
<ul>
<li>Correlation networks in the <strong>low-miRNA context</strong>, using a sentinel miRNA as the context-defining variable.</li>
<li>Each row is a gene‚Äìregulator pair with a Pearson correlation (<code>correlation</code>) and raw <code>p_value</code> computed only within low-miRNA samples.</li>
<li><strong>How to assess confidence</strong>: as above, p-values are unadjusted across many tests; use them as a guide for ranking, not strict significance. Strong |correlation| and consistency with patterns seen in <code>methylation_mirna_context.csv</code> or across contexts provide more persuasive evidence.</li>
</ul></li>
<li><strong>lncrna_mirna_context.csv</strong> (if lncRNA context module is enabled):
<ul>
<li>Regression-based lncRNA‚ÄìmiRNA‚Äìgene context metrics analogous to <code>methylation_mirna_context.csv</code>.</li>
<li>Empirical comparisons with randomized data suggest that current interaction metrics here are more exploratory; interpret ‚Äúcontext-dependent‚Äù calls cautiously.</li>
<li><strong>How to assess confidence</strong>: use this table primarily for hypothesis generation or to find lncRNAs associated with genes that already have strong methylation‚ÄìmiRNA context signals.</li>
</ul></li>
<li><strong>multi_way_interactions.csv</strong> (if multi-way module is enabled):
<ul>
<li>Summarizes multi-regulator regression models for each gene, comparing a simple model to a full model with many regulators.</li>
<li>Contains <code>improvement_from_regulators</code> and an F-test <code>interaction_p_value</code> with a boolean <code>has_significant_interactions</code>.</li>
<li><strong>How to assess confidence</strong>: current evidence shows that large improvements can also arise in randomized data; treat these results as exploratory and consider additional validation (e.g., overlap with simpler context metrics or external datasets).</li>
</ul></li>
</ul>
</section>
</section>
<section id="analysis-parameters-2" class="level2">
<h2 class="anchored" data-anchor-id="analysis-parameters-2">Analysis Parameters</h2>
<ul>
<li><strong>Parallel workers:</strong> 192</li>
<li><strong>Data directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/data/full-species-biomin/cleaned_apul</li>
<li><strong>Output directory:</strong> /mmfs1/gscratch/scrubbed/sr320/github/ConTra/output/context_dependent_analysis_20251201_061836</li>
<li><strong>Analysis timestamp:</strong> 20251201_061836</li>
</ul>
</section>
<section id="conclusion-2" class="level2">
<h2 class="anchored" data-anchor-id="conclusion-2">Conclusion</h2>
<p>This analysis successfully identified context-dependent regulatory interactions using optimized parallel processing. The results provide insights into how different regulatory layers interact in a context-specific manner.</p>
<p><em>Report generated by OptimizedContextDependentRegulationAnalysis on 2025-12-01 11:13:07</em></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/63-contra/</guid>
  <pubDate>Sat, 29 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-27-36.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Calcification Count Matrices</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/62-biomin/</link>
  <description><![CDATA[ 





<p>Pulling out calcification / biomin gene counts.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TLDR
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/apul_biomin_counts.csv</li>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/peve_biomin_counts.csv</li>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/ptua_biomin_counts.csv</li>
</ul>
</div>
</div>
<p>Have list of biomineralization genes from coral literature (e.g., Takeuchi et al.&nbsp;2016, Ramos-Silva et al.&nbsp;2013)</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">-in ../output/31-biomin-pathway/Stylo-biomin.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">-out ../output/31-biomin-pathway/Stylo-biomin-db</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> ../output/11.3-ortholog-annotation/representative_sequences.faa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> ../output/31-biomin-pathway/Stylo-biomin-db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 qseqid sseqid evalue bitscore"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-evalue</span> 1e-20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 10</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths</span></span>
<span id="cb3-5">blast_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv"</span></span>
<span id="cb3-6">mapping_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read BLAST results</span></span>
<span id="cb3-9">blast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(</span>
<span id="cb3-10">  blast_file,</span>
<span id="cb3-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evalue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>)</span>
<span id="cb3-12">)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read ortholog mapping</span></span>
<span id="cb3-15">mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(mapping_file)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join to add group_id to each gene in blast results</span></span>
<span id="cb3-18">annotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> blast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapping <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb3-20"></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write out CSV</span></span>
<span id="cb3-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(annotated, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>)</span>
<span id="cb3-24"></span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View result</span></span>
<span id="cb3-27">annotated</span></code></pre></div>
<pre><code>gene_id,hit,evalue,score,group_id
FUN_000236-T1,XP_022780303.1,6.1399999999999995e-24,102,OG_00030
FUN_000857-T1,XP_022795459.1,1.3899999999999998e-159,447,OG_00171
FUN_000867-T1,XP_022780694.1,1.6e-34,125,OG_00176
FUN_001009-T1,XP_022789591.1,7.039999999999999e-107,338,OG_00246
FUN_001088-T1,XP_022783044.1,3.9e-35,130,OG_00297
FUN_001089-T1,XP_022783044.1,2.1699999999999998e-23,93.2,OG_00298
FUN_001101-T1,XP_022783044.1,1.22e-31,118,OG_00302
FUN_001107-T1,XP_022795459.1,9.45e-59,190,OG_00305
FUN_001118-T1,XP_022801359.1,1.33e-35,124,OG_00314</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb5-2"></span>
<span id="cb5-3">ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/biomin-OG.txt"</span>,</span>
<span id="cb5-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6">map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span>)</span>
<span id="cb5-7"></span>
<span id="cb5-8">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">semi_join</span>(ogs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt;&lt; KEY FIX</span></span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb6-2"></span>
<span id="cb6-3">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/MOSAiC/refs/heads/main/data/orthologs"</span></span>
<span id="cb6-4"></span>
<span id="cb6-5">apul <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apul-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb6-6">peve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"peve-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb6-7">ptua <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ptua-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id format matches count matrices</span></span>
<span id="cb7-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter apul &amp; add group_id as first column</span></span>
<span id="cb7-8">apul_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb7-10">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Apul"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb7-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt;&lt; KEY LINEter(species == "Apul") </span></span>
<span id="cb7-14"></span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb7-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb7-18">  apul_filt,</span>
<span id="cb7-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/apul_biomin_counts.csv"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id in mapping file matches (remove transcript suffix)</span></span>
<span id="cb8-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter Peve matrix, normalize gene_id, join, move group_id to column 1</span></span>
<span id="cb8-8">peve_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^gene-"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt; FIX HERE</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb8-11">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peve"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb8-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)</span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb8-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb8-18">  peve_filt,</span>
<span id="cb8-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/peve_biomin_counts.csv"</span></span>
<span id="cb8-20">)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id in mapping file matches count matrix format</span></span>
<span id="cb9-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter Ptua matrix, normalize gene_id, join, move group_id to column 1</span></span>
<span id="cb9-8">ptua_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^gene-"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt; KEY FIX</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb9-11">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ptua"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb9-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb9-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)</span>
<span id="cb9-17"></span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb9-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb9-21">  ptua_filt,</span>
<span id="cb9-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/ptua_biomin_counts.csv"</span></span>
<span id="cb9-23">)</span></code></pre></div>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/62-biomin/</guid>
  <pubDate>Wed, 26 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-26_10-46-20.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Timeseries Gene Level methylation</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/61-gene-meth/</link>
  <description><![CDATA[ 





<p>Getting gene-level methylation using 10xbedgraphs‚Ä¶</p>
<p>Here is a walk through of one species..</p>
<section id="gene-model-preparation" class="level2">
<h2 class="anchored" data-anchor-id="gene-model-preparation">Gene Model Preparation</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3</span></code></pre></div>
<pre><code>##gff-version 3
##sequence-region   Pocillopora_meandrina_HIv1___xfSc0000716 887 39392
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    gene    887 6811    .   -   .   ID=gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    mRNA    887 6811    .   -   .   ID=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 887 973 .   -   0   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    887 973 .   -   0   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 1828    1882    .   -   1   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    1828    1882    .   -   1   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-2;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 2308    2371    .   -   2   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    2308    2371    .   -   2   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-3;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1</code></pre>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f3</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^#"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nr</span></span></code></pre></div>
<pre><code> 208535 exon
 208535 CDS
  31840 mRNA
  31840 gene</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gawk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3=="gene" {</span></span>
<span id="cb5-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    split($9, a, ";");</span></span>
<span id="cb5-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for(i in a){</span></span>
<span id="cb5-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if(a[i] ~ /^ID=/){</span></span>
<span id="cb5-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            sub("ID=", "", a[i]);</span></span>
<span id="cb5-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            gene_id = a[i];</span></span>
<span id="cb5-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb5-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb5-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print $1 "\t" $4-1 "\t" $5 "\t" gene_id;</span></span>
<span id="cb5-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}'</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___xfSc0000716    886 6811    gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    7304    12239   gene-Pocillopora_meandrina_HIv1___RNAseq.g29952.t1
Pocillopora_meandrina_HIv1___xfSc0000716    21621   23112   gene-Pocillopora_meandrina_HIv1___RNAseq.g29953.t1
Pocillopora_meandrina_HIv1___xfSc0000716    25312   26016   gene-Pocillopora_meandrina_HIv1___RNAseq.g29954.t1
Pocillopora_meandrina_HIv1___xfSc0000716    34770   39392   gene-Pocillopora_meandrina_HIv1___RNAseq.g29955.t1
Pocillopora_meandrina_HIv1___Sc0000029  18377   30613   gene-Pocillopora_meandrina_HIv1___RNAseq.g10233.t1
Pocillopora_meandrina_HIv1___Sc0000029  35435   38326   gene-Pocillopora_meandrina_HIv1___RNAseq.g10234.t1
Pocillopora_meandrina_HIv1___Sc0000029  39901   40640   gene-Pocillopora_meandrina_HIv1___RNAseq.g10235.t1
Pocillopora_meandrina_HIv1___Sc0000029  56431   56839   gene-Pocillopora_meandrina_HIv1___RNAseq.g10236.t1
Pocillopora_meandrina_HIv1___Sc0000029  96446   105523  gene-Pocillopora_meandrina_HIv1___RNAseq.g10237.t1
31840 ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</code></pre>
</section>
<section id="prepping-bedgraphs" class="level1">
<h1>Prepping bedgraphs</h1>
<pre><code>mkdir -p ../data/10xbedgraph
cd ../data/10xbedgraph
wget -r -l1 --no-parent -nd -A '*10x.bedgraph' \
     'https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250821_meth_Ptua/'</code></pre>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/10xbedgraph/POC-40-TP1_10x.bedgraph</span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../data/10xbedgraph/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb10-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k2,2n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span>.sorted.bedgraph</span>
<span id="cb10-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/10xbedgraph/POC-40-TP1_10x.sorted.bedgraph</span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___Sc0000000  2852    2854    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  2908    2910    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  3375    3377    6.666667
Pocillopora_meandrina_HIv1___Sc0000000  3384    3386    7.142857
Pocillopora_meandrina_HIv1___Sc0000000  3429    3431    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  3570    3572    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  5128    5130    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  6101    6103    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  6110    6112    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  9318    9320    0.000000</code></pre>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/09-Ptua-Gene-Methylation/</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k2,2n</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-4">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.sorted.bed</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../data/10xbedgraph/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_10x.sorted.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _10x.sorted.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-8"></span>
<span id="cb13-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> map <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.sorted.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> mean,count <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-14">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/09-Ptua-Gene-Methylation/gene_methylation_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.tsv</span>
<span id="cb13-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___Sc0000000  10770   23652   gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  77.1836165  18
Pocillopora_meandrina_HIv1___Sc0000000  25128   33764   gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  60.81863374 38
Pocillopora_meandrina_HIv1___Sc0000000  33907   39296   gene-Pocillopora_meandrina_HIv1___TS.g25664.t1  20.83649989 45
Pocillopora_meandrina_HIv1___Sc0000000  44371   50798   gene-Pocillopora_meandrina_HIv1___RNAseq.g20905.t1  0.2109149468    282
Pocillopora_meandrina_HIv1___Sc0000000  52049   53624   gene-Pocillopora_meandrina_HIv1___RNAseq.g20906.t1  0.2717391282    39
Pocillopora_meandrina_HIv1___Sc0000000  54620   71869   gene-Pocillopora_meandrina_HIv1___RNAseq.g20907.t1  9.341014667 255
Pocillopora_meandrina_HIv1___Sc0000000  75141   87120   gene-Pocillopora_meandrina_HIv1___RNAseq.g20908.t1  35.22936122 74
Pocillopora_meandrina_HIv1___Sc0000000  89333   101789  gene-Pocillopora_meandrina_HIv1___RNAseq.g20909.t1  32.38789587 97
Pocillopora_meandrina_HIv1___Sc0000000  104428  116100  gene-Pocillopora_meandrina_HIv1___RNAseq.g20910.t1  54.14505446 61
Pocillopora_meandrina_HIv1___Sc0000000  117505  121120  gene-Pocillopora_meandrina_HIv1___RNAseq.g20911.t1  27.60554107 54</code></pre>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/09-Ptua-Gene-Methylation/gene_methylation<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.tsv<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb15-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_gt10.tsv"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb15-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$6 &gt; 10'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$out</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/09-Ptua-Gene-Methylation/gene_methylation_POC-40-TP<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_gt10.tsv</span></code></pre></div>
<pre><code>==&gt; ../output/09-Ptua-Gene-Methylation/gene_methylation_POC-40-TP1_gt10.tsv &lt;==
Pocillopora_meandrina_HIv1___Sc0000000  10770   23652   gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  78.86871104 24
Pocillopora_meandrina_HIv1___Sc0000000  25128   33764   gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  66.12523937 38
Pocillopora_meandrina_HIv1___Sc0000000  33907   39296   gene-Pocillopora_meandrina_HIv1___TS.g25664.t1  25.66347985 41
Pocillopora_meandrina_HIv1___Sc0000000  44371   50798   gene-Pocillopora_meandrina_HIv1___RNAseq.g20905.t1  0.61153482  250
Pocillopora_meandrina_HIv1___Sc0000000  52049   53624   gene-Pocillopora_meandrina_HIv1___RNAseq.g20906.t1  1.662464711 38
Pocillopora_meandrina_HIv1___Sc0000000  54620   71869   gene-Pocillopora_meandrina_HIv1___RNAseq.g20907.t1  8.299407695 256
Pocillopora_meandrina_HIv1___Sc0000000  75141   87120   gene-Pocillopora_meandrina_HIv1___RNAseq.g20908.t1  32.24347769 74
Pocillopora_meandrina_HIv1___Sc0000000  89333   101789  gene-Pocillopora_meandrina_HIv1___RNAseq.g20909.t1  29.81549905 94
Pocillopora_meandrina_HIv1___Sc0000000  104428  116100  gene-Pocillopora_meandrina_HIv1___RNAseq.g20910.t1  54.3217754  63
Pocillopora_meandrina_HIv1___Sc0000000  117505  121120  gene-Pocillopora_meandrina_HIv1___RNAseq.g20911.t1  22.62597314 65</code></pre>
<section id="combined-matrix" class="level2">
<h2 class="anchored" data-anchor-id="combined-matrix">Combined Matrix</h2>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing all filtered tsv files</span></span>
<span id="cb18-4">indir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation"</span></span>
<span id="cb18-5"></span>
<span id="cb18-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List all filtered files</span></span>
<span id="cb18-7">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(indir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_methylation.*_gt10.tsv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read and combine</span></span>
<span id="cb18-10">df_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(files, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(f) {</span>
<span id="cb18-11">  sample_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_methylation_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> _) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_gt10.tsv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> _)</span>
<span id="cb18-14"></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(f, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb18-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(X4, X5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb18-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> X4, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample_name :=</span> X5)</span>
<span id="cb18-18">})</span>
<span id="cb18-19"></span>
<span id="cb18-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full join all files by gene_id</span></span>
<span id="cb18-21">merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(df_list, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb18-22"></span>
<span id="cb18-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- NEW PART: keep genes present in &gt;=75% of samples ----</span></span>
<span id="cb18-24">merged_75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb18-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fraction of samples with non-NA values (ignores gene_id column)</span></span>
<span id="cb18-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frac_nonNA =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id)))</span>
<span id="cb18-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(frac_nonNA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac_nonNA)</span>
<span id="cb18-31"></span>
<span id="cb18-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save 75% filtered matrix</span></span>
<span id="cb18-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(merged_75, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span></code></pre></div>
<pre><code>23370 ../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv
gene_id POC-201-TP1 POC-201-TP2 POC-219-TP1 POC-219-TP2 POC-219-TP3 POC-219-TP4 POC-222-TP1 POC-222-TP3 POC-222-TP4 POC-255-TP1 POC-255-TP2 POC-255-TP3 POC-259-TP1 POC-259-TP2 POC-40-TP1  POC-40-TP2  POC-40-TP3  POC-40-TP4  POC-42-TP2  POC-42-TP4  POC-52-TP1  POC-52-TP2  POC-52-TP3  POC-52-TP4  POC-53-TP1  POC-53-TP2  POC-53-TP3  POC-53-TP4  POC-57-TP1  POC-57-TP2  POC-57-TP3  POC-57-TP4
gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  55.94819507 65  NA  56.71798513 70.75064638 72.97016588 69.38569095 61.48214065 60.15602938 68.71286394 68.121314   NA  80.14404553 81.65033473 78.86871104 75.75863129 73.52938063 77.1836165  63.71908893 73.56089086 NA  63.53896107 61.79727092 NA  69.83198112 66.01362921 48.35913809 NA  71.90167729 75.73253744 74.34254614 65.64244627
gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  62.07071959 64.30941694 57.89994524 57.9764581  62.95167124 61.53853367 59.22841108 59.25982624 56.56210374 57.61653049 56.71230877 62.92154108 61.34633203 67.04912922 66.12523937 64.45467636 63.47604045 60.81863374 58.51124484 60.36185731 57.97446009 60.10673518 56.45465472 53.58677349 57.63890561 60.56861659 56.60354664 54.7309886  62.98476886 62.72254031 66.12983122 63.81437656</code></pre>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb20-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb20-8"></span>
<span id="cb20-9">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb20-12"></span>
<span id="cb20-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1 ‚Äî Impute NA with row means</span></span>
<span id="cb20-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-16">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-17"></span>
<span id="cb20-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb20-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all-NA rows</span></span>
<span id="cb20-20">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb20-21">}</span>
<span id="cb20-22"></span>
<span id="cb20-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2 ‚Äî Remove zero-variance rows</span></span>
<span id="cb20-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-26">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb20-27">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb20-28"></span>
<span id="cb20-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3 ‚Äî Remove rows still containing Inf/NaN</span></span>
<span id="cb20-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-32">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb20-33"></span>
<span id="cb20-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heatmap 1 ‚Äî Scaled (same as before)</span></span>
<span id="cb20-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb20-38">  mat2,</span>
<span id="cb20-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"row"</span>,</span>
<span id="cb20-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb20-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb20-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene-level Methylation Patterns (Scaled)"</span></span>
<span id="cb20-43">)</span>
<span id="cb20-44"></span>
<span id="cb20-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heatmap 2 ‚Äî Actual methylation values (Unscaled)</span></span>
<span id="cb20-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb20-49">  mat2,</span>
<span id="cb20-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb20-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb20-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb20-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene-level Methylation Values (Raw)"</span>,</span>
<span id="cb20-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optional nicer palette</span></span>
<span id="cb20-55">)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-49.png" class="img-fluid figure-img"></p>
<figcaption>heatmap_scaled</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RColorBrewer)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb21-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb21-8"></span>
<span id="cb21-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to matrix</span></span>
<span id="cb21-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-12">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb21-15"></span>
<span id="cb21-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Impute NA with row means</span></span>
<span id="cb21-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-19">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-20"></span>
<span id="cb21-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb21-22">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if entire row is NA</span></span>
<span id="cb21-23">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb21-24">}</span>
<span id="cb21-25"></span>
<span id="cb21-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Remove zero-variance genes </span></span>
<span id="cb21-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (these blow up PCA scaling)</span></span>
<span id="cb21-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-30">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb21-31">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, ]</span>
<span id="cb21-32"></span>
<span id="cb21-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Remove genes containing any Inf/NaN</span></span>
<span id="cb21-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-36">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), ]</span>
<span id="cb21-37"></span>
<span id="cb21-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4: Transpose (samples as rows)</span></span>
<span id="cb21-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-41">mat2_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(mat2)</span>
<span id="cb21-42"></span>
<span id="cb21-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample group</span></span>
<span id="cb21-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-46">sample_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(mat2_t), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POC-[0-9]+"</span>)</span>
<span id="cb21-47"></span>
<span id="cb21-48">ngroups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(sample_groups))</span>
<span id="cb21-49"></span>
<span id="cb21-50">colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, ngroups), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>ngroups]</span>
<span id="cb21-51">group_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setNames</span>(colors, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(sample_groups))</span>
<span id="cb21-52"></span>
<span id="cb21-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 5: Run PCA safely</span></span>
<span id="cb21-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-56">pca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prcomp</span>(mat2_t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-57"></span>
<span id="cb21-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 6: Build plotting DF</span></span>
<span id="cb21-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-61">pca_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb21-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PC1 =</span> pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb21-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PC2 =</span> pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb21-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb21-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample_groups</span>
<span id="cb21-66">)</span>
<span id="cb21-67"></span>
<span id="cb21-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 7: Plot PCA</span></span>
<span id="cb21-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(pca_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(PC1, PC2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> group_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PCA of Gene-Level Methylation"</span>,</span>
<span id="cb21-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Group"</span></span>
<span id="cb21-79">  )</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-17.png" class="img-fluid figure-img"></p>
<figcaption>pca</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and convert to matrix</span></span>
<span id="cb22-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-7">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1 ‚Äî Impute NA with row means</span></span>
<span id="cb22-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-14">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb22-15"></span>
<span id="cb22-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb22-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handles all-NA rows</span></span>
<span id="cb22-18">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb22-19">}</span>
<span id="cb22-20"></span>
<span id="cb22-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2 ‚Äî Remove zero-variance genes</span></span>
<span id="cb22-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (these make correlation produce NA columns)</span></span>
<span id="cb22-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-25">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb22-26">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb22-27"></span>
<span id="cb22-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3 ‚Äî Remove any rows still containing Inf/NaN</span></span>
<span id="cb22-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-31">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb22-32"></span>
<span id="cb22-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4 ‚Äî Compute correlation matrix safely</span></span>
<span id="cb22-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-36">cor_mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(mat2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pairwise.complete.obs"</span>)</span>
<span id="cb22-37"></span>
<span id="cb22-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 5 ‚Äî Remove NA rows/columns in correlation matrix (if any remain)</span></span>
<span id="cb22-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-41">finite_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(cor_mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x)))</span>
<span id="cb22-42">cor_mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cor_mat[finite_cols, finite_cols]</span>
<span id="cb22-43"></span>
<span id="cb22-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 6 ‚Äî Plot sample‚Äìsample correlation heatmap</span></span>
<span id="cb22-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(cor_mat2,</span>
<span id="cb22-48">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample‚ÄìSample Correlation"</span>,</span>
<span id="cb22-49">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>,</span>
<span id="cb22-50">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-05-08.png" class="img-fluid figure-img"></p>
<figcaption>samplesample</figcaption>
</figure>
</div>
</section>
<section id="quick-species-comparison" class="level2">
<h2 class="anchored" data-anchor-id="quick-species-comparison">Quick Species Comparison</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Apul</th>
<th>Peve</th>
<th>Ptua</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-14-56.png" width="250"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-16-52.png" width="250"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-49.png" width="250"></td>
</tr>
</tbody>
</table>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/61-gene-meth/</guid>
  <pubDate>Tue, 25 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_10-10-01.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Biomineraliztion in dark matter</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/58-biomin/</link>
  <description><![CDATA[ 





<p>Have list of biomineralization genes from coral literature (e.g., Takeuchi et al.&nbsp;2016, Ramos-Silva et al.&nbsp;2013)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Accession / GeneID</th>
<th>Blasted protein in Stylophora</th>
<th>Definition</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AAD11470.1</td>
<td>XP_022803851.1</td>
<td>L-type calcium channel alpha-1 subunit</td>
<td>Zoccola et al., 1999</td>
</tr>
<tr class="even">
<td>AAR13013.1</td>
<td>XP_022785723.1</td>
<td>plasma membrane calcium ATPase</td>
<td>Zoccola et al., 2004</td>
</tr>
<tr class="odd">
<td>ACE95141.1</td>
<td>XP_022799914.1</td>
<td>carbonic anhydrase</td>
<td>Moya et al., 2008</td>
</tr>
<tr class="even">
<td>AGE35225.2</td>
<td>XP_022785805.1</td>
<td>CARP1</td>
<td>Mass et al., 2013</td>
</tr>
<tr class="odd">
<td>AGE35226.1</td>
<td>XP_022794102.1</td>
<td>CARP3</td>
<td>Mass et al., 2013</td>
</tr>
<tr class="even">
<td>AGG36361.1</td>
<td>XP_022784808.1</td>
<td>Protoacadherin (PC4)</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>AJQ31790.1</td>
<td>XP_022788307.1</td>
<td>solute carrier family 4 member gamma</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>aug_v2a.00002.t1</td>
<td>XP_022808048.1, XP_022808045.1, XP_022790310.1</td>
<td>EP-like 2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.01440.t1 (aug_v2a.01441.t1)</td>
<td>XP_022780690.1</td>
<td>Adi-SAARP2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.02830</td>
<td>XP_022782704.1, XP_022782703.1</td>
<td>PKD1-related protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.02830.t1</td>
<td>XP_022782704.1, XP_022782703.1</td>
<td>PKD1-related protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.05945.t1</td>
<td>XP_022783430.1</td>
<td>TSP-1 and VWA domain-containing</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.06122.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.06123.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.06327.t1</td>
<td>XP_022781839.1, XP_022781915.1</td>
<td>SAARP3</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.07627.t1</td>
<td>XP_022806326.1</td>
<td>Zona pellucida domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.09809.t1</td>
<td>XP_022801334.1</td>
<td>Mucin4-like protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.09968.t1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDLr domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.09969.t1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDLr domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.11068.t1</td>
<td>XP_022782398.1</td>
<td>SAARP1</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.15064.t1</td>
<td>XP_022808152.1</td>
<td>Cysteine-rich</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.15065.t1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>galaxin2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.15580.t1</td>
<td>XP_022804012.1</td>
<td>Laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.18631.t1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>galaxin</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.19518.t1</td>
<td>XP_022784808.1</td>
<td>Protocadherin-like</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.22918.t1</td>
<td>XP_022808048.1, XP_022808045.1, XP_022790310.1</td>
<td>EP-like1</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.24015.t1</td>
<td>XP_022788227.1</td>
<td>Hephaestin-like protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.24512.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>EU532164.1</td>
<td>XP_022799914.1</td>
<td>carbonic anhydrase 2</td>
<td>Bertucci et al., 2011</td>
</tr>
<tr class="even">
<td>Gene:g29033.t1</td>
<td>XP_022799914.1</td>
<td>Carbonic Anhydrase (STPCA2-1)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g3745.t1</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:10186</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC2)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g10186</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g10187</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC3)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g10188</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC3)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g11190</td>
<td>XP_022783323.1</td>
<td>USOMP12</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g13552</td>
<td>XP_022781839.1</td>
<td>Acidic SOMP (p27)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g14733</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g1484</td>
<td>XP_022785805.1</td>
<td>CARP1</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g15294.t1</td>
<td>XP_022779720.1</td>
<td>Vitellogenin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g15955</td>
<td>XP_022794736.1</td>
<td>MAM LDL-2</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g2115</td>
<td>XP_022784808.1</td>
<td>Cadherin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g2116</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC1)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g22569</td>
<td>XP_022810031.1</td>
<td>Fibronectin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g24177</td>
<td>XP_022798258.1</td>
<td>Protocadherin (PC5)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g27814</td>
<td>XP_022801359.1</td>
<td>carbonic anhydrase (STPCA2-2)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g2829</td>
<td>XP_022783414.1, XP_022783413.1</td>
<td>Thrombospondin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g2829.t1</td>
<td>XP_022783415.1</td>
<td>Coadhesin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g29034.t1</td>
<td>XP_022799914.1</td>
<td>Carbonic Anhydrase</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g30</td>
<td>XP_022784808.1</td>
<td>Protoacadherin (PC4)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g30385.t1</td>
<td>XP_022780049.1</td>
<td>USOMPS13</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g34749</td>
<td>XP_022804012.1</td>
<td>EGF &amp; LamininG-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g37058</td>
<td>XP_022804608.1</td>
<td>Fibronectin-2</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g38128</td>
<td>XP_022783430.1</td>
<td>Œ±-Collagen</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g38881</td>
<td>XP_022790556.1, XP_022790555.1</td>
<td>USOMP14</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g39770</td>
<td>XP_022795871.1</td>
<td>Kielin-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g5735.t1</td>
<td>XP_022799127.1</td>
<td>Tolloid-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g7086</td>
<td>XP_022804012.1</td>
<td>EGF LamG1</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g8396</td>
<td>XP_022803859.1</td>
<td>CARP6-partial</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g907</td>
<td>XP_022806326.1</td>
<td>Zona Pellucida</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g9094</td>
<td>XP_022795459.1, XP_022777933.1</td>
<td>Actin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>HM163215</td>
<td>XP_029187982.1</td>
<td>Acropora millepora galaxin</td>
<td>Reyes-Bermudez et al., 2009</td>
</tr>
<tr class="odd">
<td>JN631095.1</td>
<td>XP_029195765.1</td>
<td>hypothetical protein p251_4</td>
<td>Hayward et al., 2011</td>
</tr>
<tr class="even">
<td>JR971508.1</td>
<td>XP_022793420.1, XP_022793422.1</td>
<td>USOMP6</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR972076.1</td>
<td>XP_022781839.1, XP_022781915.1</td>
<td>Acidic SOMP</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR973117.1</td>
<td>XP_022808048.1, XP_022808045.1</td>
<td>USOMP-5</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR976690.1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>Galaxin 2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR980881.1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G protein</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR982706.1</td>
<td>XP_022808152.1</td>
<td>USOMP-2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR986059.1</td>
<td>XP_022782738.1</td>
<td>Cephalotoxin-like</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR991083.1</td>
<td>XP_022779335.1</td>
<td>Collagen Œ±-1 chain</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR991407.1</td>
<td>XP_022780690.1</td>
<td>SAARP2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR994474.1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDL-receptor protein 2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR997000.1</td>
<td>XP_022807628.1, XP_022807627.1</td>
<td>USOMP-3</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR998014.1</td>
<td>XP_022799897.1, XP_022801331.1</td>
<td>Putative carbonic anhydrase</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR998260.1</td>
<td>XP_022803212.1</td>
<td>USOMP7</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT001945.1</td>
<td>XP_022782398.1</td>
<td>SAARP1</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JT004498.1</td>
<td>XP_022780690.1</td>
<td>USOMP-4</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT011118.1</td>
<td>XP_022794736.1</td>
<td>MAM LDL receptor protein 1</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JT014391.1</td>
<td>XP_022797021.1</td>
<td>USOMP-8</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT016638.1</td>
<td>XP_022783430.1</td>
<td>Coadhesin</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>MG182344.1</td>
<td>XP_022792788.1</td>
<td>Acropora yongei Na+/Ca2+ exchanger</td>
<td>Barron et al., 2018</td>
</tr>
<tr class="odd">
<td>MG182345.1</td>
<td>XP_022784107.1</td>
<td>Acropora yongei Na+/Ca2+ exchanger</td>
<td>Barron et al., 2018</td>
</tr>
<tr class="even">
<td>P12_g2385</td>
<td>XP_022796981.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P13_g6918</td>
<td>XP_022803207.1</td>
<td>Sushi domain-containing</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P14_g9951</td>
<td>XP_022783415.1</td>
<td>collagen-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P15_g1532</td>
<td>XP_022780640.1, XP_022783414.1</td>
<td>CARP9</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P16_g11702</td>
<td>XP_022780049.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P18_g810</td>
<td>XP_022783430.1</td>
<td>collagen-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P19_g20041</td>
<td>XP_022804012.1</td>
<td>Contactin-associated protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P2_g11187</td>
<td>XP_022782364.1</td>
<td>CARP8</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P20_g6066</td>
<td>XP_022794736.1</td>
<td>MAM domain anchor protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P21_g18277</td>
<td>XP_022806326.1</td>
<td>Zona pellucida</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P22_g19762</td>
<td>XP_022785540.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P23_g1057</td>
<td>XP_022808083.1, XP_022808082.1</td>
<td>Protocadherin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P24_g15888</td>
<td>XP_022779720.1</td>
<td>vitellogenin-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P26_g1441</td>
<td>XP_022794920.1</td>
<td>vitellogenin-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P27_g18472</td>
<td>XP_022781915.1</td>
<td>Integrin-alpha</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P28_g11651</td>
<td>XP_022793421.1</td>
<td>Late embryogenesis protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P3_g12510</td>
<td>XP_022783415.1</td>
<td>Thrombospondin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P31_g20420</td>
<td>XP_022804012.1</td>
<td>Neurexin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P32_g5540</td>
<td>XP_022795871.1</td>
<td>Kielin/chordin-like</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P33_g8985</td>
<td>XP_022781364.1</td>
<td>Flagellar associated protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P34_g1714</td>
<td>XP_022794736.1</td>
<td>MAM/LDL receptor domain protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P36_g13890</td>
<td>XP_022794736.1</td>
<td>Zonadhesion-like precursor</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P4_g9861</td>
<td>XP_022797264.1</td>
<td>Viral inclusion protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P5_g11674</td>
<td>XP_022783415.1</td>
<td>Hemicentin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P8_g9654</td>
<td>XP_022786917.1, XP_022786918.1</td>
<td>Major yolk protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P9_g10811; P1_g11108; P10_g11107</td>
<td>XP_022784808.1</td>
<td>Protocadherin fat-like</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>PFX13778.1</td>
<td>XP_022808646.1</td>
<td>Sacsin</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX14205.1</td>
<td>XP_022808089.1</td>
<td>Ret receptor kinase (partial)</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX15740.1</td>
<td>XP_022806058.1</td>
<td>Protein FAM208A</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX16398.1</td>
<td>XP_022805070.1</td>
<td>hypothetical protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX18785.1</td>
<td>XP_022801334.1, XP_022801335.1</td>
<td>Mucin-4</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX26597.1</td>
<td>XP_022788977.1</td>
<td>Complement C3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX26751.1</td>
<td>XP_022788730.1</td>
<td>Transmembrane protease serine 9</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX27832.1</td>
<td>XP_022786864.1</td>
<td>PARP11</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX30903.1</td>
<td>XP_022781839.1</td>
<td>hypothetical protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022778254.1</td>
<td>XP_022778254.1</td>
<td>uncharacterized protein LOC111319781</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022778283.1</td>
<td>XP_022778283.1</td>
<td>uncharacterized protein LOC111319816</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022779720.1</td>
<td>XP_022779720.1</td>
<td>vitellogenin-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022780303.1</td>
<td>XP_022780303.1</td>
<td>uncharacterized protein LOC111321626</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022780690.1</td>
<td>XP_022780690.1</td>
<td>CARP5</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022780694.1</td>
<td>XP_022780694.1</td>
<td>CUB &amp; peptidase domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022781731.1</td>
<td>XP_022781731.1</td>
<td>sulfate anion transporter-like 2C</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022782398.1</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783031.1</td>
<td>XP_022783031.1</td>
<td>sodium bicarbonate transporter-like 11</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022783044.1</td>
<td>XP_022783044.1</td>
<td>uncharacterized protein LOC111323869</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783323.1</td>
<td>XP_022783323.1</td>
<td>VHS3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022783415.1</td>
<td>XP_022783415.1</td>
<td>coadhesin-like isoform X3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783952.1</td>
<td>XP_022783952.1</td>
<td>collagenase 3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022784623.1</td>
<td>XP_022784623.1</td>
<td>sperm-associated cation channel</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022786582.1</td>
<td>XP_022786582.1</td>
<td>synapsin-2-like isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022786918.1</td>
<td>XP_022786918.1</td>
<td>major yolk protein-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022788227.1</td>
<td>XP_022788227.1</td>
<td>hephaestin-like protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022788270.1</td>
<td>XP_022788270.1</td>
<td>band 3 anion transport protein-like</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022788730.1</td>
<td>XP_022788730.1</td>
<td>elastase-like peptidase</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022789591.1</td>
<td>XP_022789591.1</td>
<td>endothelin-converting enzyme 1-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022789932.1</td>
<td>XP_022789932.1</td>
<td>MAGUK p55 subfamily member 7-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022790441.1</td>
<td>XP_022790441.1</td>
<td>PHD finger protein 21A-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022791567.1</td>
<td>XP_022791567.1</td>
<td>anion exchange protein 2-like</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022792212.1</td>
<td>XP_022792212.1</td>
<td>ras-like protein 3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022794122.1</td>
<td>XP_022794122.1</td>
<td>galaxin-like isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022794351.1</td>
<td>XP_022794351.1</td>
<td>ependymin-related protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022794736.1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDL receptor protein 2-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022796981.1</td>
<td>XP_022796981.1</td>
<td>skeletal organic matrix protein 8-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022796982.1</td>
<td>XP_022796982.1</td>
<td>uncharacterized protein LOC111335364</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022798902.1</td>
<td>XP_022798902.1</td>
<td>LDL receptor-related protein 8-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022799089.1</td>
<td>XP_022799089.1</td>
<td>CUB domain protein isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022799541.1</td>
<td>XP_022799541.1</td>
<td>uncharacterized protein LOC111337489</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022800320.1</td>
<td>XP_022800320.1</td>
<td>sulfate anion transporter 1-like X1</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022800329.1</td>
<td>XP_022800329.1</td>
<td>sulfate anion transporter 1-like X2</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022800339.1</td>
<td>XP_022800339.1</td>
<td>sulfate anion transporter 1-like X1</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022801463.1</td>
<td>XP_022801463.1</td>
<td>bicarbonate cotransporter 3-like X2</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022803524.1</td>
<td>XP_022803524.1</td>
<td>digestive cysteine proteinase 1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022803808.1</td>
<td>XP_022803808.1</td>
<td>tumor suppressor DMBT1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022803872.1</td>
<td>XP_022803872.1</td>
<td>spore wall protein 2-like X3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022803894.1</td>
<td>XP_022803894.1</td>
<td>uncharacterized protein LOC111341206</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022804012.1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022804785.1</td>
<td>XP_022804785.1</td>
<td>thioredoxin reductase 1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022805470.1</td>
<td>XP_022805470.1</td>
<td>uncharacterized protein LOC111342641</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022806326.1</td>
<td>XP_022806326.1</td>
<td>ZP domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022806664.1</td>
<td>XP_022806664.1</td>
<td>protein lingerer-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022806928.1</td>
<td>XP_022806928.1</td>
<td>SLIT-ROBO RhoGAP1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022807143.1</td>
<td>XP_022807143.1</td>
<td>condensin-2 subunit D3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022807256.1</td>
<td>XP_022807256.1</td>
<td>uncharacterized protein LOC111344300</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022807807.1</td>
<td>XP_022807807.1</td>
<td>uncharacterized protein LOC111344812</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022808163.1</td>
<td>XP_022808163.1</td>
<td>uncharacterized protein LOC111345150</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022808576.1</td>
<td>XP_022808576.1</td>
<td>LOC111345553 isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022809269.1</td>
<td>XP_022809269.1</td>
<td>microtubule-associated tumor suppressor 1-like X1</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022809270.1</td>
<td>XP_022809270.1</td>
<td>microtubule-associated tumor suppressor 1-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022810585.1</td>
<td>XP_022810585.1</td>
<td>vWF D + EGF domain protein (partial)</td>
<td>Peled et al., 2020</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seqkit</span> grep <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> ../data/biomin-ids.txt ../data/GCF_002571385.2_Stylophora_pistillata_v1.1_protein.faa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/31-biomin-pathway/Stylo-biomin.fasta</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> ../output/11.3-ortholog-annotation/representative_sequences.faa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> ../output/31-biomin-pathway/Stylo-biomin-db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 qseqid sseqid evalue bitscore"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-evalue</span> 1e-20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 10</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv</span></code></pre></div>
<pre><code>FUN_000236-T1   XP_022780303.1  6.14e-24    102
FUN_000857-T1   XP_022795459.1  1.39e-159   447
FUN_000867-T1   XP_022780694.1  1.60e-34    125
FUN_001009-T1   XP_022789591.1  7.04e-107   338
FUN_001088-T1   XP_022783044.1  3.90e-35    130
FUN_001089-T1   XP_022783044.1  2.17e-23    93.2
FUN_001101-T1   XP_022783044.1  1.22e-31    118
FUN_001107-T1   XP_022795459.1  9.45e-59    190
FUN_001118-T1   XP_022801359.1  1.33e-35    124
FUN_001185-T1   XP_022798902.1  0.0 870</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv</span></code></pre></div>
<pre><code>gene_id,species,group_id,type,conservation_level
FUN_000185-T1,Apul,OG_00001,three_way,medium
Peve_00037402,Peve,OG_00001,three_way,medium
Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,Ptua,OG_00001,three_way,medium
FUN_000189-T1,Apul,OG_00002,three_way,medium
Peve_00038462,Peve,OG_00002,three_way,medium
Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,Ptua,OG_00002,three_way,medium
FUN_000190-T1,Apul,OG_00003,three_way,low
Peve_00038463,Peve,OG_00003,three_way,low
Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,Ptua,OG_00003,three_way,low</code></pre>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths</span></span>
<span id="cb7-5">blast_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv"</span></span>
<span id="cb7-6">mapping_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read BLAST results</span></span>
<span id="cb7-9">blast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(</span>
<span id="cb7-10">  blast_file,</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evalue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>)</span>
<span id="cb7-12">)</span>
<span id="cb7-13"></span>
<span id="cb7-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read ortholog mapping</span></span>
<span id="cb7-15">mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(mapping_file)</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join to add group_id to each gene in blast results</span></span>
<span id="cb7-18">annotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> blast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapping <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb7-20"></span>
<span id="cb7-21"></span>
<span id="cb7-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write out CSV</span></span>
<span id="cb7-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(annotated, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>)</span>
<span id="cb7-24"></span>
<span id="cb7-25"></span>
<span id="cb7-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View result</span></span>
<span id="cb7-27">annotated</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_15-57-58.png" class="img-fluid"></p>
<section id="matches-in-barnacle" class="level1">
<h1>Matches in Barnacle</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Load the Stylo-biomin group_id list</span></span>
<span id="cb8-4">stylo_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span></span>
<span id="cb8-5"></span>
<span id="cb8-6">stylo_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(stylo_file) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(group_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Get all *_top100.csv files</span></span>
<span id="cb8-11">path_top100 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/22-Visualizing-Rank-outs"</span></span>
<span id="cb8-12"></span>
<span id="cb8-13">top100_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(</span>
<span id="cb8-14">  path_top100,</span>
<span id="cb8-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*_top100.csv"</span>,</span>
<span id="cb8-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb8-17">)</span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. For each file, find matching group IDs in column 1</span></span>
<span id="cb8-20">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(top100_files, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(f) {</span>
<span id="cb8-21"></span>
<span id="cb8-22">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(f, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb8-23"></span>
<span id="cb8-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># assume the first column has the group_ids</span></span>
<span id="cb8-25">  col1_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb8-26"></span>
<span id="cb8-27">  matches <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(stylo_groups, col1_ids)</span>
<span id="cb8-28"></span>
<span id="cb8-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb8-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(f),</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">matched_group_id =</span> matches</span>
<span id="cb8-32">  )</span>
<span id="cb8-33">})</span>
<span id="cb8-34"></span>
<span id="cb8-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show results</span></span>
<span id="cb8-36">results</span>
<span id="cb8-37"></span>
<span id="cb8-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Write out summary file</span></span>
<span id="cb8-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb8-40">  results,</span>
<span id="cb8-41">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/Stylo-biomin_matches_in_top100.csv"</span></span>
<span id="cb8-42">)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the file: it has two columns (file, group_id)</span></span>
<span id="cb9-4">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/Stylo-biomin_matches_in_top100.csv"</span>,</span>
<span id="cb9-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>))</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count occurrences of each file (column 1)</span></span>
<span id="cb9-8">file_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> res <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_occurrences"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(n_occurrences))</span>
<span id="cb9-11"></span>
<span id="cb9-12">file_counts</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-00-08.png" class="img-fluid"></p>
</section>
<section id="wgcna-module-enrichment" class="level1">
<h1>WGCNA module enrichment</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Load biomin group IDs</span></span>
<span id="cb10-4">biomin_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(group_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb10-7"></span>
<span id="cb10-8">n_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(biomin_groups)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># total number of biomin groups</span></span>
<span id="cb10-9"></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Load module assignments (must contain group_id and module_label)</span></span>
<span id="cb10-11">assignments <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(</span>
<span id="cb10-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/GitHub/timeseries_molecular/M-multi-species/output/18-ortholog-wgcna/gene_module_assignments.csv"</span></span>
<span id="cb10-13">)</span>
<span id="cb10-14"></span>
<span id="cb10-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Mark biomin matches</span></span>
<span id="cb10-16">assignments2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> assignments <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> group_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> biomin_groups)</span>
<span id="cb10-18"></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Summarize by module_label</span></span>
<span id="cb10-20">module_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> assignments2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(module_label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_group_ids_in_module =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(group_id),</span>
<span id="cb10-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_biomin_in_module =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(is_biomin),</span>
<span id="cb10-25">    </span>
<span id="cb10-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percent of BIOMIN groups captured by this module</span></span>
<span id="cb10-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_of_all_biomin =</span> (n_biomin_in_module <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_biomin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb10-28">    </span>
<span id="cb10-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percent of module that is biomin</span></span>
<span id="cb10-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_of_module_that_is_biomin =</span> (n_biomin_in_module <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_group_ids_in_module) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb10-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(pct_of_all_biomin))</span>
<span id="cb10-33"></span>
<span id="cb10-34">module_summary</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-01-10.png" class="img-fluid"></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/58-biomin/</guid>
  <pubDate>Sat, 15 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-01-54.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Functional annotation summary for WGCNA modules</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/59-wgcna-annotation/</link>
  <description><![CDATA[ 





<p>Implementation</p>
<ul>
<li><p><strong>Script</strong>:&nbsp;<code>19-annotate-wgcna-modules.py</code>&nbsp;joins&nbsp;<code>wgcna_ortholog_module_assignments.csv</code>&nbsp;with&nbsp;<code>ortholog_groups_annotated.csv</code>&nbsp;on&nbsp;<code>group_id</code>&nbsp;(OG_xxxxx)</p></li>
<li><p><strong>Summarization</strong>: Counts and ranks GO terms (BP/CC/MF), GO Slim pathways, and protein functions per module</p></li>
<li><p><strong>Output</strong>: 7 files in&nbsp;<code>M-multi-species/output/18-ortholog-wgcna/</code>:</p>
<ul>
<li><p><code>wgcna_module_annotation_summary.txt</code>&nbsp;- detailed report with top 10 terms per category for all 15 modules</p></li>
<li><p><code>wgcna_module_overview.csv</code>&nbsp;- per-module statistics (size, coverage, dominant terms)</p></li>
<li><p>5 CSV matrices showing term distributions across modules (GO BP/CC/MF, GO Slim, proteins)</p></li>
</ul></li>
</ul>
<hr>
<p>All output:<a href="https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/18-ortholog-wgcna" class="uri">https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/18-ortholog-wgcna</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/refs/heads/main/M-multi-species/output/18-ortholog-wgcna/wgcna_module_go_bp_summary.csv"</span></span>
<span id="cb1-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                    term
1 positive regulation of transcription by RNA polymerase II [GO:0045944]
2 negative regulation of transcription by RNA polymerase II [GO:0000122]
3          regulation of transcription by RNA polymerase II [GO:0006357]
4        positive regulation of DNA-templated transcription [GO:0045893]
5                                               proteolysis [GO:0006508]
6                                         protein transport [GO:0015031]
  module_0 module_1 module_2 module_3 module_4 module_5 module_6 module_7
1       14       33       40       16       21       35        9       13
2       16       36       25       16       17       23       15       13
3       22       28       28       18       14       27        0        0
4       14       26       29       14        0       22        0        0
5        0       35       19       20       15        0        0       16
6        9       33        0       21        0       17       12       12
  module_8 module_9 module_10 module_11 module_12 module_13 module_14 total
1        8        4         0         0         3         0         4   200
2        7        0         0         0         3         0         2   173
3        0        0         3         0         0         0         3   143
4        5        0         0         0         3         0         0   113
5        0        0         2         0         0         3         0   110
6        0        0         0         0         0         0         0   104</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb3-4">  df,</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pageLength =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">autoWidth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-8">  ),</span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filter =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># column filters at the top</span></span>
<span id="cb3-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-11">)</span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0fb88eec8b62dde94752" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0fb88eec8b62dde94752">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"22\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"45\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"40\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"21\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"21\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"35\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"16\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"10\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"200\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["positive regulation of transcription by RNA polymerase II [GO:0045944]","negative regulation of transcription by RNA polymerase II [GO:0000122]","regulation of transcription by RNA polymerase II [GO:0006357]","positive regulation of DNA-templated transcription [GO:0045893]","proteolysis [GO:0006508]","protein transport [GO:0015031]","cell division [GO:0051301]","apoptotic process [GO:0006915]","protein ubiquitination [GO:0016567]","cilium assembly [GO:0060271]","signal transduction [GO:0007165]","intracellular signal transduction [GO:0035556]","DNA repair [GO:0006281]","negative regulation of DNA-templated transcription [GO:0045892]","DNA damage response [GO:0006974]","negative regulation of apoptotic process [GO:0043066]","cell differentiation [GO:0030154]","positive regulation of gene expression [GO:0010628]","protein stabilization [GO:0050821]","spermatogenesis [GO:0007283]","G protein-coupled receptor signaling pathway [GO:0007186]","neurogenesis [GO:0022008]","cell population proliferation [GO:0008283]","negative regulation of cell population proliferation [GO:0008285]","inflammatory response [GO:0006954]","mRNA splicing, via spliceosome [GO:0000398]","RNA splicing [GO:0008380]","mRNA processing [GO:0006397]","chromatin remodeling [GO:0006338]","protein folding [GO:0006457]","flagellated sperm motility [GO:0030317]","translation [GO:0006412]","positive regulation of cell population proliferation [GO:0008284]","sperm axoneme assembly [GO:0007288]","epithelial cilium movement involved in extracellular fluid movement [GO:0003351]","positive regulation of MAPK cascade [GO:0043410]","rhythmic process [GO:0048511]","positive regulation of proteasomal ubiquitin-dependent protein catabolic process [GO:0032436]","proteasome-mediated ubiquitin-dependent protein catabolic process [GO:0043161]","chordate embryonic development [GO:0043009]","endoplasmic reticulum to Golgi vesicle-mediated transport [GO:0006888]","intracellular protein transport [GO:0006886]","gluconeogenesis [GO:0006094]","malate metabolic process [GO:0006108]","malate-aspartate shuttle [GO:0043490]","tricarboxylic acid cycle [GO:0006099]","angiogenesis [GO:0001525]","negative regulation of cell differentiation [GO:0045596]","spermatid development [GO:0007286]","protein localization [GO:0008104]"],[14,16,22,14,0,9,0,11,9,11,12,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[33,36,28,26,35,33,45,0,0,34,0,0,33,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[40,25,28,29,19,0,0,15,28,0,0,18,0,0,0,19,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[16,16,18,14,20,21,0,12,0,18,14,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[21,17,14,0,15,0,0,16,15,0,14,0,0,14,0,0,0,0,0,0,14,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[35,23,27,22,0,17,17,17,0,0,16,16,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[9,15,0,0,0,12,14,9,10,0,0,0,11,8,0,8,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[13,13,0,0,16,12,10,0,9,0,0,11,0,0,0,0,0,0,0,0,0,0,9,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8,7,0,5,0,0,0,0,0,6,0,0,0,5,0,0,0,0,6,0,0,0,0,0,0,10,8,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0],[0,0,3,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,3,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0],[0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,2,4,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],[3,3,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,2,3,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[200,173,143,113,110,104,86,83,71,69,63,49,44,36,32,27,26,20,17,16,14,13,13,11,11,10,8,8,8,4,4,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>module_0<\/th>\n      <th>module_1<\/th>\n      <th>module_2<\/th>\n      <th>module_3<\/th>\n      <th>module_4<\/th>\n      <th>module_5<\/th>\n      <th>module_6<\/th>\n      <th>module_7<\/th>\n      <th>module_8<\/th>\n      <th>module_9<\/th>\n      <th>module_10<\/th>\n      <th>module_11<\/th>\n      <th>module_12<\/th>\n      <th>module_13<\/th>\n      <th>module_14<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{"name":"term","targets":0},{"name":"module_0","targets":1},{"name":"module_1","targets":2},{"name":"module_2","targets":3},{"name":"module_3","targets":4},{"name":"module_4","targets":5},{"name":"module_5","targets":6},{"name":"module_6","targets":7},{"name":"module_7","targets":8},{"name":"module_8","targets":9},{"name":"module_9","targets":10},{"name":"module_10","targets":11},{"name":"module_11","targets":12},{"name":"module_12","targets":13},{"name":"module_13","targets":14},{"name":"module_14","targets":15},{"name":"total","targets":16}],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/59-wgcna-annotation/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_05-28-34.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Contra on 24</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/58-contra-24/</link>
  <description><![CDATA[ 





<p>Took the top 100 genes in component 24 (of 35 rank) and did Context Dependent Regulation Ananysis</p>
<p>Summary of output</p>
<p>These CSV files contain the detailed results of context-dependent regulatory analysis, including interaction statistics, p-values, context strengths, and regulatory relationships for each analyzed gene-regulator pair.</p>
<p>high_methylation_gene_lncrna_correlations.csv (29626.7 KB) high_methylation_gene_methylation_correlations.csv (339626.1 KB) high_methylation_gene_mirna_correlations.csv (40.0 KB) lncrna_mirna_context.csv (1544.7 KB) low_mirna_gene_lncrna_correlations.csv (36676.7 KB) low_mirna_gene_methylation_correlations.csv (341486.6 KB) low_mirna_gene_mirna_correlations.csv (81.5 KB) methylation_mirna_context.csv (1898.0 KB) multi_way_interactions.csv (248.9 KB)</p>
<section id="ptua" class="level1">
<h1>Ptua</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/tables/multi_way_interactions.csv</code></p>
</section>
<section id="peve" class="level1">
<h1>Peve</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/tables/multi_way_interactions.csv</code></p>
</section>
<section id="apul" class="level1">
<h1>Apul</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/tables/multi_way_interactions.csv</code></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/58-contra-24/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_04-58-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>More Random Please</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/60-contra-random/</link>
  <description><![CDATA[ 





<section id="status" class="level3">
<h3 class="anchored" data-anchor-id="status">Status</h3>
<ul>
<li><strong>Randomization done</strong>: For each of cleaned_apul, cleaned_peve, and cleaned_ptua, the three requested files have been randomized:</li>
</ul>
<!-- -->
<ul>
<li><strong>Value ranges preserved</strong>:</li>
</ul>
<p>For each file, I computed the global numeric <strong>min/max</strong> and re-generated every numeric entry uniformly within that range.</p>
<p>Sparsity is roughly preserved by probabilistically setting some randomized values to zero using the original zero fraction.</p>
<p><strong>Summaries updated</strong>:</p>
<p>Features and Samples remain the same; Sparsity has been recomputed from the new randomized data (e.g., in cleaned_apul, lncrna sparsity is now <strong>3.76%</strong>, mirrored in both lncrna_counts_summary.txt and combined_summary.txt).</p>
<pre><code>python code/context_dependent_analysis.py --data-dir data/full-species-24-random/cleaned_apul </code></pre>
</section>
<section id="random-v-real" class="level1">
<h1>Random v Real</h1>
<p>TLDR</p>
<ul>
<li>Real data has much stronger baseline signal (especially for lncRNA‚Äìgene relationships: high R¬≤ and high correlations).</li>
<li>Interaction improvements and counts of ‚Äúcontext-dependent‚Äù pairs are similar or stronger in random data, for both methylation‚ÄìmiRNA and lncRNA‚ÄìmiRNA, and especially for lncRNA‚ÄìmiRNA.</li>
<li>Methylation‚ÄìmiRNA context_strength stands out as a metric where real &gt; random, while lncRNA‚ÄìmiRNA context_strength does not (and often random ‚â• real).</li>
</ul>
<hr>
<section id="where-empirical-fdr-shows-up" class="level3">
<h3 class="anchored" data-anchor-id="where-empirical-fdr-shows-up">Where empirical FDR shows up</h3>
<p>When you run with ‚Äìenable-empirical-fdr (and ‚Äìnull-replicates &gt; 0):</p>
<ul>
<li><strong>In the tables directory of that run</strong> (e.g.&nbsp;output/context_dependent_analysis_YYYYMMDD_HHMMSS/tables/), the file:</li>
</ul>
<!-- -->
<ul>
<li><strong>methylation_mirna_context.csv</strong> gets three extra columns:</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_threshold</strong>: the scalar context_strength threshold chosen for the run (same value in every row).</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_estimated</strong>: the estimated global FDR at that threshold (same in every row).</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_significant</strong>: <strong>True/False</strong> per interaction, indicating whether context_strength &gt;= empirical_fdr_threshold.</li>
</ul>
<hr>
</section>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<ul>
<li><strong>Real-data run</strong>: output/context_dependent_analysis_20251108_140602 using data/full-species-24/cleaned_apul.</li>
</ul>
<!-- -->
<ul>
<li><strong>Random-data run</strong>: output/context_dependent_analysis_20251119_071813 using data/full-species-24-random/cleaned_apul.</li>
</ul>
<!-- -->
<ul>
<li>Both runs did the same core analyses (methylation‚ÄìmiRNA context, lncRNA‚ÄìmiRNA context, multi-way interactions) and produced the same types of context tables and plots.</li>
</ul>
<hr>
</section>
<section id="sidebyside-numerical-comparison" class="level3">
<h3 class="anchored" data-anchor-id="sidebyside-numerical-comparison">Side‚Äëby‚Äëside numerical comparison</h3>
<section id="methylationmirna-context-methylation_mirna_context.csv" class="level4">
<h4 class="anchored" data-anchor-id="methylationmirna-context-methylation_mirna_context.csv">1. Methylation‚ÄìmiRNA context (methylation_mirna_context.csv)</h4>
<ul>
<li><strong>Number of pairs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 13,065 pairs</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 7,125 pairs</li>
</ul>
<!-- -->
<ul>
<li>So the random run considered roughly half as many context pairs (this is likely due to code/parameter differences, not biology).</li>
</ul>
<!-- -->
<ul>
<li><strong>Context-dependent interaction counts (from reports)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 1,464 context-dependent interactions (‚âà11% of all)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 1,152 context-dependent interactions (‚âà16% of all)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random actually has a higher fraction</strong> of pairs flagged as context-dependent.</li>
</ul>
<!-- -->
<ul>
<li><strong>Variance explained (R¬≤)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.392</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.481</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.502</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.345</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.406</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.437</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: Real data clearly has <strong>stronger overall predictive signal</strong> (higher R¬≤ at every stage).</li>
</ul>
<!-- -->
<ul>
<li><strong>Effect sizes / improvements</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_regulator2: <strong>0.089</strong></li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: <strong>0.021</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_regulator2: <strong>0.061</strong></li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: <strong>0.031</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Top interaction improvements</strong> (from reports):</li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> top 10: up to <strong>0.251</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> top 10: up to <strong>0.261</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Adding a second regulator boosts R¬≤ <strong>more in real data</strong> (+0.089 vs +0.061), consistent with real structure.</li>
</ul>
<!-- -->
<ul>
<li>The <strong>interaction term itself</strong> (improvement_from_interaction) is <strong>not smaller in random</strong>; in fact its mean is slightly <strong>larger in random</strong> (0.031 vs 0.021), with similar max values. So interaction ‚Äúgains‚Äù alone do <strong>not</strong> cleanly separate real vs random.</li>
</ul>
<!-- -->
<ul>
<li><strong>Context strength</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: mean context_strength <strong>0.321</strong> (p90 ‚âà 0.674, max ‚âà 1.843)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: mean context_strength <strong>0.255</strong> (p90 ‚âà 0.546, max ‚âà 1.323)</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: For methylation‚ÄìmiRNA, real data has <strong>moderately stronger context signals on average</strong>, but random still produces many pairs with non-trivial context_strength.</li>
</ul>
<hr>
</section>
<section id="lncrnamirna-context-lncrna_mirna_context.csv" class="level4">
<h4 class="anchored" data-anchor-id="lncrnamirna-context-lncrna_mirna_context.csv">2. lncRNA‚ÄìmiRNA context (lncrna_mirna_context.csv)</h4>
<ul>
<li><strong>Number of pairs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 13,065</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 7,125</li>
</ul>
<!-- -->
<ul>
<li><strong>Context-dependent interaction counts (from reports)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 1,812 context-dependent interactions (‚âà14%)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 1,165 context-dependent interactions (‚âà16%)</li>
</ul>
<!-- -->
<ul>
<li>Again, <strong>similar absolute scale</strong>, with <strong>random slightly higher in proportion</strong>.</li>
</ul>
<!-- -->
<ul>
<li><strong>Variance explained (R¬≤)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.716</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.739</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.751</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.288</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.359</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.392</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: Huge separation here ‚Äî real data shows <strong>very strong baseline fits</strong> (R¬≤ ~0.72‚Äì0.75), while random is much weaker (~0.29‚Äì0.39). This is clear evidence that the overall lncRNA‚Äìgene relationships are real and not reproduced by randomization.</li>
</ul>
<!-- -->
<ul>
<li><strong>Effect sizes / improvements</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>:</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: mean <strong>0.012</strong>, p90 ‚âà 0.034, max ‚âà 0.231</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>:</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: mean <strong>0.033</strong>, p90 ‚âà 0.087, max ‚âà 0.322</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>On <strong>random data</strong>, the <strong>interaction term looks stronger on average</strong> (higher mean, higher upper tail) than on real data.</li>
</ul>
<!-- -->
<ul>
<li>This strongly suggests that <strong>‚Äúinteraction improvements‚Äù on their own are not a clean signal of biology</strong>, and you can get quite substantial-looking interaction gains from noise.</li>
</ul>
<!-- -->
<ul>
<li><strong>Context strength</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: mean context_strength <strong>0.175</strong>, p90 ‚âà 0.381, max ‚âà 1.737</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: mean context_strength <strong>0.265</strong>, p90 ‚âà 0.549, max ‚âà 1.306</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: For lncRNA‚ÄìmiRNA, <strong>random data actually has larger average context_strength</strong> and more mass in the upper tail. So the context metric here is <strong>not uniquely elevated in real data</strong>.</li>
</ul>
<hr>
</section>
<section id="multi-way-interactions-multi_way_interactions.csv" class="level4">
<h4 class="anchored" data-anchor-id="multi-way-interactions-multi_way_interactions.csv">3. Multi-way interactions (multi_way_interactions.csv)</h4>
<ul>
<li><strong>Both runs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Total genes analyzed</strong>: 100</li>
</ul>
<!-- -->
<ul>
<li><strong>Genes with significant interactions</strong>: <strong>0</strong> in both random and real runs.</li>
</ul>
<!-- -->
<ul>
<li><strong>Mean improvement from interactions</strong>:</li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: <strong>0.671</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: <strong>0.811</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>The multi-way model produces <strong>substantial mean improvements</strong> in both datasets, even larger in the random run, yet <strong>none are called significant</strong> under your threshold.</li>
</ul>
<!-- -->
<ul>
<li>So the <strong>raw improvement metric alone is not discriminative</strong>, and the ‚Äúsignificant interactions‚Äù filter is what‚Äôs preventing you from calling many clearly-noisy multi-way effects.</li>
</ul>
<hr>
</section>
</section>
<section id="overlap-and-qualitative-patterns" class="level3">
<h3 class="anchored" data-anchor-id="overlap-and-qualitative-patterns">Overlap and qualitative patterns</h3>
<ul>
<li><strong>Top hits differ</strong>, but there is <strong>some gene overlap</strong> (e.g.&nbsp;FUN_028275, FUN_000398, FUN_040206 appear as top regulators in one or both runs), which suggests:</li>
</ul>
<!-- -->
<ul>
<li>Either those genes have generic properties (e.g.&nbsp;high variance, many regulators) that make them prone to being selected in many settings, or</li>
</ul>
<!-- -->
<ul>
<li>The pipeline‚Äôs ranking is influenced by structural aspects (feature counts, model behaviour) that can re-surface the same genes even on randomized expression.</li>
</ul>
<!-- -->
<ul>
<li><strong>File sizes and counts</strong> (e.g.&nbsp;context tables, correlation tables) differ between runs, but that‚Äôs mostly reflecting different filtering / setup rather than a biologically interpretable signal.</li>
</ul>
<hr>
</section>
<section id="interpretation-do-random-and-real-give-similar-results" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-do-random-and-real-give-similar-results">Interpretation: do random and real give ‚Äúsimilar‚Äù results?</h3>
<ul>
<li><strong>Where they are clearly different</strong>:</li>
</ul>
<!-- -->
<ul>
<li><strong>Real data shows much stronger base signal</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Higher R¬≤ for gene prediction from regulators (especially lncRNA‚ÄìmiRNA‚Äìgene, where real R¬≤ ‚âà 0.75 vs random ‚âà 0.39).</li>
</ul>
<!-- -->
<ul>
<li>Stronger, more consistent correlations (corr_high_regulator2, corr_low_regulator2 are ~0.6‚Äì0.8 in real vs near 0 on average in random).</li>
</ul>
<!-- -->
<ul>
<li>For methylation‚ÄìmiRNA, <strong>context_strength is somewhat higher in real</strong>.</li>
</ul>
<!-- -->
<ul>
<li><strong>Where they look surprisingly similar (or random looks ‚Äústronger‚Äù)</strong>:</li>
</ul>
<!-- -->
<ul>
<li>The <strong>number of context-dependent interactions</strong> is large in both and not dramatically reduced in random; the <strong>fraction of pairs flagged context-dependent is actually slightly higher in random</strong> for both context analyses.</li>
</ul>
<!-- -->
<ul>
<li><strong>Mean interaction improvements</strong> (improvement_from_interaction) and their upper tails are <strong>of the same order in real and random</strong>, and frequently <strong>larger in the random run</strong>, particularly for lncRNA‚ÄìmiRNA and multi-way models.</li>
</ul>
<!-- -->
<ul>
<li>Thus, <strong>raw interaction ‚Äúgain‚Äù and context_strength values alone can be generated by noise</strong>, and do not serve as a strong discriminator between real and randomized data.</li>
</ul>
<hr>
</section>
<section id="bottom-line" class="level3">
<h3 class="anchored" data-anchor-id="bottom-line">Bottom line</h3>
<ul>
<li><strong>Yes, the pipeline produces superficially similar-looking context-dependent interaction metrics on random data and real data</strong>: thousands of candidate interactions, similar or even larger mean interaction improvements and context_strengths, and comparable top effect sizes.</li>
</ul>
<!-- -->
<ul>
<li><strong>The main quantitative separation lives in the baseline fit quality (R¬≤ and correlations), not in the interaction metrics themselves.</strong> Real data has much stronger overall gene‚Äìregulator relationships, but the extra improvement attributed to context/interaction is not dramatically suppressed in the random run.</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation-wise</strong>, this suggests that <strong>context-dependent interaction scores require a proper null/thresholding strategy (e.g.&nbsp;empirical FDR vs randomizations)</strong>; taken at face value, they are not by themselves strong evidence of biology because similar magnitudes arise from randomized data.</li>
</ul>
</section>
</section>
<section id="what-is-contra-doing" class="level1">
<h1>What is Contra Doing?</h1>
<section id="highlevel-idea" class="level3">
<h3 class="anchored" data-anchor-id="highlevel-idea">High‚Äëlevel idea</h3>
<p><strong>context_dependent_analysis.py is a pipeline that asks:</strong></p>
<p>‚ÄúFor each gene, do its regulators (miRNAs, lncRNAs, DNA methylation sites) affect it differently in different contexts (e.g., when a regulator is high vs low)?‚Äù</p>
<p>It takes the four matched datasets (genes, lncRNAs, miRNAs, methylation), runs a lot of regression and correlation models in parallel, and then writes out tables and plots summarizing which interactions look context‚Äëdependent.</p>
<hr>
</section>
<section id="step-1-load-and-align-the-omics-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-and-align-the-omics-data">Step 1 ‚Äì Load and align the omics data</h3>
<ul>
<li><strong>Loads four matrices</strong> from gene_counts_cleaned.csv, lncrna_counts_cleaned.csv, mirna_counts_cleaned.csv, wgbs_counts_cleaned.csv.</li>
</ul>
<!-- -->
<ul>
<li>Rows = features (genes, lncRNAs, miRNAs, CpGs)</li>
</ul>
<!-- -->
<ul>
<li>Columns = the same 40 samples.</li>
</ul>
<!-- -->
<ul>
<li><strong>Checks that sample IDs match across all four</strong>, so everything is aligned per sample.</li>
</ul>
<!-- -->
<ul>
<li>Stores convenient arrays so it can do fast, parallel calculations.</li>
</ul>
<hr>
</section>
<section id="step-2-methylationmirnagene-context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-2-methylationmirnagene-context-analysis">Step 2 ‚Äì Methylation‚ÄìmiRNA‚Äìgene context analysis</h3>
<p>For <strong>each gene</strong>:</p>
<ul>
<li><strong>Finds top‚Äëcorrelated miRNAs and CpG sites</strong> with that gene (using Pearson correlation, keeping only those with somewhat small p‚Äëvalues).</li>
</ul>
<!-- -->
<ul>
<li>For each <strong>gene‚ÄìmiRNA‚ÄìCpG trio</strong>, it fits three regression models:</li>
</ul>
<ol type="1">
<li>Gene ~ methylation</li>
</ol>
<!-- -->
<ol type="1">
<li>Gene ~ methylation + miRNA</li>
</ol>
<!-- -->
<ol type="1">
<li>Gene ~ methylation + miRNA + (methylation √ó miRNA interaction term)</li>
</ol>
<ul>
<li>It then <strong>asks whether including the interaction term significantly improves the model fit</strong> (using an F‚Äëtest).</li>
</ul>
<!-- -->
<ul>
<li>If yes, it flags that <strong>the effect of methylation on the gene depends on miRNA level</strong> (context‚Äëdependent regulation).</li>
</ul>
<!-- -->
<ul>
<li>It also <strong>splits samples into ‚Äúhigh miRNA‚Äù vs ‚Äúlow miRNA‚Äù</strong> and compares the methylation‚Äìgene correlation in those two groups, to quantify how strong and in which direction the context effect is.</li>
</ul>
<p>All results are collected into a big table (one row per trio).</p>
<hr>
</section>
<section id="step-3-lncrnamirnagene-context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-3-lncrnamirnagene-context-analysis">Step 3 ‚Äì lncRNA‚ÄìmiRNA‚Äìgene context analysis</h3>
<p>This is analogous to Step 2, but now:</p>
<ul>
<li><strong>Regulator1 = lncRNA</strong>, <strong>Regulator2 = miRNA</strong> for each gene.</li>
</ul>
<!-- -->
<ul>
<li>Same workflow: pick top regulators, fit 3 nested models, test whether <strong>lncRNA‚Äôs effect on the gene depends on miRNA level</strong>, and compare correlations in high vs low miRNA contexts.</li>
</ul>
<!-- -->
<ul>
<li>Produces another large table describing <strong>lncRNA‚ÄìmiRNA‚Äìgene</strong> context‚Äëdependent interactions.</li>
</ul>
<hr>
</section>
<section id="step-4-multiway-regulatory-interactions" class="level3">
<h3 class="anchored" data-anchor-id="step-4-multiway-regulatory-interactions">Step 4 ‚Äì Multi‚Äëway regulatory interactions</h3>
<p>For a subset or all genes (depending on script version):</p>
<ul>
<li>For each gene, <strong>collects a set of top regulators</strong> (a mix of miRNAs, lncRNAs, and methylation sites that correlate with the gene).</li>
</ul>
<!-- -->
<ul>
<li>Builds two models:</li>
</ul>
<!-- -->
<ul>
<li><strong>Base model</strong>: gene ~ the strongest single regulator.</li>
</ul>
<!-- -->
<ul>
<li><strong>Full model</strong>: gene ~ all selected regulators together.</li>
</ul>
<!-- -->
<ul>
<li>Tests whether <strong>adding all these regulators significantly improves the explanation of gene expression</strong>, again via a model comparison (F‚Äëtest).</li>
</ul>
<!-- -->
<ul>
<li>This highlights genes with <strong>complex, multi‚Äëregulator control</strong> (many regulators acting together, not just one).</li>
</ul>
<hr>
</section>
<section id="step-5-contextspecific-networks-highlow-regulator-states" class="level3">
<h3 class="anchored" data-anchor-id="step-5-contextspecific-networks-highlow-regulator-states">Step 5 ‚Äì ‚ÄúContext‚Äëspecific networks‚Äù (high/low regulator states)</h3>
<p>The script defines simple contexts like:</p>
<ul>
<li><strong>High miRNA</strong>, <strong>low miRNA</strong>, <strong>high methylation</strong>, based on z‚Äëscored levels of a ‚Äúsentinel‚Äù miRNA or CpG across samples.</li>
</ul>
<p>For each context:</p>
<ul>
<li>Subsets samples that fall into that context (e.g., high miRNA).</li>
</ul>
<!-- -->
<ul>
<li>Within that subset, <strong>recalculates correlations</strong>:</li>
</ul>
<!-- -->
<ul>
<li>gene‚ÄìmiRNA</li>
</ul>
<!-- -->
<ul>
<li>gene‚ÄìlncRNA</li>
</ul>
<!-- -->
<ul>
<li>gene‚Äìmethylation</li>
</ul>
<!-- -->
<ul>
<li>This gives <strong>context‚Äëspecific correlation networks</strong>, showing which regulatory edges are present when, say, a particular miRNA or CpG is high vs low.</li>
</ul>
<hr>
</section>
<section id="step-6-outputs-plots-and-reports" class="level3">
<h3 class="anchored" data-anchor-id="step-6-outputs-plots-and-reports">Step 6 ‚Äì Outputs, plots, and reports</h3>
<p>Finally, the script:</p>
<ul>
<li><strong>Saves all result tables</strong> (interactions, p‚Äëvalues, context strength, etc.) as CSVs in an output/‚Ä¶/tables folder.</li>
</ul>
<!-- -->
<ul>
<li><strong>Generates plots</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Distributions of ‚Äúinteraction improvement‚Äù (how much the interaction term helps).</li>
</ul>
<!-- -->
<ul>
<li>Distributions of context strength.</li>
</ul>
<!-- -->
<ul>
<li>Bar charts summarizing how many edges of each type exist in each context.</li>
</ul>
<!-- -->
<ul>
<li><strong>Produces Markdown and HTML reports</strong> that summarize:</li>
</ul>
<!-- -->
<ul>
<li>How many interactions were tested.</li>
</ul>
<!-- -->
<ul>
<li>How many look context‚Äëdependent.</li>
</ul>
<!-- -->
<ul>
<li>Top examples for each interaction type.</li>
</ul>
<!-- -->
<ul>
<li>Links to the generated CSV files.</li>
</ul>
<hr>
</section>
<section id="in-biologist-terms" class="level3">
<h3 class="anchored" data-anchor-id="in-biologist-terms">In biologist terms</h3>
<ul>
<li>Think of it as an <strong>automatic screen for context‚Äëdependent regulation</strong> across all genes and all regulators you have.</li>
</ul>
<!-- -->
<ul>
<li>It‚Äôs looking for cases where <strong>‚Äúregulator A only affects gene X when regulator B is high (or low)‚Äù</strong>, and formalizes that with regression models, significance tests, and context‚Äëspecific networks.</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/60-contra-random/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_05-28-34.png" medium="image" type="image/png"/>
</item>
<item>
  <title>More Sparsity?</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/57-barnacle-35opt/</link>
  <description><![CDATA[ 





<p>Based on overlap of genes across components wanted to increase sparsity be increasing lambda-gene values..</p>
<p>Ran with multiple values</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDAS_GENE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.00 0.01 0.05 0.1 0.2 0.4 0.8"</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_SAMPLE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.1</span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_TIME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.05</span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RANK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>35</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR_BASE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>../output/26-rank35-optimization</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> LG <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDAS_GENE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-10">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTDIR_BASE}</span>/lambda_gene_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${LG}</span></span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/Users/sr320/.local/bin/uv</span> run python ../scripts/14.1-barnacle/build_tensor_and_run.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--input-file</span> ../output/14-pca-orthologs/vst_counts_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output-dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rank</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$RANK</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-gene</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-sample</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_SAMPLE</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-time</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_TIME</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-iter</span> 2000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tol</span> 1e-5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seed</span> 81</span>
<span id="cb1-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-05_14-01-07.png" class="img-fluid"></p>
<p>Move forward with lamda_gene of 0.2‚Ä¶</p>
<section id="sample" class="level1">
<h1>Sample</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-16-18.png" class="img-fluid"></p>
</section>
<section id="time" class="level1">
<h1>Time</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File path</span></span>
<span id="cb2-4">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/barnacle_factors/time_factors.csv"</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read data</span></span>
<span id="cb2-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute variance of each component across timepoints</span></span>
<span id="cb2-10">var_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb2-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb2-13">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Component) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Variance))</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select top 10 most variable components</span></span>
<span id="cb2-19">top10_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_components <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(Variance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(Component)</span>
<span id="cb2-20"></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare data for plotting</span></span>
<span id="cb2-22">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb2-24">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb2-25">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> top10_components)</span>
<span id="cb2-27"></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line plot</span></span>
<span id="cb2-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> OG_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> Component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Component)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Top 10 Most Variable Components Across Timepoints"</span>,</span>
<span id="cb2-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb2-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component Value"</span></span>
<span id="cb2-38">  )</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-18-17.png" class="img-fluid"></p>
</section>
<section id="pick-your-component" class="level1">
<h1>Pick your component</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File path</span></span>
<span id="cb3-4">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/barnacle_factors/time_factors.csv"</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- USER INPUT ----</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick the component you want to plot (e.g., "Component_5")</span></span>
<span id="cb3-8">selected_component <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_24"</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------</span></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read data</span></span>
<span id="cb3-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to long format</span></span>
<span id="cb3-15">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb3-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb3-20">  )</span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check that the chosen component exists</span></span>
<span id="cb3-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(selected_component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(df_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Component))) {</span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>, selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not found in data!"</span>))</span>
<span id="cb3-25">}</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the selected component</span></span>
<span id="cb3-28">df_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> selected_component)</span>
<span id="cb3-29"></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot single component across timepoints</span></span>
<span id="cb3-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_sel, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> OG_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Across Timepoints"</span>),</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loading Value"</span></span>
<span id="cb3-40">  )</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-20-36.png" class="img-fluid"></p>
</section>
<section id="gene-factor-loading" class="level1">
<h1>Gene Factor Loading</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-21-34.png" class="img-fluid"></p>
</section>
<section id="annotation" class="level1">
<h1>Annotation</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/testddd.png" class="img-fluid"></p>
</section>
<section id="an-annotation---u-pick" class="level1">
<h1>An Annotation - U pick!</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- File path ----</span></span>
<span id="cb4-5">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/top_genes_per_component/goslim_term_counts.csv"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change to your actual CSV path</span></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- User input ----</span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Enter one or more GO terms (exact or partial match)</span></span>
<span id="cb4-9">selected_terms <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"protein catabolic process"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lipid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"immune system process"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"carbohydrate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"antioxidant activity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mitochondrion"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inflammatory response"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reproductive"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Options ----</span></span>
<span id="cb4-12">row_normalize <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># TRUE for row-normalized (z-score), FALSE for raw</span></span>
<span id="cb4-13">log_transform <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># TRUE to apply log10(x+1) before plotting</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Load and prepare data ----</span></span>
<span id="cb4-16">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove total column if present</span></span>
<span id="cb4-19">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any_of</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>))</span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter by GO term (partial match supported)</span></span>
<span id="cb4-22">df_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_any</span>(term, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(.x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(selected_terms, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>))))</span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df_sel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"‚ö†Ô∏è No matching GO terms found. Check spelling or capitalization."</span>)</span>
<span id="cb4-27">}</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to matrix</span></span>
<span id="cb4-30">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_sel <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"term"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional log-transform</span></span>
<span id="cb4-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (log_transform) {</span>
<span id="cb4-36">  mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-37">}</span>
<span id="cb4-38"></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional row normalization</span></span>
<span id="cb4-40"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (row_normalize) {</span>
<span id="cb4-41">  mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(mat)))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># z-score per row</span></span>
<span id="cb4-42">}</span>
<span id="cb4-43"></span>
<span id="cb4-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Plot heatmap ----</span></span>
<span id="cb4-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb4-46">  mat,</span>
<span id="cb4-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick3"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb4-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb4-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb4-52">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO Term Heatmap ‚Äî"</span>,</span>
<span id="cb4-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (row_normalize) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Row-normalized"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raw values"</span>,</span>
<span id="cb4-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (log_transform) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(log10)"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb4-55">  )</span>
<span id="cb4-56">)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-25-48.png" class="img-fluid"></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/57-barnacle-35opt/</guid>
  <pubDate>Wed, 05 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-05_13-57-12.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Deep Dive on Rank 35</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/56-barnacle/</link>
  <description><![CDATA[ 





<p>Sam had run a series of ranks to see which one was most appropriate. Specifically he ran from 5-75.</p>
<p>It looks like 35 is where we go forward</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-13-35.png" class="img-fluid"></p>
<ul>
<li>‚Ä¢ Gene sparsity increases sharply after rank 35.</li>
</ul>
<hr>
<p>Heatmaps at 35</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-30-11.png" class="img-fluid"></p>
<p>Figures for all ranks can be seen at <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/scripts/22-Visualizing-Rank-outs.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/scripts/22-Visualizing-Rank-outs.html</a></p>
<p>Comparison of GO terms</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-46-24.png" class="img-fluid"> Full report:</p>
<p>Key Findings The top 5 biological processes across all rank 35 components are:<br>
- Innate immune response - 80 occurrences across 27 components.<br>
- Proteolysis - 79 occurrences across 25 components.<br>
- Positive regulation of gene expression - 78 occurrences across 27 components.<br>
- Defense response to Gram-negative bacterium - 76 occurrences across 30 components.<br>
- Positive regulation of transcription by RNA polymerase II - 76 occurrences across 21 components.</p>
<p>Some of this is part is driven by Group IDs in multiple components</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-55-02.png" class="img-fluid"></p>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/56-barnacle/</guid>
  <pubDate>Sun, 02 Nov 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-06-29.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Lets talk Cod</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/55-cod-talk/</link>
  <description><![CDATA[ 





<p>The directory <code>/volume1/web/nightingales/G_macrocephalus</code> contains seven sequencing projects, each representing a distinct Azenta sequencing batch or data delivery. The projects vary in size and file-naming conventions but consistently use paired-end FASTQ/FQ files with clear sample identifiers. Two projects (30-1067895835, 30-1149633765) are earlier batches, while others correspond to newer Azenta runs (<code>AN00025267</code>, <code>AN00025268</code>, <code>H202SC23041287</code>).</p>
<ul>
<li><strong>30-1067895835</strong> ‚Äî Single-sample pilot sequencing set (<code>1D11</code>), paired-end reads, includes Azenta report.<br>
</li>
<li><strong>30-1149633765</strong> ‚Äî Large-scale sequencing project (<code>EXP###</code>, <code>MHW###</code> prefixes), paired-end reads with checksums and HTML report.<br>
</li>
<li><strong>30-1149634506</strong> ‚Äî Moderate batch (<code>ET##</code> prefix), paired-end reads with standard naming and report.<br>
</li>
<li><strong>30-943133806</strong> ‚Äî Mixed sample identifiers (e.g., <code>19-G</code>, <code>RESUB-###</code>), includes supplemental folder and Azenta report.<br>
</li>
<li><strong>AN00025267 / AN00025268</strong> ‚Äî Consistent naming (<code>##B_1.fastq.gz</code> / <code>_2.fastq.gz</code>), likely replicate or continuation projects.<br>
</li>
<li><strong>H202SC23041287</strong> ‚Äî Deeply nested structure (<code>GM##</code> samples, multiple lanes per run), each sample has multiple files and MD5 checksums.</li>
</ul>
<hr>
<section id="section" class="level1">
<h1>30-1067895835</h1>
<p><strong>30-1067895835</strong> is test aging sample, noting there are also some comparable shark sample(s). refers to WGBS from a single cod fin clip (experimental cod with ‚Äúgenetic sampling count‚Äù = 84 from <a href="https://github.com/RobertsLab/project-cod-temperature/blob/main/data/temp-experiment.csv">this table</a> - that cod was held at 9C).</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Project</th>
<th>Sample ID</th>
<th>Barcode Sequence</th>
<th># Reads</th>
<th>Yield (Mbases)</th>
<th>Mean Quality Score</th>
<th>% Bases &gt;= 30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30-1067895835</td>
<td>1D11</td>
<td>CAACACAG+TGGCTATC</td>
<td>47,537,334</td>
<td>14,261</td>
<td>37.27</td>
<td>87.02</td>
</tr>
</tbody>
</table>
<p>Direct links - <code>https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1067895835/1D11_R1_001.fastq.gz</code> - <code>https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1067895835/1D11_R2_001.fastq.gz</code></p>
<hr>
</section>
<section id="an00025267-an00025268" class="level1">
<h1>AN00025267 / AN00025268</h1>
<p><strong>AN00025267 / AN00025268</strong> are paired RNA-seq / WGBS samples. Samples 1-36 are blood from cod held at 16C and samples 44-74 are blood from cod held at 0C. Note we also have lcWGS (~3x depth, a few samples higher) for the same cod individuals, should we want to, say, compare SNPs pulled from WGBS and lcWGS, or do a similar genetic + epigenetic variation paper (like the Silliman &amp; Spencer Oly paper).</p>
<section id="an00025267" class="level2">
<h2 class="anchored" data-anchor-id="an00025267">AN00025267</h2>
<p>Link to <strong>AN00025267</strong> report:</p>
<p><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/202508_AN00025267_Report/report.html" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/202508_AN00025267_Report/report.html</a></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-07-03.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-08-09.png" width="50%"></p>
<p>Link to data - <a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/</a></p>
<hr>
</section>
<section id="an00025268" class="level2">
<h2 class="anchored" data-anchor-id="an00025268">AN00025268</h2>
<p>Link to Report</p>
<p><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/202508_AN00025268_Report/report.html" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/202508_AN00025268_Report/report.html</a></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-16-46.png" width="75%"></p>
<p>Link to data</p>
<ul>
<li><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/</a></li>
</ul>
<hr>
</section>
</section>
<section id="genome" class="level1">
<h1>Genome</h1>
<p><a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_031168955.1/" class="uri">https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_031168955.1/</a></p>
<hr>
</section>
<section id="larger-effort" class="level1">
<h1>Larger Effort</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 45%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Project</th>
<th>Type</th>
<th style="text-align: right;">Unique samples</th>
<th style="text-align: right;">FASTQ/FQ files</th>
<th>Naming schema</th>
<th>Examples</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30-943133806</td>
<td>RNA-seq</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">160</td>
<td><code>NN[_SUFFIX]_R{1,2}_001.fastq.gz</code>, <code>RESUB-###_R{1,2}_001.fastq.gz</code></td>
<td><code>100_R1_001.fastq.gz</code>, <code>19-G_R1_001.fastq.gz</code>, <code>RESUB-76_R1_001.fastq.gz</code></td>
<td>Complete - WGCNA analysis identified temperature-responsive genes (0, 5, 9, 16C)</td>
</tr>
<tr class="even">
<td>H202SC23041287</td>
<td>lcWGS</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">314*</td>
<td><code>GM##_*_{1,2}.fq.gz</code> (sample <code>GM##</code>, multiple lanes/runs)</td>
<td><code>GM1_CKDN230011839-1A_H5NNGDSX7_L1_1.fq.gz</code></td>
<td>Complete - Population assignment, RDA, GWAS, eQTL analyses</td>
</tr>
<tr class="odd">
<td>30-1149633765</td>
<td>WGS</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">700</td>
<td><code>EXP###_R{1,2}_001.fastq.gz</code>, <code>MHW###_R{1,2}_001.fastq.gz</code></td>
<td><code>EXP001_R1_001.fastq.gz</code>, <code>MHW001_R1_001.fastq.gz</code></td>
<td>In progress - heatwave genetics study (2008-2023) + experimental resequencing</td>
</tr>
<tr class="even">
<td>30-1149634506</td>
<td>WGS</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">32</td>
<td><code>ET##_R{1,2}_001.fastq.gz</code></td>
<td><code>ET22_R1_001.fastq.gz</code></td>
<td>In progress - pilot ecotype sequencing (shallow/deep)</td>
</tr>
<tr class="odd">
<td>AN00025267**</td>
<td>BS-seq</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">64</td>
<td><code>##B_{1,2}.fastq.gz</code> (paired reads as <code>_1</code>/<code>_2</code>)</td>
<td><code>01B_1.fastq.gz</code>, <code>01B_2.fastq.gz</code></td>
<td>In progress - nf-core/methylseq pipeline (17.nextflow)</td>
</tr>
<tr class="even">
<td>AN00025268**</td>
<td>BS-seq</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">64</td>
<td><code>##B_{1,2}.fastq.gz</code> (paired reads as <code>_1</code>/<code>_2</code>)</td>
<td><code>01B_1.fastq.gz</code>, <code>01B_2.fastq.gz</code></td>
<td>Planned</td>
</tr>
<tr class="odd">
<td>30-1067895835**</td>
<td>WGBS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td><code>SAMPLE_R{1,2}_001.fastq.gz</code></td>
<td><code>1D11_R1_001.fastq.gz</code></td>
<td>trial WGBS for Pacific cod methylation and depth, in progress</td>
</tr>
</tbody>
</table>
<section id="key-results-to-date" class="level3">
<h3 class="anchored" data-anchor-id="key-results-to-date">Key Results to Date</h3>
<ul>
<li><strong>RNA-seq differential expression</strong>: Weighted gene correlation network analysis (WGCNA) identified genes expressed in the liver that are temperature-responsive, and those that correlate with juvenile cod performance (e.g.&nbsp;liver lipid content) within temperatures, particularly warming.<br>
</li>
<li><strong>Gene ontology enrichment</strong>: GO term enrichment analysis performed using DAVID on DEGs.</li>
<li><strong>Population genetics</strong>: lcWGS data analyzed to assign experimental fish to known Pacific cod spawning populations using WGSassign, PCA, which indicated that all were from the GOA spawning aggregation. Redundancy analysis (RDA) indicated that genetic variation associated with GOA populations (eGOA, wGOA) was not strongly linked to phenotypic responses in warming (16C), while there was some evidence for population-associated variation in cold acclimation (e.g.&nbsp;polar lipid concentrations). Additional genetic structure (within the wGOA population) existed that was not associated with the wGOA and eGOA populations that correlated with trait variation.</li>
<li><strong>Genome-Wide Association Study (GWAS)</strong>: lcWGS data paired with per-individual traits (growth, condition, liver lipid content) measured across four temperatures (0-16C) identified genetic variants associated with trait variation.<br>
</li>
<li><strong>Growth and physiology</strong>: Significant treatment effects observed on growth rates (SGRww, SGRsl), condition indices (Kwet, HSI), and liver lipid composition. Temperature-dependent models were constructed.</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>cod</category>
  <category>methylation</category>
  <category>RNA-seq</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/55-cod-talk/</guid>
  <pubDate>Sat, 01 Nov 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-14-45.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Lake Trout PacBio Data</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/54-lake-trout-QC/</link>
  <description><![CDATA[ 





<p>PacBio data came from Wisconsin</p>
<p>Raw data at <a href="https://owl.fish.washington.edu/nightingales/S_namaycush/LakeTrout/" class="uri">https://owl.fish.washington.edu/nightingales/S_namaycush/LakeTrout/</a></p>
<p>have 4 lean and 4 siscowets</p>
<p>they were run in three pools</p>
<p>Pool 1.</p>
<p>Lean FA047 bc2041 TATGATCACTGAGTAT.<br>
Siscowet FA097 bc2071 CGAGTCTAGCGAGTAT.<br>
Siscowet FA099 bc2072 TATCAGTAGTGAGTAT.</p>
<p>Pool 2.</p>
<p>Lean FA094 bc2069 TCTATGACATGAGTAT.<br>
Lean FA095 bc2070 TACTGCTCACGAGTAT.<br>
Siscowet FA100 bc2073 ATCACTAGTCGAGTAT.</p>
<p>Pool 3.</p>
<p>Lean FA092 - bc2068 ACTACGTGATGAGTAT.<br>
Siscowet FA253 - bc2096 ATGTACTAGTGAGTAT.</p>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">TLDR</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Sample ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lean</td>
<td>bc2041</td>
</tr>
<tr class="even">
<td>Lean</td>
<td>bc2068</td>
</tr>
<tr class="odd">
<td>Lean</td>
<td>bc2069</td>
</tr>
<tr class="even">
<td>Lean</td>
<td>bc2070</td>
</tr>
<tr class="odd">
<td>Siscowet</td>
<td>bc2071</td>
</tr>
<tr class="even">
<td>Siscowet</td>
<td>bc2072</td>
</tr>
<tr class="odd">
<td>Siscowet</td>
<td>bc2073</td>
</tr>
<tr class="even">
<td>Siscowet</td>
<td>bc2096</td>
</tr>
</tbody>
</table>
<p>Fastq files @ https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/data/pacbio-reads/fastq2/</p>
<hr>
<p>The first two pools arrived as Bams, and Sam demultiplexed. <a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-10-23-Demultiplexing---S.namaychush-PacBio-Sequencing-Using-Lima/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-10-23-Demultiplexing---S.namaychush-PacBio-Sequencing-Using-Lima/</a></p>
<p>The third pool arrived demultiplexed.</p>
<p>Sam generated corresponding fastq files</p>
<hr>
</section>
<section id="nanoplot" class="level2">
<h2 class="anchored" data-anchor-id="nanoplot">NanoPlot</h2>
<p>For each of the 8 files ran</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/envs/nanoplot_env/bin/NanoPlot</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">-t 40 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">--fastq ../data/pacbio-reads/fastq2/m84082_250614_101514_s4.hifi_reads.demux.bc2069--bc2069.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">-o ../analyses/08-nanoplot/bc2069 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--prefix bc2069_</span></code></pre></div>
<p>which created</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_05-31-35.png" class="img-fluid"></p>
</section>
<section id="multiqc" class="level2">
<h2 class="anchored" data-anchor-id="multiqc">MultiQC</h2>
<p>after all were complete ran multiqc</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc</span> ../analyses/08-nanoplot/ <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../analyses/08-multiqc</span></code></pre></div>
<p><a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html</a></p>
<hr>
<iframe src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html" width="100%" height="800px" style="border:none;">
</iframe>


<!-- -->

</section>

 ]]></description>
  <category>lake trout</category>
  <category>methylation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/54-lake-trout-QC/</guid>
  <pubDate>Mon, 27 Oct 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_05-35-03.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Ortholog Selection for Physiological Processes</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/53-ortho-select/</link>
  <description><![CDATA[ 





<section id="ortho-select" class="level1">
<h1>13-ortho-select</h1>
<p>TLDR: <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/13-ortho-select/selected_orthologs.csv" class="uri">https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/13-ortho-select/selected_orthologs.csv</a></p>
<section id="overview-of-annotated-orthologs" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-annotated-orthologs">Overview of Annotated Orthologs</h2>
<p>First, let‚Äôs examine the annotated ortholog data from the previous analysis:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/11-orthology-analysis/ortholog_groups.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity
OG_00001,FUN_000185-T1,Peve_00037402,Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,three_way,71.059
OG_00002,FUN_000189-T1,Peve_00038462,Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,three_way,68.72583333333334
OG_00003,FUN_000190-T1,Peve_00038463,Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,three_way,55.1975
OG_00004,FUN_000191-T1,Peve_00038464,Pocillopora_meandrina_HIv1___RNAseq.g28890.t1,three_way,72.047
OG_00005,FUN_000192-T1,Peve_00038466,Pocillopora_meandrina_HIv1___RNAseq.g28893.t1,three_way,81.15866666666666
OG_00006,FUN_000193-T1,Peve_00038467,Pocillopora_meandrina_HIv1___RNAseq.g28894.t1,three_way,70.21933333333334
OG_00007,FUN_000194-T1,Peve_00038470,Pocillopora_meandrina_HIv1___RNAseq.g28898.t1,three_way,77.11833333333334
OG_00008,FUN_000195-T1,Peve_00038471,Pocillopora_meandrina_HIv1___RNAseq.g28899.t1,three_way,68.38
OG_00009,FUN_000197-T1,Peve_00027182,Pocillopora_meandrina_HIv1___RNAseq.g28901.t1,three_way,56.498333333333335</code></pre>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/11-orthology-analysis/ortholog_groups.csv</span></code></pre></div>
<pre><code>18327 ../output/11-orthology-analysis/ortholog_groups.csv</code></pre>
</section>
<section id="annotated-orthologs" class="level2">
<h2 class="anchored" data-anchor-id="annotated-orthologs">Annotated Orthologs</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity,query,accession,id,reviewed,protein_name,organism,pident,length,evalue,bitscore,title,go_ids,go_bp,go_cc,go_mf,goslim_ids,goslim_names
OG_00001,FUN_000185-T1,Peve_00037402,Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,three_way,71.059,FUN_000185-T1,Q32LQ0,AMPE_BOVIN,,Glutamyl aminopeptidase (EAP) (EC 3.4.11.7) (Aminopeptidase A) (AP-A) (CD antigen CD249),Bos taurus (Bovine),41.5,881.0,1.4e-197,691.4,sp|Q32LQ0|AMPE_BOVIN Glutamyl aminopeptidase OS=Bos taurus OX=9913 GN=ENPEP PE=2 SV=1,GO:0003081; GO:0004177; GO:0004230; GO:0005615; GO:0005737; GO:0005886; GO:0006508; GO:0008217; GO:0008270; GO:0008283; GO:0016477; GO:0042277; GO:0043171; GO:0070006,cell migration [GO:0016477]; cell population proliferation [GO:0008283]; peptide catabolic process [GO:0043171]; proteolysis [GO:0006508]; regulation of blood pressure [GO:0008217]; regulation of systemic arterial blood pressure by renin-angiotensin [GO:0003081],cytoplasm [GO:0005737]; extracellular space [GO:0005615]; plasma membrane [GO:0005886],aminopeptidase activity [GO:0004177]; glutamyl aminopeptidase activity [GO:0004230]; metalloaminopeptidase activity [GO:0070006]; peptide binding [GO:0042277]; zinc ion binding [GO:0008270],GO:0003824; GO:0005615; GO:0005886; GO:0016787; GO:0048870; GO:0050886; GO:0140096,"catalytic activity; extracellular space; plasma membrane; hydrolase activity; cell motility; endocrine process; catalytic activity, acting on a protein"
OG_00002,FUN_000189-T1,Peve_00038462,Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,three_way,68.72583333333334,FUN_000189-T1,Q9DCT6,,,,,38.0,171.0,4.6e-18,92.8,sp|Q9DCT6|BAP18_MOUSE BPTF-associated chromatin complex component 1 OS=Mus musculus OX=10090 GN=Bacc1 PE=1 SV=1,,,,,,
OG_00003,FUN_000190-T1,Peve_00038463,Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,three_way,55.1975,,,,,,,,,,,,,,,,,
OG_00004,FUN_000191-T1,Peve_00038464,Pocillopora_meandrina_HIv1___RNAseq.g28890.t1,three_way,72.047,FUN_000191-T1,Q95108,,,,,44.1,136.0,3.3e-29,129.4,"sp|Q95108|THIOM_BOVIN Thioredoxin, mitochondrial OS=Bos taurus OX=9913 GN=TXN2 PE=1 SV=2",,,,,,
OG_00005,FUN_000192-T1,Peve_00038466,Pocillopora_meandrina_HIv1___RNAseq.g28893.t1,three_way,81.15866666666666,FUN_000192-T1,Q1LWX3,,,,,54.3,188.0,3.5e-53,209.5,sp|Q1LWX3|NTAQ1_DANRE Protein N-terminal glutamine amidohydrolase OS=Danio rerio OX=7955 GN=ntaq1 PE=2 SV=1,,,,,,
OG_00006,FUN_000193-T1,Peve_00038467,Pocillopora_meandrina_HIv1___RNAseq.g28894.t1,three_way,70.21933333333334,FUN_000193-T1,Q5I0K7,,,,,53.2,158.0,3.4e-41,169.5,sp|Q5I0K7|ALG13_RAT UDP-N-acetylglucosamine transferase subunit ALG13 OS=Rattus norvegicus OX=10116 GN=Alg13 PE=1 SV=1,,,,,,
OG_00007,FUN_000194-T1,Peve_00038470,Pocillopora_meandrina_HIv1___RNAseq.g28898.t1,three_way,77.11833333333334,FUN_000194-T1,P70182,,,,,60.2,447.0,3.4e-147,523.5,sp|P70182|PI51A_MOUSE Phosphatidylinositol 4-phosphate 5-kinase type-1 alpha OS=Mus musculus OX=10090 GN=Pip5k1a PE=1 SV=2,,,,,,
OG_00008,FUN_000195-T1,Peve_00038471,Pocillopora_meandrina_HIv1___RNAseq.g28899.t1,three_way,68.38,FUN_000195-T1,B8D9S0,,,,,38.5,148.0,9e-19,95.1,sp|B8D9S0|FMT_BUCA5 Methionyl-tRNA formyltransferase OS=Buchnera aphidicola subsp. Acyrthosiphon pisum (strain 5A) OX=563178 GN=fmt PE=3 SV=1,,,,,,
OG_00009,FUN_000197-T1,Peve_00027182,Pocillopora_meandrina_HIv1___RNAseq.g28901.t1,three_way,56.498333333333335,FUN_000197-T1,Q8TCT7,,,,,44.7,488.0,1.6e-89,331.6,sp|Q8TCT7|SPP2B_HUMAN Signal peptide peptidase-like 2B OS=Homo sapiens OX=9606 GN=SPPL2B PE=1 SV=2,,,,,,</code></pre>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv</span></code></pre></div>
<pre><code>18373 ../output/12-ortho-annot/ortholog_groups_annotated.csv</code></pre>
</section>
</section>
<section id="physiology-based-selection" class="level1">
<h1>Physiology Based Selection</h1>
<section id="filter-for-specific-go-terms" class="level2">
<h2 class="anchored" data-anchor-id="filter-for-specific-go-terms">Filter for Specific GO Terms</h2>
<p>We‚Äôll filter the annotated orthologs for genes involved in metabolic and stress-related processes that are relevant to coral physiology:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter orthologs for metabolic and stress-related processes</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Filtering for:"</span></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Glycolysis (GO:0006096)"</span></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Gluconeogenesis (GO:0006094)"</span></span>
<span id="cb9-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Lipolysis/lipid catabolism (GO:0016042)"</span></span>
<span id="cb9-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Fatty acid beta oxidation (GO:0006635)"</span></span>
<span id="cb9-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Starvation (GO:0042594)"</span></span>
<span id="cb9-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Lipid biosynthesis (GO:0008610)"</span></span>
<span id="cb9-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Protein catabolic process (GO:0030163)"</span></span>
<span id="cb9-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Reproductive Process (GO:0022414)"</span></span>
<span id="cb9-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-12"></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create output directory if it doesn't exist</span></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/13-ortho-select</span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract header</span></span>
<span id="cb9-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/13-ortho-select/selected_orthologs.csv</span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the specified GO terms and reproduction-related processes</span></span>
<span id="cb9-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006096|GO:0006094|GO:0016042|GO:0006635|GO:0042594|GO:0008610|GO:0030163|GO:0022414'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-21">  ../output/12-ortho-annot/ortholog_groups_annotated.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-22">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ../output/13-ortho-select/selected_orthologs.csv</span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total orthologs selected:"</span></span>
<span id="cb9-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/13-ortho-select/selected_orthologs.csv</span></code></pre></div>
<pre><code>Filtering for:
- Glycolysis (GO:0006096)
- Gluconeogenesis (GO:0006094)
- Lipolysis/lipid catabolism (GO:0016042)
- Fatty acid beta oxidation (GO:0006635)
- Starvation (GO:0042594)
- Lipid biosynthesis (GO:0008610)
- Protein catabolic process (GO:0030163)
- Reproductive Process (GO:0022414)

Total orthologs selected:
787 ../output/13-ortho-select/selected_orthologs.csv</code></pre>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show first few selected orthologs</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/13-ortho-select/selected_orthologs.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity,query,accession,id,reviewed,protein_name,organism,pident,length,evalue,bitscore,title,go_ids,go_bp,go_cc,go_mf,goslim_ids,goslim_names
OG_00044,FUN_000272-T1,Peve_00027798,Pocillopora_meandrina_HIv1___RNAseq.g28985.t1,three_way,70.59733333333334,FUN_000272-T1,O75031,HSF2B_HUMAN,,Heat shock factor 2-binding protein,Homo sapiens (Human),43.2,190.0,5.9e-32,139.0,sp|O75031|HSF2B_HUMAN Heat shock factor 2-binding protein OS=Homo sapiens OX=9606 GN=HSF2BP PE=1 SV=1,GO:0005654; GO:0005694; GO:0005829; GO:0006366; GO:0007141; GO:0007144; GO:0007283; GO:1990918,double-strand break repair involved in meiotic recombination [GO:1990918]; female meiosis I [GO:0007144]; male meiosis I [GO:0007141]; spermatogenesis [GO:0007283]; transcription by RNA polymerase II [GO:0006366],chromosome [GO:0005694]; cytosol [GO:0005829]; nucleoplasm [GO:0005654],,GO:0005654; GO:0005694; GO:0005829; GO:0006281; GO:0006351; GO:0022414; GO:0043226; GO:0140013,nucleoplasm; chromosome; cytosol; DNA repair; DNA-templated transcription; reproductive process; organelle; meiotic nuclear division
OG_00086,FUN_000437-T1,Peve_00011193,Pocillopora_meandrina_HIv1___RNAseq.g2323.t1,three_way,77.881,FUN_000437-T1,F1MNN4,FBXW7_BOVIN,,F-box/WD repeat-containing protein 7 (F-box and WD-40 domain-containing protein 7),Bos taurus (Bovine),36.4,195.0,1.9999999999999998e-26,122.5,sp|F1MNN4|FBXW7_BOVIN F-box/WD repeat-containing protein 7 OS=Bos taurus OX=9913 GN=FBXW7 PE=1 SV=3,GO:0005634; GO:0005654; GO:0005694; GO:0005737; GO:0006281; GO:0006974; GO:0007062; GO:0010629; GO:0010992; GO:0019005; GO:0030332; GO:0031146; GO:0031398; GO:0031625; GO:0042752; GO:0042802; GO:0043130; GO:0043161; GO:0050816; GO:0050821; GO:0070374; GO:0070534; GO:0097027; GO:1901524; GO:1901800; GO:1903378; GO:1903955; GO:1990452; GO:1990756; GO:2000060; GO:2001205,DNA damage response [GO:0006974]; DNA repair [GO:0006281]; negative regulation of gene expression [GO:0010629]; negative regulation of osteoclast development [GO:2001205]; positive regulation of ERK1 and ERK2 cascade [GO:0070374]; positive regulation of oxidative stress-induced neuron intrinsic apoptotic signaling pathway [GO:1903378]; positive regulation of proteasomal protein catabolic process [GO:1901800]; positive regulation of protein targeting to mitochondrion [GO:1903955]; positive regulation of protein ubiquitination [GO:0031398]; positive regulation of ubiquitin-dependent protein catabolic process [GO:2000060]; proteasome-mediated ubiquitin-dependent protein catabolic process [GO:0043161]; protein K63-linked ubiquitination [GO:0070534]; protein stabilization [GO:0050821]; regulation of circadian rhythm [GO:0042752]; regulation of mitophagy [GO:1901524]; SCF-dependent proteasomal ubiquitin-dependent protein catabolic process [GO:0031146]; sister chromatid cohesion [GO:0007062]; ubiquitin recycling [GO:0010992],chromosome [GO:0005694]; cytoplasm [GO:0005737]; nucleoplasm [GO:0005654]; nucleus [GO:0005634]; Parkin-FBXW7-Cul1 ubiquitin ligase complex [GO:1990452]; SCF ubiquitin ligase complex [GO:0019005],cyclin binding [GO:0030332]; identical protein binding [GO:0042802]; phosphothreonine residue binding [GO:0050816]; ubiquitin binding [GO:0043130]; ubiquitin protein ligase binding [GO:0031625]; ubiquitin-like ligase-substrate adaptor activity [GO:1990756]; ubiquitin-protein transferase activator activity [GO:0097027],GO:0005634; GO:0005654; GO:0005694; GO:0006281; GO:0030163; GO:0043226; GO:0060090; GO:0098772,nucleus; nucleoplasm; chromosome; DNA repair; protein catabolic process; organelle; molecular adaptor activity; molecular function regulator activity
OG_00107,FUN_000499-T1,Peve_00024155,Pocillopora_meandrina_HIv1___RNAseq.g2414.t1,three_way,82.06683333333332,FUN_000499-T1,Q14432,PDE3A_HUMAN,,"cGMP-inhibited 3',5'-cyclic phosphodiesterase 3A (EC 3.1.4.17) (Cyclic GMP-inhibited phosphodiesterase A) (CGI-PDE A) (cGMP-inhibited cAMP phosphodiesterase) (cGI-PDE)",Homo sapiens (Human),37.6,1034.0,2.2e-143,511.5,"sp|Q14432|PDE3A_HUMAN cGMP-inhibited 3',5'-cyclic phosphodiesterase 3A OS=Homo sapiens OX=9606 GN=PDE3A PE=1 SV=3",GO:0001556; GO:0004114; GO:0004115; GO:0004119; GO:0005829; GO:0006629; GO:0007186; GO:0009410; GO:0016020; GO:0019933; GO:0019934; GO:0030284; GO:0040020; GO:0043066; GO:0043116; GO:0043117; GO:0046872; GO:0047555; GO:0060282; GO:0060700; GO:0071321; GO:0071560; GO:0097190; GO:0099130; GO:0106072; GO:0141162,apoptotic signaling pathway [GO:0097190]; cAMP-mediated signaling [GO:0019933]; cellular response to cGMP [GO:0071321]; cellular response to transforming growth factor beta stimulus [GO:0071560]; cGMP-mediated signaling [GO:0019934]; G protein-coupled receptor signaling pathway [GO:0007186]; lipid metabolic process [GO:0006629]; negative regulation of adenylate cyclase-activating G protein-coupled receptor signaling pathway [GO:0106072]; negative regulation of apoptotic process [GO:0043066]; negative regulation of cAMP/PKA signal transduction [GO:0141162]; negative regulation of vascular permeability [GO:0043116]; oocyte maturation [GO:0001556]; positive regulation of oocyte development [GO:0060282]; positive regulation of vascular permeability [GO:0043117]; regulation of meiotic nuclear division [GO:0040020]; regulation of ribonuclease activity [GO:0060700]; response to xenobiotic stimulus [GO:0009410],cytosol [GO:0005829]; membrane [GO:0016020],"3',5'-cGMP-inhibited cyclic-nucleotide phosphodiesterase activity [GO:0004119]; 3',5'-cyclic-AMP phosphodiesterase activity [GO:0004115]; 3',5'-cyclic-GMP phosphodiesterase activity [GO:0047555]; 3',5'-cyclic-nucleotide phosphodiesterase activity [GO:0004114]; estrogen binding [GO:0099130]; metal ion binding [GO:0046872]; nuclear estrogen receptor activity [GO:0030284]",GO:0003013; GO:0003824; GO:0005829; GO:0006629; GO:0016787; GO:0022414; GO:0060089; GO:0140110,circulatory system process; catalytic activity; cytosol; lipid metabolic process; hydrolase activity; reproductive process; molecular transducer activity; transcription regulator activity
OG_00142,FUN_000582-T1,Peve_00034702,Pocillopora_meandrina_HIv1___TS.g6501.t1,three_way,59.576166666666666,FUN_000582-T1,D2X8K2,PA2_CONGI,,Phospholipase A2 A2-actitoxin-Cgg2a (A2-AITX-Cgg2a) (EC 3.1.1.4) (CgPLA2) (Phosphatidylcholine 2-acylhydrolase),Condylactis gigantea (Giant Caribbean anemone) (Condylactis passiflora),43.7,119.0,3.5e-25,116.3,sp|D2X8K2|PA2_CONGI Phospholipase A2 A2-actitoxin-Cgg2a OS=Condylactis gigantea OX=47073 PE=1 SV=1,GO:0005509; GO:0005543; GO:0005576; GO:0006644; GO:0016042; GO:0042151; GO:0044398; GO:0044470; GO:0044522; GO:0047498; GO:0050482; GO:0090729,arachidonate secretion [GO:0050482]; lipid catabolic process [GO:0016042]; phospholipid metabolic process [GO:0006644]; venom-mediated edema in another organism [GO:0044398]; venom-mediated myocyte killing in another organism [GO:0044522]; venom-mediated suppression of blood coagulation [GO:0044470],extracellular region [GO:0005576]; nematocyst [GO:0042151],calcium ion binding [GO:0005509]; calcium-dependent phospholipase A2 activity [GO:0047498]; phospholipid binding [GO:0005543]; toxin activity [GO:0090729],GO:0003824; GO:0005576; GO:0006629; GO:0008289; GO:0016787; GO:0043226; GO:0090729,catalytic activity; extracellular region; lipid metabolic process; lipid binding; hydrolase activity; organelle; toxin activity
OG_00192,FUN_000898-T1,Peve_00009741,Pocillopora_meandrina_HIv1___RNAseq.g29449.t1,three_way,80.12233333333333,FUN_000898-T1,O43903,GAS2_HUMAN,,Growth arrest-specific protein 2 (GAS-2),Homo sapiens (Human),42.6,256.0,1.3e-48,194.9,sp|O43903|GAS2_HUMAN Growth arrest-specific protein 2 OS=Homo sapiens OX=9606 GN=GAS2 PE=1 SV=1,GO:0001544; GO:0001547; GO:0001725; GO:0005829; GO:0005884; GO:0006915; GO:0008017; GO:0008360; GO:0008593; GO:0016020; GO:0030728; GO:0051015; GO:0051726; GO:0051764; GO:0071711,actin crosslink formation [GO:0051764]; antral ovarian follicle growth [GO:0001547]; apoptotic process [GO:0006915]; basement membrane organization [GO:0071711]; initiation of primordial ovarian follicle growth [GO:0001544]; ovulation [GO:0030728]; regulation of cell cycle [GO:0051726]; regulation of cell shape [GO:0008360]; regulation of Notch signaling pathway [GO:0008593],actin filament [GO:0005884]; cytosol [GO:0005829]; membrane [GO:0016020]; stress fiber [GO:0001725],actin filament binding [GO:0051015]; microtubule binding [GO:0008017],GO:0005829; GO:0008092; GO:0012501; GO:0022414; GO:0030198,cytosol; cytoskeletal protein binding; programmed cell death; reproductive process; extracellular matrix organization
OG_00195,FUN_000905-T1,Peve_00009733,Pocillopora_meandrina_HIv1___RNAseq.g29456.t1,three_way,66.77466666666666,FUN_000905-T1,P70627,FOLH1_RAT,,Glutamate carboxypeptidase 2 (EC 3.4.17.21) (Folate hydrolase 1) (Folylpoly-gamma-glutamate carboxypeptidase) (FGCP) (Glutamate carboxypeptidase II) (GCPII) (Membrane glutamate carboxypeptidase) (mGCP) (N-acetylated-alpha-linked acidic dipeptidase I) (NAALADase I) (Prostate-specific membrane antigen homolog) (Pteroylpoly-gamma-glutamate carboxypeptidase),Rattus norvegicus (Rat),37.3,753.0,5.9e-130,466.5,sp|P70627|FOLH1_RAT Glutamate carboxypeptidase 2 OS=Rattus norvegicus OX=10116 GN=Folh1 PE=1 SV=1,GO:0004180; GO:0004181; GO:0005886; GO:0006508; GO:0006760; GO:0008233; GO:0009986; GO:0016020; GO:0016805; GO:0030163; GO:0043065; GO:0046872; GO:1904492; GO:1904493,folic acid-containing compound metabolic process [GO:0006760]; positive regulation of apoptotic process [GO:0043065]; protein catabolic process [GO:0030163]; proteolysis [GO:0006508],cell surface [GO:0009986]; membrane [GO:0016020]; plasma membrane [GO:0005886],Ac-Asp-Glu binding [GO:1904492]; carboxypeptidase activity [GO:0004180]; dipeptidase activity [GO:0016805]; metal ion binding [GO:0046872]; metallocarboxypeptidase activity [GO:0004181]; peptidase activity [GO:0008233]; tetrahydrofolyl-poly(glutamate) polymer binding [GO:1904493],GO:0003824; GO:0005886; GO:0006575; GO:0016787; GO:0030163; GO:0140096,"catalytic activity; plasma membrane; modified amino acid metabolic process; hydrolase activity; protein catabolic process; catalytic activity, acting on a protein"
OG_00207,FUN_000926-T1,Peve_00009718,Pocillopora_meandrina_HIv1___RNAseq.g29467.t1,three_way,63.42333333333334,FUN_000926-T1,Q9R0N8,SYT6_MOUSE,,Synaptotagmin-6 (Synaptotagmin VI) (SytVI),Mus musculus (Mouse),29.5,319.0,9.1e-33,142.9,sp|Q9R0N8|SYT6_MOUSE Synaptotagmin-6 OS=Mus musculus OX=10090 GN=Syt6 PE=1 SV=2,GO:0001786; GO:0005544; GO:0005829; GO:0005886; GO:0007340; GO:0009898; GO:0016020; GO:0030672; GO:0042802; GO:0042803; GO:0046872; GO:0046982; GO:0048306; GO:0097038,acrosome reaction [GO:0007340],cytoplasmic side of plasma membrane [GO:0009898]; cytosol [GO:0005829]; membrane [GO:0016020]; perinuclear endoplasmic reticulum [GO:0097038]; plasma membrane [GO:0005886]; synaptic vesicle membrane [GO:0030672],calcium-dependent phospholipid binding [GO:0005544]; calcium-dependent protein binding [GO:0048306]; identical protein binding [GO:0042802]; metal ion binding [GO:0046872]; phosphatidylserine binding [GO:0001786]; protein heterodimerization activity [GO:0046982]; protein homodimerization activity [GO:0042803],GO:0005829; GO:0005886; GO:0008289; GO:0022414,cytosol; plasma membrane; lipid binding; reproductive process
OG_00237,FUN_000992-T1,Peve_00004455,Pocillopora_meandrina_HIv1___RNAseq.g29194.t1,three_way,92.068,FUN_000992-T1,P82471,GNAQ_RAT,,Guanine nucleotide-binding protein G(q) subunit alpha (EC 3.6.5.-) (Guanine nucleotide-binding protein alpha-q),Rattus norvegicus (Rat),82.2,353.0,8.9e-169,594.3,sp|P82471|GNAQ_RAT Guanine nucleotide-binding protein G(q) subunit alpha OS=Rattus norvegicus OX=10116 GN=Gnaq PE=2 SV=2,GO:0001501; GO:0001508; GO:0001664; GO:0003924; GO:0003925; GO:0005096; GO:0005525; GO:0005737; GO:0005794; GO:0005834; GO:0005886; GO:0005901; GO:0007186; GO:0007189; GO:0007200; GO:0007206; GO:0007207; GO:0007208; GO:0007215; GO:0007218; GO:0007507; GO:0008217; GO:0009791; GO:0010543; GO:0016020; GO:0016322; GO:0021884; GO:0030234; GO:0030425; GO:0031683; GO:0031965; GO:0032024; GO:0034695; GO:0042711; GO:0042733; GO:0043066; GO:0043267; GO:0044297; GO:0044877; GO:0045634; GO:0046872; GO:0047391; GO:0048066; GO:0050821; GO:0060158; GO:0060828; GO:0086100; GO:0098793; GO:0099524; GO:1904888; GO:1990806,action potential [GO:0001508]; adenylate cyclase-activating G protein-coupled receptor signaling pathway [GO:0007189]; cranial skeletal system development [GO:1904888]; developmental pigmentation [GO:0048066]; embryonic digit morphogenesis [GO:0042733]; endothelin receptor signaling pathway [GO:0086100]; forebrain neuron development [GO:0021884]; G protein-coupled receptor signaling pathway [GO:0007186]; glutamate receptor signaling pathway [GO:0007215]; heart development [GO:0007507]; ligand-gated ion channel signaling pathway [GO:1990806]; maternal behavior [GO:0042711]; negative regulation of apoptotic process [GO:0043066]; negative regulation of potassium ion transport [GO:0043267]; neuron remodeling [GO:0016322]; neuropeptide signaling pathway [GO:0007218]; phospholipase C-activating dopamine receptor signaling pathway [GO:0060158]; phospholipase C-activating G protein-coupled acetylcholine receptor signaling pathway [GO:0007207]; phospholipase C-activating G protein-coupled glutamate receptor signaling pathway [GO:0007206]; phospholipase C-activating G protein-coupled receptor signaling pathway [GO:0007200]; phospholipase C-activating serotonin receptor signaling pathway [GO:0007208]; positive regulation of insulin secretion [GO:0032024]; post-embryonic development [GO:0009791]; protein stabilization [GO:0050821]; regulation of blood pressure [GO:0008217]; regulation of canonical Wnt signaling pathway [GO:0060828]; regulation of melanocyte differentiation [GO:0045634]; regulation of platelet activation [GO:0010543]; response to prostaglandin E [GO:0034695]; skeletal system development [GO:0001501],caveola [GO:0005901]; cell body [GO:0044297]; cytoplasm [GO:0005737]; dendrite [GO:0030425]; Golgi apparatus [GO:0005794]; heterotrimeric G-protein complex [GO:0005834]; membrane [GO:0016020]; nuclear membrane [GO:0031965]; plasma membrane [GO:0005886]; postsynaptic cytosol [GO:0099524]; presynapse [GO:0098793],alkylglycerophosphoethanolamine phosphodiesterase activity [GO:0047391]; enzyme regulator activity [GO:0030234]; G protein activity [GO:0003925]; G protein-coupled receptor binding [GO:0001664]; G-protein beta/gamma-subunit complex binding [GO:0031683]; GTP binding [GO:0005525]; GTPase activator activity [GO:0005096]; GTPase activity [GO:0003924]; metal ion binding [GO:0046872]; protein-containing complex binding [GO:0044877],GO:0003824; GO:0003924; GO:0005794; GO:0005829; GO:0005886; GO:0016787; GO:0022414; GO:0043226; GO:0048856; GO:0098772,catalytic activity; GTPase activity; Golgi apparatus; cytosol; plasma membrane; hydrolase activity; reproductive process; organelle; anatomical structure development; molecular function regulator activity
OG_00248,FUN_001011-T1,Peve_00041060,Pocillopora_meandrina_HIv1___RNAseq.g29164.t1,three_way,70.763,FUN_001011-T1,Q6ZUX7,LHPL2_HUMAN,,LHFPL tetraspan subfamily member 2 protein (Lipoma HMGIC fusion partner-like 2 protein),Homo sapiens (Human),43.1,232.0,6.4e-43,175.6,sp|Q6ZUX7|LHPL2_HUMAN LHFPL tetraspan subfamily member 2 protein OS=Homo sapiens OX=9606 GN=LHFPL2 PE=1 SV=2,GO:0005886; GO:0007338; GO:0016020; GO:0031092; GO:0046545; GO:0046546; GO:1905516,development of primary female sexual characteristics [GO:0046545]; development of primary male sexual characteristics [GO:0046546]; positive regulation of fertilization [GO:1905516]; single fertilization [GO:0007338],membrane [GO:0016020]; plasma membrane [GO:0005886]; platelet alpha granule membrane [GO:0031092],,GO:0005886; GO:0022414,plasma membrane; reproductive process</code></pre>
</section>
<section id="summary-by-go-category" class="level2">
<h2 class="anchored" data-anchor-id="summary-by-go-category">Summary by GO Category</h2>
<p>Let‚Äôs examine how many orthologs were identified for each physiological process:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count orthologs by each GO category</span></span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Glycolysis (GO:0006096) ==="</span></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006096'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Gluconeogenesis (GO:0006094) ==="</span></span>
<span id="cb13-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006094'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Lipolysis/lipid catabolism (GO:0016042) ==="</span></span>
<span id="cb13-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0016042'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-10"></span>
<span id="cb13-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Fatty acid beta oxidation (GO:0006635) ==="</span></span>
<span id="cb13-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006635'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Starvation (GO:0042594) ==="</span></span>
<span id="cb13-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0042594'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Lipid biosynthesis (GO:0008610) ==="</span></span>
<span id="cb13-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0008610'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-19"></span>
<span id="cb13-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Protein catabolic process (GO:0030163) ==="</span></span>
<span id="cb13-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0030163'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-22"></span>
<span id="cb13-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Reproductive Process (GO:0022414) ==="</span></span>
<span id="cb13-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0022414'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span></code></pre></div>
<pre><code>=== Glycolysis (GO:0006096) ===
10
=== Gluconeogenesis (GO:0006094) ===
13
=== Lipolysis/lipid catabolism (GO:0016042) ===
21
=== Fatty acid beta oxidation (GO:0006635) ===
22
=== Starvation (GO:0042594) ===
12
=== Lipid biosynthesis (GO:0008610) ===
7
=== Protein catabolic process (GO:0030163) ===
235
=== Reproductive Process (GO:0022414) ===
496</code></pre>
</section>
<section id="results-summary" class="level2">
<h2 class="anchored" data-anchor-id="results-summary">Results Summary</h2>
<p>From the 18,326 annotated ortholog groups, we selected <strong>787 orthologs</strong> that are involved in key physiological processes relevant to coral metabolism and reproduction:</p>
<section id="metabolic-processes" class="level3">
<h3 class="anchored" data-anchor-id="metabolic-processes">Metabolic Processes</h3>
<ul>
<li><strong>Glycolysis</strong>: 10 orthologs - Energy production through glucose breakdown</li>
<li><strong>Gluconeogenesis</strong>: 13 orthologs - Glucose synthesis from non-carbohydrate sources</li>
<li><strong>Lipolysis/Lipid catabolism</strong>: 21 orthologs - Breakdown of lipids for energy</li>
<li><strong>Fatty acid beta oxidation</strong>: 22 orthologs - Oxidation of fatty acids in mitochondria</li>
<li><strong>Lipid biosynthesis</strong>: 7 orthologs - Synthesis of new lipids</li>
<li><strong>Starvation response</strong>: 12 orthologs - Cellular responses to nutrient deprivation</li>
</ul>
</section>
<section id="protein-turnover" class="level3">
<h3 class="anchored" data-anchor-id="protein-turnover">Protein Turnover</h3>
<ul>
<li><strong>Protein catabolic process</strong>: 235 orthologs - Protein degradation and recycling</li>
</ul>
</section>
<section id="reproduction" class="level3">
<h3 class="anchored" data-anchor-id="reproduction">Reproduction</h3>
<ul>
<li><strong>Reproductive processes</strong>: 496 orthologs - Genes involved in reproductive development and function</li>
</ul>
<p>These selected orthologs represent conserved genes across all three coral species that play crucial roles in:</p>
<ol type="1">
<li><p><strong>Energy metabolism</strong> - particularly relevant for understanding coral responses to bleaching and thermal stress</p></li>
<li><p><strong>Lipid metabolism</strong> - important for energy storage and membrane maintenance</p></li>
<li><p><strong>Reproduction</strong> - critical for understanding coral spawning and life cycle processes</p></li>
<li><p><strong>Protein homeostasis</strong> - essential for cellular function and stress responses</p></li>
</ol>
<p>This filtered set of orthologs provides a focused gene list for downstream expression analysis, particularly for studies examining coral physiological responses to environmental stressors.</p>


<!-- -->

</section>
</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/53-ortho-select/</guid>
  <pubDate>Sat, 04 Oct 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MOSAiC_orthologs__Tumbling_Oysters_2025-08-31_08-16-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>MOSAiC orthologs</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</link>
  <description><![CDATA[ 





<section id="orthologous-protein-identification-across-three-coral-species" class="level1">
<h1>Orthologous Protein Identification Across Three Coral Species</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Understanding the evolutionary relationships between genes across different species is fundamental to comparative genomics. In this analysis, we identified orthologous proteins across three distinct coral species using a reciprocal best hits (RBH) approach. This methodology provides a robust foundation for cross-species comparisons and evolutionary studies.</p>
</section>
<section id="study-species" class="level2">
<h2 class="anchored" data-anchor-id="study-species">Study Species</h2>
<p>Our analysis focused on three coral species representing different growth forms and ecological strategies:</p>
<ul>
<li><strong>Acropora pulchra</strong> (D-Apul): A fast-growing, branching coral species</li>
<li><strong>Porites evermanni</strong> (E-Peve): A slow-growing, massive coral species<br>
</li>
<li><strong>Pocillopora tuahiniensis</strong> (F-Ptua): An intermediate growth, branching coral species</li>
</ul>
<p>These species represent different evolutionary strategies within the coral phylogeny, making them ideal candidates for comparative genomic analysis.</p>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="orthology-identification-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="orthology-identification-pipeline">Orthology Identification Pipeline</h3>
<p>We employed a comprehensive orthology identification pipeline using the following parameters:</p>
<ul>
<li><strong>BLAST algorithm</strong>: All-vs-all protein BLAST comparisons</li>
<li><strong>Orthology criterion</strong>: Reciprocal best hits (RBH)</li>
<li><strong>E-value threshold</strong>: 1e-5 (stringent significance threshold)</li>
<li><strong>Minimum identity</strong>: 30% (allowing for evolutionary divergence)</li>
<li><strong>Minimum coverage</strong>: 50% (ensuring substantial sequence overlap)</li>
</ul>
</section>
<section id="computational-workflow" class="level3">
<h3 class="anchored" data-anchor-id="computational-workflow">Computational Workflow</h3>
<ol type="1">
<li><strong>Database Preparation</strong>: Created BLAST databases for each species‚Äô protein sequences</li>
<li><strong>All-vs-All Comparisons</strong>: Performed bidirectional BLAST searches between all species pairs</li>
<li><strong>Reciprocal Best Hits</strong>: Identified protein pairs that are mutual best matches</li>
<li><strong>Ortholog Grouping</strong>: Organized orthologs into groups based on presence across species</li>
<li><strong>Quality Filtering</strong>: Applied identity and coverage thresholds to ensure orthology confidence</li>
</ol>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="protein-sequence-statistics" class="level3">
<h3 class="anchored" data-anchor-id="protein-sequence-statistics">Protein Sequence Statistics</h3>
<p>The analysis began with comprehensive protein datasets from each species:</p>
<ul>
<li><strong>Acropora pulchra</strong>: 15,664 total proteins from genome annotation</li>
<li><strong>Porites evermanni</strong>: 16,693 total proteins from genome assembly</li>
<li><strong>Pocillopora tuahiniensis</strong>: 16,060 total proteins from genome annotation</li>
</ul>
<p>These datasets represent the complete protein complement for each species, providing a comprehensive foundation for orthology analysis.</p>
</section>
<section id="orthology-classification" class="level3">
<h3 class="anchored" data-anchor-id="orthology-classification">Orthology Classification</h3>
<p>Our analysis identified several categories of orthologous relationships:</p>
<ol type="1">
<li><strong>Three-way orthologs</strong>: 10,346 proteins present in all three species (highest confidence)</li>
<li><strong>Two-way orthologs</strong>: 7,980 proteins shared between specific species pairs</li>
<li><strong>Total ortholog groups</strong>: 18,326 distinct ortholog groups identified</li>
</ol>
</section>
<section id="pairwise-orthology-results" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-orthology-results">Pairwise Orthology Results</h3>
<p>The reciprocal best hits analysis revealed strong orthology relationships between species pairs:</p>
<ul>
<li><strong>Acropora pulchra vs Porites evermanni</strong>: 13,782 orthologous protein pairs</li>
<li><strong>Acropora pulchra vs Pocillopora tuahiniensis</strong>: 13,320 orthologous protein pairs<br>
</li>
<li><strong>Porites evermanni vs Pocillopora tuahiniensis</strong>: 14,303 orthologous protein pairs</li>
</ul>
</section>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<p>The orthology analysis revealed substantial conservation across the three coral species:</p>
<ul>
<li><strong>High conservation</strong>: ~66% of Acropora pulchra proteins have orthologs in both other species</li>
<li><strong>Strong pairwise relationships</strong>: Each species pair shares 80-86% of their protein complement</li>
<li><strong>Core gene set</strong>: 10,346 proteins (three-way orthologs) represent the conserved ancestral gene set</li>
<li><strong>Lineage-specific genes</strong>: ~7,980 proteins show species-specific orthology patterns, indicating potential lineage-specific adaptations</li>
</ul>
</section>
</section>
<section id="technical-implementation" class="level2">
<h2 class="anchored" data-anchor-id="technical-implementation">Technical Implementation</h2>
<section id="computational-resources" class="level3">
<h3 class="anchored" data-anchor-id="computational-resources">Computational Resources</h3>
<p>The analysis utilized:<br>
- <strong>BLAST databases</strong>: Custom-built for each species<br>
- <strong>Parallel processing</strong>: Multi-threaded BLAST searches for efficiency<br>
- <strong>Quality control</strong>: Multiple filtering steps to ensure orthology confidence<br>
</p>
</section>
<section id="data-management" class="level3">
<h3 class="anchored" data-anchor-id="data-management">Data Management</h3>
<p>Results were organized into:<br>
- <strong>Ortholog groups</strong>: Hierarchical classification of orthologous relationships<br>
- <strong>Pairwise comparisons</strong>: Detailed RBH results for each species pair<br>
- <strong>Summary statistics</strong>: Comprehensive overview of orthology patterns</p>
</section>
<section id="output-files" class="level3">
<h3 class="anchored" data-anchor-id="output-files">Output Files</h3>
<p>All analysis results are available in the <a href="https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/11-orthology-analysis">orthology analysis output directory</a>:</p>
<p><strong>Core Results:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/ortholog_groups.csv"><code>ortholog_groups.csv</code></a> - Complete ortholog group assignments (18,326 groups)<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/orthology_summary.csv"><code>orthology_summary.csv</code></a> - Summary statistics and counts</p>
<p><strong>Pairwise Comparisons:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_peve_rbh.csv"><code>apul_peve_rbh.csv</code></a> - Acropora pulchra vs Porites evermanni reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_ptua_rbh.csv"><code>apul_ptua_rbh.csv</code></a> - Acropora pulchra vs Pocillopora tuahiniensis reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/peve_ptua_rbh.csv"><code>peve_ptua_rbh.csv</code></a> - Porites evermanni vs Pocillopora tuahiniensis reciprocal best hits<br>
</p>
<p><strong>Raw BLAST Results:</strong><br>
- BLAST output files for all pairwise comparisons (Apul_vs_Peve.blastp, Peve_vs_Apul.blastp, etc.)<br>
- BLAST databases for each species (Apul_proteins.<em>, Peve_proteins.</em>, Ptua_proteins.*)</p>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>The identification of orthologous proteins across three coral species establishes a critical resource for comparative coral genomics. This analysis reveals both conserved and divergent aspects of coral biology, providing insights into the evolutionary processes that have shaped coral diversity.</p>
<p>The orthology assignments generated here will serve as a reference for future studies investigating coral biology, evolution, and responses to environmental change. By understanding the genetic relationships between these species, we can better predict how different coral lineages may respond to changing environmental conditions.</p>
<hr>
<p><em>This analysis represents a key step in our multi-species comparative genomics pipeline, providing the foundation for cross-species comparisons and evolutionary studies in coral biology.</em></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</guid>
  <pubDate>Sun, 31 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MOSAiC_orthologs__Tumbling_Oysters_2025-08-31_08-16-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Next leveling RNAseq</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</link>
  <description><![CDATA[ 





<p>Started over with merged genome‚Ä¶.</p>
<section id="minimap2" class="level1">
<h1>minimap2</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of threads</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set paths</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref_genome</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/merged_out.fasta.TBtools.fa"</span></span>
<span id="cb1-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1"</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over each FASTQ file</span></span>
<span id="cb1-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${input_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name (e.g., Pum_barcode02 from Pum_barcode02_combined.fastq.gz)</span></span>
<span id="cb1-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-18"></span>
<span id="cb1-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run minimap2 and samtools sort</span></span>
<span id="cb1-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">minimap2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ax</span> splice <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k14</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--MD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ref_genome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-22"></span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb1-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="stringtie" class="level1">
<h1>Stringtie</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_out</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb2-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/04-align-v1/stringtie_out/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/04-align-v1/stringtie_out/mergelist.txt</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../data/GN.gene.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">    ../output/04-align-v1/stringtie_out/mergelist.txt</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_quant</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb4-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_quant/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf</span>
<span id="cb4-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="matrix" class="level1">
<h1>matrix</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/stringtie-2.2.1.Linux_x86_64/prepDE.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2">-i ../output/04-align-v1/stringtie_quant/samplelist.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">-g ../output/04-align-v1/stringtie_quant/gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">-t ../output/04-align-v1/stringtie_quant/transcript_count_matrix.csv</span></code></pre></div>
<section id="normalize-matrix" class="level2">
<h2 class="anchored" data-anchor-id="normalize-matrix">normalize matrix</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DESeq2)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load raw counts</span></span>
<span id="cb6-4">gene_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1/stringtie_quant/gene_count_matrix.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make sample metadata</span></span>
<span id="cb6-7">sample_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb6-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_counts),</span>
<span id="cb6-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example</span></span>
<span id="cb6-10">)</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DESeq2 object and normalization</span></span>
<span id="cb6-13">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeqDataSetFromMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">countData =</span> gene_counts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colData =</span> sample_info, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> condition)</span>
<span id="cb6-14">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeq</span>(dds)</span>
<span id="cb6-15">norm_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">counts</span>(dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalized =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
</section>
<section id="limma-differential-expression" class="level1">
<h1>limma (differential expression)</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(limma)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare expression matrix (genes x samples)</span></span>
<span id="cb7-5">expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(norm_counts)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create design matrix</span></span>
<span id="cb7-8">group <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Pum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pum"</span>,</span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Qui"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui"</span>,</span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Rio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rio"</span></span>
<span id="cb7-12">))</span>
<span id="cb7-13"></span>
<span id="cb7-14">design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> group)</span>
<span id="cb7-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(design) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(group)</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit linear model</span></span>
<span id="cb7-18">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmFit</span>(expr, design)</span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create contrast for all pairwise comparisons</span></span>
<span id="cb7-21">contrast_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeContrasts</span>(</span>
<span id="cb7-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Qui =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Qui,</span>
<span id="cb7-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Rio =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Qui_vs_Rio =</span> Qui <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> design</span>
<span id="cb7-26">)</span>
<span id="cb7-27"></span>
<span id="cb7-28">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contrasts.fit</span>(fit, contrast_matrix)</span>
<span id="cb7-29">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eBayes</span>(fit2)</span>
<span id="cb7-30"></span>
<span id="cb7-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get top DE genes across comparisons</span></span>
<span id="cb7-32">top_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui_vs_Rio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(top_table)</span></code></pre></div>
<section id="get-all-contrast" class="level2">
<h2 class="anchored" data-anchor-id="get-all-contrast">Get all Contrast</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get all contrast names</span></span>
<span id="cb8-2">contrast_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(fit2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrasts)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract all DEGs per contrast</span></span>
<span id="cb8-5">deg_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(contrast_names, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(contrast) {</span>
<span id="cb8-6">  tt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> contrast, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all genes</span></span>
<span id="cb8-7">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(tt)</span>
<span id="cb8-8">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> contrast</span>
<span id="cb8-9">  tt</span>
<span id="cb8-10">})</span>
<span id="cb8-11"></span>
<span id="cb8-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine into one long data frame</span></span>
<span id="cb8-13">all_degs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(deg_list)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(contrast)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-37-58.png" class="img-fluid"></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(UpSetR)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make DEG sets by contrast</span></span>
<span id="cb10-4">deg_sets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(contrast) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(gene_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deframe</span>()</span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">upset</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromList</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsets =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"freq"</span>)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-39-02.png" class="img-fluid"></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 29%">
<col style="width: 18%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">gene_id</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">X1</th>
<th style="text-align: left;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
<th style="text-align: right;">X11</th>
<th style="text-align: right;">X12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6914</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.19435</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28904</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21022</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31461</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.18807</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.2111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21438</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24917</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.10366</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27117</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24906</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.22169</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.22169::Chromosome_6B:76312513-76318400(-)</td>
<td style="text-align: left;">sp|Q8BFQ2|T229B_MOUSE</td>
<td style="text-align: right;">60.9</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5323</td>
<td style="text-align: right;">5787</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">208.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_01.png" class="img-fluid" alt="Page 1"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_02.png" class="img-fluid" alt="Page 2"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_03.png" class="img-fluid" alt="Page 3"></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>oyster</category>
  <category>chile</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</guid>
  <pubDate>Mon, 04 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-31-31.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
