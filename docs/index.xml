<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Tumbling Oysters</title>
<link>https://sr320.github.io/tumbling-oysters/</link>
<atom:link href="https://sr320.github.io/tumbling-oysters/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.6.40</generator>
<lastBuildDate>Thu, 02 Oct 2025 07:00:00 GMT</lastBuildDate>
<item>
  <title>MOSAiC orthologs</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</link>
  <description><![CDATA[ 





<section id="orthologous-protein-identification-across-three-coral-species" class="level1">
<h1>Orthologous Protein Identification Across Three Coral Species</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Understanding the evolutionary relationships between genes across different species is fundamental to comparative genomics. In this analysis, we identified orthologous proteins across three distinct coral species using a reciprocal best hits (RBH) approach. This methodology provides a robust foundation for cross-species comparisons and evolutionary studies.</p>
</section>
<section id="study-species" class="level2">
<h2 class="anchored" data-anchor-id="study-species">Study Species</h2>
<p>Our analysis focused on three coral species representing different growth forms and ecological strategies:</p>
<ul>
<li><strong>Acropora pulchra</strong> (D-Apul): A fast-growing, branching coral species</li>
<li><strong>Porites evermanni</strong> (E-Peve): A slow-growing, massive coral species<br>
</li>
<li><strong>Pocillopora tuahiniensis</strong> (F-Ptua): An intermediate growth, branching coral species</li>
</ul>
<p>These species represent different evolutionary strategies within the coral phylogeny, making them ideal candidates for comparative genomic analysis.</p>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="orthology-identification-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="orthology-identification-pipeline">Orthology Identification Pipeline</h3>
<p>We employed a comprehensive orthology identification pipeline using the following parameters:</p>
<ul>
<li><strong>BLAST algorithm</strong>: All-vs-all protein BLAST comparisons</li>
<li><strong>Orthology criterion</strong>: Reciprocal best hits (RBH)</li>
<li><strong>E-value threshold</strong>: 1e-5 (stringent significance threshold)</li>
<li><strong>Minimum identity</strong>: 30% (allowing for evolutionary divergence)</li>
<li><strong>Minimum coverage</strong>: 50% (ensuring substantial sequence overlap)</li>
</ul>
</section>
<section id="computational-workflow" class="level3">
<h3 class="anchored" data-anchor-id="computational-workflow">Computational Workflow</h3>
<ol type="1">
<li><strong>Database Preparation</strong>: Created BLAST databases for each species’ protein sequences</li>
<li><strong>All-vs-All Comparisons</strong>: Performed bidirectional BLAST searches between all species pairs</li>
<li><strong>Reciprocal Best Hits</strong>: Identified protein pairs that are mutual best matches</li>
<li><strong>Ortholog Grouping</strong>: Organized orthologs into groups based on presence across species</li>
<li><strong>Quality Filtering</strong>: Applied identity and coverage thresholds to ensure orthology confidence</li>
</ol>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="protein-sequence-statistics" class="level3">
<h3 class="anchored" data-anchor-id="protein-sequence-statistics">Protein Sequence Statistics</h3>
<p>The analysis began with comprehensive protein datasets from each species:</p>
<ul>
<li><strong>Acropora pulchra</strong>: 15,664 total proteins from genome annotation</li>
<li><strong>Porites evermanni</strong>: 16,693 total proteins from genome assembly</li>
<li><strong>Pocillopora tuahiniensis</strong>: 16,060 total proteins from genome annotation</li>
</ul>
<p>These datasets represent the complete protein complement for each species, providing a comprehensive foundation for orthology analysis.</p>
</section>
<section id="orthology-classification" class="level3">
<h3 class="anchored" data-anchor-id="orthology-classification">Orthology Classification</h3>
<p>Our analysis identified several categories of orthologous relationships:</p>
<ol type="1">
<li><strong>Three-way orthologs</strong>: 10,346 proteins present in all three species (highest confidence)</li>
<li><strong>Two-way orthologs</strong>: 7,980 proteins shared between specific species pairs</li>
<li><strong>Total ortholog groups</strong>: 18,326 distinct ortholog groups identified</li>
</ol>
</section>
<section id="pairwise-orthology-results" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-orthology-results">Pairwise Orthology Results</h3>
<p>The reciprocal best hits analysis revealed strong orthology relationships between species pairs:</p>
<ul>
<li><strong>Acropora pulchra vs Porites evermanni</strong>: 13,782 orthologous protein pairs</li>
<li><strong>Acropora pulchra vs Pocillopora tuahiniensis</strong>: 13,320 orthologous protein pairs<br>
</li>
<li><strong>Porites evermanni vs Pocillopora tuahiniensis</strong>: 14,303 orthologous protein pairs</li>
</ul>
</section>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<p>The orthology analysis revealed substantial conservation across the three coral species:</p>
<ul>
<li><strong>High conservation</strong>: ~66% of Acropora pulchra proteins have orthologs in both other species</li>
<li><strong>Strong pairwise relationships</strong>: Each species pair shares 80-86% of their protein complement</li>
<li><strong>Core gene set</strong>: 10,346 proteins (three-way orthologs) represent the conserved ancestral gene set</li>
<li><strong>Lineage-specific genes</strong>: ~7,980 proteins show species-specific orthology patterns, indicating potential lineage-specific adaptations</li>
</ul>
</section>
</section>
<section id="technical-implementation" class="level2">
<h2 class="anchored" data-anchor-id="technical-implementation">Technical Implementation</h2>
<section id="computational-resources" class="level3">
<h3 class="anchored" data-anchor-id="computational-resources">Computational Resources</h3>
<p>The analysis utilized:<br>
- <strong>BLAST databases</strong>: Custom-built for each species<br>
- <strong>Parallel processing</strong>: Multi-threaded BLAST searches for efficiency<br>
- <strong>Quality control</strong>: Multiple filtering steps to ensure orthology confidence<br>
</p>
</section>
<section id="data-management" class="level3">
<h3 class="anchored" data-anchor-id="data-management">Data Management</h3>
<p>Results were organized into:<br>
- <strong>Ortholog groups</strong>: Hierarchical classification of orthologous relationships<br>
- <strong>Pairwise comparisons</strong>: Detailed RBH results for each species pair<br>
- <strong>Summary statistics</strong>: Comprehensive overview of orthology patterns</p>
</section>
<section id="output-files" class="level3">
<h3 class="anchored" data-anchor-id="output-files">Output Files</h3>
<p>All analysis results are available in the <a href="https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/11-orthology-analysis">orthology analysis output directory</a>:</p>
<p><strong>Core Results:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/ortholog_groups.csv"><code>ortholog_groups.csv</code></a> - Complete ortholog group assignments (18,326 groups)<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/orthology_summary.csv"><code>orthology_summary.csv</code></a> - Summary statistics and counts</p>
<p><strong>Pairwise Comparisons:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_peve_rbh.csv"><code>apul_peve_rbh.csv</code></a> - Acropora pulchra vs Porites evermanni reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_ptua_rbh.csv"><code>apul_ptua_rbh.csv</code></a> - Acropora pulchra vs Pocillopora tuahiniensis reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/peve_ptua_rbh.csv"><code>peve_ptua_rbh.csv</code></a> - Porites evermanni vs Pocillopora tuahiniensis reciprocal best hits<br>
</p>
<p><strong>Raw BLAST Results:</strong><br>
- BLAST output files for all pairwise comparisons (Apul_vs_Peve.blastp, Peve_vs_Apul.blastp, etc.)<br>
- BLAST databases for each species (Apul_proteins.<em>, Peve_proteins.</em>, Ptua_proteins.*)</p>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>The identification of orthologous proteins across three coral species establishes a critical resource for comparative coral genomics. This analysis reveals both conserved and divergent aspects of coral biology, providing insights into the evolutionary processes that have shaped coral diversity.</p>
<p>The orthology assignments generated here will serve as a reference for future studies investigating coral biology, evolution, and responses to environmental change. By understanding the genetic relationships between these species, we can better predict how different coral lineages may respond to changing environmental conditions.</p>
<hr>
<p><em>This analysis represents a key step in our multi-species comparative genomics pipeline, providing the foundation for cross-species comparisons and evolutionary studies in coral biology.</em></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</guid>
  <pubDate>Thu, 02 Oct 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MOSAiC_orthologs__Tumbling_Oysters_2025-08-31_08-16-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Next leveling RNAseq</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</link>
  <description><![CDATA[ 





<p>Started over with merged genome….</p>
<section id="minimap2" class="level1">
<h1>minimap2</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of threads</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set paths</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref_genome</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/merged_out.fasta.TBtools.fa"</span></span>
<span id="cb1-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1"</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over each FASTQ file</span></span>
<span id="cb1-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${input_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name (e.g., Pum_barcode02 from Pum_barcode02_combined.fastq.gz)</span></span>
<span id="cb1-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-18"></span>
<span id="cb1-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run minimap2 and samtools sort</span></span>
<span id="cb1-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">minimap2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ax</span> splice <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k14</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--MD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ref_genome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-22"></span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb1-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="stringtie" class="level1">
<h1>Stringtie</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_out</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb2-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/04-align-v1/stringtie_out/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/04-align-v1/stringtie_out/mergelist.txt</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../data/GN.gene.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">    ../output/04-align-v1/stringtie_out/mergelist.txt</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_quant</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb4-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_quant/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf</span>
<span id="cb4-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="matrix" class="level1">
<h1>matrix</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/stringtie-2.2.1.Linux_x86_64/prepDE.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2">-i ../output/04-align-v1/stringtie_quant/samplelist.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">-g ../output/04-align-v1/stringtie_quant/gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">-t ../output/04-align-v1/stringtie_quant/transcript_count_matrix.csv</span></code></pre></div>
<section id="normalize-matrix" class="level2">
<h2 class="anchored" data-anchor-id="normalize-matrix">normalize matrix</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DESeq2)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load raw counts</span></span>
<span id="cb6-4">gene_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1/stringtie_quant/gene_count_matrix.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make sample metadata</span></span>
<span id="cb6-7">sample_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb6-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_counts),</span>
<span id="cb6-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example</span></span>
<span id="cb6-10">)</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DESeq2 object and normalization</span></span>
<span id="cb6-13">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeqDataSetFromMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">countData =</span> gene_counts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colData =</span> sample_info, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> condition)</span>
<span id="cb6-14">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeq</span>(dds)</span>
<span id="cb6-15">norm_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">counts</span>(dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalized =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
</section>
<section id="limma-differential-expression" class="level1">
<h1>limma (differential expression)</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(limma)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare expression matrix (genes x samples)</span></span>
<span id="cb7-5">expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(norm_counts)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create design matrix</span></span>
<span id="cb7-8">group <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Pum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pum"</span>,</span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Qui"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui"</span>,</span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Rio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rio"</span></span>
<span id="cb7-12">))</span>
<span id="cb7-13"></span>
<span id="cb7-14">design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> group)</span>
<span id="cb7-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(design) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(group)</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit linear model</span></span>
<span id="cb7-18">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmFit</span>(expr, design)</span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create contrast for all pairwise comparisons</span></span>
<span id="cb7-21">contrast_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeContrasts</span>(</span>
<span id="cb7-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Qui =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Qui,</span>
<span id="cb7-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Rio =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Qui_vs_Rio =</span> Qui <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> design</span>
<span id="cb7-26">)</span>
<span id="cb7-27"></span>
<span id="cb7-28">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contrasts.fit</span>(fit, contrast_matrix)</span>
<span id="cb7-29">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eBayes</span>(fit2)</span>
<span id="cb7-30"></span>
<span id="cb7-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get top DE genes across comparisons</span></span>
<span id="cb7-32">top_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui_vs_Rio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(top_table)</span></code></pre></div>
<section id="get-all-contrast" class="level2">
<h2 class="anchored" data-anchor-id="get-all-contrast">Get all Contrast</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get all contrast names</span></span>
<span id="cb8-2">contrast_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(fit2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrasts)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract all DEGs per contrast</span></span>
<span id="cb8-5">deg_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(contrast_names, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(contrast) {</span>
<span id="cb8-6">  tt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> contrast, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all genes</span></span>
<span id="cb8-7">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(tt)</span>
<span id="cb8-8">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> contrast</span>
<span id="cb8-9">  tt</span>
<span id="cb8-10">})</span>
<span id="cb8-11"></span>
<span id="cb8-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine into one long data frame</span></span>
<span id="cb8-13">all_degs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(deg_list)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(contrast)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-37-58.png" class="img-fluid"></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(UpSetR)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make DEG sets by contrast</span></span>
<span id="cb10-4">deg_sets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(contrast) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(gene_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deframe</span>()</span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">upset</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromList</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsets =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"freq"</span>)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-39-02.png" class="img-fluid"></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 29%">
<col style="width: 18%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">gene_id</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">X1</th>
<th style="text-align: left;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
<th style="text-align: right;">X11</th>
<th style="text-align: right;">X12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6914</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.19435</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28904</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21022</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31461</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.18807</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.2111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21438</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24917</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.10366</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27117</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24906</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.22169</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.22169::Chromosome_6B:76312513-76318400(-)</td>
<td style="text-align: left;">sp|Q8BFQ2|T229B_MOUSE</td>
<td style="text-align: right;">60.9</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5323</td>
<td style="text-align: right;">5787</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">208.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_01.png" class="img-fluid" alt="Page 1"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_02.png" class="img-fluid" alt="Page 2"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_03.png" class="img-fluid" alt="Page 3"></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>oyster</category>
  <category>chile</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</guid>
  <pubDate>Mon, 04 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-31-31.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Getting on with Nanopore cDNA data</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/50-nano-cDNA/</link>
  <description><![CDATA[ 





<p>Went in a few directions but will try to layout properly here. Experiment - 3 populations, 4 pooled (n=5) libraires - thus 20 individuals represented per population.</p>
<section id="data-as-provided" class="level1">
<h1>Data as provided</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Screen_Capture_on_2025-08-01_at_17-36-23.gif" class="img-fluid"></p>
</section>
<section id="combining" class="level1">
<h1>Combining</h1>
<p>Here is an example from one species</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode01 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode01_combined.fastq.gz</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode01_1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode01_1_combined.fastq.gz</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode02_1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode02_1_combined.fastq.gz</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode12_combined.fastq.gz</span></code></pre></div>
</section>
<section id="align" class="level1">
<h1>Align</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of threads</span></span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set paths</span></span>
<span id="cb2-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref_genome</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Och_HapA_assembly.fa"</span></span>
<span id="cb2-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb2-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over each FASTQ file</span></span>
<span id="cb2-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${input_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name (e.g., Pum_barcode02 from Pum_barcode02_combined.fastq.gz)</span></span>
<span id="cb2-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-16"></span>
<span id="cb2-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb2-18"></span>
<span id="cb2-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run minimap2 and samtools sort</span></span>
<span id="cb2-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">minimap2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ax</span> splice <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k14</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--MD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ref_genome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb2-22"></span>
<span id="cb2-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb2-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb2-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="stringtie" class="level1">
<h1>Stringtie</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/02-RNAseq/stringtie_out</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/02-RNAseq/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_out/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb3-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/02-RNAseq/stringtie_out/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/stringtie_out/mergelist.txt</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../data/GN.gene.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">    ../output/02-RNAseq/stringtie_out/mergelist.txt</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/02-RNAseq/stringtie_quant</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/02-RNAseq/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../output/02-RNAseq/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_quant/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf</span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/stringtie-2.2.1.Linux_x86_64/prepDE.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">-i ../output/02-RNAseq/stringtie_quant/samplelist.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-g ../output/02-RNAseq/stringtie_quant/gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-t ../output/02-RNAseq/stringtie_quant/transcript_count_matrix.csv</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-01_17-48-48.png" class="img-fluid"></p>
</section>
<section id="next" class="level1">
<h1>Next?</h1>
<p>Normalize, QC?, Annotate (many are novel genes)</p>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>chile</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/50-nano-cDNA/</guid>
  <pubDate>Fri, 01 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-01_17-33-00.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Oyster Pickup and Cleaning</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/49-ptwhit/</link>
  <description><![CDATA[ 





<section id="dock" class="level1">
<h1>Dock</h1>
<p>Inspected bags at dock. Retrieved one PolyIC and Control bag. This left two of each on dock. For all others replaced bags.</p>
<p>Right Line</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-20-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-23-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-23-45.png" class="img-fluid"></p>
<p>Left Line</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-21-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-21-57.png" class="img-fluid"></p>
<p>PolyIC Bags</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-22-34.png" class="img-fluid"></p>
</section>
<section id="heath-trays" class="level1">
<h1>Heath Trays</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-27-55.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-28-16.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-28-46.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-09.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-32.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-56.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-15.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-36.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-58.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-13.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-40.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-57.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
</section>
<section id="section" class="level1">
<h1></h1>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>aquaculture</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/49-ptwhit/</guid>
  <pubDate>Wed, 23 Jul 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-18-25.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Cod alignment</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/48-cod-bwa/</link>
  <description><![CDATA[ 





<section id="genome" class="level1">
<h1>Genome</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> https://owl.fish.washington.edu/halfshell/genomic-databank/GCF_031168955.1_ASM3116895v1_genomic.fna</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bwa</span> index ../data/GCF_031168955.1_ASM3116895v1_genomic.fna</span></code></pre></div>
</div>
</section>
<section id="reads---getting-on-raven" class="level1">
<h1>Reads - getting on raven</h1>
<p>ecotype</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../data/fastq-ecotype</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data/fastq-ecotype</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-np</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.gz"</span> https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1149634506/00_fastq/</span></code></pre></div>
</div>
</section>
<section id="align" class="level1">
<h1>Align</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Path to reference genome (must be indexed with bwa index)</span></span>
<span id="cb4-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REFERENCE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/GCF_031168955.1_ASM3116895v1_genomic.fna"</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of threads per BWA job</span></span>
<span id="cb4-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb4-6"></span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing fastq files</span></span>
<span id="cb4-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FASTQ_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/fastq-ecotype"</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory (you can change this)</span></span>
<span id="cb4-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span></span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File suffixes</span></span>
<span id="cb4-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1_001.fastq.gz"</span></span>
<span id="cb4-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_001.fastq.gz"</span></span>
<span id="cb4-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sam"</span></span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------</span></span>
<span id="cb4-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RUN BWA IN PARALLEL</span></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------</span></span>
<span id="cb4-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run loop</span></span>
<span id="cb4-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sample <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">//"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-24">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-25">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${R2_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${OUT_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-27"></span>
<span id="cb4-28">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running BWA on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb4-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bwa</span> mem <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${REFERENCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
<section id="convert-sam-to-bam" class="level1">
<h1>Convert SAM to BAM</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing .sam files</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SAM_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory (can be same as SAM_DIR or different)</span></span>
<span id="cb5-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change this if you want bams elsewhere</span></span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of threads for sorting</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb5-11"></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through all .sam files</span></span>
<span id="cb5-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAM_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get base name (e.g., sample1)</span></span>
<span id="cb5-16">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sam}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-17"></span>
<span id="cb5-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define output file</span></span>
<span id="cb5-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb5-20"></span>
<span id="cb5-21">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Converting </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb5-22"></span>
<span id="cb5-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert and sort</span></span>
<span id="cb5-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$THREADS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$THREADS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-25"></span>
<span id="cb5-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb5-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>cod</category>
  <category>wgs</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/48-cod-bwa/</guid>
  <pubDate>Tue, 08 Jul 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-cod-temperature__RStudio_Server_2025-07-09_08-43-39.png" medium="image" type="image/png"/>
</item>
<item>
  <title>The lncRNA repertoire of Ptuh</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/47-ffs/</link>
  <description><![CDATA[ 





<section id="tldr" class="level1">
<h1>TLDR</h1>
<p>fasta - https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/Ptuh-lncRNA.fasta</p>
<p>gtf - https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/Ptuh-lncRNA.gtf</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># URLs</span></span>
<span id="cb1-2">bed_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.bed"</span></span>
<span id="cb1-3">gtf_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span></span>
<span id="cb1-4">fasta_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.fasta"</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### BED file</span></span>
<span id="cb1-7">bed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(bed_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chrom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>))</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BED file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BED file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(bed))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  chrom                                   start    end
  &lt;chr&gt;                                   &lt;dbl&gt;  &lt;dbl&gt;
1 Pocillopora_meandrina_HIv1___Sc0000000 130006 130942
2 Pocillopora_meandrina_HIv1___Sc0000000 164394 165221
3 Pocillopora_meandrina_HIv1___Sc0000000 164596 165221
4 Pocillopora_meandrina_HIv1___Sc0000000 168916 182502
5 Pocillopora_meandrina_HIv1___Sc0000000 245808 248612
6 Pocillopora_meandrina_HIv1___Sc0000000 282742 283165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for BED</span></span>
<span id="cb5-2">bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BED file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
BED file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of features:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(bed), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of features: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean length: 3125.615 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median length: 702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### GTF file</span></span>
<span id="cb13-2">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(gtf_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GTF file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
GTF file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(gtf))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GRanges object with 6 ranges and 5 metadata columns:
                    seqnames        ranges strand |   source     type     score
                       &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt;
  [1] Pocillopora_meandrin.. 130006-130942      + |       NA   lncRNA        NA
  [2] Pocillopora_meandrin.. 164394-165221      + |       NA   lncRNA        NA
  [3] Pocillopora_meandrin.. 164596-165221      + |       NA   lncRNA        NA
  [4] Pocillopora_meandrin.. 168916-182502      + |       NA   lncRNA        NA
  [5] Pocillopora_meandrin.. 245808-248612      + |       NA   lncRNA        NA
  [6] Pocillopora_meandrin.. 282742-283165      + |       NA   lncRNA        NA
          phase     gene_id
      &lt;integer&gt; &lt;character&gt;
  [1]      &lt;NA&gt;  lncRNA_001
  [2]      &lt;NA&gt;  lncRNA_002
  [3]      &lt;NA&gt;  lncRNA_003
  [4]      &lt;NA&gt;  lncRNA_004
  [5]      &lt;NA&gt;  lncRNA_005
  [6]      &lt;NA&gt;  lncRNA_006
  -------
  seqinfo: 175 sequences from an unspecified genome; no seqlengths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for GTF</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GTF file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
GTF file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of entries:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(gtf), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of entries: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unique feature types:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(gtf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique feature types: lncRNA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### FASTA file</span></span>
<span id="cb23-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(fasta_url)</span>
<span id="cb23-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">FASTA file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FASTA file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:130007-130942"
[2] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:164395-165221"
[3] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:164597-165221"
[4] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:168917-182502"
[5] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:245809-248612"
[6] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:282743-283165"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(fasta[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6-letter DNAString object
seq: GCCTTG</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for FASTA</span></span>
<span id="cb29-2">seq_lengths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">width</span>(fasta)</span>
<span id="cb29-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">FASTA file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FASTA file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of sequences:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(fasta), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of sequences: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean sequence length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(seq_lengths), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean sequence length: 3123.615 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median sequence length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(seq_lengths), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median sequence length: 700 </code></pre>
</div>
</div>
</section>
<section id="renaming-fasta" class="level1">
<h1>Renaming fasta</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File paths</span></span>
<span id="cb37-2">fasta_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.fasta"</span></span>
<span id="cb37-3">gtf_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span></span>
<span id="cb37-4"></span>
<span id="cb37-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in FASTA and GTF</span></span>
<span id="cb37-6">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(fasta_url)</span>
<span id="cb37-7">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(gtf_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb37-8"></span>
<span id="cb37-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract gene_id from GTF</span></span>
<span id="cb37-10">gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(gtf)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, x))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove quotes</span></span>
<span id="cb37-11">unique_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(gene_ids)</span>
<span id="cb37-12"></span>
<span id="cb37-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate new FASTA headers</span></span>
<span id="cb37-14">new_headers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ptuh_"</span>, unique_gene_ids)</span>
<span id="cb37-15"></span>
<span id="cb37-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Confirm lengths match</span></span>
<span id="cb37-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(fasta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(new_headers)) {</span>
<span id="cb37-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mismatch between number of FASTA sequences and GTF gene IDs."</span>)</span>
<span id="cb37-19">}</span>
<span id="cb37-20"></span>
<span id="cb37-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename sequences</span></span>
<span id="cb37-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> new_headers</span>
<span id="cb37-23"></span>
<span id="cb37-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write new FASTA</span></span>
<span id="cb37-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeXStringSet</span>(fasta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filepath =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta"</span>)</span>
<span id="cb37-26"></span>
<span id="cb37-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FASTA headers renamed and saved to lncRNA_renamed.fasta</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> lncRNA_renamed.fasta <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> </span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read renamed FASTA and original GTF</span></span>
<span id="cb39-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>)</span>
<span id="cb39-3">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb39-4"></span>
<span id="cb39-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract gene IDs from GTF</span></span>
<span id="cb39-6">gtf_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(gtf)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove quotes</span></span>
<span id="cb39-7"></span>
<span id="cb39-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract IDs from FASTA headers</span></span>
<span id="cb39-9">fasta_headers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)</span>
<span id="cb39-10">fasta_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Ptuh_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fasta_headers)</span>
<span id="cb39-11"></span>
<span id="cb39-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare</span></span>
<span id="cb39-13">all_match <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(fasta_gene_ids <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> gtf_gene_ids) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(gtf_gene_ids <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> fasta_gene_ids)</span>
<span id="cb39-14"></span>
<span id="cb39-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (all_match) {</span>
<span id="cb39-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"✅ FASTA headers match gene_ids in GTF exactly.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-17">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb39-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"❌ Mismatch found between FASTA headers and GTF gene_ids.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-19"></span>
<span id="cb39-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional: show what's missing</span></span>
<span id="cb39-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">In FASTA but not GTF:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(fasta_gene_ids, gtf_gene_ids))</span>
<span id="cb39-23"></span>
<span id="cb39-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">In GTF but not FASTA:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(gtf_gene_ids, fasta_gene_ids))</span>
<span id="cb39-26">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>✅ FASTA headers match gene_ids in GTF exactly.</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read files</span></span>
<span id="cb41-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>)</span>
<span id="cb41-3">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb41-4"></span>
<span id="cb41-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean gene_id and extract relevant fields</span></span>
<span id="cb41-6">gtf_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(gtf)</span>
<span id="cb41-7">gtf_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, gtf_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id)</span>
<span id="cb41-8">gtf_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gtf_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(seqnames, start, end, gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-10">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-11">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gtf_length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span>)</span>
<span id="cb41-12"></span>
<span id="cb41-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract FASTA lengths</span></span>
<span id="cb41-14">fasta_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb41-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Ptuh_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)),</span>
<span id="cb41-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta_length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">width</span>(fasta),</span>
<span id="cb41-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta_header =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)</span>
<span id="cb41-18">)</span>
<span id="cb41-19"></span>
<span id="cb41-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join and compare</span></span>
<span id="cb41-21">merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(gtf_summary, fasta_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb41-22"></span>
<span id="cb41-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check consistency</span></span>
<span id="cb41-24">merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_match <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gtf_length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fasta_length</span>
<span id="cb41-25"></span>
<span id="cb41-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display a few examples</span></span>
<span id="cb41-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"🔍 Sample GTF vs FASTA length comparison:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>🔍 Sample GTF vs FASTA length comparison:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(merged[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta_header"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf_length"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta_length"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_match"</span>)]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  fasta_header    gtf_length fasta_length length_match
  &lt;chr&gt;                &lt;dbl&gt;        &lt;int&gt; &lt;lgl&gt;       
1 Ptuh_lncRNA_001        937          935 FALSE       
2 Ptuh_lncRNA_002        828          826 FALSE       
3 Ptuh_lncRNA_003        626          624 FALSE       
4 Ptuh_lncRNA_004      13587        13585 FALSE       
5 Ptuh_lncRNA_005       2805         2803 FALSE       
6 Ptuh_lncRNA_006        424          422 FALSE       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall match rate</span></span>
<span id="cb45-2">match_rate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_match)</span>
<span id="cb45-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">✅ Percent of exact matches: %.1f%%</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> match_rate))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
✅ Percent of exact matches: 0.0%</code></pre>
</div>
</div>
<hr>
</section>
<section id="code" class="level1">
<h1>Code</h1>
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb47-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">knitr::opts_chunk</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$set</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> = TRUE<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-3"></span>
<span id="cb47-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb47-5"> </span>
<span id="cb47-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/17-Ptuh-lncRNA"</span></span>
<span id="cb47-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/17-Ptuh-lncRNA"</span></span>
<span id="cb47-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">THREADS</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24"</span></span>
<span id="cb47-9">  </span>
<span id="cb47-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20230519-E5_coral-fastqc-fastp-multiqc-RNAseq/P_meandrina/trimmed/"</span></span>
<span id="cb47-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq.gz"</span></span>
<span id="cb47-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://owl.fish.washington.edu/halfshell/genomic-databank/Pocillopora_meandrina_HIv1.assembly.fasta"</span></span>
<span id="cb47-13"></span>
<span id="cb47-14"></span>
<span id="cb47-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GTF_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/d5f546705e3df40558eeaa5c18b122c79d2f4453/F-Ptua/data/Pocillopora_meandrina_HIv1.genes-validated.gtf"</span></span>
<span id="cb47-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFF_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/deep-dive-expression/F-Ptuh/data/Pocillopora_meandrina_HIv1.genes-validated.gff3"</span></span>
<span id="cb47-17"></span>
<span id="cb47-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFPATTERN</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"|class_code "x"|class_code "o"|class_code "i"'</span></span>
<span id="cb47-19"></span>
<span id="cb47-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#RAVEN</span></span>
<span id="cb47-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HISAT2_DIR &lt;- "/home/shared/hisat2-2.2.1/"</span></span>
<span id="cb47-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SAMTOOLS_DIR &lt;- "/home/shared/samtools-1.12/"</span></span>
<span id="cb47-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># STRINGTIE_DIR &lt;- "/home/shared/stringtie-2.2.1.Linux_x86_64"</span></span>
<span id="cb47-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GFFCOMPARE_DIR &lt;- "/home/shared/gffcompare-0.12.6.Linux_x86_64"</span></span>
<span id="cb47-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BEDTOOLS_DIR &lt;- "/home/shared/bedtools2/bin"</span></span>
<span id="cb47-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPC2_DIR &lt;- "/home/shared/CPC2_standalone-1.0.1"</span></span>
<span id="cb47-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CONDA_PATH &lt;- "/opt/anaconda/anaconda3/bin/conda"</span></span>
<span id="cb47-28"></span>
<span id="cb47-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#KLONE</span></span>
<span id="cb47-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HISAT2_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">STRINGTIE_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs/gffcompare-0.12.6.Linux_x86_64/"</span></span>
<span id="cb47-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CPC2_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs/CPC2_standalone-1.0.1/bin/"</span></span>
<span id="cb47-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CONDA_PATH</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/mmfs1/gscratch/srlab/nextflow/bin/miniforge/bin/conda"</span></span>
<span id="cb47-37"></span>
<span id="cb47-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_FASTA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.fasta"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GTF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gtf"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GFF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gff"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_INDEX</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.index"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-43"></span>
<span id="cb47-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb47-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Sys.setenv</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb47-46">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">THREADS</span> = THREADS,</span>
<span id="cb47-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR</span> = DATA_DIR,</span>
<span id="cb47-48">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SOURCE</span> = FASTQ_SOURCE,</span>
<span id="cb47-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX</span> = FASTQ_SUFFIX,</span>
<span id="cb47-50">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span> = OUTPUT_DIR,</span>
<span id="cb47-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_SOURCE</span> = GENOME_SOURCE,</span>
<span id="cb47-52">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GTF_SOURCE</span> = GTF_SOURCE,</span>
<span id="cb47-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFF_SOURCE</span> = GFF_SOURCE,</span>
<span id="cb47-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HISAT2_DIR</span> = HISAT2_DIR,</span>
<span id="cb47-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR</span> = SAMTOOLS_DIR,</span>
<span id="cb47-56">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">STRINGTIE_DIR</span> = STRINGTIE_DIR,</span>
<span id="cb47-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR</span> = GFFCOMPARE_DIR,</span>
<span id="cb47-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR</span> = BEDTOOLS_DIR,</span>
<span id="cb47-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CPC2_DIR</span> = CPC2_DIR,</span>
<span id="cb47-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CONDA_PATH</span> = CONDA_PATH,</span>
<span id="cb47-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_FASTA</span> = GENOME_FASTA,</span>
<span id="cb47-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GTF</span> = GENOME_GTF,</span>
<span id="cb47-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GFF</span> = GENOME_GFF,</span>
<span id="cb47-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_DIR</span> = FASTQ_DIR,</span>
<span id="cb47-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_INDEX</span> = GENOME_INDEX,</span>
<span id="cb47-66">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFPATTERN</span> = GFFPATTERN</span>
<span id="cb47-67"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DATA_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb48-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-3">-P <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SOURCE}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span></span></code></pre></div>
</div>
<pre><code>RNA-POC-47-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-47-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-48-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-48-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-50-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-50-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-53-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-53-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-57-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-57-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb52-1"></span>
<span id="cb52-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb53-1"></span>
<span id="cb53-2"></span>
<span id="cb53-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GTF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"></span>
<span id="cb54-2"></span>
<span id="cb54-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gtf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-4"></span>
<span id="cb55-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb55-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FAIL - FFS you downloaded a HTML not and genome feature file!"</span></span>
<span id="cb55-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb55-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</div>
</section>
<section id="hisat" class="level1">
<h1>HISAT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_exons.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span></span>
<span id="cb56-2"></span>
<span id="cb56-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_splice_sites.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb57-1"></span>
<span id="cb57-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2-build"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--exon</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ss</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-8">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-build_stats.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over every file ending in .fastq.gz that contains "_R2_"</span></span>
<span id="cb58-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb58-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the basename (filename without path)</span></span>
<span id="cb58-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-5">    </span>
<span id="cb58-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Derive a sample name by taking everything before "_R2_"</span></span>
<span id="cb58-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-8">    </span>
<span id="cb58-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding R1 filename by replacing "_R2_" with "_R1_"</span></span>
<span id="cb58-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${r2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_R2_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>_R1_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-11">    </span>
<span id="cb58-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the output SAM file name using the sample name</span></span>
<span id="cb58-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sam"</span></span>
<span id="cb58-14">    </span>
<span id="cb58-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run hisat2 with the paired-end files</span></span>
<span id="cb58-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<section id="convert-sam-to-bam" class="level2">
<h2 class="anchored" data-anchor-id="convert-sam-to-bam">convert SAM to BAM</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> samfile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb59-2">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.bam"</span></span>
<span id="cb59-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb59-4">  </span>
<span id="cb59-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert SAM to BAM</span></span>
<span id="cb59-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$samfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-7">  </span>
<span id="cb59-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort BAM</span></span>
<span id="cb59-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-10">  </span>
<span id="cb59-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index sorted BAM</span></span>
<span id="cb59-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> index <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
</section>
<section id="stringtie" class="level1">
<h1>StringTie</h1>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples–an important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-4">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-5">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-6">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.sorted.bam"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb63-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-3">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/stringtie_merged.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb65-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/stringtie_merged.gtf</span></code></pre></div>
</div>
<p>#GFFCOMPARE</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb66-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFCOMPARE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gffcompare"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-3">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-4</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb68-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb69-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb69-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb70-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged.annotated.gtf"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb70-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb70-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb71-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb73-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> ../output/17-Ptuh-lncRNA/lncRNA_candidates.gtf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span></span></code></pre></div>
</div>
</section>
<section id="bedtools" class="level1">
<h1>Bedtools</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb74-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BEDTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> getfasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-2">-fi <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-3">-bed <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-4">-fo <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb75-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.fasta</span></code></pre></div>
</div>
<p>#CPC2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb76-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/gao-lab/CPC2_standalone/archive/refs/tags/v1.0.1.zip</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb77-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> v1.0.1.zip</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb78-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/mmfs1/gscratch/srlab/nextflow/bin/miniforge/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb78-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate /mmfs1/gscratch/srlab/nextflow/bin/miniforge/envs/nextflow  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># replace with your actual env name</span></span>
<span id="cb78-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /mmfs1/gscratch/scrubbed/sr320/github/deep-dive-expression/F-Ptuh/code/CPC2_standalone-1.0.1/bin/CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb78-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb78-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2"</span></span></code></pre></div>
</div>
<p>Filter</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb79-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span></span>
<span id="cb80-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb81-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb81-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<p>Subsetting fasta</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb82-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> faidx <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb82-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb82-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb83-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span>
<span id="cb83-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb84-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define input and output file paths using the OUTPUT_DIR variable</span></span>
<span id="cb84-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb84-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span>
<span id="cb84-4"></span>
<span id="cb84-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line of the input file</span></span>
<span id="cb84-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb84-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "transcript::" from the line</span></span>
<span id="cb84-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">transcript::</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-9">    </span>
<span id="cb84-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the line by ':' to get the chromosome and position string</span></span>
<span id="cb84-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chromosome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pos</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$line</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-12">    </span>
<span id="cb84-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position string by '-' to separate start and end positions</span></span>
<span id="cb84-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">end</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pos</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-15">    </span>
<span id="cb84-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb84-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((start</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb84-18">    </span>
<span id="cb84-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, updated start, and end positions to the output file (tab-separated)</span></span>
<span id="cb84-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\t%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$chromosome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$start</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$end</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$input</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb85-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb86-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb86-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb87-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb87-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb88-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb88-2"></span>
<span id="cb88-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb88-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN {</span></span>
<span id="cb88-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries = 0;</span></span>
<span id="cb88-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    min_length = 1e9;</span></span>
<span id="cb88-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    max_length = 0;</span></span>
<span id="cb88-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length = 0;</span></span>
<span id="cb88-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"># Skip comment lines</span></span>
<span id="cb88-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/^#/ { next }</span></span>
<span id="cb88-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb88-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (NF &lt; 9) next;</span></span>
<span id="cb88-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries++;</span></span>
<span id="cb88-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    start = $4;</span></span>
<span id="cb88-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    end = $5;</span></span>
<span id="cb88-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    gene_length = end - start + 1;</span></span>
<span id="cb88-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &lt; min_length) min_length = gene_length;</span></span>
<span id="cb88-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &gt; max_length) max_length = gene_length;</span></span>
<span id="cb88-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length += gene_length;</span></span>
<span id="cb88-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    feature[$3]++;</span></span>
<span id="cb88-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    chrom[$1]++;</span></span>
<span id="cb88-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    # Use two-argument match() and then extract the gene_id manually.</span></span>
<span id="cb88-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (match($9, /gene_id "[^"]+"/)) {</span></span>
<span id="cb88-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gene_str = substr($9, RSTART, RLENGTH);</span></span>
<span id="cb88-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Remove the "gene_id " prefix and the quotes.</span></span>
<span id="cb88-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/gene_id "/, "", gene_str);</span></span>
<span id="cb88-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/"/, "", gene_str);</span></span>
<span id="cb88-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        genes[gene_str] = 1;</span></span>
<span id="cb88-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">END {</span></span>
<span id="cb88-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    avg_length = (total_entries &gt; 0) ? sum_length / total_entries : 0;</span></span>
<span id="cb88-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    unique_gene_count = 0;</span></span>
<span id="cb88-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (g in genes)</span></span>
<span id="cb88-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        unique_gene_count++;</span></span>
<span id="cb88-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Basic GTF File Statistics:";</span></span>
<span id="cb88-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "--------------------------";</span></span>
<span id="cb88-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Total entries:      " total_entries;</span></span>
<span id="cb88-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Unique genes:       " unique_gene_count;</span></span>
<span id="cb88-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Min gene length:    " min_length;</span></span>
<span id="cb88-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Max gene length:    " max_length;</span></span>
<span id="cb88-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    printf("Average gene length: %.2f\n", avg_length);</span></span>
<span id="cb88-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nFeature counts:";</span></span>
<span id="cb88-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (f in feature) {</span></span>
<span id="cb88-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " f ": " feature[f];</span></span>
<span id="cb88-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nChromosome counts:";</span></span>
<span id="cb88-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (c in chrom) {</span></span>
<span id="cb88-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " c ": " chrom[c];</span></span>
<span id="cb88-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$tf_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<pre><code>Basic GTF File Statistics:
--------------------------
Total entries:      16153
Unique genes:       0
Min gene length:    203
Max gene length:    227016
Average gene length: 3125.62

Feature counts:
  lncRNA: 16153

Chromosome counts:
  Pocillopora_meandrina_HIv1___xfSc0000447: 7
  Pocillopora_meandrina_HIv1___xfSc0000094: 2
  Pocillopora_meandrina_HIv1___Sc0000041: 71
  Pocillopora_meandrina_HIv1___xfSc0000343: 7
  Pocillopora_meandrina_HIv1___xfSc0000004: 3
  Pocillopora_meandrina_HIv1___Sc0000011: 362
  Pocillopora_meandrina_HIv1___xfSc0000812: 1
  Pocillopora_meandrina_HIv1___xfSc0000081: 2
  Pocillopora_meandrina_HIv1___Sc0000032: 132
  Pocillopora_meandrina_HIv1___xpSc0001344: 1
  Pocillopora_meandrina_HIv1___xpSc0001331: 1
  Pocillopora_meandrina_HIv1___xfSc0001179: 1
  Pocillopora_meandrina_HIv1___xfSc0000284: 2
  Pocillopora_meandrina_HIv1___xfSc0000692: 3
  Pocillopora_meandrina_HIv1___xfSc0000029: 2
  Pocillopora_meandrina_HIv1___Sc0000052: 3
  Pocillopora_meandrina_HIv1___xfSc0000145: 2
  Pocillopora_meandrina_HIv1___Sc0000046: 28
  Pocillopora_meandrina_HIv1___xfSc0000948: 1
  Pocillopora_meandrina_HIv1___Sc0000025: 274
  Pocillopora_meandrina_HIv1___xfSc0000477: 2
  Pocillopora_meandrina_HIv1___Sc0000066: 1
  Pocillopora_meandrina_HIv1___Sc0000039: 96
  Pocillopora_meandrina_HIv1___xpSc0001280: 5
  Pocillopora_meandrina_HIv1___xfSc0001170: 1
  Pocillopora_meandrina_HIv1___xfSc0000212: 7
  Pocillopora_meandrina_HIv1___xfSc0000007: 36
  Pocillopora_meandrina_HIv1___Sc0000012: 457
  Pocillopora_meandrina_HIv1___xfSc0000974: 1
  Pocillopora_meandrina_HIv1___xfSc0000817: 1
  Pocillopora_meandrina_HIv1___xfSc0000570: 1
  Pocillopora_meandrina_HIv1___xfSc0000479: 2
  Pocillopora_meandrina_HIv1___xfSc0000237: 2
  Pocillopora_meandrina_HIv1___Sc0000068: 2
  Pocillopora_meandrina_HIv1___Sc0000037: 101
  Pocillopora_meandrina_HIv1___Sc0000003: 803
  Pocillopora_meandrina_HIv1___xfSc0000428: 4
  Pocillopora_meandrina_HIv1___xfSc0000059: 6
  Pocillopora_meandrina_HIv1___Sc0000057: 5
  Pocillopora_meandrina_HIv1___xfSc0000146: 5
  Pocillopora_meandrina_HIv1___Sc0000045: 52
  Pocillopora_meandrina_HIv1___Sc0000009: 729
  Pocillopora_meandrina_HIv1___xfSc0000952: 1
  Pocillopora_meandrina_HIv1___xfSc0000835: 2
  Pocillopora_meandrina_HIv1___xfSc0000000: 71
  Pocillopora_meandrina_HIv1___Sc0000015: 328
  Pocillopora_meandrina_HIv1___xfSc0000716: 1
  Pocillopora_meandrina_HIv1___Sc0000080: 2
  Pocillopora_meandrina_HIv1___xfSc0000616: 1
  Pocillopora_meandrina_HIv1___Sc0000034: 118
  Pocillopora_meandrina_HIv1___xpSc0001290: 1
  Pocillopora_meandrina_HIv1___xfSc0000527: 2
  Pocillopora_meandrina_HIv1___xfSc0000206: 6
  Pocillopora_meandrina_HIv1___Sc0000006: 561
  Pocillopora_meandrina_HIv1___xpSc0001273: 29
  Pocillopora_meandrina_HIv1___xfSc0000540: 4
  Pocillopora_meandrina_HIv1___Sc0000058: 5
  Pocillopora_meandrina_HIv1___Sc0000021: 290
  Pocillopora_meandrina_HIv1___xfSc0000859: 2
  Pocillopora_meandrina_HIv1___Sc0000040: 123
  Pocillopora_meandrina_HIv1___xfSc0000890: 1
  Pocillopora_meandrina_HIv1___xfSc0000836: 1
  Pocillopora_meandrina_HIv1___xfSc0000555: 2
  Pocillopora_meandrina_HIv1___xfSc0000003: 15
  Pocillopora_meandrina_HIv1___Sc0000016: 448
  Pocillopora_meandrina_HIv1___xfSc0000765: 5
  Pocillopora_meandrina_HIv1___Sc0000033: 112
  Pocillopora_meandrina_HIv1___Sc0000018: 348
  Pocillopora_meandrina_HIv1___xfSc0000415: 2
  Pocillopora_meandrina_HIv1___Sc0000053: 14
  Pocillopora_meandrina_HIv1___xfSc0000436: 4
  Pocillopora_meandrina_HIv1___xfSc0000205: 13
  Pocillopora_meandrina_HIv1___Sc0000070: 2
  Pocillopora_meandrina_HIv1___Sc0000049: 4
  Pocillopora_meandrina_HIv1___Sc0000005: 551
  Pocillopora_meandrina_HIv1___xpSc0001276: 1
  Pocillopora_meandrina_HIv1___Sc0000024: 245
  Pocillopora_meandrina_HIv1___Sc0000065: 2
  Pocillopora_meandrina_HIv1___xpSc0001281: 4
  Pocillopora_meandrina_HIv1___xfSc0000006: 13
  Pocillopora_meandrina_HIv1___Sc0000013: 555
  Pocillopora_meandrina_HIv1___xfSc0001237: 2
  Pocillopora_meandrina_HIv1___xfSc0000612: 2
  Pocillopora_meandrina_HIv1___xfSc0000168: 3
  Pocillopora_meandrina_HIv1___xfSc0000083: 2
  Pocillopora_meandrina_HIv1___Sc0000030: 198
  Pocillopora_meandrina_HIv1___Sc0000002: 725
  Pocillopora_meandrina_HIv1___xfSc0000175: 3
  Pocillopora_meandrina_HIv1___Sc0000054: 1
  Pocillopora_meandrina_HIv1___xfSc0000565: 2
  Pocillopora_meandrina_HIv1___Sc0000044: 51
  Pocillopora_meandrina_HIv1___Sc0000008: 538
  Pocillopora_meandrina_HIv1___Sc0000027: 291
  Pocillopora_meandrina_HIv1___xfSc0000840: 1
  Pocillopora_meandrina_HIv1___xfSc0000596: 2
  Pocillopora_meandrina_HIv1___Sc0000060: 1
  Pocillopora_meandrina_HIv1___xfSc0000763: 1
  Pocillopora_meandrina_HIv1___Sc0000035: 227
  Pocillopora_meandrina_HIv1___xfSc0000968: 2
  Pocillopora_meandrina_HIv1___Sc0000001: 883
  Pocillopora_meandrina_HIv1___xpSc0001355: 1
  Pocillopora_meandrina_HIv1___xfSc0000699: 2
  Pocillopora_meandrina_HIv1___xfSc0000655: 4
  Pocillopora_meandrina_HIv1___xfSc0000426: 7
  Pocillopora_meandrina_HIv1___Sc0000020: 294
  Pocillopora_meandrina_HIv1___xfSc0000621: 2
  Pocillopora_meandrina_HIv1___xfSc0000445: 2
  Pocillopora_meandrina_HIv1___xfSc0000074: 1
  Pocillopora_meandrina_HIv1___Sc0000043: 60
  Pocillopora_meandrina_HIv1___xfSc0000837: 1
  Pocillopora_meandrina_HIv1___xfSc0000288: 5
  Pocillopora_meandrina_HIv1___xfSc0000217: 5
  Pocillopora_meandrina_HIv1___xfSc0000002: 34
  Pocillopora_meandrina_HIv1___Sc0000017: 382
  Pocillopora_meandrina_HIv1___Sc0000019: 291
  Pocillopora_meandrina_HIv1___xfSc0000012: 7
  Pocillopora_meandrina_HIv1___Sc0000029: 178
  Pocillopora_meandrina_HIv1___xfSc0000886: 3
  Pocillopora_meandrina_HIv1___xfSc0000868: 3
  Pocillopora_meandrina_HIv1___xfSc0000824: 8
  Pocillopora_meandrina_HIv1___xfSc0000583: 1
  Pocillopora_meandrina_HIv1___Sc0000071: 2
  Pocillopora_meandrina_HIv1___Sc0000004: 652
  Pocillopora_meandrina_HIv1___xfSc0000704: 4
  Pocillopora_meandrina_HIv1___xfSc0000469: 3
  Pocillopora_meandrina_HIv1___xfSc0000223: 2
  Pocillopora_meandrina_HIv1___xfSc0000195: 1
  Pocillopora_meandrina_HIv1___xfSc0000021: 2
  Pocillopora_meandrina_HIv1___Sc0000023: 213
  Pocillopora_meandrina_HIv1___xfSc0000264: 3
  Pocillopora_meandrina_HIv1___Sc0000010: 615
  Pocillopora_meandrina_HIv1___xfSc0001122: 3
  Pocillopora_meandrina_HIv1___xfSc0000811: 1
  Pocillopora_meandrina_HIv1___Sc0000031: 185
  Pocillopora_meandrina_HIv1___xfSc0000788: 5
  Pocillopora_meandrina_HIv1___xfSc0000875: 1
  Pocillopora_meandrina_HIv1___xfSc0000488: 7
  Pocillopora_meandrina_HIv1___xfSc0000017: 2
  Pocillopora_meandrina_HIv1___Sc0000055: 12
  Pocillopora_meandrina_HIv1___xfSc0001011: 2
  Pocillopora_meandrina_HIv1___xfSc0000092: 6
  Pocillopora_meandrina_HIv1___Sc0000047: 22
  Pocillopora_meandrina_HIv1___xfSc0000482: 4
  Pocillopora_meandrina_HIv1___xfSc0000132: 4
  Pocillopora_meandrina_HIv1___xfSc0000024: 2
  Pocillopora_meandrina_HIv1___Sc0000026: 271
  Pocillopora_meandrina_HIv1___xfSc0000995: 1
  Pocillopora_meandrina_HIv1___Sc0000067: 2
  Pocillopora_meandrina_HIv1___Sc0000038: 93
  Pocillopora_meandrina_HIv1___xfSc0000642: 1
  Pocillopora_meandrina_HIv1___xfSc0000376: 1
  Pocillopora_meandrina_HIv1___Sc0000082: 3
  Pocillopora_meandrina_HIv1___xfSc0000975: 3
  Pocillopora_meandrina_HIv1___xfSc0000760: 2
  Pocillopora_meandrina_HIv1___Sc0000069: 1
  Pocillopora_meandrina_HIv1___Sc0000036: 124
  Pocillopora_meandrina_HIv1___xfSc0000275: 1
  Pocillopora_meandrina_HIv1___Sc0000000: 922
  Pocillopora_meandrina_HIv1___xfSc0000199: 2
  Pocillopora_meandrina_HIv1___xfSc0000058: 1
  Pocillopora_meandrina_HIv1___xfSc0000014: 1
  Pocillopora_meandrina_HIv1___xfSc0000725: 5
  Pocillopora_meandrina_HIv1___Sc0000042: 68
  Pocillopora_meandrina_HIv1___xfSc0000892: 1
  Pocillopora_meandrina_HIv1___xfSc0000001: 67
  Pocillopora_meandrina_HIv1___Sc0000014: 378
  Pocillopora_meandrina_HIv1___xfSc0000262: 3
  Pocillopora_meandrina_HIv1___xfSc0000228: 4
  Pocillopora_meandrina_HIv1___Sc0000051: 13
  Pocillopora_meandrina_HIv1___Sc0000028: 208
  Pocillopora_meandrina_HIv1___xfSc0000885: 5
  Pocillopora_meandrina_HIv1___xfSc0000272: 5
  Pocillopora_meandrina_HIv1___Sc0000007: 643
  Pocillopora_meandrina_HIv1___xfSc0000705: 1
  Pocillopora_meandrina_HIv1___Sc0000022: 231</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>lncRNA</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/47-ffs/</guid>
  <pubDate>Sat, 21 Jun 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_deep-dive-expression__RStudio_Server_2025-06-21_17-48-43.png" medium="image" type="image/png"/>
</item>
<item>
  <title>ROL-PI Day three</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/46-ROLPI-d3/</link>
  <description><![CDATA[ 





<p>Day three. Looking for missing files.. working on slides</p>
<p>Narrowed down issue with missing “WGBS” files from Peve and Ptua to a possible error in wget Azenta named files.</p>
<p>Need to get full data sets for both species and run through Bismark.. and beyond..</p>


<!-- -->


 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/46-ROLPI-d3/</guid>
  <pubDate>Mon, 26 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Assess_WGBS_data_sample_numbers_by_species__Issue_34__urol-e5timeseries_molecular_2025-05-26_12-43-24.png" medium="image" type="image/png"/>
</item>
<item>
  <title>ROL-PI Day two</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/45-ROLPI-d2/</link>
  <description><![CDATA[ 





<p>Day two. Much of time was spent on Epigenetic Simulation then moving on to POISE model.</p>
<p>Did some slide edits…</p>
<p>And coding to figure out what caused the lack of CpG loci in Apul (TLDR::one bad sample)</p>
<section id="trouble-shooting-apul" class="level1">
<h1>Trouble shooting Apul</h1>
<p>Went back to processed txt loci files (from 10x bedgraph).</p>
<p>Found that 225-T1 was much smaller in line counts and we tracked down multiQC on bismark and found very bad alignment.</p>
<p>To remedy, did merge as before.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pull processed files from Gannet </span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: Unfortunately we can't use the `cache` feature to make this process more time efficient, as it doesn't support long vectors</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base URL</span></span>
<span id="cb1-5">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/"</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the HTML page</span></span>
<span id="cb1-8">page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(base_url)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract links to files</span></span>
<span id="cb1-11">file_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for files ending in "processed.txt"</span></span>
<span id="cb1-16">processed_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"processed</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.txt$"</span>, file_links)]</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create full URLs</span></span>
<span id="cb1-19">file_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, processed_files)</span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to read a file from URL</span></span>
<span id="cb1-22">read_processed_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(url) {</span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_table</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read as character to avoid parsing issues</span></span>
<span id="cb1-24">}</span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import all processed files into a list</span></span>
<span id="cb1-27">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(file_urls, read_processed_file)</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name the list elements by file name</span></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> processed_files</span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of imported data</span></span>
<span id="cb1-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(processed_data)</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a header row that has "CpG" for the first column and "sample" for the second column, which will be populated by the file name </span></span>
<span id="cb1-36"></span>
<span id="cb1-37">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Map</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df, filename) {</span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, filename)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb1-40">}, processed_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use stored file names</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#merge files together by "CpG"</span></span>
<span id="cb1-43">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(processed_data, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>)</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of final merged data</span></span>
<span id="cb1-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(merged_data)</span></code></pre></div>
</div>
<p>Then changed things up.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove 225-T1</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(merged_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ACR-225-TP1_10x_processed.txt"</span>)]</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all columns (except "CpG") to numeric</span></span>
<span id="cb3-2">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, as.numeric)) \</span></code></pre></div>
</div>
<p>Only keep CpGs that have a non-na value in all samples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(merged_data)</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure it's formatted as a data frame</span></span>
<span id="cb4-4">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(filtered_wgbs)</span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only keep the sample information in the column name. </span></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*?)_.*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs))</span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set CpG IDs to rownames</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CpG</span>
<span id="cb4-9">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG)</span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(merged_data)</span>
<span id="cb4-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(filtered_wgbs)</span></code></pre></div>
</div>
<p>We had 12,093,025 CpGs before filtering and have 96785 after filtering.</p>
<hr>
</section>
<section id="how-about-ptua" class="level1">
<h1>How about Ptua?</h1>
<p>First lets go back to processed txt loci file to see if there are any outliers.</p>
<p>Missing data downloads - https://github.com/urol-e5/timeseries_molecular/issues/34</p>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/45-ROLPI-d2/</guid>
  <pubDate>Sat, 24 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_EpigeneticsSimulationMS_-_Online_LaTeX_Editor_Overleaf_2025-05-25_07-13-14.png" medium="image" type="image/png"/>
</item>
<item>
  <title>ROL-PI Day one</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/44-ROLPI-d1/</link>
  <description><![CDATA[ 





<p>Day one. Much of time was spent on Epigenetic Simulation paper completion.</p>
<p>Some coding completed.</p>
<section id="epigenetic-machinery-expression" class="level1">
<h1>Epigenetic Machinery Expression</h1>
<p>For Apul joined relavant blast matches to expression data.</p>
<p><a href="https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/code/29-Apul-epimachine-exp.Rmd" class="uri">https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/code/29-Apul-epimachine-exp.Rmd</a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-4c77aa782bd09f4ea0c8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4c77aa782bd09f4ea0c8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"22.14\" data-max=\"96.032\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"63\" data-max=\"2737\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4\" data-max=\"1462\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"58\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"5020\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"70\" data-max=\"5588\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"4415\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"71\" data-max=\"5008\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1.930000001e-06\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"48.1\" data-max=\"4484\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"7625\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"6418\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"40983\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"14864\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"38648\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"36350\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"35652\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"23609\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"17944\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"56200\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"16029\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"8252\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"13859\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"29148\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"12501\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"21194\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"32084\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"27499\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"33492\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"35605\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"52575\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"26096\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"12683\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"38178\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"8186\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"13746\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"57266\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"40983\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"8980\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"13746\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"26666\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"10263\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"14686\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"61638\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"11854\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"44115\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"10894\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"17265\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"34168\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"39083\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479"],["FUN_000231","FUN_000374","FUN_000374","FUN_000535","FUN_001019","FUN_001019","FUN_001019","FUN_001086","FUN_001086","FUN_001086","FUN_001141","FUN_001141","FUN_001141","FUN_001172","FUN_001196","FUN_001341","FUN_001341","FUN_001341","FUN_001342","FUN_001344","FUN_001354","FUN_001354","FUN_001403","FUN_001425","FUN_001425","FUN_001425","FUN_001425","FUN_001593","FUN_001664","FUN_001947","FUN_001947","FUN_002092","FUN_002429","FUN_002454","FUN_002469","FUN_002813","FUN_003846","FUN_004003","FUN_004054","FUN_004096","FUN_004339","FUN_004346","FUN_004346","FUN_004346","FUN_004436","FUN_004436","FUN_004436","FUN_004436","FUN_004447","FUN_004470","FUN_004511","FUN_004512","FUN_004643","FUN_004748","FUN_004860","FUN_004860","FUN_004860","FUN_004918","FUN_004918","FUN_005063","FUN_005113","FUN_005113","FUN_005113","FUN_005114","FUN_005114","FUN_005114","FUN_005133","FUN_005808","FUN_005808","FUN_005808","FUN_006104","FUN_006104","FUN_006169","FUN_006369","FUN_006436","FUN_006436","FUN_006885","FUN_006985","FUN_007018","FUN_007147","FUN_007147","FUN_007150","FUN_007708","FUN_007977","FUN_008086","FUN_008086","FUN_008108","FUN_008187","FUN_008187","FUN_008278","FUN_008529","FUN_008710","FUN_008710","FUN_008710","FUN_008711","FUN_008895","FUN_009381","FUN_009519","FUN_009519","FUN_009959","FUN_009959","FUN_010587","FUN_010654","FUN_010654","FUN_010713","FUN_010733","FUN_010779","FUN_010962","FUN_010962","FUN_011179","FUN_011276","FUN_011276","FUN_011750","FUN_011750","FUN_011847","FUN_011931","FUN_011956","FUN_011956","FUN_011974","FUN_011974","FUN_012182","FUN_012241","FUN_012241","FUN_012353","FUN_012366","FUN_012384","FUN_012490","FUN_012591","FUN_012595","FUN_012662","FUN_012762","FUN_013373","FUN_013373","FUN_013377","FUN_013377","FUN_013400","FUN_013560","FUN_014437","FUN_014483","FUN_014486","FUN_014486","FUN_014515","FUN_014527","FUN_014539","FUN_014616","FUN_014621","FUN_014624","FUN_014624","FUN_014641","FUN_014641","FUN_014690","FUN_014690","FUN_014794","FUN_014855","FUN_015145","FUN_015145","FUN_015158","FUN_015193","FUN_015216","FUN_015228","FUN_015272","FUN_015402","FUN_015424","FUN_016070","FUN_016091","FUN_016091","FUN_016148","FUN_016148","FUN_016161","FUN_016161","FUN_016161","FUN_016161","FUN_016200","FUN_016202","FUN_016202","FUN_016202","FUN_016202","FUN_016202","FUN_016284","FUN_016320","FUN_016320","FUN_016320","FUN_016340","FUN_016586","FUN_016586","FUN_016652","FUN_016677","FUN_017768","FUN_017839","FUN_017839","FUN_017839","FUN_017901","FUN_017922","FUN_018005","FUN_018005","FUN_018009","FUN_018029","FUN_018029","FUN_018046","FUN_021451","FUN_021938","FUN_021938","FUN_022104","FUN_022104","FUN_022245","FUN_022313","FUN_022341","FUN_022390","FUN_022390","FUN_022482","FUN_022526","FUN_022629","FUN_022629","FUN_022632","FUN_022863","FUN_022897","FUN_022897","FUN_023050","FUN_023134","FUN_023202","FUN_023231","FUN_023231","FUN_023248","FUN_023369","FUN_023369","FUN_023552","FUN_023577","FUN_023950","FUN_023950","FUN_024017","FUN_024017","FUN_024017","FUN_024018","FUN_024018","FUN_024199","FUN_024199","FUN_024215","FUN_024215","FUN_024215","FUN_024220","FUN_024350","FUN_024350","FUN_024350","FUN_024354","FUN_024446","FUN_024481","FUN_024566","FUN_024761","FUN_025431","FUN_025671","FUN_025733","FUN_025748","FUN_025751","FUN_025751","FUN_025756","FUN_025756","FUN_025766","FUN_025766","FUN_025766","FUN_025798","FUN_026076","FUN_026093","FUN_026093","FUN_026093","FUN_026177","FUN_026177","FUN_026177","FUN_026177","FUN_026632","FUN_026714","FUN_027900","FUN_027982","FUN_027982","FUN_028193","FUN_028262","FUN_028279","FUN_028309","FUN_028309","FUN_028309","FUN_028511","FUN_028819","FUN_028838","FUN_028838","FUN_028838","FUN_028838","FUN_028908","FUN_028911","FUN_028977","FUN_028977","FUN_029079","FUN_029248","FUN_029248","FUN_029248","FUN_029406","FUN_029671","FUN_030672","FUN_031645","FUN_031645","FUN_031678","FUN_031939","FUN_032088","FUN_032104","FUN_032137","FUN_032162","FUN_032215","FUN_032215","FUN_032215","FUN_032220","FUN_032245","FUN_032245","FUN_032245","FUN_032353","FUN_032353","FUN_032363","FUN_032363","FUN_032433","FUN_032572","FUN_032572","FUN_032572","FUN_032605","FUN_032607","FUN_032610","FUN_032610","FUN_032757","FUN_032815","FUN_032815","FUN_032815","FUN_032815","FUN_033309","FUN_033745","FUN_033843","FUN_033885","FUN_033922","FUN_033922","FUN_034012","FUN_034012","FUN_034029","FUN_034029","FUN_034262","FUN_034263","FUN_034339","FUN_034382","FUN_034460","FUN_034483","FUN_034727","FUN_034781","FUN_034799","FUN_034808","FUN_034836","FUN_034972","FUN_034972","FUN_034972","FUN_035067","FUN_035338","FUN_035339","FUN_035339","FUN_035340","FUN_035340","FUN_035357","FUN_035359","FUN_035359","FUN_035359","FUN_035552","FUN_035677","FUN_035677","FUN_035720","FUN_035819","FUN_035819","FUN_035867","FUN_036021","FUN_036028","FUN_036028","FUN_036040","FUN_036120","FUN_036120","FUN_036120","FUN_036132","FUN_036132","FUN_036137","FUN_036205","FUN_036208","FUN_036507","FUN_036742","FUN_036826","FUN_036827","FUN_037053","FUN_037054","FUN_037093","FUN_037221","FUN_037324","FUN_037383","FUN_037384","FUN_037684","FUN_037745","FUN_037911","FUN_037911","FUN_037911","FUN_037972","FUN_037983","FUN_038038","FUN_038040","FUN_038040","FUN_038040","FUN_038060","FUN_038060","FUN_038088","FUN_038100","FUN_038218","FUN_038346","FUN_038347","FUN_038403","FUN_038421","FUN_038633","FUN_038633","FUN_038732","FUN_038936","FUN_038936","FUN_038936","FUN_039863","FUN_039873","FUN_039935","FUN_039983","FUN_039983","FUN_040002","FUN_040021","FUN_040025","FUN_040029","FUN_040103","FUN_040153","FUN_040230","FUN_040266","FUN_040713","FUN_040713","FUN_040713","FUN_040878","FUN_040949","FUN_040954","FUN_041312","FUN_041548","FUN_041551","FUN_041562","FUN_041562","FUN_041566","FUN_041566","FUN_041642","FUN_041732","FUN_041732","FUN_041750","FUN_041750","FUN_041777","FUN_041838","FUN_041902","FUN_041920","FUN_042630","FUN_042837","FUN_042970","FUN_042972","FUN_042972","FUN_043098","FUN_043156","FUN_043321","FUN_043354","FUN_043447","FUN_043447","FUN_043481","FUN_043503","FUN_044376","FUN_045078","FUN_045085","FUN_045085","FUN_045085","FUN_045085","FUN_045194","FUN_045194","FUN_045329","FUN_045329","FUN_045329","FUN_045329","FUN_045444"],["Kmt7-Setd7/9-201","PRDM7-202","Kmt8-Prdm2-201","Mbd4-201","USP47-207","USP41-201","USP18-201","PPP1R12C-201","PPP1R12B-216","PPP1R12A-203","Kat6a-201","Kat7-205","Kat6b-214","Prmt3-201","PPP6C-201","UBE2D1-201","UBE2D2-202","UBE2D3-210","Sirt1-201","CDK1-203","Parp5b-Tnks2-201","Parp5a-Tnks-201","WEE1-202","Kdm3b-201","Kdm3a-201","Kdm3c-Jmjd1c-211","Hr-205","SLK-202","Setd3-201","USP8-201","USP50-203","Arh3-Adprs-201","PRKCD-201","PIM1-201","HUWE1-202","BAP1-202","YTHDC1-201","Wt1-205","Hdac3-201","Prdm6-201","Prdm14-201","PRKAA2-201","PRKAA1-202","PRKAA2-201","Kdm4a-203","Kdm4d-201","Kdm4b-201","Kdm4c-201","USP24-201","Jmjd7-201","JAK2-201","Kat14-201","Zbtb38-201","UBA6-201","Parp6-201","Parp16-201","Parp8-201","OTUD7B-202","OTUD7A-201","YTHDC2-201","Kat13A-Ncoa1-201","Kat13C-Ncoa2-201","Kat13B-Ncoa3-201","USP3-202","USP44-201","USP49-206","MAP2K1-201","USP4-201","USP15-201","USP11-201","Hdac6-201","Hdac10-201","Kat4-Taf1-206","JKAMP-214","USP35-203","USP38-201","USP19-205","UBE3A-226","PUS3-201","UBA7-201","UBA1-201","Hdac11-201","USP34-201","BUB1-201","Riox2-201","Riox1-201","Parp3-202","RPS6KA4-201","RPS6KA5-207","Kat5-201","CBLL1-201","Suv39h2-Kmt1b-201","BAZ1B-201","Suv39h1-kmt1a-202","NAA10-208","Parp10-201","MCM3AP-201","MACROH2A1-201","H1-2-201","H2AZ2-202","H2AZ1-201","MDC1-201","ESCO2-201","ESCO1-201","PPP1R8-202","EIF3H-209","Kat8-201","RNF20-202","RNF40-201","Kmt5a—Setd8-202","Kmt2g-Setd1b-201","Kmt2f-Setd1a-201","USP45-208","USP16-204","ACAT1-201","ACAT2-201","NSUN4-204","NSUN3-201","Senp7-203","Senp6-203","ATM-229","ARID1A-201","ARID1B-220","Kdm1a-202","Parp4-201","WTAP-202","Prdm13-202","PUS7-202","CDK8-201","Parp12-201","Hdac8-201","USP5-201","USP13-201","NSUN6-201","NOP2-201","YBX1-201","PPP1R7-201","GTF3C2-201","Kat9-Elp3-201","Hdac2-201","H2AX-201","Setd6-201","PPM1D-201","USP14-201","PPP4C-201","USP30-201","PPP1CA-203","PPP1CC-201","RPUSD3-201","RPUSD4-201","USP6-205","USP32-201","Prdm10-205","PRPF8-201","Kdm2b-202","Kdm2a-201","HNRNPA2B1-201","TRIM37-201","ALKBH3-201","Sirt4-201","METTL16-201","MCPH1-201","COPS5-201","YWHAQ-201","MAPK1-201","MAPK3-201","HIRA-201","HIRA-201","EYA1-202","EYA3-203","EYA2-202","EYA4-202","Prdm5-202","Ctcf-201","Prdm4-207","Zfp57-201","Prdm9-207","Prdm15-201","map3k22-202","USP29-201","USP37-201","USP26-201","UBE4A-201","MYSM1-202","MPND-207","TRMT112-206","Tyw5-209","PSMD7-201","Whsc1-Nsd2-201","Kmt3a-Setd2-201","Kmt2h-Ash1l-201","MAP3K12-205","PPP1R13B-201","Kmt6-Ezh2-201","Ezh1-203","Prdm8-201","PPP1R9A-206","PPP1R9B-202","UBA5-202","ATF2-201","Dnmt3b-201","Dnmt3a-201","Kat2a-202","Kat2b-201","Mbd5-201","DBF4-201","Tet3-203","TRMT61B-201","TRMT61A-202","Kat1-Hat1-201","BRCA1-203","Kmt2c-201","Kmt2d-201","BLOC1S1-203","PAN2-201","PPP1R3C-201","PPP1R3B-201","ZRANB1-201","Egr1-202","HASPIN-201","PUS1-202","PUSL1-201","Smyd5-201","Whsc1l-Nsd3-205","Kmt3b-Nsd1-201","TRMT1-202","ZCCHC4-201","Kat3B-Ep300-201","Kat3A-Crebbp-201","UHRF1-208","Uhrf1-201","Uhrf2-201","RBM15B-201","RBM15-201","USP46-201","USP12-201","UCHL3-201","Uchl4-201","UCHL1-201","Klf4-201","OTUD1-201","OTUD4-201","ALG13-203","Setmar-201","TRMT10A-202","APBB1-221","Ogt-201","UBE2A-202","USP48-201","OTUD3-201","METTL6-202","UBE2Z-201","Prdm16-206","Mecom-PRDM3-212","ADARB1-201","ADARB2-203","METTL2A-201","METTL8-217","METTL2B-201","ALKBH1-201","USP40-208","IGF2BP2-204","IGF2BP3-201","IGF2BP1-201","Hdac4-201","Hdac5-201","Hdac9-204","Hdac7-204","Prdm1-201","Hspbap1-202","RNF168-201","USP21-203","USP2-201","EIF3F-209","CHEK1-204","PUS7L-201","Kdm6a-202","Uty-201","Kdm6b-201","FMR1-201","OTUD5-202","MAPK11-201","MAPK13-201","MAPK12-201","MAPK14-201","NSUN5-204","Senp8-206","Kmt2e-202","Setd5-201","Kat12-Gtf3c4-201","Phf2-201","Phf8-201","Kdm7a-201","H1-6-201","METTL4-203","Prmt2-203","Zbtb33-201","Zbtb4-202","RNF8-202","METTL5-201","Sirt2-201","UBR2-202","PUS10-201","PPP1CB-203","YTHDF2-201","YTHDF3-205","YTHDF1-202","DLAT-201","MAPK9-207","MAPK8-201","mapk8b-203","USP54-201","USP53-201","Tet1-206","Tet2-204","GTF3C1-201","NAT8B-201","NAT8L-201","NAT8-201","ATR-201","PSMD14-201","STK4-202","STK4-202","Setd4-201","ZC3H12A-201","ZC3H12B-201","ZC3H12D-201","ZC3H12C-201","Kdm1b-201","Kat13D-Clock-201","DDB1-201","Sirt3-210","Kmt5c-201","Kmt5b-206","USP36-201","USP42-201","Prmt6-203","Prmt8-201","Kmt1f-Setdb2-201","Kmt1e-Setdb1-201","NAT10-201","ELF3-203","PRKDC-201","Sirt7-201","USP7-201","USP10-201","Prmt5-201","UBA3-202","VIRMA-201","AURKB-214","AURKA-208","AURKC-201","Prmt7-201","PPP1R3G-201","PPP1R3D-201","PPP1R3E-201","PPP1R3F-201","PPP1R3A-201","DTX3L-201","Parp14-201","Parp9-203","PARP15-202","UBE2V1-203","PPP1R16B-201","PPP1R16A-202","Sirt5-207","ATXN3L-201","ATXN3-254","UBA2-201","HNRNPC-201","OTUD6B-201","OTUD6A-201","Jmjd8-201","H1-5-201","H1-4-201","H1-3-201","H2AW-201","H2AJ-201","H1-1-201","Parp2-201","Jarid2-201","RPUSD1-201","PPP1R2-206","Chuk-201","STAMBPL1-203","Parg-201","METTL14-201","USP39-201","METTL1-202","VCPIP1-201","ADAR-202","TRDMT1-203","Jmjd6-201","Ash2l-201","Smyd1-201","Smyd3-204","Kmt3c-Smyd2-201","H1-8-201","Smyd4-201","TOM1-209","USP22-201","USP27X-201","USP51-201","USP31-201","USP43-201","Arh1-Adprh-201","PRKCB-210","ALKBH5-201","ALYREF-202","DUS1L-201","NAA60-202","USP1-201","JOSD2-204","JOSD1-210","H1-0-201","H2AB1-201","H2AB2-201","H2AB3-201","Kdm8-201","Prdm12-201","PRRC2A-202","MST1-202","MST1-202","DLK1-202","Parp11-201","Parp13-Zc3hav1-203","Parp7-Tiparp-201","WDR5-201","ATAT1-204","DCP2-201","DAPK3-202","Mbd2-201","Mbd3-201","Mbd1-201","Sirt6-201","NSUN2-201","RPUSD2-201","NAA50-201","Prmt9-201","PAK2-201","Dnmt3l-201","USP9Y-201","USP28-201","USP25-204","CUL4A-202","Kmt2b-201","Kmt2a-201","TRUB1-201","DKC1-201","DYRK1A-221","PPP1R11-205","BRCC3-201","COPS6-201","Kmt4-Dot1l-201","BRD4-201","UCHL5-205","USP33-204","USP20-203","TRMT10C-201","PKN1-201","Dnmt1-201","RBMX-201","Kmt1c-Ehmt2-201","Kmt1d-Ehmt1-210","PPP1R10-201","CSNK2B-203","PKM-202","ZC3H13-201","Senp5-201","Senp1-204","Senp3-201","Senp2-201","Baz2b-201","Mbd6-201","Kdm5a-201","Kdm5d-201","Kdm5c-202","Kdm5b-201","Prdm11-206"],[24.49,31.641,37.778,59.77,52.476,27.711,24.495,41.274,46.791,57.143,60.172,47.416,67.69199999999999,47.887,89.03700000000001,87.755,90.476,90.476,47.266,70.548,69.43000000000001,71.553,49.293,61.417,58.268,36.31,28.689,58.491,44.376,48.133,32.71,39.601,52.299,50.787,42.108,67.181,66.443,62.353,70.68600000000001,46.765,52.078,57.951,53.731,57.951,65.95099999999999,58.333,54.773,53.93,45.492,55.769,36.585,52.055,32.836,56.891,23.81,46.006,22.14,40,45.725,52.008,25.691,24.119,23.592,49.906,32.598,32.598,72.727,54.261,53.961,47.303,54.895,51.22,50.64,47.619,35.441,35.053,52.116,50.172,42.561,42.787,64.52200000000001,61.846,46.038,29.635,32.36,50.461,34.652,58.333,63.786,60.542,35.533,49.826,45.675,46.884,87.01300000000001,40.113,43.455,56.364,53.886,96.032,95.238,42.857,43.805,47.186,54.076,58.095,76.071,33.203,59.885,50.581,54.088,53.205,32.346,34.136,69.42400000000001,61.44,36.164,32.416,47.516,61.029,56.56,37.931,37.865,69.13,44.32,69.874,60.684,42.88,75.72799999999999,35.053,54.133,54.842,50.238,46.089,31.25,82.22199999999999,60.667,31.757,79.511,83.77800000000001,85.185,40.857,51.264,61.122,90.291,36.468,92.56999999999999,91.536,30.159,36,65.789,50.815,32.759,92.11499999999999,42.676,40.773,42.614,78.842,35.443,57.823,37.961,50,83.133,62.656,85.673,80.286,58.02,58.02,76.429,65.09099999999999,71.378,72.857,36.865,35.806,31.116,26.316,37.553,27.519,39.291,34.754,36.842,38.828,38.833,33.152,42.599,55.645,63.423,79.239,37.288,40.587,42.857,62.5,43.116,53.701,50.75,33.636,40.777,51.961,66.491,39.636,43.529,46.097,61.23,60.75,57.143,32.154,32.082,28.448,58.73,48.13,26.047,39.327,54.104,61.864,49.869,35.294,34.146,46.143,65.541,46.921,44.477,23.611,55.556,48.173,53.973,51.525,45.992,55.799,56.124,53.178,52.574,45.629,43.258,43.169,76.613,76.152,59.556,57.895,50,76.667,28.571,46.259,38.814,46.392,57.303,33.175,85.405,93.95999999999999,44.787,45.675,58.462,70.124,28.936,31.02,46.812,39.94,52.121,49.245,51.818,40.21,34.823,29.622,29.387,26.987,60.044,59.267,56.156,56.531,46.043,45.669,40.351,43.288,52.113,53.585,55.063,30.496,55.641,54.22,62.185,44.772,45.902,74.236,64.574,63.793,75.983,49.767,49.774,33.482,29.103,24.216,44.025,48.578,53.363,45.714,37.363,43.508,38.095,36.275,28.657,64.878,59.596,42.126,46.313,93.578,70.745,66.667,40.134,55.58,69.63800000000001,80.80800000000001,72.316,53.757,50,48.066,49.66,26.349,31.469,33.014,31.313,40.738,89.81100000000001,62.222,62.222,36,66.321,60.338,66.495,66.169,46.314,30.373,68.49299999999999,52.145,49.624,54.194,51.204,48.402,36.55,66.667,54.348,42.739,69.92,52.273,40.226,53.191,59.725,44.492,57.987,68.75,32.865,61.677,68.977,67.816,40.496,27.753,35.897,32.275,33.6,36.047,58.659,28.041,29.136,49.261,71.223,42.318,41.489,62.257,43.716,37.857,70,44.186,53.025,43.772,26.36,45.714,44.286,44.286,88.28100000000001,88.8,43.056,62.124,37.922,29.787,44.344,35.433,38.814,54.971,61.312,68.48999999999999,65.587,46.667,43.984,44.941,66.568,65.99299999999999,27.957,32.889,30.586,37.607,28.383,59.804,61.132,58.388,54.259,42.491,40.727,57.714,63.529,67.039,51.562,54.273,58.791,46.875,47.701,50.61,64.10299999999999,45.098,46.078,46.078,43.207,48.229,33.901,35.242,35.242,43.75,33.832,30.892,34.188,85.494,51.899,48.905,54.945,43.922,41.264,57.812,62.602,52.567,47.651,80.26300000000001,78.328,63.971,60.977,60.859,38.28,47.162,73.621,35.232,33.376,25.738,70.337,75.105,42.975,53.287,60.169,68.08499999999999,49.356,60,42.712,43.144,34.555,50.261,51.653,38.739,46.654,46.097,30.189,94.146,59.69,34.615,39.267,33.748,39.048,42.544,36.35,31.115,55.486,40.275,42.424,33.255,25.605],[147,256,135,87,848,249,396,361,374,287,349,445,325,497,301,147,147,147,512,292,1158,1146,495,381,381,851,366,318,489,482,321,351,696,254,1983,259,149,85,423,340,409,566,603,566,326,336,440,458,2673,312,287,365,268,1023,273,313,271,575,269,971,362,369,373,531,408,408,352,927,934,890,286,287,1720,294,601,1047,378,871,289,1019,1057,325,2726,685,445,434,531,732,729,517,197,287,289,337,154,177,573,385,386,126,126,210,226,231,368,315,397,512,349,172,318,312,439,457,399,389,365,327,322,136,564,696,684,690,986,239,117,618,412,659,375,857,842,473,272,90,300,592,532,450,432,350,277,499,309,436,323,319,252,250,304,1043,232,2321,553,569,176,449,158,294,569,174,332,241,349,350,505,505,280,275,283,280,453,310,421,247,703,516,677,305,361,273,1097,184,277,124,298,289,295,579,224,432,276,743,733,110,309,204,379,275,680,679,797,800,63,311,826,116,252,401,215,1040,597,118,1149,204,205,726,148,341,344,288,378,739,667,590,474,1095,1094,818,816,835,356,366,372,369,225,228,220,90,140,294,371,291,178,422,692,149,940,289,260,241,470,245,643,671,330,331,330,286,1298,476,473,478,458,464,463,467,139,127,228,365,355,265,474,787,390,391,119,373,427,229,223,232,229,430,221,672,457,574,477,457,446,70,273,439,84,102,499,205,297,1797,339,327,188,222,598,448,359,198,354,346,346,362,294,964,143,209,198,2737,265,495,495,375,193,237,194,201,814,563,1095,303,266,310,457,438,342,354,92,241,1004,88,1504,423,1090,463,626,432,1923,334,303,261,726,227,195,189,125,172,179,1940,405,203,139,371,376,257,183,280,290,86,281,281,239,70,70,70,128,125,72,499,385,141,442,762,371,513,442,457,247,1020,507,425,338,297,465,450,461,117,606,306,530,459,540,546,523,350,680,179,256,433,182,192,174,164,78,102,102,102,449,367,587,227,227,160,334,437,468,324,158,137,273,255,269,64,246,409,447,152,586,544,2519,2468,1058,687,580,667,776,237,445,474,121,289,236,329,699,350,885,897,191,959,1603,111,538,538,318,205,516,130,191,563,210,228,1370,556,319,437,429,427,703],[84,159,77,33,339,177,221,187,181,122,134,184,102,243,33,18,14,14,236,83,336,308,218,141,152,478,236,130,262,216,193,188,302,122,948,84,50,32,118,136,159,179,188,179,109,137,178,176,1294,131,159,153,156,428,142,164,148,230,114,407,196,223,219,205,195,194,90,369,377,401,127,137,674,145,372,563,177,324,146,551,368,124,1280,370,260,214,308,278,246,121,112,134,147,160,20,97,279,144,153,4,5,119,124,113,131,124,89,285,140,84,140,127,259,258,120,150,205,201,144,51,233,351,365,188,508,71,46,315,86,350,169,319,367,223,145,16,114,347,73,68,60,196,127,173,28,227,20,22,153,134,100,461,149,181,279,258,99,94,96,120,284,83,54,84,50,69,179,179,64,96,81,74,267,190,242,146,380,296,294,172,199,147,607,106,154,53,109,60,151,250,118,143,144,280,316,59,163,83,117,123,320,317,284,291,27,170,446,82,102,201,152,478,243,45,532,113,118,319,44,162,161,174,163,319,292,256,234,384,366,325,322,372,150,152,66,73,90,92,104,21,92,121,194,145,75,207,101,9,450,135,105,69,268,146,287,355,138,150,139,150,746,290,274,279,170,170,188,187,75,65,117,164,141,123,198,424,160,164,45,161,170,59,78,81,55,203,103,332,234,344,254,219,202,36,133,211,52,63,268,70,118,937,179,20,54,64,236,174,106,38,95,153,166,145,134,518,91,117,126,1462,27,159,159,229,62,77,62,65,391,316,321,89,127,112,198,207,198,112,42,117,290,42,799,173,417,242,258,134,1114,116,90,84,382,104,114,111,49,105,73,1188,246,93,38,203,206,97,95,116,78,47,126,145,151,37,38,38,12,11,40,178,227,74,206,444,200,216,144,139,78,474,248,195,113,98,285,254,277,67,354,117,172,130,203,258,271,145,232,59,92,176,75,93,90,80,28,56,55,55,195,144,259,133,133,83,176,245,242,47,75,70,121,118,128,26,90,191,201,30,127,162,890,890,533,296,150,364,453,122,120,107,66,103,87,104,275,116,450,431,116,412,653,59,278,281,156,12,203,77,111,289,115,129,714,266,126,226,212,239,466],[2,8,2,1,11,2,8,8,5,1,3,6,2,4,0,0,0,0,5,2,8,9,12,3,4,18,7,2,8,8,7,6,7,2,40,1,0,0,4,7,8,9,8,9,2,3,5,7,40,1,8,4,4,10,9,4,8,13,7,14,15,14,15,10,14,15,2,12,13,15,2,2,33,4,4,18,3,11,5,14,5,0,49,24,13,1,16,15,9,10,6,6,6,5,0,3,9,6,7,1,1,1,2,3,11,2,4,8,0,1,3,7,14,8,2,0,9,8,7,1,7,15,14,6,13,1,0,8,3,24,1,13,16,7,8,0,1,19,1,3,2,4,4,4,1,12,2,1,10,7,2,15,4,2,10,12,1,1,4,2,11,3,2,3,0,0,7,7,1,0,0,1,9,6,10,9,11,11,22,7,9,6,26,5,2,2,0,0,7,12,7,6,4,12,12,3,8,6,4,11,12,9,6,5,0,10,25,1,2,2,4,29,12,0,18,6,7,14,3,5,6,12,3,11,11,11,11,18,20,15,17,13,11,10,2,2,1,2,3,0,2,5,7,4,1,11,0,0,17,5,2,1,12,5,13,12,3,6,3,4,30,17,14,13,3,5,4,4,0,4,6,10,6,0,7,22,8,8,0,4,8,0,1,1,0,5,3,18,16,23,5,5,2,2,4,6,0,1,18,1,1,42,3,1,1,3,26,4,1,0,1,5,5,6,3,25,2,6,4,47,0,8,8,6,1,4,2,2,9,15,7,3,3,4,10,8,7,1,0,4,5,0,25,5,13,8,4,1,50,2,2,0,12,8,6,7,2,2,1,58,9,3,2,5,5,0,3,5,2,1,3,5,6,1,1,1,2,2,1,6,5,5,10,15,5,8,6,3,1,22,11,9,0,3,8,5,9,4,16,3,11,11,12,14,10,2,7,0,4,8,0,4,1,1,0,0,0,0,9,6,20,7,7,4,10,16,8,0,1,0,1,9,10,1,1,3,6,0,0,8,26,26,26,13,1,13,13,6,2,2,2,5,3,1,13,3,13,18,5,19,29,2,5,6,9,0,2,2,2,14,4,1,35,13,5,7,9,7,13],[20,196,8,388,1,2,53,8,8,2,476,170,688,46,5,1,1,1,138,1,15,177,171,1383,940,1707,867,1,4,648,28,26,4,38,499,4,352,389,3,245,182,9,7,9,11,8,8,13,1,7,836,433,883,31,319,11,579,5,27,462,29,35,35,1,274,254,30,14,8,93,494,17,21,9,1,1,596,6,154,10,3,5,772,459,41,164,13,13,28,6,5,197,1875,81,1,776,432,1,248,1,1,1872,372,602,9,36,62,15,652,193,1671,1417,13,3,31,8,23,22,732,670,2503,1635,1725,194,244,5,586,72,1,81,6,15,34,7,352,52,59,314,34,1,181,44,99,1,1,68,1,1,108,125,499,1,508,15,165,166,22,1,130,28,1,645,1,2,6,23,1,1,315,299,256,362,141,264,372,134,160,402,43,260,266,296,13,526,221,1,13,2,985,1444,2062,85,815,15,18,29,455,388,34,234,221,267,52,27,15,44,1867,181,1,15,1648,3963,5020,29,56,56,30,3,313,461,54,1,25,682,1543,57,17,1045,1080,1,1,1,159,172,12,16,5,5,5,393,301,25,196,27,99,254,24,1,138,1,12,106,77,23,80,87,17,31,17,21,13,133,126,126,621,660,604,484,600,241,10,210,261,90,3,11,56,49,1177,58,167,1,8,1,1,3,345,19,11,22,6,6,38,44,130,44,488,265,19,4,56,23,182,1,381,353,1,214,10,10,10,24,25,1338,1055,611,59,74,6,8,45,13,13,5,133,152,86,235,26,19,1,1,8,75,23,89,17,47,622,200,4,271,1757,1,18,341,13,33,9,13,88,40,3,130,92,77,166,62,561,9,83,482,7,1,1,37,69,69,6,2,37,8,45,41,38,39,1,1,41,63,814,64,238,11,26,448,1,101,16,139,723,2,1,317,16,5,3,49,7,1,23,1,195,275,234,7,1,78,9,3,10,426,14,25,23,8,8,8,19,28,1,503,503,85,18,597,243,10,22,104,5,152,5,7,1,29,98,4,879,1,469,67,43,39,183,1167,1309,69,27,71,1,8,43,5,6,3,8,8,198,31,48,10,698,731,7,1,13,689,563,123,365,361,816,2438,971,996,1000,987,478],[139,443,139,474,812,247,370,364,373,288,822,607,1010,528,305,147,147,147,647,291,1162,1309,645,1760,1317,2524,1208,317,484,1109,329,368,670,291,2365,262,500,473,423,583,558,551,573,551,336,343,428,446,2598,311,1120,779,1146,1047,576,319,836,514,289,1419,344,368,364,520,678,657,381,926,935,931,778,302,1639,302,601,1011,971,872,428,1010,1058,329,3390,1070,462,597,533,734,748,513,191,477,2159,412,154,951,991,370,618,126,126,2081,597,831,351,349,455,505,1000,363,1985,1716,430,445,427,396,383,333,1034,805,3056,2284,2371,859,1207,242,702,656,411,688,377,858,863,465,588,141,358,867,565,446,608,383,373,487,307,501,323,314,348,358,799,1022,736,2335,695,681,197,448,283,317,555,817,331,238,354,372,478,478,592,573,538,639,590,573,754,349,847,914,623,551,620,561,1065,700,497,123,310,290,1258,2005,2279,507,1085,745,748,132,755,584,404,485,860,907,824,807,77,333,2607,295,251,414,1855,4904,5588,146,1180,257,233,690,460,791,397,282,397,1414,2206,644,481,2089,2105,793,782,803,507,531,365,369,229,232,219,482,440,290,544,308,276,664,715,149,1035,272,269,346,504,250,699,737,326,345,326,306,1247,577,549,549,1073,1117,1064,949,738,367,231,556,597,354,466,698,436,429,1295,430,557,229,229,232,229,424,564,683,417,555,475,452,477,112,399,475,571,364,480,206,352,1755,517,327,567,573,546,647,368,207,363,365,366,1696,1348,1511,194,265,194,2644,309,487,487,368,325,380,279,435,826,556,1073,299,270,381,466,510,356,394,713,420,1004,358,3186,400,1102,798,637,463,1812,334,387,300,687,347,284,257,289,233,739,1815,455,676,145,370,375,293,248,348,290,87,311,276,264,110,107,108,127,124,112,555,1194,197,672,745,385,950,415,553,262,1119,1221,389,338,612,449,414,430,161,598,305,525,426,709,801,738,355,670,256,258,429,191,612,186,188,100,109,109,109,413,348,496,722,722,244,330,984,656,333,179,240,277,390,257,70,246,435,544,155,1464,523,2954,2502,1074,711,759,1784,2068,300,459,544,119,291,271,333,685,328,882,884,380,942,1605,120,1230,1263,311,205,528,814,748,666,566,588,2116,2918,1277,1424,1417,1379,1141],[1137,86,121,226,1,159,158,6,7,12,410,311,410,31,3,1,1,1,71,12,12,22,81,1977,1974,1533,1983,1,12,844,960,26,3,80,569,6,540,245,4,102,9,37,19,37,6,3,2,6,1,11,416,285,12,2,6,13,6,1,1,570,66,69,69,1,141,141,42,24,22,35,1,1,1,29,1,1,455,3,6,53,10,20,550,656,166,163,465,15,12,19,2,182,181,141,1,1140,261,1,1,1,1,1046,417,417,10,22,58,9,552,169,1588,1598,11,12,38,12,23,13,687,679,1,1264,1264,60,275,20,325,65,1,14,10,8,8,10,202,17,20,1050,1,1,5,6,41,1,1,40,1,1,1,1,693,1,528,7,1,1,22,1,113,23,1,638,1,3,2,2,1,1,480,485,477,480,79,524,137,436,90,386,25,241,209,272,9,308,311,1,10,4,35,38,39,36,1272,5,5,66,535,476,27,172,64,51,2,2,13,50,3,37,1,6,1962,4024,4415,1,8,5,3,5,227,389,55,62,17,546,574,20,7,804,801,1,1,1,108,90,1,1,3,3,6,157,31,30,4,4,85,772,14,1,211,1,8,21,112,263,93,61,9,12,9,19,1,3,3,3,758,756,726,724,93,5,5,282,278,16,2,3,49,49,839,4,90,1,7,1,1,4,24,18,10,14,5,5,5,24,47,49,727,709,6,1,61,16,24,1,341,316,1,104,39,39,39,13,15,181,223,555,76,16,22,57,10,7,7,4,372,334,371,364,10,22,1,115,16,16,29,102,30,25,352,330,4,321,1,1,8,343,5,20,14,48,77,121,1,25,29,27,112,35,463,154,988,1818,2,1,1,10,1,1,10,28,5,10,180,65,65,65,11,11,27,232,1124,188,1,10,7,143,1,39,5,1,625,4,1,155,17,9,4,9,12,1,4,96,4,26,25,6,1,53,5,4,8,245,3,2,22,4,4,4,28,19,1,8,8,1432,319,655,921,21,34,1,8,7,7,9,1,13,16,16,1,1,35,67,9,9,1,761,696,108,46,55,1,13,59,3,52,2,4,4,360,34,4,72,474,474,7,1,16,150,493,186,478,458,30,800,1,2,2,1,30],[1283,333,251,310,820,407,553,345,370,297,755,712,733,525,303,147,147,147,550,301,1161,1162,562,2354,2350,2352,2347,317,498,1311,1276,360,697,330,2467,263,688,329,422,397,412,566,566,566,329,335,439,452,2585,322,681,645,259,1017,227,324,226,525,243,1494,400,415,418,481,471,471,387,909,908,907,285,285,1646,313,585,966,830,767,288,1057,1060,344,3191,1301,592,595,966,729,730,461,193,464,463,463,154,1308,801,376,376,125,125,1254,639,639,364,329,451,484,900,340,1902,1902,432,439,436,400,363,334,1002,812,562,1924,1924,748,1241,258,441,677,399,645,384,809,809,464,466,106,315,1622,496,449,436,354,311,490,309,427,319,319,240,240,995,1012,755,2325,537,543,195,449,268,316,514,808,331,241,350,351,499,499,759,759,759,759,515,824,547,677,748,826,680,531,546,531,1085,483,582,123,307,292,316,539,258,457,1539,695,694,167,831,671,403,426,719,718,797,797,75,340,798,152,251,400,2176,5008,5008,118,1136,191,191,696,367,720,368,309,394,1226,1228,581,467,1848,1848,785,785,785,418,405,369,369,226,226,224,246,162,314,363,292,261,1129,705,149,1123,284,266,258,557,501,703,703,338,340,338,283,1261,464,464,464,1207,1206,1175,1175,231,127,219,621,621,280,470,765,434,434,957,331,491,229,229,229,229,428,237,581,426,536,475,455,450,92,284,457,810,810,453,205,355,1773,362,326,528,528,528,540,394,236,389,355,357,502,502,1389,218,218,218,2733,274,493,493,378,561,561,561,561,790,533,1093,365,277,298,473,536,354,378,443,569,998,408,1478,421,1080,795,626,451,1878,381,378,381,717,200,214,206,203,201,640,2018,1383,2018,138,361,363,266,178,222,295,112,285,289,412,133,133,133,136,133,97,725,1500,310,409,750,361,650,442,494,244,989,1103,426,338,449,462,450,454,123,551,301,526,526,524,534,526,353,674,231,234,420,189,432,176,164,99,105,105,105,470,385,549,227,227,1584,628,1083,1376,344,190,137,278,252,261,71,244,420,429,167,586,531,2493,2490,972,642,580,1408,1423,295,490,517,120,274,294,330,690,351,841,841,549,974,1529,173,1007,1007,271,205,526,275,683,683,682,683,1310,1313,315,411,406,415,714],[7e-10,8.909999999999999e-32,3.42e-19,5.190000000000001e-29,0,5.409999999999999e-23,1.22e-25,2.98e-84,1.59e-100,1.19e-107,3.77e-134,1.1e-130,3.65e-148,1.23e-162,0,1.15e-97,7.97e-100,1.24e-99,2.37e-160,3.84e-155,0,0,2.789999999999999e-145,1.36e-149,2.37e-140,1.44e-153,3.64e-40,1.23e-134,1.46e-136,2.18e-141,1.1e-50,8.13e-76,0,6.059999999999999e-89,0,3.46e-125,3.4e-66,2.7e-31,0,1.12e-101,7.49e-140,0,0,0,2.77e-157,9.409999999999998e-145,2.539999999999999e-159,3.669999999999999e-159,0,1.73e-135,1.83e-46,4.82e-118,1.27e-30,0,6.02e-10,2.31e-102,4.12e-07,4.869999999999999e-106,1.71e-54,0,2.58e-19,8.98e-16,2.73e-16,0,1.68e-56,1.52e-52,0,0,0,0,3.58e-103,2.16e-99,0,1.23e-96,3.3e-125,0,7.659999999999998e-119,0,2.55e-75,0,0,4.459999999999999e-152,0,1.19e-62,1.33e-56,2.33e-156,2.14e-78,0,0,0,2.58e-30,6.04e-88,5.98e-72,8.440000000000001e-91,3.52e-101,4.11e-32,3.39e-132,9.749999999999999e-137,1.44e-129,9.829999999999999e-81,2.91e-80,2.06e-45,3.07e-61,3.03e-67,1.53e-124,2.35e-133,0,8.000000000000001e-66,7.45e-131,5.01e-59,1.59e-96,3.53e-91,2.49e-60,3.55e-67,0,1.63e-174,1.04e-63,6.909999999999999e-48,3.64e-82,3.23e-47,0,3.54e-126,1.52e-122,0,0,3.7e-110,3.41e-41,6.499999999999999e-180,0,4.39e-109,1.05e-148,0,0,6.529999999999999e-135,1.55e-22,2.75e-49,3.799999999999999e-120,1.49e-84,0,0,0,1.12e-77,4.01e-95,0,0,9.1e-78,0,0,1.45e-20,6.88e-38,4.42e-128,0,1.76e-30,0,1.2e-135,5.07e-123,5.559999999999999e-48,0,1.4e-18,1.43e-119,1.91e-116,5.619999999999999e-45,0,9.199999999999998e-102,0,0,0,0,5.519999999999999e-159,4.13e-132,8.279999999999999e-148,3.45e-154,8.92e-92,7.839999999999999e-61,2.38e-52,5.22e-14,9.31e-149,5.1e-60,4.58e-124,1.72e-40,1.55e-51,3.67e-45,0,1.09e-23,2.87e-69,1.15e-42,1.54e-146,2.53e-168,8.799999999999999e-44,6.03e-123,2.27e-48,0,2.77e-66,0,0,1.09e-09,5.939999999999999e-52,2.07e-50,5.139999999999999e-173,8.22e-39,0,0,0,0,8.14e-17,4.86e-31,8.319999999999998e-107,2.51e-11,6.05e-109,1.78e-131,6.15e-21,0,0,1.71e-47,0,7.38e-29,7.93e-29,0,4.799999999999999e-58,1.92e-92,4.14e-94,3.64e-07,3.9e-135,0,0,0,4.909999999999999e-129,0,0,0,0,0,9.469999999999999e-66,7.54e-74,0,0,6.66e-102,2.16e-97,9.660000000000001e-77,4.5e-46,1.91e-14,1.47e-75,5.43e-68,1.97e-80,3.37e-70,8.879999999999999e-67,0,3.84e-104,0,4.56e-75,3.47e-114,9.01e-124,1.12e-52,8.2e-32,8.669999999999998e-180,1.04e-143,2.49e-115,4.63e-104,3.3e-115,5.89e-67,0,4.27e-39,2.97e-39,2.35e-35,0,0,7.369999999999999e-177,7.579999999999999e-178,8.84e-39,2.37e-24,8.07e-44,3.619999999999999e-87,1.68e-117,1.65e-105,0,2.26e-97,9.149999999999999e-138,2.02e-137,4.05e-39,2.56e-103,8.389999999999999e-115,1.75e-132,1.54e-112,8.409999999999999e-116,8.83e-135,7.349999999999999e-143,2.65e-67,1.28e-80,6.699999999999999e-43,6.619999999999999e-23,7.049999999999999e-143,3.22e-152,5.36e-174,1.05e-06,5.75e-53,1.84e-125,1.71e-16,7.23e-15,1.65e-34,5.159999999999999e-99,1.6e-133,0,5.489999999999999e-96,0,4.05e-92,6.01e-93,2.43e-99,1.29e-163,0,5.399999999999999e-119,0,2.34e-120,4.529999999999999e-109,3.56e-95,9.039999999999999e-88,2.18e-83,3.37e-12,1.22e-12,5.27e-16,0,0,0,0,2.86e-62,1.09e-89,2.82e-92,6.1e-90,5.42e-92,0,5.56e-65,0,4.8e-104,5.5e-85,3.32e-108,6.6e-147,1.08e-130,2.92e-69,0,3.11e-28,5.75e-51,0,2.85e-27,0,3.63e-138,0,1.2e-117,0,0,0,3.28e-145,1.6e-152,3.48e-135,0,3.83e-14,3.06e-28,1.22e-25,6.92e-11,2.89e-24,1.81e-67,0,1.06e-42,4.16e-57,2.75e-65,1.98e-92,1.03e-91,1.77e-114,7.819999999999999e-42,2.72e-47,1.8e-150,8.51e-18,9.729999999999999e-94,2.73e-72,9.429999999999999e-16,1.5e-09,9.489999999999999e-09,6.03e-09,1.24e-74,3.859999999999999e-74,2.18e-08,0,1.21e-72,1.61e-06,1.61e-112,9.999999999999999e-149,5.21e-82,0,4.999999999999999e-178,0,8.25e-120,0,4.41e-122,1.72e-115,7.609999999999998e-176,9.449999999999999e-140,9.92e-58,1.1e-85,2.71e-64,4.12e-08,2.36e-59,9.079999999999999e-127,0,1.08e-174,0,1.73e-124,4.66e-117,6.719999999999999e-144,0,1.58e-79,1.53e-56,4.249999999999999e-169,5.64e-79,1.21e-46,1.27e-55,3.2e-57,4.29e-28,2.11e-25,1.28e-26,1.28e-26,5.01e-114,3.24e-115,1.14e-36,4.93e-34,4.93e-34,7.98e-44,2.19e-52,8.4e-54,3.81e-69,0,4.939999999999999e-48,4.95e-44,7.6e-103,4.67e-60,2.11e-57,1.35e-15,4.229999999999999e-116,1.53e-149,1.52e-148,1.83e-91,0,0,0,0,0,0,0,3.35e-120,3.66e-137,1.11e-14,0,0,8.57e-17,3e-99,1.42e-95,5.95e-150,0,1.12e-154,0,0,3.54e-23,0,0,5.34e-15,3.789999999999999e-165,1.96e-164,5.06e-33,1.79e-150,0,1.93e-06,3.72e-39,1.68e-81,7.07e-43,1.59e-65,0,2e-69,5.07e-90,9.59e-77,8.51e-78,2.46e-53,3.33e-70],[61.2,130,95.5,117,841,99.8,108,286,335,355,447,408,488,472,574,277,283,282,483,436,1652,1684,434,511,474,533,163,442,409,459,181,238,721,270,1363,385,233,124,639,314,414,638,611,638,488,437,494,493,2281,387,179,370,127,1169,61.6,303,53.1,344,203,975,94.7,83.2,84.7,524,200,189,532,976,973,751,327,306,1558,288,406,575,401,845,239,814,1442,432,2290,233,201,461,265,790,882,595,122,276,249,282,293,135,457,394,385,233,232,181,214,236,362,383,633,239,418,194,348,330,222,242,573,507,208,165,288,184,633,442,432,1000,817,330,157,527,644,345,425,967,840,397,102,166,350,298,896,782,781,254,297,635,588,251,618,612,90.09999999999999,137,436,1041,130,4484,439,401,167,771,85.90000000000001,347,355,174,562,296,628,603,635,635,473,403,442,463,292,226,199,74.7,485,227,382,162,197,176,694,106,232,136,415,471,174,421,191,563,245,769,710,61.6,201,192,489,147,570,614,1028,1027,87.40000000000001,130,362,65.5,321,384,101,677,684,150,1084,110,109,654,197,306,291,51.6,411,708,743,603,384,1148,1171,856,814,748,236,261,587,578,295,283,231,160,76.59999999999999,273,250,246,223,239,1278,294,748,241,330,357,196,132,529,442,339,311,339,217,691,150,150,139,595,572,549,548,145,99.8,159,282,363,311,518,317,449,444,159,323,350,378,327,336,384,420,221,293,172,105,453,476,530,48.1,186,373,84,79.7,136,286,387,1323,296,637,293,295,311,479,538,348,545,405,364,340,316,306,64.3,66.59999999999999,74.7,1971,504,613,613,208,290,303,288,303,743,228,1516,314,270,342,467,428,222,512,118,196,1428,111,1091,429,1323,374,735,658,838,416,436,389,546,70.90000000000001,108,101,63.2,102,234,614,169,210,195,299,296,333,145,160,438,82.8,280,224,77,56.6,54.3,54.7,218,217,52.8,631,266,49.7,349,452,256,569,506,679,343,888,405,343,496,415,198,269,214,52.8,214,380,622,499,543,399,374,411,872,246,181,484,236,177,174,178,104,93.2,96.3,96.3,342,340,153,130,130,163,183,204,245,587,171,157,308,196,185,77.40000000000001,336,455,433,263,950,679,3088,3036,625,573,873,425,480,75.09999999999999,652,738,71.2,292,286,497,592,437,723,732,101,879,1528,75.5,519,518,137,417,633,52.8,154,271,163,226,669,259,300,262,265,194,250],[680,29,29,55,750,750,750,5289,5289,5289,497,497,497,52,409,819,819,819,228,298,148,148,282,319,319,319,319,7625,399,1035,1035,43,115,178,598,161,7433,539,719,22,237,291,291,291,196,196,196,196,268,64,249,337,16,269,102,102,102,148,148,356,578,578,578,117,117,117,484,637,637,637,99,99,1024,183,214,214,153,284,79,1497,1497,489,478,247,149,149,571,109,109,242,254,28,28,28,272,38,392,1423,1423,2881,2881,233,22,22,80,2070,201,644,644,0,514,514,397,397,280,58,91,91,298,298,23,205,205,834,524,502,71,53,360,34,33,518,518,499,499,6651,565,947,160,1765,1765,187,314,707,231,99,880,880,337,337,368,368,289,2762,478,478,340,294,567,75,319,203,83,1964,508,508,147,147,207,207,207,207,148,230,230,230,230,230,243,83,83,83,534,248,248,84,66,985,480,480,480,137,163,340,340,0,901,901,94,398,375,375,350,350,103,20,34,237,237,277,222,2237,2237,126,189,445,445,207,3769,48,515,515,41,197,197,29,58,1570,1570,335,335,335,202,202,341,341,622,622,622,84,1015,1015,1015,111,116,559,2112,1366,77,316,290,278,94,94,204,204,144,144,144,102,216,186,186,186,511,511,511,511,58,56,54,111,111,1503,76,88,206,206,206,2417,288,204,204,204,204,272,136,1326,1326,20,135,135,135,791,11,69,202,202,185,90,485,578,140,1060,1001,1001,1001,273,417,417,417,422,422,232,232,73,17,17,17,175,915,469,469,43,489,489,489,489,90,217,366,259,689,689,1545,1545,267,267,291,262,289,678,193,201,664,1170,827,480,1081,99,99,99,84,7,859,859,256,256,12,51,51,51,1069,181,181,116,193,193,34,95,561,561,108,271,271,271,0,0,0,405,904,181,17,436,263,311,156,210,101,126,69,48,196,119,118,118,118,862,14,440,99,99,99,85,85,37,177,314,834,211,115,15,9,9,6829,5,5,5,84,49,2523,0,0,0,22,2,146,160,105,83,168,112,112,112,179,522,413,891,951,1317,705,705,296,296,351,1619,1619,1029,1029,193,220,168,399,705,2123,2334,332,332,266,483,246,10,352,352,324,268,null,null,null,null,null,null,null,null,null,null,null,null,null],[1134,35,35,187,956,956,956,2639,2639,2639,555,555,555,62,350,809,809,809,369,240,145,145,377,202,202,202,202,4171,247,227,227,24,80,320,440,104,4654,597,967,0,46,227,227,227,271,271,271,271,255,20,409,430,82,232,392,392,392,79,79,299,364,364,364,138,138,138,226,785,785,785,94,94,1091,268,456,456,389,270,137,1627,1627,1246,1061,226,375,375,229,53,53,279,232,82,82,82,168,70,205,1063,1063,2572,2572,167,39,39,112,1357,240,619,619,0,852,852,503,503,456,79,90,90,267,267,0,304,304,530,347,584,51,33,341,72,20,483,483,732,732,6418,508,477,231,832,832,84,294,609,300,183,648,648,246,246,531,531,161,1535,332,332,160,373,701,208,494,197,197,830,327,327,72,72,454,454,454,454,33,300,300,300,300,300,325,113,113,113,676,56,56,102,19,906,428,428,428,168,238,360,360,10,700,700,89,475,156,156,268,268,133,33,0,206,206,467,97,2037,2037,241,59,326,326,222,3823,8,711,711,17,260,260,16,19,1276,1276,390,390,390,258,258,193,193,780,780,780,130,557,557,557,286,107,550,3869,1526,56,338,328,597,99,99,212,212,166,166,166,70,240,53,53,53,936,936,936,936,118,118,17,240,240,746,324,155,258,258,258,3847,171,116,116,116,116,144,164,1056,1056,28,44,44,44,638,29,83,556,556,374,80,596,1053,138,795,2201,2201,2201,232,254,254,254,392,392,76,76,60,33,33,33,178,600,320,320,154,881,881,881,881,279,1210,174,159,498,498,894,894,148,148,191,106,282,389,64,253,751,2365,721,1220,698,117,117,117,165,0,885,885,134,134,89,128,128,128,764,93,93,204,208,208,18,85,639,639,27,70,70,70,0,0,0,372,733,253,0,839,309,575,82,148,337,103,14,25,152,154,124,124,124,69,36,434,76,76,76,65,65,92,98,327,956,125,100,0,71,71,2923,0,0,0,22,12,2675,0,0,220,6,40,512,171,177,87,152,217,217,217,152,1019,632,583,775,1156,879,879,301,301,304,1318,1318,393,393,158,125,156,344,496,2023,1667,217,217,248,626,420,51,402,402,375,200,null,null,null,null,null,null,null,null,null,null,null,null,null],[1793,160,160,258,1661,1661,1661,2552,2552,2552,420,420,420,134,1116,1318,1318,1318,452,1205,726,726,251,263,263,263,263,1321,379,1217,1217,33,447,313,1347,185,2525,3064,2030,7,13,1256,1256,1256,427,427,427,427,975,50,787,1544,42,436,324,324,324,176,176,562,1496,1496,1496,349,349,349,1604,1248,1248,1248,228,228,777,181,420,420,568,514,193,2211,2211,1565,1345,379,357,357,607,453,453,265,279,128,128,128,538,183,446,2156,2156,9374,9374,293,104,104,169,3172,328,419,419,0,612,612,541,541,414,212,73,73,530,530,46,778,778,935,458,313,47,56,805,169,63,336,336,800,800,5894,740,730,329,1661,1661,529,523,1081,483,267,2011,2011,442,442,1320,1320,773,2694,397,397,667,636,847,190,415,182,265,2558,1365,1365,313,313,1071,1071,1071,1071,57,481,481,481,481,481,858,261,261,261,1085,338,338,461,32,1857,589,589,589,324,345,476,476,6,1092,1092,145,465,915,915,385,385,238,78,31,189,189,954,222,3124,3124,327,362,2140,2140,515,40983,120,422,422,78,453,453,114,238,1407,1407,290,290,290,660,660,1850,1850,1377,1377,1377,609,1050,1050,1050,171,49,2256,3979,990,223,560,488,790,338,338,295,295,194,194,194,148,506,382,382,382,1743,1743,1743,1743,65,182,130,878,878,1033,204,327,829,829,829,1413,439,497,497,497,497,217,275,1272,1272,28,157,157,157,831,177,250,31,31,454,181,934,1351,203,3533,2068,2068,2068,1402,775,775,775,533,533,490,490,99,99,99,99,411,1338,326,326,227,4816,4816,4816,4816,237,273,541,289,845,845,477,477,698,698,354,425,248,1074,86,368,1277,2620,821,1110,852,194,194,194,172,0,4396,4396,558,558,32,419,419,419,2120,599,599,695,1172,1172,207,248,574,574,40,71,71,71,0,0,0,333,732,219,14,1314,334,729,195,431,607,305,136,149,303,191,158,158,158,305,102,580,295,295,295,385,385,211,460,1741,1612,235,258,42,191,191,1875,0,0,0,112,15,2856,0,0,0,68,0,279,265,279,98,194,341,341,341,410,514,552,545,1760,3146,1578,1578,463,463,645,508,508,429,429,413,290,309,887,874,1789,3284,1168,1168,200,1395,302,54,639,639,457,438,null,null,null,null,null,null,null,null,null,null,null,null,null],[577,29,29,99,976,976,976,5424,5424,5424,225,225,225,42,280,681,681,681,99,186,107,107,167,844,844,844,844,14864,121,219,219,0,19,66,296,119,10805,835,717,0,13,202,202,202,56,56,56,56,146,50,268,415,33,227,207,207,207,107,107,297,420,420,420,130,130,130,259,511,511,511,0,0,748,104,207,207,219,176,91,1038,1038,312,470,110,265,265,536,55,55,124,232,52,52,52,441,29,221,616,616,3370,3370,129,0,0,110,3058,175,988,988,51,755,755,504,504,174,52,61,61,188,188,0,112,112,460,287,568,58,49,345,26,6,310,310,688,688,3656,815,899,78,1762,1762,79,356,773,104,96,441,441,398,398,146,146,123,1219,602,602,228,273,533,157,429,356,121,822,230,230,68,68,278,278,278,278,499,368,368,368,368,368,172,109,109,109,359,135,135,126,40,1399,315,315,315,166,158,497,497,6,946,946,115,289,139,139,454,454,115,50,0,180,180,273,165,1401,1401,120,75,405,405,176,8927,26,509,509,22,747,747,81,124,1750,1750,518,518,518,141,141,226,226,1720,1720,1720,73,333,333,333,11,335,765,2263,854,51,849,364,208,92,92,111,111,143,143,143,66,160,45,45,45,256,256,256,256,130,77,0,69,69,1682,66,639,134,134,134,1389,142,36,36,36,36,376,241,1154,1154,37,14,14,14,1288,78,64,127,127,177,57,155,297,88,772,1489,1489,1489,154,134,134,134,133,133,52,52,34,63,63,63,86,1523,496,496,21,674,674,674,674,47,192,137,98,338,338,1689,1689,152,152,238,216,444,236,8,218,462,1867,641,808,1115,95,95,95,42,0,536,536,104,104,14,31,31,31,552,181,181,76,243,243,20,88,1488,1488,54,286,286,286,0,0,0,777,923,136,26,411,886,369,91,432,225,76,26,17,284,154,52,52,52,1213,12,505,67,67,67,36,36,43,91,185,391,75,92,15,22,22,7128,0,0,0,55,0,1527,16,16,0,35,0,37,81,109,83,42,85,85,85,153,1102,454,741,1070,1387,543,543,217,217,240,2408,2408,1121,1121,159,114,338,601,421,1524,4113,149,149,273,311,87,28,421,421,122,180,null,null,null,null,null,null,null,null,null,null,null,null,null],[1023,197,197,157,1637,1637,1637,1371,1371,1371,475,475,475,155,818,1288,1288,1288,467,1070,370,370,215,100,100,100,100,807,365,536,536,69,207,162,605,176,1986,4360,1164,40,28,519,519,519,332,332,332,332,689,12,512,1352,73,346,786,786,786,99,99,437,1357,1357,1357,435,435,435,1468,1046,1046,1046,134,134,593,236,124,124,579,307,395,1681,1681,1576,1311,121,372,372,386,327,327,333,243,85,85,85,630,153,331,1998,1998,7398,7398,188,102,102,192,4212,178,289,289,0,560,560,339,339,724,192,162,162,320,320,0,461,461,973,376,322,58,74,742,207,39,540,540,457,457,5319,1004,536,272,1102,1102,244,398,1117,426,304,1781,1781,433,433,748,748,345,1459,458,458,755,462,780,185,210,107,212,2321,752,752,197,197,986,986,986,986,31,53,53,53,53,53,702,273,273,273,645,332,332,420,16,1596,440,440,440,221,180,240,240,4,604,604,68,319,474,474,207,207,215,19,21,222,222,764,56,1815,1815,730,189,941,941,462,38648,51,484,484,33,379,379,84,198,876,876,312,312,312,392,392,717,717,1581,1581,1581,634,951,951,951,265,51,1587,2505,920,103,428,482,937,426,426,327,327,285,285,285,85,384,160,160,160,930,930,930,930,53,236,210,702,702,692,142,218,339,339,339,461,288,568,568,568,568,106,195,1070,1070,34,75,75,75,380,124,218,79,79,359,160,1118,763,298,3479,1613,1613,1613,1410,471,471,471,371,371,243,243,68,56,56,56,170,341,320,320,546,9516,9516,9516,9516,541,351,364,401,634,634,314,314,543,543,280,322,261,713,46,367,792,2018,472,1307,729,191,191,191,108,10,6574,6574,247,247,0,231,231,231,2048,512,512,68,946,946,138,126,550,550,30,27,27,27,0,0,0,112,450,393,0,1318,222,804,145,445,865,289,155,111,198,170,188,188,188,267,94,604,273,273,273,225,225,130,276,1643,1361,129,248,39,225,225,993,0,0,0,50,15,1505,7,7,4,26,5,180,228,159,137,118,223,223,223,441,493,352,903,1339,2411,964,964,304,304,485,378,378,446,446,262,260,242,1416,425,1388,3552,796,796,301,1005,104,115,460,460,316,399,null,null,null,null,null,null,null,null,null,null,null,null,null],[1707,177,177,327,1260,1260,1260,2106,2106,2106,546,546,546,86,553,1036,1036,1036,431,904,512,512,312,246,246,246,246,1332,352,1484,1484,62,350,110,1236,127,4118,1087,1395,10,37,803,803,803,461,461,461,461,912,24,638,1010,92,383,557,557,557,208,208,506,1258,1258,1258,423,423,423,742,1595,1595,1595,173,173,756,196,456,456,928,341,100,2032,2032,1164,1064,197,451,451,474,265,265,239,129,136,136,136,473,150,652,1251,1251,6274,6274,327,133,133,221,2985,210,448,448,17,783,783,553,553,701,154,47,47,381,381,30,667,667,1123,352,419,74,65,406,231,56,524,524,490,490,3067,715,535,305,600,600,372,528,982,375,174,1787,1787,218,218,1796,1796,399,2066,520,520,453,758,800,67,384,136,258,1368,600,600,342,342,748,748,748,748,630,1278,1278,1278,1278,1278,773,317,317,317,1219,254,254,417,51,1544,772,772,772,369,524,438,438,21,923,923,104,492,694,694,272,272,201,151,29,70,70,1118,133,3323,3323,583,480,357,357,384,36350,106,674,674,23,456,456,81,140,1999,1999,557,557,557,557,557,852,852,1121,1121,1121,480,708,708,708,73,42,1308,8139,828,194,267,441,1335,194,194,264,264,150,150,150,108,612,179,179,179,1872,1872,1872,1872,172,133,118,914,914,572,134,577,785,785,785,1186,378,443,443,443,443,341,361,1173,1173,48,161,161,161,578,108,143,112,112,314,146,518,1417,198,2275,3157,3157,3157,537,437,437,437,354,354,318,318,141,35,35,35,410,421,332,332,183,3378,3378,3378,3378,203,406,459,198,485,485,283,283,482,482,342,309,404,936,157,325,1358,1967,971,1191,1514,434,434,434,117,0,3141,3141,196,196,0,156,156,156,1156,509,509,398,991,991,60,209,855,855,48,86,86,86,0,0,1,250,664,232,22,1395,183,812,121,364,418,646,145,116,193,109,141,141,141,250,86,938,174,174,174,245,245,103,686,767,1041,127,167,46,119,119,1252,0,0,0,64,13,2391,42,42,0,39,0,400,233,408,101,136,161,161,161,262,980,1090,402,1446,3429,1452,1452,405,405,490,858,858,394,394,372,137,162,643,839,1740,2215,1135,1135,159,1327,437,88,1064,1064,380,269,null,null,null,null,null,null,null,null,null,null,null,null,null],[1970,109,109,267,1639,1639,1639,2381,2381,2381,799,799,799,152,798,1342,1342,1342,681,1214,417,417,291,181,181,181,181,2319,520,809,809,105,315,137,962,162,2892,4583,1507,0,29,1319,1319,1319,469,469,469,469,561,84,1131,1223,143,531,479,479,479,313,313,409,1489,1489,1489,436,436,436,1228,1181,1181,1181,157,157,969,443,506,506,587,530,256,2382,2382,792,1215,291,440,440,551,346,346,307,428,125,125,125,672,81,507,2677,2677,6936,6936,230,222,222,278,3034,466,621,621,0,835,835,612,612,490,199,108,108,604,604,8,671,671,1444,413,563,89,116,816,125,43,473,473,623,623,8154,804,478,306,1593,1593,264,1028,1313,706,418,1187,1187,328,328,1100,1100,697,2953,530,530,404,929,777,220,965,182,295,1876,1045,1045,272,272,927,927,927,927,118,729,729,729,729,729,968,250,250,250,1167,421,421,346,33,1644,422,422,422,250,456,530,530,5,981,981,74,370,828,828,433,433,468,98,37,138,138,796,238,3022,3022,274,287,1598,1598,729,35652,254,811,811,158,504,504,77,73,1362,1362,313,313,313,579,579,1279,1279,1511,1511,1511,473,1022,1022,1022,221,62,1094,4964,1184,248,380,553,510,362,362,445,445,225,225,225,67,334,182,182,182,1580,1580,1580,1580,17,169,101,774,774,1746,235,342,717,717,717,1594,444,294,294,294,294,313,389,1445,1445,60,127,127,127,1502,101,384,103,103,417,238,1479,1622,151,2817,2836,2836,2836,1430,629,629,629,519,519,355,355,76,44,44,44,416,706,548,548,76,5164,5164,5164,5164,301,335,487,427,1029,1029,806,806,418,418,382,252,391,1405,97,575,1103,2372,986,962,1070,438,438,438,193,0,3044,3044,538,538,31,192,192,192,2460,588,588,510,697,697,65,214,597,597,55,77,77,77,0,0,0,409,673,396,20,1589,199,781,234,423,581,349,140,128,193,275,136,136,136,275,125,622,156,156,156,250,250,261,482,1085,1511,180,392,29,44,44,5405,2,2,2,78,24,3486,0,0,0,50,14,225,349,322,187,185,332,332,332,410,911,678,740,1928,2605,1636,1636,634,634,824,781,781,519,519,359,236,267,1311,709,2000,2622,887,887,426,1257,265,84,692,692,374,383,null,null,null,null,null,null,null,null,null,null,null,null,null],[1405,58,58,184,2185,2185,2185,2321,2321,2321,467,467,467,83,588,1592,1592,1592,490,462,355,355,306,235,235,235,235,2786,530,509,509,19,410,356,1175,189,4105,1185,1396,31,35,464,464,464,449,449,449,449,568,108,765,542,81,750,233,233,233,398,398,665,1117,1117,1117,224,224,224,775,1508,1508,1508,171,171,1045,337,694,694,403,384,134,2470,2470,1769,1026,425,347,347,651,177,177,443,432,116,116,116,519,714,499,1884,1884,6377,6377,179,67,67,197,3910,303,674,674,0,756,756,678,678,402,174,99,99,712,712,13,560,560,829,587,724,133,57,732,196,80,442,442,837,837,8023,469,610,311,2082,2082,216,304,1064,332,235,1588,1588,366,366,953,953,439,2944,467,467,295,563,991,224,347,183,273,2562,716,716,246,246,733,733,733,733,89,399,399,399,399,399,665,240,240,240,817,350,350,347,58,1256,945,945,945,345,276,506,506,0,1094,1094,156,516,584,584,364,364,237,51,45,150,150,781,235,3196,3196,249,417,967,967,369,23609,179,482,482,114,204,204,60,111,1438,1438,278,278,278,710,710,769,769,2157,2157,2157,225,1416,1416,1416,256,101,1712,3644,1735,160,272,377,1243,364,364,486,486,191,191,191,164,335,218,218,218,1245,1245,1245,1245,70,458,85,566,566,1796,124,293,377,377,377,4086,355,751,751,751,751,136,391,1088,1088,63,109,109,109,1176,90,128,330,330,377,132,1033,1422,233,2588,2302,2302,2302,656,608,608,608,822,822,321,321,136,27,27,27,404,1414,701,701,183,3962,3962,3962,3962,103,1302,432,274,1188,1188,852,852,561,561,248,132,453,1350,43,455,1251,2594,884,709,1058,138,138,138,217,11,1806,1806,358,358,0,352,352,352,1790,290,290,289,652,652,82,255,740,740,55,238,238,238,0,0,1,522,541,299,19,1326,376,562,241,453,387,272,206,110,285,193,130,130,130,1448,56,839,128,128,128,79,79,203,277,671,1738,304,233,63,159,159,4706,0,0,0,143,58,4048,15,15,34,32,33,357,331,226,283,242,283,283,283,400,498,595,840,1477,3952,1338,1338,554,554,741,806,806,988,988,283,217,300,694,924,2827,3138,596,596,227,1062,415,72,770,770,596,357,null,null,null,null,null,null,null,null,null,null,null,null,null],[1137,83,83,270,960,960,960,2271,2271,2271,401,401,401,133,573,651,651,651,407,919,270,270,225,328,328,328,328,3612,288,747,747,82,125,125,443,142,3650,3268,974,28,51,472,472,472,215,215,215,215,280,39,534,563,54,273,175,175,175,130,130,499,690,690,690,206,206,206,419,1100,1100,1100,88,88,1235,289,242,242,372,343,153,1809,1809,565,686,344,353,353,655,105,105,264,286,98,98,98,407,47,390,1614,1614,7007,7007,180,12,12,101,2891,209,819,819,0,792,792,388,388,698,176,109,109,302,302,0,416,416,993,440,487,83,43,536,73,38,500,500,1039,1039,9619,770,400,260,1615,1615,91,617,1120,342,138,648,648,397,397,590,590,274,1828,372,372,160,543,805,119,492,253,110,1208,353,353,113,113,388,388,388,388,162,509,509,509,509,509,495,253,253,253,861,169,169,161,63,1553,221,221,221,254,273,593,593,3,621,621,26,253,454,454,330,330,146,103,34,134,134,688,168,2372,2372,140,223,885,885,240,17944,71,697,697,82,411,411,44,87,1214,1214,327,327,327,224,224,516,516,918,918,918,118,614,614,614,211,99,551,4251,1067,141,534,574,294,319,319,307,307,283,283,283,115,258,180,180,180,960,960,960,960,65,108,128,192,192,1545,132,293,354,354,354,1001,223,190,190,190,190,347,307,1301,1301,75,58,58,58,946,29,104,145,145,368,189,662,697,126,2127,2009,2009,2009,822,315,315,315,194,194,68,68,66,34,34,34,210,1180,394,394,328,891,891,891,891,106,244,486,221,553,553,711,711,315,315,317,163,197,268,41,441,1136,1635,793,1160,922,233,233,233,141,0,1304,1304,228,228,0,46,46,46,1179,263,263,171,401,401,57,66,839,839,21,201,201,201,0,0,0,319,728,380,33,876,195,691,119,318,397,165,78,88,197,153,195,195,195,257,67,473,109,109,109,80,80,59,166,511,1086,271,76,136,65,65,5222,0,0,0,103,22,2258,10,10,8,42,0,118,205,188,106,76,179,179,179,169,770,546,945,957,1976,866,866,407,407,651,1003,1003,538,538,177,204,260,656,262,1687,2679,246,246,299,600,158,55,506,506,205,309,null,null,null,null,null,null,null,null,null,null,null,null,null],[1641,234,234,156,2073,2073,2073,2667,2667,2667,758,758,758,164,858,2167,2167,2167,385,933,576,576,553,315,315,315,315,4714,719,622,622,48,409,454,1199,225,5414,1718,1356,23,84,1128,1128,1128,590,590,590,590,681,85,797,849,40,506,310,310,310,310,310,747,1224,1224,1224,390,390,390,744,1605,1605,1605,127,127,1351,720,406,406,703,673,175,2774,2774,588,1044,406,409,409,899,137,137,369,503,103,103,103,832,164,701,2068,2068,7424,7424,397,98,98,299,2942,725,1256,1256,0,817,817,774,774,856,195,84,84,845,845,0,657,657,1669,1023,921,175,115,1089,165,50,599,599,732,732,9369,896,618,258,2884,2884,370,795,1581,536,191,1639,1639,326,326,1003,1003,349,4861,676,676,232,1870,1320,57,358,405,282,2640,793,793,366,366,1087,1087,1087,1087,214,459,459,459,459,459,784,354,354,354,1409,399,399,163,40,2278,792,792,792,280,574,671,671,0,1635,1635,148,740,734,734,780,780,345,145,82,238,238,1089,286,3801,3801,239,392,323,323,440,56200,204,874,874,72,413,413,136,108,2536,2536,385,385,385,582,582,534,534,1435,1435,1435,185,1301,1301,1301,119,83,1805,5522,1949,339,342,551,903,595,595,454,454,327,327,327,101,571,104,104,104,1276,1276,1276,1276,45,325,74,256,256,2099,203,364,511,511,511,1832,464,541,541,541,541,316,405,2273,2273,42,146,146,146,1881,46,211,441,441,497,108,491,1561,142,2420,2551,2551,2551,771,794,794,794,685,685,334,334,156,51,51,51,459,1810,975,975,50,5074,5074,5074,5074,159,1933,648,401,809,809,1261,1261,415,415,665,325,464,688,111,424,1936,2428,1288,875,1494,442,442,442,177,5,1258,1258,415,415,21,239,239,239,1588,447,447,363,566,566,80,328,739,739,54,285,285,285,3,3,0,830,976,484,38,1414,359,717,205,931,258,258,127,98,281,401,242,242,242,2312,60,1193,160,160,160,121,121,194,275,519,1910,260,245,48,57,57,9831,0,0,0,85,57,4792,4,4,5,58,0,232,293,290,225,149,198,198,198,432,821,804,909,2114,3114,1678,1678,704,704,845,1456,1456,1500,1500,204,297,355,775,579,3159,3366,623,623,352,1299,510,65,1039,1039,538,633,null,null,null,null,null,null,null,null,null,null,null,null,null],[1307,22,22,151,1308,1308,1308,8612,8612,8612,311,311,311,0,586,1394,1394,1394,235,410,207,207,259,675,675,675,675,13421,496,748,748,47,101,158,505,144,10108,1637,870,6,50,421,421,421,193,193,193,193,236,64,409,503,45,273,250,250,250,194,194,376,626,626,626,120,120,120,508,871,871,871,41,41,1092,279,299,299,283,241,120,1917,1917,366,728,453,222,222,439,183,183,203,224,92,92,92,550,131,414,1628,1628,5170,5170,397,29,29,135,3306,405,931,931,0,1104,1104,935,935,351,83,113,113,465,465,0,335,335,587,699,490,21,10,636,101,22,604,604,768,768,7387,962,1014,88,2522,2522,129,421,1236,295,73,686,686,340,340,403,403,282,2301,1003,1003,767,402,993,101,252,500,318,1906,585,585,112,112,487,487,487,487,37,145,145,145,145,145,403,139,139,139,330,143,143,166,1,1396,561,561,561,98,171,501,501,0,1816,1816,79,369,674,674,790,790,164,88,97,339,339,287,297,2154,2154,299,64,449,449,374,16029,141,524,524,40,574,574,88,52,2158,2158,590,590,590,318,318,421,421,1993,1993,1993,218,913,913,913,145,305,1085,1680,1075,74,951,348,190,117,117,209,209,137,137,137,97,287,206,206,206,606,606,606,606,78,144,47,167,167,2310,87,318,317,317,317,882,174,276,276,276,276,332,290,2222,2222,31,53,53,53,1282,20,83,82,82,293,31,330,625,184,1521,1527,1527,1527,377,493,493,493,446,446,343,343,39,68,68,68,273,1337,786,786,33,2174,2174,2174,2174,157,367,303,188,386,386,2670,2670,388,388,406,230,338,2207,13,301,1121,2276,718,999,1022,196,196,196,85,0,977,977,406,406,110,298,298,298,1083,276,276,147,217,217,8,127,1351,1351,43,324,324,324,0,0,0,745,1455,123,0,647,589,273,109,521,206,132,133,38,230,243,138,138,138,469,30,689,108,108,108,85,85,129,242,374,903,195,191,63,23,23,9214,0,0,0,66,37,2740,0,0,149,17,0,135,256,247,149,82,117,117,117,177,1718,411,1022,1427,1742,788,788,297,297,420,2097,2097,1446,1446,200,231,332,611,739,1680,4079,299,299,259,821,126,4,328,328,240,286,null,null,null,null,null,null,null,null,null,null,null,null,null],[662,21,21,89,544,544,544,6023,6023,6023,296,296,296,54,397,928,928,928,157,386,147,147,232,274,274,274,274,8153,400,949,949,47,91,145,564,114,6598,1114,486,0,95,264,264,264,116,116,116,116,207,92,251,273,38,240,141,141,141,98,98,208,690,690,690,164,164,164,324,589,589,589,35,35,901,153,99,99,200,230,58,1480,1480,435,348,232,219,219,592,39,39,214,260,3,3,3,306,37,277,1189,1189,3767,3767,220,39,39,20,2858,213,1002,1002,0,518,518,382,382,407,127,25,25,230,230,30,192,192,535,332,497,67,64,638,33,25,392,392,410,410,7233,555,786,61,1861,1861,155,274,948,179,39,837,837,268,268,218,218,115,1774,392,392,323,185,690,127,312,281,105,1484,500,500,87,87,361,361,361,361,83,216,216,216,216,216,234,29,29,29,322,184,184,89,113,1255,506,506,506,111,122,237,237,0,1119,1119,75,325,398,398,364,364,79,24,0,331,331,320,113,1659,1659,81,106,279,279,182,8252,67,374,374,26,301,301,20,63,1291,1291,409,409,409,139,139,204,204,775,775,775,167,1095,1095,1095,171,130,418,1191,1364,71,435,373,264,117,117,81,81,125,125,125,116,108,101,101,101,386,386,386,386,34,157,20,110,110,1882,79,42,202,202,202,841,268,101,101,101,101,251,128,1122,1122,62,52,52,52,1036,11,83,262,262,159,96,270,472,91,1209,1027,1027,1027,271,318,318,318,221,221,143,143,28,31,31,31,94,1073,657,657,68,481,481,481,481,57,585,256,184,254,254,1762,1762,338,338,223,253,277,605,43,221,679,1095,816,372,861,74,74,74,88,0,455,455,157,157,0,40,40,40,897,151,151,104,150,150,15,147,856,856,22,388,388,388,0,0,1,586,707,141,0,329,398,273,128,364,97,129,65,44,112,173,139,139,139,319,18,565,57,57,57,39,39,40,134,186,823,161,126,29,31,31,6103,8,8,8,25,9,1888,0,0,0,12,2,92,167,109,54,129,90,90,90,123,616,278,840,931,1509,673,673,344,344,230,1359,1359,1086,1086,148,188,280,390,1339,1889,2788,160,160,200,485,276,46,248,248,233,395,null,null,null,null,null,null,null,null,null,null,null,null,null],[1768,28,28,172,1449,1449,1449,2419,2419,2419,676,676,676,77,1101,1743,1743,1743,462,462,330,330,228,165,165,165,165,2748,469,723,723,54,266,231,1142,146,3616,1321,811,4,131,764,764,764,506,506,506,506,465,63,740,504,53,478,259,259,259,274,274,365,1083,1083,1083,305,305,305,548,1210,1210,1210,153,153,844,392,547,547,855,367,90,1983,1983,949,1196,167,212,212,383,274,274,715,345,88,88,88,528,277,312,1460,1460,6023,6023,280,69,69,201,9182,391,568,568,90,638,638,525,525,749,105,118,118,602,602,0,596,596,2231,438,687,42,31,559,224,67,444,444,602,602,7020,570,470,345,1710,1710,128,625,932,439,147,2221,2221,339,339,1610,1610,272,2835,648,648,230,579,772,221,426,214,218,2917,777,777,165,165,276,276,276,276,101,413,413,413,413,413,459,136,136,136,795,215,215,200,25,1301,1283,1283,1283,191,201,358,358,9,1450,1450,99,941,664,664,298,298,237,26,33,268,268,556,303,3080,3080,276,228,1829,1829,534,13859,51,407,407,15,170,170,24,69,2084,2084,403,403,403,544,544,542,542,1155,1155,1155,368,1808,1808,1808,443,62,1017,4900,2285,146,163,441,1261,135,135,394,394,193,193,193,157,351,343,343,343,1343,1343,1343,1343,36,697,45,724,724,803,102,276,571,571,571,6515,489,382,382,382,382,233,155,1874,1874,42,178,178,178,1818,20,90,876,876,378,58,660,1989,146,1795,2333,2333,2333,423,474,474,474,820,820,247,247,113,17,17,17,265,902,764,764,129,3363,3363,3363,3363,186,984,354,421,1151,1151,920,920,254,254,380,219,358,1941,83,407,1300,2041,703,585,942,165,165,165,138,33,3568,3568,307,307,22,101,101,101,1533,193,193,312,195,195,40,201,522,522,27,451,451,451,0,0,1,375,594,368,42,862,379,429,130,368,259,396,105,57,226,214,143,143,143,246,24,1378,115,115,115,38,38,81,297,542,1438,503,226,26,69,69,6139,0,0,0,118,38,4586,13,13,37,22,0,1103,1015,178,232,757,232,232,232,169,580,365,518,1786,3112,1509,1509,455,455,560,1143,1143,964,964,365,225,217,360,3187,4353,2055,562,562,196,910,591,106,704,704,638,366,null,null,null,null,null,null,null,null,null,null,null,null,null],[1398,114,114,530,1499,1499,1499,1508,1508,1508,527,527,527,104,670,878,878,878,481,618,399,399,266,105,105,105,105,1302,280,596,596,127,296,172,591,125,3705,5827,1157,0,42,580,580,580,486,486,486,486,630,74,785,848,146,524,405,405,405,135,135,334,848,848,848,478,478,478,683,1182,1182,1182,156,156,852,249,343,343,642,319,169,1578,1578,1010,2636,237,379,379,403,234,234,261,145,65,65,65,535,127,620,1024,1024,6105,6105,177,80,80,158,3840,247,626,626,0,768,768,547,547,584,177,100,100,299,299,2,558,558,1196,419,463,50,36,375,188,38,486,486,658,658,3123,1353,391,226,798,798,233,551,1061,347,220,1160,1160,406,406,1064,1064,342,1561,307,307,265,495,1004,149,434,152,210,1167,557,557,268,268,537,537,537,537,180,673,673,673,673,673,410,250,250,250,921,128,128,354,10,1892,400,400,400,261,425,461,461,0,629,629,89,347,429,429,274,274,226,142,0,155,155,1111,177,2165,2165,604,290,309,309,291,29148,96,770,770,52,510,510,35,119,1596,1596,319,319,319,415,415,494,494,1398,1398,1398,367,473,473,473,178,30,751,5849,1095,173,361,763,1048,248,248,283,283,247,247,247,103,516,182,182,182,1565,1565,1565,1565,24,121,108,508,508,578,321,253,493,493,493,970,282,389,389,389,389,193,379,1167,1167,41,105,105,105,512,59,297,163,163,502,144,666,1234,178,2543,2625,2625,2625,597,364,364,364,330,330,290,290,112,20,20,20,277,585,223,223,237,2681,2681,2681,2681,374,392,506,230,502,502,363,363,238,238,289,151,238,955,50,341,978,1791,1133,1610,695,247,247,247,172,0,3914,3914,164,164,40,184,184,184,1342,449,449,403,739,739,83,108,659,659,48,69,69,69,0,0,1,223,703,231,12,1578,164,660,132,517,598,453,122,136,224,155,267,267,267,221,121,477,146,146,146,313,313,97,445,1604,1126,196,198,64,168,168,1317,0,0,0,116,21,2140,12,12,182,22,0,289,238,297,98,133,313,313,313,293,1080,725,914,1071,2128,1020,1020,317,317,367,716,716,396,396,187,150,233,948,613,1213,2249,590,590,314,900,238,82,817,817,302,353,null,null,null,null,null,null,null,null,null,null,null,null,null],[655,34,34,47,733,733,733,5082,5082,5082,165,165,165,32,319,767,767,767,124,195,87,87,222,496,496,496,496,7789,204,270,270,14,80,90,397,56,7233,553,630,2,24,216,216,216,178,178,178,178,135,52,266,430,15,223,157,157,157,120,120,171,357,357,357,153,153,153,303,690,690,690,36,36,596,288,359,359,112,195,101,1156,1156,204,402,176,143,143,475,72,72,155,259,50,50,50,332,0,278,672,672,3804,3804,113,10,10,113,2688,189,767,767,25,586,586,410,410,286,80,28,28,249,249,0,240,240,908,405,340,49,27,364,82,27,284,284,544,544,4492,418,634,83,1653,1653,103,406,552,187,70,558,558,209,209,216,216,119,1921,605,605,195,345,566,63,569,280,116,1265,296,296,58,58,174,174,174,174,197,302,302,302,302,302,357,70,70,70,334,226,226,115,10,1076,301,301,301,72,125,304,304,0,887,887,62,274,232,232,454,454,123,9,5,86,86,202,141,1849,1849,114,96,408,408,208,12501,24,575,575,27,260,260,46,44,1203,1203,372,372,372,101,101,133,133,1084,1084,1084,59,360,360,360,55,188,556,1779,1322,87,543,246,249,112,112,151,151,94,94,94,34,179,105,105,105,262,262,262,262,4,141,46,131,131,1604,36,174,206,206,206,1840,167,105,105,105,105,186,135,900,900,12,46,46,46,946,14,75,26,26,93,31,423,612,63,1061,1106,1106,1106,214,223,223,223,172,172,108,108,27,33,33,33,146,931,555,555,13,1024,1024,1024,1024,56,162,140,99,396,396,2266,2266,98,98,291,163,213,380,54,285,585,1677,396,431,830,101,101,101,42,0,954,954,140,140,0,61,61,61,764,152,152,110,178,178,0,50,976,976,65,162,162,162,3,3,0,436,652,208,16,360,537,339,83,262,162,101,25,13,137,230,48,48,48,1153,29,428,74,74,74,55,55,84,134,153,474,171,135,16,21,21,6979,0,0,0,31,18,1936,46,46,0,9,0,129,82,69,90,70,56,56,56,130,720,408,520,1079,1287,555,555,247,247,217,1919,1919,793,793,82,167,298,417,604,1940,2745,152,152,197,461,71,11,338,338,124,234,null,null,null,null,null,null,null,null,null,null,null,null,null],[1076,61,61,112,1302,1302,1302,6020,6020,6020,516,516,516,91,741,1367,1367,1367,250,470,230,230,395,565,565,565,565,10974,293,442,442,41,158,136,552,145,9500,1819,1029,14,103,588,588,588,210,210,210,210,232,50,306,604,40,347,234,234,234,217,217,407,517,517,517,314,314,314,502,1027,1027,1027,103,103,1001,271,240,240,281,493,90,1525,1525,305,702,506,455,455,612,149,149,214,501,46,46,46,624,160,399,1765,1765,6293,6293,154,53,53,340,3440,380,931,931,43,996,996,738,738,296,68,103,103,417,417,0,471,471,847,392,794,151,38,555,88,11,499,499,628,628,8328,958,671,77,3361,3361,183,676,1133,289,134,522,522,397,397,351,351,206,2914,426,426,557,531,915,132,313,309,211,1682,657,657,135,135,452,452,452,452,127,190,190,190,190,190,404,130,130,130,462,329,329,185,92,1882,417,417,417,209,291,640,640,3,1325,1325,96,365,434,434,611,611,209,27,22,321,321,385,172,2531,2531,118,169,824,824,261,21194,70,588,588,60,730,730,66,94,2139,2139,496,496,496,226,226,365,365,1753,1753,1753,166,829,829,829,104,317,1240,2816,1462,168,906,478,298,248,248,159,159,220,220,220,97,383,197,197,197,619,619,619,619,102,118,41,208,208,2541,124,72,237,237,237,1176,219,168,168,168,168,294,367,1587,1587,67,0,0,0,1584,21,132,135,135,248,67,639,581,66,1786,1771,1771,1771,373,385,385,385,254,254,319,319,43,99,99,99,123,2056,1013,1013,38,1607,1607,1607,1607,49,191,246,139,355,355,2783,2783,288,288,306,226,368,794,24,432,842,2636,990,907,1232,111,111,111,151,0,678,678,298,298,0,136,136,136,1436,366,366,328,255,255,13,134,1312,1312,49,339,339,339,7,7,0,1034,1073,260,31,559,492,456,203,407,226,144,111,59,340,307,102,102,102,2115,45,537,73,73,73,99,99,71,261,438,1140,211,205,68,26,26,8200,0,0,0,79,61,2792,18,18,0,24,0,85,238,267,155,97,103,103,103,269,571,337,776,1341,1890,974,974,274,274,437,2344,2344,1136,1136,243,250,526,619,457,1555,5192,290,290,311,631,161,15,322,322,156,192,null,null,null,null,null,null,null,null,null,null,null,null,null],[1514,127,127,371,1628,1628,1628,1485,1485,1485,397,397,397,101,745,836,836,836,414,857,338,338,186,157,157,157,157,1188,307,896,896,81,191,139,833,87,2754,2316,1000,18,46,513,513,513,399,399,399,399,600,46,717,1553,86,411,693,693,693,146,146,469,864,864,864,340,340,340,1069,1040,1040,1040,107,107,888,258,263,263,578,400,152,1742,1742,1210,1147,211,450,450,510,276,276,215,203,138,138,138,497,172,560,1157,1157,5525,5525,292,74,74,183,3354,188,311,311,0,689,689,515,515,612,190,83,83,383,383,0,524,524,1015,438,388,93,58,409,192,35,374,374,493,493,3671,911,476,230,1267,1267,395,466,1113,307,195,1350,1350,419,419,964,964,423,1601,399,399,355,1603,894,207,165,141,124,1515,585,585,257,257,942,942,942,942,77,270,270,270,270,270,562,269,269,269,1319,178,178,166,14,2263,448,448,448,200,382,362,362,7,788,788,76,367,558,558,253,253,173,114,65,67,67,1302,154,2192,2192,162,334,431,431,311,32084,111,444,444,84,307,307,76,72,1280,1280,213,213,213,469,469,1389,1389,1227,1227,1227,280,770,770,770,269,41,1134,5018,790,238,353,739,1075,298,298,264,264,240,240,240,56,425,185,185,185,1613,1613,1613,1613,85,261,165,588,588,675,101,341,374,374,374,783,308,287,287,287,287,157,372,1228,1228,62,57,57,57,494,20,117,154,154,464,103,414,957,239,2861,2847,2847,2847,774,481,481,481,421,421,250,250,101,17,17,17,238,804,229,229,130,2689,2689,2689,2689,123,451,298,359,507,507,449,449,227,227,457,413,221,601,93,269,1366,1423,583,1143,683,255,255,255,64,3,4772,4772,225,225,7,327,327,327,1526,441,441,455,878,878,152,150,400,400,41,15,15,15,2,2,0,198,555,289,0,1211,182,765,99,639,860,379,121,102,174,148,155,155,155,234,45,613,177,177,177,161,161,139,467,1142,1010,167,168,31,249,249,1354,0,0,0,94,23,1910,3,3,0,51,0,289,158,225,122,98,264,264,264,265,512,418,706,1550,2268,1046,1046,306,306,399,542,542,330,330,250,144,138,801,706,1077,2325,801,801,256,866,149,139,508,508,252,304,null,null,null,null,null,null,null,null,null,null,null,null,null],[1007,97,97,237,1076,1076,1076,1371,1371,1371,409,409,409,117,470,803,803,803,269,709,340,340,202,136,136,136,136,978,187,556,556,65,294,115,595,139,2851,1615,906,2,63,688,688,688,297,297,297,297,543,42,476,571,25,287,313,313,313,103,103,425,738,738,738,231,231,231,611,894,894,894,126,126,386,149,240,240,372,158,130,1735,1735,617,788,151,297,297,562,132,132,257,236,56,56,56,368,96,405,1179,1179,4531,4531,169,56,56,134,1890,228,379,379,6,471,471,415,415,230,68,86,86,316,316,0,406,406,745,299,366,37,55,411,194,70,303,303,469,469,3467,589,348,189,922,922,288,408,795,317,270,915,915,200,200,1027,1027,295,1414,367,367,297,411,612,83,194,103,140,997,490,490,131,131,556,556,556,556,49,338,338,338,338,338,488,215,215,215,808,266,266,236,25,993,317,317,317,230,319,475,475,25,581,581,79,291,505,505,247,247,138,125,31,65,65,703,102,1812,1812,181,346,624,624,194,27499,66,369,369,78,389,389,25,131,1295,1295,237,237,237,430,430,835,835,808,808,808,260,554,554,554,151,109,969,4463,673,194,212,530,836,277,277,139,139,135,135,135,78,445,152,152,152,1131,1131,1131,1131,102,250,73,525,525,736,171,234,341,341,341,644,237,177,177,177,177,129,167,742,742,72,133,133,133,386,65,134,100,100,270,47,751,1181,146,1704,1777,1777,1777,426,255,255,255,254,254,252,252,107,29,29,29,316,718,334,334,157,2356,2356,2356,2356,191,327,370,201,392,392,386,386,254,254,247,171,220,682,69,224,841,1414,632,712,505,161,161,161,70,0,2466,2466,253,253,20,231,231,231,1103,399,399,362,670,670,68,111,451,451,34,43,43,43,0,0,0,234,466,360,14,918,229,466,92,215,300,197,95,111,229,159,131,131,131,158,109,458,232,232,232,157,157,64,393,620,809,82,126,38,100,100,971,0,0,0,35,34,1495,0,0,0,16,5,227,165,183,66,84,173,173,173,211,450,430,351,991,1960,1028,1028,319,319,329,617,617,342,342,204,171,121,560,389,1307,2635,450,450,178,855,166,78,665,665,293,231,null,null,null,null,null,null,null,null,null,null,null,null,null],[1093,0,0,64,864,864,864,21367,21367,21367,216,216,216,56,554,1012,1012,1012,46,210,180,180,123,1418,1418,1418,1418,33492,547,397,397,0,131,62,383,120,30729,460,671,27,59,259,259,259,185,185,185,185,135,76,337,361,0,145,176,176,176,128,128,250,544,544,544,139,139,139,402,508,508,508,0,0,1352,188,74,74,202,106,35,1052,1052,279,628,289,144,144,684,73,73,148,324,42,42,42,344,118,469,912,912,4501,4501,612,52,52,151,2685,182,936,936,0,1577,1577,1991,1991,181,27,73,73,399,399,0,274,274,607,331,507,49,0,324,77,0,363,363,635,635,5752,430,2201,90,2495,2495,312,319,908,117,72,381,381,226,226,146,146,146,1230,2332,2332,391,507,676,26,275,1301,98,1624,572,572,91,91,183,183,183,183,153,137,137,137,137,137,227,62,62,62,271,260,260,24,46,2097,1068,1068,1068,159,111,612,612,0,3091,3091,168,209,344,344,541,541,87,20,93,299,299,336,283,1616,1616,140,177,375,375,96,9222,78,628,628,0,1328,1328,0,231,3391,3391,1787,1787,1787,240,240,283,283,1498,1498,1498,186,675,675,675,52,575,1550,1295,868,146,1378,317,306,147,147,132,132,105,105,105,47,465,207,207,207,286,286,286,286,29,173,54,153,153,1639,119,404,231,231,231,1191,229,208,208,208,208,514,191,2586,2586,0,0,0,0,1162,0,208,56,56,161,49,165,234,68,1095,726,726,726,59,312,312,312,268,268,105,105,0,117,117,117,0,1446,383,383,0,1077,1077,1077,1077,95,157,191,99,314,314,5146,5146,120,120,855,403,814,453,21,173,420,1603,455,483,819,182,182,182,63,0,512,512,157,157,0,164,164,164,1142,332,332,231,322,322,0,76,1784,1784,103,94,94,94,0,0,0,1503,3046,129,57,609,1977,287,301,287,31,40,104,58,152,210,85,85,85,1861,5,521,35,35,35,50,50,53,82,208,721,142,241,0,0,0,5286,0,0,0,73,24,1612,0,0,0,101,0,107,110,111,19,118,86,86,86,161,798,426,718,1095,1010,596,596,168,168,243,6013,6013,1584,1584,183,76,157,473,1016,1744,3087,231,231,607,542,89,29,303,303,78,377,null,null,null,null,null,null,null,null,null,null,null,null,null],[1302,54,54,182,1360,1360,1360,1593,1593,1593,521,521,521,136,594,862,862,862,420,541,340,340,319,63,63,63,63,2117,336,406,406,77,167,112,923,156,2576,3907,1243,49,143,762,762,762,321,321,321,321,433,13,664,769,67,358,306,306,306,149,149,420,813,813,813,305,305,305,701,1263,1263,1263,160,160,1034,322,367,367,580,398,199,1843,1843,656,1643,297,343,343,457,193,193,195,296,78,78,78,522,134,507,1418,1418,5789,5789,173,34,34,154,2094,292,612,612,0,759,759,560,560,505,189,97,97,485,485,10,468,468,867,791,487,33,42,462,116,61,580,580,613,613,6433,838,356,301,1039,1039,176,503,999,453,157,1213,1213,279,279,962,962,324,1993,430,430,258,478,717,59,425,160,319,1326,511,511,156,156,780,780,780,780,82,369,369,369,369,369,457,185,185,185,577,156,156,239,7,1142,412,412,412,219,376,472,472,10,692,692,59,330,293,293,375,375,204,127,57,253,253,686,221,2452,2452,376,328,1334,1334,405,35605,91,616,616,65,306,306,91,156,1325,1325,250,250,250,458,458,562,562,1076,1076,1076,274,603,603,603,155,59,965,3853,1136,121,340,312,436,226,226,220,220,167,167,167,97,315,151,151,151,1373,1373,1373,1373,52,142,74,525,525,972,292,234,322,322,322,1137,277,365,365,365,365,176,335,1076,1076,21,122,122,122,836,28,222,70,70,460,72,474,924,174,1803,2053,2053,2053,722,377,377,377,279,279,185,185,116,20,20,20,292,829,413,413,84,4324,4324,4324,4324,437,279,433,304,529,529,716,716,309,309,328,166,231,495,114,373,741,2130,774,1062,820,257,257,257,115,12,2465,2465,193,193,61,160,160,160,1105,192,192,341,532,532,95,155,610,610,95,107,107,107,0,0,0,397,767,280,30,1141,215,533,206,428,337,280,107,105,218,193,216,216,216,553,64,460,175,175,175,153,153,121,230,830,1050,313,194,26,108,108,3512,9,9,9,96,31,2355,14,14,216,10,0,320,186,283,140,187,186,186,186,217,1182,546,723,970,1634,993,993,382,382,488,865,865,630,630,195,257,198,769,366,1722,1952,586,586,257,1073,215,54,616,616,355,189,null,null,null,null,null,null,null,null,null,null,null,null,null],[887,65,65,168,1111,1111,1111,2425,2425,2425,372,372,372,87,1103,1471,1471,1471,357,1179,304,304,128,103,103,103,103,930,412,937,937,74,401,261,837,144,1368,5921,1630,27,18,438,438,438,489,489,489,489,752,15,632,1078,34,323,738,738,738,76,76,359,1415,1415,1415,244,244,244,1377,1057,1057,1057,151,151,934,196,248,248,353,304,277,1392,1392,1683,1882,292,262,262,282,322,322,196,170,82,82,82,530,74,414,1850,1850,6695,6695,185,47,47,186,3890,235,240,240,0,351,351,317,317,588,205,94,94,510,510,0,427,427,937,519,225,120,30,729,152,69,277,277,416,416,6663,915,403,426,839,839,205,258,843,372,174,2780,2780,312,312,820,820,576,2203,740,740,912,559,773,52,485,97,286,2909,1034,1034,219,219,558,558,558,558,10,296,296,296,296,296,966,159,159,159,658,233,233,277,0,1803,674,674,674,218,153,235,235,0,1210,1210,95,646,776,776,243,243,183,41,36,51,51,795,136,2517,2517,652,192,645,645,538,52575,135,300,300,56,209,209,58,149,1070,1070,313,313,313,390,390,922,922,1516,1516,1516,648,1066,1066,1066,438,13,946,1839,1291,149,265,329,1064,237,237,209,209,282,282,282,76,495,227,227,227,1550,1550,1550,1550,91,430,132,659,659,863,212,182,591,591,591,913,304,542,542,542,542,68,310,1315,1315,37,158,158,158,606,28,274,77,77,514,56,649,909,256,2871,1390,1390,1390,961,504,504,504,558,558,494,494,41,9,9,9,194,560,242,242,194,10230,10230,10230,10230,454,761,454,402,772,772,355,355,475,475,248,264,200,1090,75,201,978,2116,530,1025,790,209,209,209,99,13,10517,10517,404,404,16,332,332,332,2019,547,547,813,773,773,106,188,646,646,12,77,77,77,0,0,0,182,422,119,9,1189,246,625,132,402,530,246,137,91,218,111,180,180,180,460,43,985,182,182,182,338,338,69,575,1964,1057,208,254,6,152,152,2016,2,2,2,79,25,2435,20,20,52,21,0,879,226,220,125,342,243,243,243,343,632,276,1013,1579,2295,1319,1319,288,288,632,332,332,562,562,288,382,179,1217,623,1707,1759,1129,1129,154,1371,180,50,446,446,358,513,null,null,null,null,null,null,null,null,null,null,null,null,null],[910,106,106,129,1249,1249,1249,2005,2005,2005,661,661,661,87,1043,1132,1132,1132,371,776,321,321,273,233,233,233,233,2619,362,289,289,94,98,209,1005,125,3121,3761,1145,6,27,1125,1125,1125,293,293,293,293,496,83,445,1001,62,449,371,371,371,180,180,325,1092,1092,1092,289,289,289,851,1469,1469,1469,128,128,952,381,258,258,820,591,119,2431,2431,391,1348,213,352,352,645,201,201,285,452,91,91,91,798,98,451,2208,2208,6906,6906,308,54,54,335,4050,426,800,800,58,857,857,411,411,761,306,154,154,514,514,0,602,602,1994,471,608,63,85,835,88,154,491,491,842,842,9452,1124,386,337,1713,1713,177,750,1817,474,151,1228,1228,481,481,659,659,259,3170,334,334,74,515,832,205,445,259,268,1966,828,828,238,238,828,828,828,828,92,352,352,352,352,352,521,227,227,227,881,291,291,379,44,1960,310,310,310,274,279,611,611,8,841,841,77,460,738,738,505,505,345,119,94,356,356,909,198,2689,2689,356,293,1521,1521,391,26096,124,497,497,105,356,356,84,81,1293,1293,551,551,551,486,486,717,717,1204,1204,1204,240,1288,1288,1288,240,110,1017,4573,1297,186,329,598,549,484,484,290,290,186,186,186,136,554,464,464,464,1160,1160,1160,1160,56,176,120,380,380,1076,131,309,373,373,373,1141,273,406,406,406,406,271,251,1424,1424,72,106,106,106,1426,16,158,66,66,271,115,214,943,187,2448,2201,2201,2201,923,698,698,698,238,238,78,78,99,26,26,26,314,1186,478,478,181,2498,2498,2498,2498,407,283,602,308,516,516,811,811,538,538,500,213,462,395,97,382,1181,2556,1045,1241,1130,200,200,200,225,0,1012,1012,366,366,6,49,49,49,1669,383,383,155,310,310,45,159,948,948,73,121,121,121,0,0,0,363,589,349,0,752,178,488,173,533,464,235,171,139,299,304,155,155,155,670,85,761,175,175,175,79,79,146,235,669,1492,200,206,130,173,173,4524,0,0,0,104,38,2538,11,11,15,12,0,156,293,248,95,183,189,189,189,277,1175,375,796,1432,2564,1098,1098,558,558,690,1021,1021,817,817,298,268,366,798,493,1961,3004,416,416,220,911,194,122,838,838,365,390,null,null,null,null,null,null,null,null,null,null,null,null,null],[758,34,34,121,1399,1399,1399,7060,7060,7060,452,452,452,58,655,1145,1145,1145,292,277,132,132,380,720,720,720,720,12683,264,299,299,40,173,380,598,199,12663,653,817,0,111,356,356,356,245,245,245,245,272,84,368,473,80,317,191,191,191,256,256,489,687,687,687,158,158,158,424,779,779,779,71,71,944,343,533,533,247,274,95,2232,2232,508,792,351,371,371,695,110,110,305,541,125,125,125,514,233,328,1336,1336,5664,5664,315,22,22,208,2943,203,1309,1309,27,1269,1269,1025,1025,362,113,114,114,526,526,0,240,240,718,483,970,86,45,593,85,16,516,516,1044,1044,8479,799,1190,143,2496,2496,247,333,1146,286,126,589,589,412,412,226,226,209,2306,639,639,153,526,915,115,330,536,74,1468,402,402,118,118,347,347,347,347,217,260,260,260,260,260,382,99,99,99,453,346,346,188,43,1657,571,571,571,254,383,631,631,8,1330,1330,100,310,399,399,836,836,235,45,17,336,336,487,197,2514,2514,130,131,562,562,285,6498,33,929,929,41,503,503,61,172,2341,2341,734,734,734,238,238,250,250,1524,1524,1524,110,692,692,692,160,407,1177,2717,1481,115,677,434,448,318,318,276,276,170,170,170,179,336,71,71,71,691,691,691,691,96,289,14,156,156,2813,111,99,196,196,196,3267,209,242,242,242,242,278,202,1309,1309,32,26,26,26,1171,75,102,519,519,241,70,420,904,163,1724,1859,1859,1859,348,431,431,431,338,338,124,124,20,114,114,114,214,2347,945,945,125,974,974,974,974,34,1683,275,182,538,538,3260,3260,267,267,277,105,456,430,0,410,732,2328,932,589,964,154,154,154,163,26,368,368,193,193,0,89,89,89,1093,131,131,198,233,233,18,91,1400,1400,46,254,254,254,0,0,0,1033,1167,311,0,829,719,413,129,429,288,200,117,45,282,245,74,74,74,2650,56,603,29,29,29,20,20,173,87,373,1037,265,82,105,47,47,6634,0,0,0,81,16,2651,2,2,10,34,11,148,151,192,116,91,145,145,145,214,567,554,995,1072,1525,907,907,240,240,384,3177,3177,1527,1527,131,212,335,495,819,2447,3801,194,194,269,415,243,29,649,649,300,222,null,null,null,null,null,null,null,null,null,null,null,null,null],[1381,71,71,54,988,988,988,2181,2181,2181,316,316,316,101,578,994,994,994,415,826,465,465,287,205,205,205,205,1095,282,2123,2123,46,378,197,1391,123,2046,2998,664,8,39,604,604,604,358,358,358,358,1035,21,652,965,42,350,160,160,160,113,113,827,1389,1389,1389,203,203,203,924,1020,1020,1020,141,141,1069,171,271,271,514,359,215,1565,1565,881,1163,179,242,242,405,278,278,349,97,70,70,70,316,78,566,1110,1110,3823,3823,142,36,36,106,2793,215,354,354,0,419,419,212,212,509,151,38,38,300,300,37,449,449,961,629,222,52,82,573,150,66,412,412,479,479,3871,466,663,387,711,711,213,246,730,318,182,3054,3054,221,221,1297,1297,483,2488,577,577,548,645,536,92,310,73,150,2134,743,743,250,250,647,647,647,647,124,617,617,617,617,617,795,162,162,162,1076,214,214,126,44,1114,1176,1176,1176,271,252,216,216,23,975,975,99,602,669,669,238,238,203,32,11,72,72,470,109,3916,3916,210,154,905,905,455,38178,89,482,482,37,174,174,35,105,1368,1368,264,264,264,624,624,753,753,549,549,549,435,968,968,968,544,20,1579,3706,933,140,252,341,822,211,211,313,313,174,174,174,20,587,296,296,296,1528,1528,1528,1528,29,448,86,618,618,636,102,295,639,639,639,1450,371,240,240,240,240,209,331,1686,1686,16,62,62,62,518,20,79,77,77,361,92,881,1214,228,2210,1196,1196,1196,672,400,400,400,775,775,469,469,99,11,11,11,371,389,321,321,107,4996,4996,4996,4996,142,420,431,216,828,828,352,352,331,331,494,489,192,1385,138,228,1081,1133,614,540,857,125,125,125,82,14,4887,4887,340,340,15,140,140,140,1518,635,635,270,567,567,93,149,237,237,18,80,80,80,0,0,1,187,614,236,19,931,183,493,164,282,219,189,114,68,197,66,122,122,122,309,72,666,200,200,200,172,172,78,481,861,922,274,218,38,69,69,1704,0,0,0,72,28,3319,7,7,12,26,6,515,185,209,115,297,174,174,174,345,438,394,520,1091,1923,1541,1541,296,296,543,487,487,399,399,437,180,202,624,814,2536,1139,869,869,154,1322,294,54,548,548,502,279,null,null,null,null,null,null,null,null,null,null,null,null,null],[1832,155,155,346,1932,1932,1932,1917,1917,1917,480,480,480,101,978,1083,1083,1083,400,1125,572,572,207,202,202,202,202,1626,454,978,978,81,449,206,1215,207,2752,4286,1803,24,54,1154,1154,1154,587,587,587,587,942,64,795,1026,106,511,476,476,476,248,248,709,1299,1299,1299,434,434,434,1472,1281,1281,1281,296,296,718,215,348,348,479,426,207,2045,2045,1330,1458,426,402,402,519,490,490,386,352,166,166,166,743,272,665,1999,1999,8186,8186,267,70,70,166,2877,367,489,489,0,849,849,656,656,479,176,106,106,466,466,44,853,853,1037,460,521,47,77,722,230,98,368,368,890,890,5747,730,698,356,1538,1538,467,860,943,468,284,1404,1404,570,570,1225,1225,589,2191,516,516,628,476,872,229,407,216,303,1906,1126,1126,276,276,938,938,938,938,55,391,391,391,391,391,845,257,257,257,1047,356,356,573,54,1525,526,526,526,412,563,529,529,6,1056,1056,129,435,826,826,257,257,411,86,35,77,77,863,140,3171,3171,415,376,2002,2002,612,7319,80,459,459,117,871,871,42,127,1640,1640,202,202,202,930,930,1546,1546,1503,1503,1503,551,1162,1162,1162,301,57,1879,5343,989,186,679,503,751,377,377,412,412,228,228,228,140,309,394,394,394,1869,1869,1869,1869,121,190,109,838,838,886,148,307,678,678,678,1200,460,472,472,472,472,163,437,1222,1222,85,214,214,214,860,82,394,55,55,631,167,1103,1512,275,2919,2551,2551,2551,1117,604,604,604,540,540,534,534,94,96,96,96,351,1174,315,315,287,2973,2973,2973,2973,147,213,431,271,699,699,539,539,643,643,283,328,307,1068,106,354,1090,2319,805,972,778,271,271,271,203,4,621,621,492,492,20,529,529,529,1923,659,659,570,1069,1069,201,201,576,576,84,61,61,61,0,0,0,315,695,296,20,1248,191,540,226,400,544,290,149,161,235,191,175,175,175,600,184,532,240,240,240,314,314,232,601,1697,1491,207,301,37,131,131,2331,0,0,0,164,52,3612,10,10,21,44,8,361,358,382,182,191,359,359,359,380,372,738,621,1812,3163,1708,1708,464,464,793,779,779,582,582,481,343,235,968,661,1698,2923,951,951,233,1568,202,111,578,578,339,406,null,null,null,null,null,null,null,null,null,null,null,null,null],[562,38,38,113,837,837,837,2107,2107,2107,415,415,415,85,495,593,593,593,210,400,36,36,231,279,279,279,279,3729,212,212,212,53,0,136,298,154,4461,2924,1114,0,13,329,329,329,160,160,160,160,192,70,236,650,72,199,372,372,372,96,96,170,321,321,321,61,61,61,351,683,683,683,66,66,939,238,144,144,320,263,128,1150,1150,510,1072,350,400,400,683,59,59,164,139,68,68,68,422,42,275,1138,1138,5351,5351,172,32,32,98,3444,102,659,659,0,809,809,382,382,325,92,70,70,307,307,2,271,271,591,494,447,30,19,353,68,74,365,365,633,633,5955,996,617,129,988,988,92,393,961,143,167,346,346,349,349,146,146,151,1208,174,174,149,394,836,108,469,108,151,918,361,361,124,124,344,344,344,344,81,194,194,194,194,194,323,104,104,104,671,55,55,195,0,1469,418,418,418,73,207,429,429,0,452,452,18,147,208,208,295,295,164,103,0,129,129,1244,83,1436,1436,223,100,641,641,222,13746,38,636,636,0,343,343,44,43,831,831,234,234,234,167,167,217,217,1438,1438,1438,162,327,327,327,319,48,326,2997,1176,114,531,509,347,209,209,101,101,202,202,202,94,234,122,122,122,557,557,557,557,68,79,86,119,119,1175,179,172,137,137,137,534,149,164,164,164,164,350,452,815,815,12,0,0,0,1182,26,159,143,143,204,66,180,727,58,1208,2762,2762,2762,338,273,273,273,134,134,40,40,94,49,49,49,216,1006,274,274,158,903,903,903,903,350,286,256,199,176,176,705,705,166,166,228,151,198,198,38,194,674,2201,648,1849,659,45,45,45,53,0,1150,1150,120,120,12,99,99,99,1000,127,127,200,421,421,58,35,903,903,41,142,142,142,0,0,0,347,823,277,0,820,161,399,67,361,369,79,20,132,131,248,139,139,139,175,24,364,20,20,20,57,57,47,71,400,731,104,57,64,46,46,3464,0,0,0,76,14,1193,0,0,276,0,0,111,89,147,85,52,118,118,118,124,1399,483,1025,815,1046,381,381,175,175,249,923,923,616,616,86,63,218,473,181,963,2481,126,126,236,351,103,64,516,516,193,182,null,null,null,null,null,null,null,null,null,null,null,null,null],[2118,182,182,220,1638,1638,1638,2605,2605,2605,923,923,923,151,913,1426,1426,1426,600,1344,654,654,357,367,367,367,367,2140,460,1495,1495,129,370,315,1757,259,3246,2476,2057,33,214,1314,1314,1314,549,549,549,549,1282,33,1154,1318,103,567,642,642,642,260,260,543,2041,2041,2041,571,571,571,1309,1887,1887,1887,268,268,1015,342,490,490,921,594,230,2407,2407,1269,1622,286,459,459,621,483,483,351,302,161,161,161,523,195,804,2639,2639,8765,8765,351,214,214,239,2687,446,493,493,37,1099,1099,533,533,699,252,115,115,603,603,82,1076,1076,1709,601,572,47,128,638,292,78,530,530,693,693,6397,740,546,508,1160,1160,448,1098,1211,793,333,2044,2044,334,334,2036,2036,785,3275,869,869,908,775,746,139,500,280,341,2464,1230,1230,402,402,1205,1205,1205,1205,342,1118,1118,1118,1118,1118,1073,391,391,391,1417,319,319,449,67,1728,843,843,843,447,864,543,543,9,1212,1212,164,672,723,723,403,403,479,188,49,199,199,1219,230,4898,4898,597,530,1902,1902,780,57266,209,637,637,101,666,666,149,151,2123,2123,517,517,517,784,784,1332,1332,1282,1282,1282,670,1034,1034,1034,150,68,2000,6724,1030,278,391,297,715,344,344,440,440,207,207,207,133,585,409,409,409,2064,2064,2064,2064,179,132,130,1078,1078,1216,225,761,946,946,946,1618,513,499,499,499,499,267,280,1738,1738,50,161,161,161,1824,115,328,73,73,595,86,641,1857,320,3019,3218,3218,3218,1148,668,668,668,700,700,560,560,178,52,52,52,570,972,453,453,191,5555,5555,5555,5555,276,340,803,419,1063,1063,578,578,706,706,329,441,353,1240,216,417,1430,3334,1021,1489,1992,552,552,552,217,0,2108,2108,378,378,37,306,306,306,1844,769,769,741,1159,1159,82,227,866,866,173,342,342,342,0,0,0,422,937,187,0,1681,220,944,225,452,454,622,177,198,240,232,153,153,153,519,145,1112,475,475,475,428,428,203,637,1316,1622,225,315,39,71,71,3987,0,0,0,115,47,3773,20,20,3,42,0,613,464,474,211,208,284,284,284,292,994,998,639,2164,3939,2089,2089,517,517,990,1078,1078,550,550,531,307,192,968,1114,2247,2458,1511,1511,351,1709,437,122,848,848,610,592,null,null,null,null,null,null,null,null,null,null,null,null,null],[1793,160,160,258,1661,1661,1661,2552,2552,2552,420,420,420,134,1116,1318,1318,1318,452,1205,726,726,251,263,263,263,263,1321,379,1217,1217,33,447,313,1347,185,2525,3064,2030,7,13,1256,1256,1256,427,427,427,427,975,50,787,1544,42,436,324,324,324,176,176,562,1496,1496,1496,349,349,349,1604,1248,1248,1248,228,228,777,181,420,420,568,514,193,2211,2211,1565,1345,379,357,357,607,453,453,265,279,128,128,128,538,183,446,2156,2156,9374,9374,293,104,104,169,3172,328,419,419,0,612,612,541,541,414,212,73,73,530,530,46,778,778,935,458,313,47,56,805,169,63,336,336,800,800,5894,740,730,329,1661,1661,529,523,1081,483,267,2011,2011,442,442,1320,1320,773,2694,397,397,667,636,847,190,415,182,265,2558,1365,1365,313,313,1071,1071,1071,1071,57,481,481,481,481,481,858,261,261,261,1085,338,338,461,32,1857,589,589,589,324,345,476,476,6,1092,1092,145,465,915,915,385,385,238,78,31,189,189,954,222,3124,3124,327,362,2140,2140,515,40983,120,422,422,78,453,453,114,238,1407,1407,290,290,290,660,660,1850,1850,1377,1377,1377,609,1050,1050,1050,171,49,2256,3979,990,223,560,488,790,338,338,295,295,194,194,194,148,506,382,382,382,1743,1743,1743,1743,65,182,130,878,878,1033,204,327,829,829,829,1413,439,497,497,497,497,217,275,1272,1272,28,157,157,157,831,177,250,31,31,454,181,934,1351,203,3533,2068,2068,2068,1402,775,775,775,533,533,490,490,99,99,99,99,411,1338,326,326,227,4816,4816,4816,4816,237,273,541,289,845,845,477,477,698,698,354,425,248,1074,86,368,1277,2620,821,1110,852,194,194,194,172,0,4396,4396,558,558,32,419,419,419,2120,599,599,695,1172,1172,207,248,574,574,40,71,71,71,0,0,0,333,732,219,14,1314,334,729,195,431,607,305,136,149,303,191,158,158,158,305,102,580,295,295,295,385,385,211,460,1741,1612,235,258,42,191,191,1875,0,0,0,112,15,2856,0,0,0,68,0,279,265,279,98,194,341,341,341,410,514,552,545,1760,3146,1578,1578,463,463,645,508,508,429,429,413,290,309,887,874,1789,3284,1168,1168,200,1395,302,54,639,639,457,438,null,null,null,null,null,null,null,null,null,null,null,null,null],[535,68,68,142,1009,1009,1009,764,764,764,218,218,218,39,419,452,452,452,181,406,84,84,170,84,84,84,84,1617,176,98,98,31,35,93,190,86,1944,1587,699,8,53,364,364,364,132,132,132,132,146,27,320,556,46,251,282,282,282,127,127,219,281,281,281,192,192,192,428,780,780,780,31,31,498,140,83,83,336,165,161,1059,1059,362,714,236,468,468,434,26,26,183,179,65,65,65,428,19,178,1101,1101,5728,5728,142,12,12,92,3925,105,398,398,0,617,617,167,167,258,109,187,187,263,263,0,207,207,455,295,274,18,0,249,46,75,294,294,484,484,4135,471,270,51,1331,1331,160,500,712,203,125,326,326,379,379,199,199,151,991,110,110,155,235,608,173,257,98,74,749,813,813,103,103,295,295,295,295,54,51,51,51,51,51,137,116,116,116,495,111,111,167,20,1121,176,176,176,126,152,294,294,0,334,334,37,176,351,351,227,227,91,32,28,117,117,928,139,990,990,208,179,580,580,77,8980,15,305,305,0,177,177,38,51,556,556,102,102,102,236,236,326,326,953,953,953,94,427,427,427,121,37,318,2299,709,141,463,376,350,187,187,193,193,67,67,67,60,107,70,70,70,350,350,350,350,164,84,87,209,209,664,75,98,77,77,77,603,110,125,125,125,125,73,213,468,468,56,8,8,8,899,33,91,34,34,125,212,395,528,81,1258,2334,2334,2334,397,245,245,245,128,128,30,30,44,38,38,38,99,425,208,208,220,630,630,630,630,311,166,167,158,266,266,326,326,151,151,146,48,174,78,10,297,364,1514,326,1325,493,88,88,88,78,0,816,816,118,118,0,31,31,31,657,84,84,20,234,234,26,45,587,587,18,71,71,71,0,0,0,310,555,257,0,313,137,552,85,221,289,112,64,74,122,96,92,92,92,131,36,267,59,59,59,61,61,107,52,337,624,106,64,31,122,122,1705,0,0,0,84,11,1055,8,8,0,0,0,41,92,112,52,14,197,197,197,202,696,208,941,833,1168,497,497,105,105,223,587,587,380,380,47,205,261,636,139,617,4316,139,139,137,282,66,30,199,199,104,212,null,null,null,null,null,null,null,null,null,null,null,null,null],[562,38,38,113,837,837,837,2107,2107,2107,415,415,415,85,495,593,593,593,210,400,36,36,231,279,279,279,279,3729,212,212,212,53,0,136,298,154,4461,2924,1114,0,13,329,329,329,160,160,160,160,192,70,236,650,72,199,372,372,372,96,96,170,321,321,321,61,61,61,351,683,683,683,66,66,939,238,144,144,320,263,128,1150,1150,510,1072,350,400,400,683,59,59,164,139,68,68,68,422,42,275,1138,1138,5351,5351,172,32,32,98,3444,102,659,659,0,809,809,382,382,325,92,70,70,307,307,2,271,271,591,494,447,30,19,353,68,74,365,365,633,633,5955,996,617,129,988,988,92,393,961,143,167,346,346,349,349,146,146,151,1208,174,174,149,394,836,108,469,108,151,918,361,361,124,124,344,344,344,344,81,194,194,194,194,194,323,104,104,104,671,55,55,195,0,1469,418,418,418,73,207,429,429,0,452,452,18,147,208,208,295,295,164,103,0,129,129,1244,83,1436,1436,223,100,641,641,222,13746,38,636,636,0,343,343,44,43,831,831,234,234,234,167,167,217,217,1438,1438,1438,162,327,327,327,319,48,326,2997,1176,114,531,509,347,209,209,101,101,202,202,202,94,234,122,122,122,557,557,557,557,68,79,86,119,119,1175,179,172,137,137,137,534,149,164,164,164,164,350,452,815,815,12,0,0,0,1182,26,159,143,143,204,66,180,727,58,1208,2762,2762,2762,338,273,273,273,134,134,40,40,94,49,49,49,216,1006,274,274,158,903,903,903,903,350,286,256,199,176,176,705,705,166,166,228,151,198,198,38,194,674,2201,648,1849,659,45,45,45,53,0,1150,1150,120,120,12,99,99,99,1000,127,127,200,421,421,58,35,903,903,41,142,142,142,0,0,0,347,823,277,0,820,161,399,67,361,369,79,20,132,131,248,139,139,139,175,24,364,20,20,20,57,57,47,71,400,731,104,57,64,46,46,3464,0,0,0,76,14,1193,0,0,276,0,0,111,89,147,85,52,118,118,118,124,1399,483,1025,815,1046,381,381,175,175,249,923,923,616,616,86,63,218,473,181,963,2481,126,126,236,351,103,64,516,516,193,182,null,null,null,null,null,null,null,null,null,null,null,null,null],[1473,205,205,248,1749,1749,1749,1942,1942,1942,795,795,795,89,980,1012,1012,1012,503,971,451,451,249,158,158,158,158,1757,427,858,858,148,223,148,1247,158,2522,2768,1100,14,69,1114,1114,1114,517,517,517,517,742,82,914,1256,93,501,509,509,509,318,318,488,1054,1054,1054,344,344,344,1077,1195,1195,1195,206,206,1184,429,270,270,706,533,191,2025,2025,825,1397,320,360,360,551,266,266,288,295,142,142,142,591,178,573,1510,1510,6823,6823,257,98,98,253,2701,516,525,525,0,894,894,639,639,520,221,73,73,602,602,0,619,619,1337,621,511,80,64,719,296,86,397,397,665,665,5841,947,585,361,1669,1669,236,1092,1286,610,288,1201,1201,328,328,900,900,591,2862,501,501,455,1415,831,299,386,152,271,1862,784,784,263,263,803,803,803,803,81,369,369,369,369,369,711,369,369,369,1550,195,195,305,38,1789,487,487,487,281,531,450,450,6,1291,1291,134,358,642,642,389,389,402,83,96,146,146,1037,204,3302,3302,282,354,1743,1743,503,26666,198,566,566,98,477,477,93,191,1632,1632,235,235,235,577,577,1194,1194,960,960,960,370,1356,1356,1356,240,85,1511,5373,840,172,465,354,602,342,342,402,402,192,192,192,90,478,209,209,209,1504,1504,1504,1504,68,215,96,550,550,1232,133,460,495,495,495,1181,418,284,284,284,284,179,481,1791,1791,32,109,109,109,1096,41,252,58,58,595,144,398,1301,169,2439,2302,2302,2302,930,577,577,577,550,550,320,320,171,54,54,54,311,1096,541,541,82,3403,3403,3403,3403,195,254,542,366,776,776,615,615,460,460,460,348,225,857,104,547,1516,2050,760,1256,1089,331,331,331,167,3,2277,2277,360,360,26,382,382,382,1759,580,580,494,735,735,154,220,621,621,74,55,55,55,0,0,0,332,827,234,0,1413,179,767,186,528,565,304,173,113,326,247,208,208,208,1104,39,733,246,246,246,208,208,273,534,1129,1376,229,368,48,135,135,3619,153,153,153,111,32,3155,0,0,6,58,0,419,273,325,166,197,310,310,310,266,728,392,660,1799,2365,1488,1488,507,507,634,745,745,592,592,271,197,299,697,805,1578,2052,959,959,210,1109,290,94,579,579,374,461,null,null,null,null,null,null,null,null,null,null,null,null,null],[1344,74,74,105,1559,1559,1559,2374,2374,2374,766,766,766,77,890,2130,2130,2130,329,568,268,268,251,103,103,103,103,2710,433,640,640,24,497,317,1108,91,2737,671,779,33,41,628,628,628,508,508,508,508,519,45,814,565,60,504,432,432,432,216,216,483,1046,1046,1046,271,271,271,601,1091,1091,1091,326,326,817,365,493,493,618,391,200,2172,2172,769,1072,148,221,221,451,184,184,645,410,71,71,71,487,65,415,1697,1697,6771,6771,148,68,68,150,5892,427,527,527,0,700,700,579,579,733,233,140,140,642,642,10,594,594,1382,353,701,96,49,556,147,39,487,487,427,427,7672,498,467,303,1769,1769,191,461,819,443,233,2189,2189,352,352,1213,1213,341,3508,407,407,299,441,941,296,285,189,235,2923,1469,1469,106,106,484,484,484,484,54,94,94,94,94,94,365,143,143,143,1091,248,248,318,39,1717,1382,1382,1382,229,200,300,300,0,1502,1502,30,1049,641,641,371,371,321,33,40,136,136,656,116,3225,3225,300,198,497,497,397,10263,31,280,280,29,112,112,45,98,2102,2102,272,272,272,457,457,377,377,1044,1044,1044,351,1684,1684,1684,422,91,864,4147,2400,101,193,302,1151,236,236,479,479,174,174,174,112,185,188,188,188,1125,1125,1125,1125,56,290,32,533,533,1525,85,107,1040,1040,1040,4268,458,333,333,333,333,99,289,1677,1677,73,107,107,107,1527,36,47,719,719,288,155,1280,1473,133,2237,1982,1982,1982,460,388,388,388,697,697,163,163,49,31,31,31,322,823,582,582,114,2511,2511,2511,2511,137,965,501,374,1366,1366,845,845,266,266,297,274,307,1984,74,445,1347,1770,661,597,1186,182,182,182,87,12,2164,2164,216,216,0,201,201,201,1544,230,230,32,283,283,71,232,530,530,35,259,259,259,0,0,0,305,520,437,7,832,234,514,149,292,227,284,83,77,196,229,138,138,138,360,48,1244,98,98,98,186,186,157,226,644,1479,198,130,12,81,81,6720,0,0,0,123,21,5181,16,16,20,27,28,245,521,170,197,334,237,237,237,339,571,403,904,1854,2953,1465,1465,439,439,839,1041,1041,794,794,356,197,327,586,2345,3202,2495,487,487,199,1066,504,24,500,500,717,438,null,null,null,null,null,null,null,null,null,null,null,null,null],[1065,56,56,117,1020,1020,1020,6929,6929,6929,433,433,433,93,447,1169,1169,1169,330,462,170,170,361,586,586,586,586,10341,513,509,509,31,98,219,948,208,11194,1459,910,7,96,329,329,329,200,200,200,200,262,63,454,503,66,325,218,218,218,259,259,520,640,640,640,221,221,221,389,1082,1082,1082,105,105,1270,399,292,292,236,418,140,2155,2155,375,1474,443,433,433,741,77,77,237,476,148,148,148,483,67,559,1610,1610,5112,5112,426,25,25,291,2671,364,1099,1099,0,1145,1145,786,786,800,174,80,80,523,523,0,447,447,832,593,742,26,43,631,55,26,437,437,737,737,9210,1047,1401,202,2374,2374,322,411,1445,213,69,983,983,229,229,421,421,157,2951,1059,1059,200,417,907,119,399,668,290,1804,483,483,124,124,557,557,557,557,68,397,397,397,397,397,558,152,152,152,658,183,183,209,40,1446,874,874,874,285,174,533,533,3,1464,1464,117,384,594,594,684,684,219,131,87,386,386,576,365,2915,2915,252,172,564,564,322,14686,116,581,581,75,468,468,105,47,1966,1966,950,950,950,341,341,231,231,1247,1247,1247,240,934,934,934,237,122,936,2245,1319,255,547,467,497,279,279,241,241,163,163,163,93,269,239,239,239,970,970,970,970,77,162,102,225,225,1971,351,194,238,238,238,1826,261,291,291,291,291,251,240,1816,1816,43,24,24,24,1221,44,70,261,261,288,73,239,830,163,1484,1602,1602,1602,367,412,412,412,544,544,106,106,118,35,35,35,320,1602,977,977,87,1312,1312,1312,1312,244,446,471,226,628,628,1710,1710,354,354,312,345,410,381,82,295,1200,1971,950,795,1290,319,319,319,135,14,447,447,171,171,27,177,177,177,944,350,350,194,286,286,40,184,1026,1026,57,299,299,299,0,0,0,986,923,232,47,805,312,443,124,547,263,154,91,95,244,290,153,153,153,796,44,512,96,96,96,69,69,101,199,401,852,305,115,48,59,59,8234,9,9,9,102,45,3598,4,4,318,24,34,327,202,217,150,143,168,168,168,230,1185,575,1009,1278,1704,1061,1061,358,358,518,2102,2102,1180,1180,216,191,271,560,622,2495,3520,296,296,320,524,378,63,698,698,376,292,null,null,null,null,null,null,null,null,null,null,null,null,null],[1922,117,117,180,1995,1995,1995,2788,2788,2788,670,670,670,119,1254,1314,1314,1314,502,1236,733,733,394,255,255,255,255,1464,344,1181,1181,74,303,181,1285,168,3019,5780,1405,24,11,1046,1046,1046,597,597,597,597,1154,43,845,1244,74,384,471,471,471,193,193,478,1943,1943,1943,410,410,410,1590,1498,1498,1498,143,143,1026,246,174,174,743,492,183,2093,2093,1447,1923,155,330,330,545,598,598,403,357,115,115,115,507,239,455,2013,2013,6725,6725,228,118,118,212,3839,340,416,416,48,847,847,423,423,539,290,94,94,737,737,16,742,742,1358,496,412,42,81,834,268,88,459,459,697,697,6031,1224,507,595,1412,1412,341,833,1222,675,277,3311,3311,466,466,1589,1589,666,3013,527,527,977,881,793,160,256,219,259,2975,1082,1082,297,297,1551,1551,1551,1551,52,480,480,480,480,480,1166,277,277,277,972,409,409,327,31,1792,760,760,760,344,382,394,394,3,1442,1442,129,580,839,839,358,358,338,69,63,124,124,752,229,4022,4022,604,400,1700,1700,763,61638,161,461,461,66,626,626,121,123,1822,1822,557,557,557,664,664,1634,1634,1246,1246,1246,672,1275,1275,1275,462,35,3041,4837,1005,209,598,562,895,431,431,412,412,282,282,282,122,614,352,352,352,2125,2125,2125,2125,28,294,118,923,923,546,161,379,788,788,788,723,442,710,710,710,710,179,390,1626,1626,39,202,202,202,1048,22,432,117,117,693,105,602,1239,306,3607,1839,1839,1839,1267,650,650,650,554,554,600,600,180,33,33,33,392,533,557,557,226,11579,11579,11579,11579,519,637,465,326,708,708,516,516,436,436,512,472,358,765,82,414,1234,2502,663,928,1017,313,313,313,213,6,4890,4890,455,455,39,180,180,180,2660,859,859,683,834,834,107,247,452,452,51,165,165,165,0,0,0,270,862,386,17,1342,276,653,345,427,536,444,281,122,203,173,215,215,215,667,111,1102,254,254,254,473,473,132,479,1514,1708,217,369,21,264,264,2034,0,0,0,43,61,3493,0,0,8,43,0,341,306,255,214,195,224,224,224,445,573,367,519,1799,3527,1860,1860,437,437,852,717,717,464,464,435,318,248,660,943,2153,2022,1183,1183,288,1865,171,139,715,715,539,493,null,null,null,null,null,null,null,null,null,null,null,null,null],[753,21,21,113,769,769,769,4144,4144,4144,328,328,328,69,404,860,860,860,208,228,113,113,260,768,768,768,768,9046,237,223,223,21,44,95,356,186,7379,1020,700,13,65,333,333,333,141,141,141,141,145,91,257,248,49,238,203,203,203,155,155,389,522,522,522,226,226,226,237,550,550,550,33,33,710,214,212,212,260,152,66,1238,1238,292,465,219,261,261,535,33,33,156,297,49,49,49,396,51,278,885,885,4210,4210,191,0,0,311,1581,247,883,883,50,779,779,435,435,248,78,85,85,276,276,0,252,252,556,200,658,75,77,358,47,80,319,319,540,540,5572,501,792,120,2023,2023,115,565,769,128,50,343,343,200,200,270,270,123,2195,635,635,227,376,474,43,320,336,102,868,322,322,77,77,309,309,309,309,340,322,322,322,322,322,318,57,57,57,366,213,213,118,64,947,340,340,340,134,243,441,441,17,647,647,74,220,268,268,493,493,114,52,0,165,165,367,266,1773,1773,87,103,174,174,165,11854,89,458,458,62,490,490,47,85,1619,1619,591,591,591,133,133,186,186,883,883,883,55,429,429,429,30,209,749,2346,717,85,446,278,221,141,141,152,152,84,84,84,75,172,80,80,80,399,399,399,399,56,59,55,107,107,1394,70,398,229,229,229,845,134,85,85,85,85,278,195,865,865,11,34,34,34,1671,64,80,386,386,189,117,165,511,87,905,1465,1465,1465,253,278,278,278,107,107,82,82,36,95,95,95,178,1350,786,786,23,445,445,445,445,30,1315,252,155,268,268,1339,1339,185,185,191,79,274,161,14,376,547,1389,559,509,924,284,284,284,106,0,213,213,155,155,0,33,33,33,773,174,174,107,174,174,6,49,885,885,35,607,607,607,0,0,2,786,767,127,21,330,342,271,117,349,129,115,46,59,56,189,74,74,74,1740,16,589,90,90,90,46,46,82,81,195,681,109,158,27,20,20,7481,0,0,0,74,16,2202,26,26,0,38,0,35,141,96,88,51,94,94,94,152,701,490,666,920,1260,711,711,224,224,392,1815,1815,754,754,103,116,191,459,345,1256,2448,110,110,318,354,149,49,350,350,118,138,null,null,null,null,null,null,null,null,null,null,null,null,null],[1538,60,60,102,1509,1509,1509,2982,2982,2982,395,395,395,128,909,1085,1085,1085,408,977,474,474,376,245,245,245,245,1088,223,1592,1592,51,252,148,1223,103,2995,2681,941,11,32,548,548,548,423,423,423,423,1139,25,662,719,32,525,226,226,226,143,143,439,1232,1232,1232,315,315,315,982,1484,1484,1484,149,149,819,251,253,253,652,331,97,1577,1577,888,1849,194,243,243,644,318,318,509,278,76,76,76,321,56,611,1262,1262,5610,5610,251,68,68,123,5397,190,372,372,19,482,482,238,238,537,126,85,85,479,479,48,613,613,2205,433,331,66,28,434,128,79,327,327,531,531,4480,816,697,456,865,865,235,627,803,390,155,4326,4326,279,279,1574,1574,450,2020,1127,1127,548,783,575,86,223,194,165,2328,997,997,422,422,822,822,822,822,115,734,734,734,734,734,713,121,121,121,778,261,261,325,18,1258,1740,1740,1740,218,284,320,320,26,1206,1206,188,492,954,954,291,291,186,38,106,108,108,747,255,3568,3568,440,417,1071,1071,627,44115,76,294,294,63,175,175,61,91,1467,1467,447,447,447,1053,1053,1029,1029,1188,1188,1188,491,1145,1145,1145,643,22,1867,5613,1353,239,297,369,1170,186,186,350,350,123,123,123,75,672,253,253,253,1970,1970,1970,1970,18,609,109,1140,1140,371,73,316,491,491,491,2761,521,355,355,355,355,140,185,1354,1354,65,175,175,175,794,11,109,187,187,470,40,426,1617,388,2225,1726,1726,1726,690,461,461,461,721,721,413,413,138,40,40,40,546,496,244,244,59,6760,6760,6760,6760,452,444,457,356,896,896,429,429,295,295,490,511,429,1547,128,253,1566,1848,827,811,1098,227,227,227,124,0,3074,3074,262,262,0,156,156,156,1876,523,523,434,454,454,60,172,488,488,22,145,145,145,0,0,0,270,753,447,17,1218,266,498,175,309,256,382,45,90,215,108,101,101,101,352,67,624,136,136,136,97,97,78,429,794,1026,322,283,29,105,105,1999,6,6,6,60,36,2877,2,2,8,27,0,1546,308,231,135,285,205,205,205,196,625,399,507,1428,2823,1453,1453,296,296,495,560,560,533,533,452,178,232,513,954,3053,1484,1050,1050,250,1179,338,138,1092,1092,665,299,null,null,null,null,null,null,null,null,null,null,null,null,null],[876,43,43,112,805,805,805,8017,8017,8017,338,338,338,92,498,1010,1010,1010,107,255,124,124,162,501,501,501,501,10894,350,579,579,24,198,293,633,126,10644,492,606,20,53,323,323,323,274,274,274,274,255,46,270,474,12,261,246,246,246,177,177,384,682,682,682,155,155,155,487,392,392,392,45,45,1139,140,239,239,174,283,71,1358,1358,1527,471,294,271,271,453,125,125,182,413,47,47,47,441,0,112,1935,1935,3696,3696,127,45,45,137,4784,248,605,605,11,918,918,672,672,231,67,61,61,461,461,0,337,337,601,443,514,38,51,599,71,51,329,329,602,602,9029,606,1258,145,2395,2395,164,87,826,195,81,898,898,369,369,314,314,192,2024,913,913,368,358,587,165,242,269,94,3137,699,699,106,106,406,406,406,406,68,101,101,101,101,101,549,97,97,97,250,303,303,160,27,1658,817,817,817,122,103,562,562,0,2133,2133,153,563,668,668,342,342,150,0,0,173,173,179,106,2020,2020,136,79,294,294,252,5735,10,410,410,38,489,489,0,61,1926,1926,421,421,421,289,289,487,487,852,852,852,211,1215,1215,1215,196,203,1436,1538,1835,40,524,409,289,170,170,155,155,146,146,146,101,458,161,161,161,532,532,532,532,64,181,14,203,203,2045,36,63,516,516,516,2553,192,169,169,169,169,126,166,1710,1710,0,37,37,37,890,16,49,212,212,305,70,354,1001,171,1521,1225,1225,1225,239,492,492,492,252,252,198,198,0,104,104,104,72,1797,959,959,24,949,949,949,949,60,293,401,163,404,404,3005,3005,147,147,354,192,584,734,68,223,961,1944,574,448,668,115,115,115,91,0,765,765,201,201,0,69,69,69,1334,331,331,127,215,215,20,98,1021,1021,55,213,213,213,0,0,0,594,768,175,25,541,607,194,240,174,62,101,56,47,254,234,87,87,87,534,48,654,112,112,112,21,21,29,336,483,971,160,164,34,19,19,6120,0,0,0,34,37,2600,0,0,0,0,27,72,310,245,139,109,124,124,124,182,443,298,926,1209,2190,747,747,245,245,422,2947,2947,1423,1423,360,158,181,406,3004,2629,4240,277,277,222,487,308,32,136,136,294,400,null,null,null,null,null,null,null,null,null,null,null,null,null],[603,48,48,0,396,396,396,16492,16492,16492,187,187,187,86,460,1477,1477,1477,46,409,161,161,113,711,711,711,711,17061,304,466,466,0,133,192,327,79,17265,325,488,0,16,158,158,158,193,193,193,193,117,38,318,353,7,229,352,352,352,53,53,405,680,680,680,166,166,166,671,408,408,408,0,0,1254,184,85,85,42,222,90,1097,1097,396,592,101,221,221,364,100,100,155,283,8,8,8,400,0,179,2275,2275,2898,2898,395,66,66,212,2487,291,234,234,0,1004,1004,794,794,104,53,31,31,458,458,0,95,95,461,335,324,5,0,244,22,0,215,215,319,319,13166,652,2610,95,2071,2071,96,58,795,299,71,712,712,87,87,417,417,505,1188,1845,1845,743,306,386,109,126,641,99,2758,1041,1041,222,222,403,403,403,403,58,47,47,47,47,47,333,127,127,127,176,245,245,38,26,1153,655,655,655,171,33,194,194,0,1884,1884,129,430,531,531,243,243,174,87,0,141,141,272,0,1812,1812,254,43,371,371,149,16431,21,225,225,0,724,724,33,154,1122,1122,1032,1032,1032,121,121,371,371,382,382,382,392,1084,1084,1084,168,287,1010,800,864,73,712,126,84,111,111,14,14,95,95,95,0,208,578,578,578,459,459,459,459,0,162,0,191,191,1660,101,120,360,360,360,388,98,106,106,106,106,133,80,2984,2984,0,59,59,59,717,0,27,185,185,124,40,157,519,26,1521,290,290,290,205,345,345,345,101,101,160,160,0,48,48,48,83,768,546,546,25,1672,1672,1672,1672,196,367,191,181,172,172,2425,2425,207,207,328,204,674,695,40,208,650,876,337,337,947,31,31,31,4,0,412,412,163,163,0,50,50,50,1863,619,619,0,214,214,64,196,1378,1378,34,41,41,41,0,0,0,636,1484,121,0,207,640,149,185,180,126,111,32,64,339,77,39,39,39,275,11,506,43,43,43,0,0,0,429,421,1385,38,236,0,0,0,3825,0,0,0,10,29,2179,0,0,0,46,0,36,217,229,95,81,60,60,60,279,364,475,725,1383,1265,517,517,169,169,332,2821,2821,1036,1036,230,205,365,333,2359,2834,2044,283,283,208,635,145,0,340,340,267,532,null,null,null,null,null,null,null,null,null,null,null,null,null],[845,29,29,113,1206,1206,1206,18163,18163,18163,319,319,319,96,368,1033,1033,1033,243,197,73,73,213,1476,1476,1476,1476,29972,214,467,467,20,88,207,597,142,34168,803,855,17,74,204,204,204,210,210,210,210,152,125,146,482,42,253,246,246,246,216,216,341,366,366,366,132,132,132,276,841,841,841,25,25,1730,284,265,265,165,160,222,1774,1774,521,866,457,352,352,544,62,62,183,354,60,60,60,528,134,575,666,666,5688,5688,561,4,4,110,3848,341,1541,1541,15,2077,2077,1660,1660,507,72,99,99,268,268,0,247,247,641,471,863,134,13,330,72,28,512,512,833,833,5742,1190,3043,112,2419,2419,365,543,1359,116,142,544,544,389,389,228,228,106,1910,2266,2266,215,596,1004,97,472,1313,340,1273,351,351,87,87,271,271,271,271,253,222,222,222,222,222,267,89,89,89,643,79,79,86,0,2495,1381,1381,1381,130,246,973,973,0,2331,2331,124,474,177,177,579,579,157,83,69,380,380,463,195,2132,2132,99,122,207,207,239,3876,78,958,958,51,929,929,57,189,2696,2696,1325,1325,1325,182,182,219,219,1527,1527,1527,58,540,540,540,85,516,1090,2696,1382,136,1481,305,340,146,146,117,117,180,180,180,98,228,133,133,133,384,384,384,384,34,181,48,96,96,2547,159,325,205,205,205,2251,142,209,209,209,209,555,282,2785,2785,27,19,19,19,1005,0,89,390,390,244,82,187,652,145,964,1712,1712,1712,303,323,323,323,281,281,115,115,25,131,131,131,199,2110,545,545,58,610,610,610,610,159,1264,210,115,440,440,4006,4006,262,262,552,383,932,169,46,237,718,2680,914,834,1078,95,95,95,189,0,533,533,137,137,69,154,154,154,703,219,219,101,107,107,0,53,2078,2078,65,301,301,301,0,0,0,1774,2834,337,108,398,1351,397,161,461,211,116,19,46,158,163,237,237,237,1838,0,513,0,0,0,25,25,34,125,216,699,297,82,14,13,13,9483,0,0,0,111,27,2966,0,0,347,27,15,65,106,67,28,153,126,126,126,253,1894,702,1130,955,1197,506,506,177,177,340,6065,6065,2020,2020,297,192,266,595,1719,3271,4493,163,163,643,274,203,25,576,576,217,254,null,null,null,null,null,null,null,null,null,null,null,null,null],[858,31,31,94,1002,1002,1002,1344,1344,1344,321,321,321,98,509,787,787,787,217,657,287,287,91,115,115,115,115,789,255,606,606,45,286,155,607,59,1579,2208,943,0,17,427,427,427,221,221,221,221,515,11,351,848,40,276,209,209,209,81,81,302,1133,1133,1133,216,216,216,1018,620,620,620,131,131,512,119,205,205,355,251,115,1248,1248,1031,760,172,233,233,309,244,244,166,149,56,56,56,396,68,280,1078,1078,3546,3546,150,51,51,53,2257,122,232,232,0,280,280,189,189,279,58,42,42,282,282,25,309,309,618,271,205,66,43,397,53,22,228,228,217,217,3753,630,358,301,796,796,258,199,524,269,118,1523,1523,312,312,615,615,376,1504,390,390,285,479,369,82,221,99,191,1601,588,588,114,114,414,414,414,414,42,148,148,148,148,148,391,140,140,140,656,199,199,254,28,1133,362,362,362,140,231,207,207,15,777,777,83,329,542,542,163,163,89,14,16,45,45,385,41,2108,2108,178,226,583,583,320,39083,47,319,319,31,204,204,26,118,763,763,232,232,232,339,339,1176,1176,843,843,843,229,588,588,588,175,9,1195,1932,731,114,314,269,736,150,150,144,144,147,147,147,81,230,152,152,152,1145,1145,1145,1145,34,244,79,547,547,569,81,82,410,410,410,586,300,275,275,275,275,64,214,938,938,23,71,71,71,294,33,102,32,32,267,59,512,887,137,2294,965,965,965,638,282,282,282,327,327,344,344,86,29,29,29,230,702,184,184,149,5601,5601,5601,5601,163,434,331,201,368,368,368,368,282,282,172,198,64,684,54,162,553,1330,418,536,502,82,82,82,56,0,6836,6836,334,334,4,167,167,167,1319,464,464,320,698,698,118,129,305,305,38,7,7,7,0,0,0,125,360,135,0,766,169,460,87,136,338,187,106,84,186,137,98,98,98,193,50,472,83,83,83,142,142,66,361,842,800,109,181,12,128,128,1116,0,0,0,66,13,1537,0,0,0,25,0,184,114,193,76,145,162,162,162,279,244,235,311,842,1919,818,818,292,292,293,330,330,277,277,130,122,132,558,325,1406,2042,517,517,52,570,155,37,326,326,282,182,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>V2<\/th>\n      <th>V1<\/th>\n      <th>V3<\/th>\n      <th>V4<\/th>\n      <th>V5<\/th>\n      <th>V6<\/th>\n      <th>V7<\/th>\n      <th>V8<\/th>\n      <th>V9<\/th>\n      <th>V10<\/th>\n      <th>V11<\/th>\n      <th>V12<\/th>\n      <th>ACR-173-TP1<\/th>\n      <th>ACR-145-TP4<\/th>\n      <th>ACR-237-TP3<\/th>\n      <th>ACR-244-TP4<\/th>\n      <th>ACR-186-TP2<\/th>\n      <th>ACR-244-TP2<\/th>\n      <th>ACR-225-TP3<\/th>\n      <th>ACR-150-TP4<\/th>\n      <th>ACR-173-TP3<\/th>\n      <th>ACR-229-TP1<\/th>\n      <th>ACR-265-TP4<\/th>\n      <th>ACR-173-TP4<\/th>\n      <th>ACR-139-TP4<\/th>\n      <th>ACR-265-TP2<\/th>\n      <th>ACR-225-TP4<\/th>\n      <th>ACR-237-TP4<\/th>\n      <th>ACR-229-TP2<\/th>\n      <th>ACR-237-TP2<\/th>\n      <th>ACR-229-TP4<\/th>\n      <th>ACR-265-TP3<\/th>\n      <th>ACR-150-TP2<\/th>\n      <th>ACR-139-TP3<\/th>\n      <th>ACR-237-TP1<\/th>\n      <th>ACR-173-TP2<\/th>\n      <th>ACR-150-TP3<\/th>\n      <th>ACR-145-TP3<\/th>\n      <th>ACR-244-TP3<\/th>\n      <th>ACR-225-TP1<\/th>\n      <th>ACR-186-TP3<\/th>\n      <th>ACR-225-TP2<\/th>\n      <th>ACR-229-TP3<\/th>\n      <th>ACR-186-TP4<\/th>\n      <th>ACR-145-TP1<\/th>\n      <th>ACR-139-TP2<\/th>\n      <th>ACR-244-TP1<\/th>\n      <th>ACR-139-TP1<\/th>\n      <th>ACR-150-TP1<\/th>\n      <th>ACR-186-TP1<\/th>\n      <th>ACR-265-TP1<\/th>\n      <th>ACR-145-TP2<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"searchHighlight":true,"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"V2","targets":1},{"name":"V1","targets":2},{"name":"V3","targets":3},{"name":"V4","targets":4},{"name":"V5","targets":5},{"name":"V6","targets":6},{"name":"V7","targets":7},{"name":"V8","targets":8},{"name":"V9","targets":9},{"name":"V10","targets":10},{"name":"V11","targets":11},{"name":"V12","targets":12},{"name":"ACR-173-TP1","targets":13},{"name":"ACR-145-TP4","targets":14},{"name":"ACR-237-TP3","targets":15},{"name":"ACR-244-TP4","targets":16},{"name":"ACR-186-TP2","targets":17},{"name":"ACR-244-TP2","targets":18},{"name":"ACR-225-TP3","targets":19},{"name":"ACR-150-TP4","targets":20},{"name":"ACR-173-TP3","targets":21},{"name":"ACR-229-TP1","targets":22},{"name":"ACR-265-TP4","targets":23},{"name":"ACR-173-TP4","targets":24},{"name":"ACR-139-TP4","targets":25},{"name":"ACR-265-TP2","targets":26},{"name":"ACR-225-TP4","targets":27},{"name":"ACR-237-TP4","targets":28},{"name":"ACR-229-TP2","targets":29},{"name":"ACR-237-TP2","targets":30},{"name":"ACR-229-TP4","targets":31},{"name":"ACR-265-TP3","targets":32},{"name":"ACR-150-TP2","targets":33},{"name":"ACR-139-TP3","targets":34},{"name":"ACR-237-TP1","targets":35},{"name":"ACR-173-TP2","targets":36},{"name":"ACR-150-TP3","targets":37},{"name":"ACR-145-TP3","targets":38},{"name":"ACR-244-TP3","targets":39},{"name":"ACR-225-TP1","targets":40},{"name":"ACR-186-TP3","targets":41},{"name":"ACR-225-TP2","targets":42},{"name":"ACR-229-TP3","targets":43},{"name":"ACR-186-TP4","targets":44},{"name":"ACR-145-TP1","targets":45},{"name":"ACR-139-TP2","targets":46},{"name":"ACR-244-TP1","targets":47},{"name":"ACR-139-TP1","targets":48},{"name":"ACR-150-TP1","targets":49},{"name":"ACR-186-TP1","targets":50},{"name":"ACR-265-TP1","targets":51},{"name":"ACR-145-TP2","targets":52}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><em>Select Gene for Expression Plot</em></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
</section>
<section id="cpg-methylation" class="level1">
<h1>CpG Methylation</h1>
<p>Also looked at CpG Methylation in time-series data.</p>
<section id="prior-had-generated-10x-bedgraph-for-apul." class="level2">
<h2 class="anchored" data-anchor-id="prior-had-generated-10x-bedgraph-for-apul.">Prior had generated 10x bedgraph for APul.</h2>
<p>15.5</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/15.5-Apul-bismark/</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>merged_CpG_evidence.cov</span>
<span id="cb1-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-5">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STEM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _R1_001.fastp-trim_bismark_bt2.CpG_report.merged_CpG_evidence.cov<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN {OFS = FS} {if ($5+$6 &gt;= 10) {print $1, $2, $3, $4}}'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-7">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STEM}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_10x.bedgraph</span>
<span id="cb1-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<pre><code>ntLink_0    25585   25587   0.000000
ntLink_0    25624   25626   0.000000
ntLink_0    25777   25779   0.000000
ntLink_0    25779   25781   0.000000
ntLink_0    25788   25790   0.000000
ntLink_0    25803   25805   0.000000
ntLink_0    25811   25813   0.000000
ntLink_0    25830   25832   0.000000
ntLink_0    90500   90502   0.000000
ntLink_0    90540   90542   0.000000
ntLink_0    90562   90564   0.000000
ntLink_0    90722   90724   0.000000
ntLink_0    94077   94079   0.000000
ntLink_0    94090   94092   0.000000
ntLink_0    94095   94097   0.000000
ntLink_0    94098   94100   0.000000
ntLink_1    2597    2599    0.000000
ntLink_1    2613    2615    0.000000
ntLink_1    2626    2628    0.000000
ntLink_1    4093    4095    0.000000
ntLink_1    4151    4153    0.000000
ntLink_1    4740    4742    10.000000
ntLink_1    4831    4833    0.000000</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/15.5-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "CpG_"_$1"_"$2, $4}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_processed.txt"</span></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<pre><code>CpG_ntLink_0_25692 0.000000
CpG_ntLink_0_25699 0.000000
CpG_ntLink_0_80003 58.333333
CpG_ntLink_0_90500 0.000000
CpG_ntLink_0_90540 0.000000
CpG_ntLink_0_90562 0.000000
CpG_ntLink_0_90633 0.000000
CpG_ntLink_0_90648 0.000000
CpG_ntLink_0_90653 15.384615
CpG_ntLink_0_90671 0.000000
CpG_ntLink_0_94077 0.000000
CpG_ntLink_0_94090 0.000000
CpG_ntLink_0_94095 0.000000
CpG_ntLink_0_94098 0.000000
CpG_ntLink_1_4093 0.000000</code></pre>
<p>From here Kathleen filtered such that</p>
</section>
<section id="wgbs-data" class="level2">
<h2 class="anchored" data-anchor-id="wgbs-data">WGBS data</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pull processed files from Gannet </span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: Unfortunately we can't use the `cache` feature to make this process more time efficient, as it doesn't support long vectors</span></span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base URL</span></span>
<span id="cb5-5">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/"</span></span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the HTML page</span></span>
<span id="cb5-8">page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(base_url)</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract links to files</span></span>
<span id="cb5-11">file_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for files ending in "processed.txt"</span></span>
<span id="cb5-16">processed_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"processed</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.txt$"</span>, file_links)]</span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create full URLs</span></span>
<span id="cb5-19">file_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, processed_files)</span>
<span id="cb5-20"></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to read a file from URL</span></span>
<span id="cb5-22">read_processed_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(url) {</span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_table</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read as character to avoid parsing issues</span></span>
<span id="cb5-24">}</span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import all processed files into a list</span></span>
<span id="cb5-27">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(file_urls, read_processed_file)</span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name the list elements by file name</span></span>
<span id="cb5-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> processed_files</span>
<span id="cb5-31"></span>
<span id="cb5-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of imported data</span></span>
<span id="cb5-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(processed_data)</span>
<span id="cb5-34"></span>
<span id="cb5-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a header row that has "CpG" for the first column and "sample" for the second column, which will be populated by the file name </span></span>
<span id="cb5-36"></span>
<span id="cb5-37">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Map</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df, filename) {</span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, filename)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns</span></span>
<span id="cb5-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb5-40">}, processed_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use stored file names</span></span>
<span id="cb5-41"></span>
<span id="cb5-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#merge files together by "CpG"</span></span>
<span id="cb5-43">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(processed_data, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>)</span>
<span id="cb5-44"></span>
<span id="cb5-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of final merged data</span></span>
<span id="cb5-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(merged_data)</span></code></pre></div>
</div>
<p>Replace any NA with 0.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all columns (except "CpG") to numeric and replace NAs with 0</span></span>
<span id="cb6-2">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, as.numeric)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all except CpG to numeric</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replace_na</span>(.x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace NA with 0 in numeric columns</span></span></code></pre></div>
</div>
</section>
<section id="filter-data-sets" class="level2">
<h2 class="anchored" data-anchor-id="filter-data-sets">Filter data sets</h2>
<p>Only keep CpGs that have a non-zero value in all samples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_all</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure it's formatted as a data frame</span></span>
<span id="cb7-4">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(filtered_wgbs)</span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only keep the sample information in the column name. </span></span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*?)_.*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs))</span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set CpG IDs to rownames</span></span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CpG</span>
<span id="cb7-9">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG)</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(merged_data)</span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(filtered_wgbs)</span></code></pre></div>
</div>
<p>We had 12,093,025 CpGs before filtering and have only 507 after filtering. This makes sense because most CpGs were not methylated in all samples.</p>
<p>Save filtered set to make code reruns/knitting quicker</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(filtered_wgbs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/22.3-Apul-multiomic-machine-learning-byTP/filtered-WGBS-CpG-counts.csv"</span>)</span></code></pre></div>
</div>
<p><em>Need to revisit filtering</em></p>
<hr>
</section>
<section id="ptua-cpg-methylation" class="level2">
<h2 class="anchored" data-anchor-id="ptua-cpg-methylation">Ptua CpG Methylation</h2>
<p>Shelly did alignment</p>
<pre><code># run pipeline
nextflow run nf-core/methylseq \
-c /gscratch/srlab/strigg/bin/uw_hyak_srlab.config \
--input /gscratch/scrubbed/strigg/analyses/20250422_methylseq/samplesheet.csv \
--outdir /gscratch/scrubbed/strigg/analyses/20250422_methylseq \
--fasta /gscratch/srlab/strigg/GENOMES/Pocillopora_meandrina_HIv1.assembly.fasta \
--em_seq \
-resume \
-with-report nf_report.html \
-with-trace \
-with-timeline nf_timeline.html \
--skip_trimming \
--nomeseq 

### Results

- Multiqc report: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/multiqc/bismark/multiqc_report.html](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/multiqc/bismark/multiqc_report.html)
- Bismark summary report: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/summary/bismark_summary_report.html](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/summary/bismark_summary_report.html)
- Pipeline report: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/nf_report.html](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/nf_report.html)
- Pipeline timeline: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/nf_timeline.html](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/nf_timeline.html)
- Counts matrices: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/methylation_calls/methylation_coverage/](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/methylation_calls/methylation_coverage/)
    - &lt;sample_name&gt;.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz
- Deduplicated sorted bam files: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/deduplicated/](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/deduplicated/) 
    - &lt;sample_name&gt;.deduplicated.sorted.bam 
- Other bismark output: [https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/](https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250422_methylseq/bismark/)</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../data/dedup-cov/methylation_calls/methylation_coverage/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 24 /home/shared/Bismark-0.24.0/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">--genome_folder ../data/bs <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">-o ../output/05-Ptua-bismark-CG/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-8">../data/dedup-cov/methylation_calls/methylation_coverage/{}R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/05-Ptua-bismark-CG/</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>merged_CpG_evidence.cov</span>
<span id="cb11-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb11-5">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STEM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _.CpG_report.merged_CpG_evidence.cov<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb11-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN {OFS = FS} {if ($5+$6 &gt;= 5) {print $1, $2, $3, $4}}'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STEM}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_10x.bedgraph</span>
<span id="cb11-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/05-Ptua-bismark-CG/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb12-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "CpG_"_$1"_"$2, $4}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_processed.txt"</span></span>
<span id="cb12-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pull processed files from Gannet </span></span>
<span id="cb13-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: Unfortunately we can't use the `cache` feature to make this process more time efficient, as it doesn't support long vectors</span></span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base URL</span></span>
<span id="cb13-5">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/F-Ptua/output/05-Ptua-bismark-CG/"</span></span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the HTML page</span></span>
<span id="cb13-8">page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(base_url)</span>
<span id="cb13-9"></span>
<span id="cb13-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract links to files</span></span>
<span id="cb13-11">file_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb13-14"></span>
<span id="cb13-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for files ending in "processed.txt"</span></span>
<span id="cb13-16">processed_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"processed</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.txt$"</span>, file_links)]</span>
<span id="cb13-17"></span>
<span id="cb13-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create full URLs</span></span>
<span id="cb13-19">file_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, processed_files)</span>
<span id="cb13-20"></span>
<span id="cb13-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to read a file from URL</span></span>
<span id="cb13-22">read_processed_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(url) {</span>
<span id="cb13-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_table</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read as character to avoid parsing issues</span></span>
<span id="cb13-24">}</span>
<span id="cb13-25"></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import all processed files into a list</span></span>
<span id="cb13-27">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(file_urls, read_processed_file)</span>
<span id="cb13-28"></span>
<span id="cb13-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name the list elements by file name</span></span>
<span id="cb13-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> processed_files</span>
<span id="cb13-31"></span>
<span id="cb13-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of imported data</span></span>
<span id="cb13-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(processed_data)</span>
<span id="cb13-34"></span>
<span id="cb13-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a header row that has "CpG" for the first column and "sample" for the second column, which will be populated by the file name </span></span>
<span id="cb13-36"></span>
<span id="cb13-37">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Map</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df, filename) {</span>
<span id="cb13-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, filename)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns</span></span>
<span id="cb13-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb13-40">}, processed_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use stored file names</span></span>
<span id="cb13-41"></span>
<span id="cb13-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#merge files together by "CpG"</span></span>
<span id="cb13-43">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(processed_data, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>)</span>
<span id="cb13-44"></span>
<span id="cb13-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of final merged data</span></span>
<span id="cb13-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(merged_data)</span></code></pre></div>
</div>
<p>Replace any NA with 0.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all columns (except "CpG") to numeric and replace NAs with 0</span></span>
<span id="cb14-2">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, as.numeric)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all except CpG to numeric</span></span>
<span id="cb14-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replace_na</span>(.x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace NA with 0 in numeric columns</span></span></code></pre></div>
</div>
</section>
<section id="filter-data-sets-1" class="level2">
<h2 class="anchored" data-anchor-id="filter-data-sets-1">Filter data sets</h2>
<p>Only keep CpGs that have a non-zero value in all samples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_all</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure it's formatted as a data frame</span></span>
<span id="cb15-4">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(filtered_wgbs)</span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only keep the sample information in the column name. </span></span>
<span id="cb15-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*?)_.*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs))</span>
<span id="cb15-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set CpG IDs to rownames</span></span>
<span id="cb15-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CpG</span>
<span id="cb15-9">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG)</span>
<span id="cb15-10"></span>
<span id="cb15-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(merged_data)</span>
<span id="cb15-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(filtered_wgbs)</span></code></pre></div>
</div>
<pre><code>[1] 9111633
[1] 137292</code></pre>
<p><strong>We had 9111633 CpGs before filtering and have only 137292 after filtering.</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(filtered_wgbs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/05-Ptua-bismark-CG/filtered-WGBS-CpG-counts.csv"</span>)</span></code></pre></div>
</div>
</section>
</section>
<section id="why-such-a-descepancy-across-species-in-number-of-filtered-cpg" class="level1">
<h1>Why such a descepancy across species in number of filtered CpG?</h1>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/44-ROLPI-d1/</guid>
  <pubDate>Sat, 24 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_EpigeneticsSimulationMS_-_Online_LaTeX_Editor_Overleaf_2025-05-25_07-13-14.png" medium="image" type="image/png"/>
</item>
<item>
  <title>CpG Intersect</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/43-intersect/</link>
  <description><![CDATA[ 





<ul>
<li>1 genome</li>
<li>2 Full run</li>
<li>3 Intersectbed</li>
</ul>
<p>Annotating CpGs ….</p>
<p>methylation calls derived at <a href="https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/" class="uri">https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/</a></p>
<p>Now there are files for each of the Apul samples</p>
<p>@ <a href="https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/" class="uri">https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/</a></p>
<p>Maybe do all CpG in genome..</p>
<section id="genome" class="level1">
<h1>1 genome</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Apulcra-genome.fa</span></code></pre></div>
<pre><code>&gt;ntLink_7
TGTATTTCTAGAGATCTAAAGTACTCAGGATAGCTGAAAAAAAAACCGTC
GTTCTTTCCCTCTGAATTTCTCACTTAGGTTTTCTGGGATATGTGACGCG
CTGCAATCCTAAACAGCCACTAACGCCGGATGTCTTCAACCGAGCGCCTC
TGCTCGAAAGCTATCTGGACCATTTGAAGGTATGGTTCAGCTTGATTTAC
TGTTGCTTCGTAGTACTTTCATCCTGATGGTTCTAATGTGCTAAGTTTTC
GCACATATTCTAGGTCATTAGGTTCTAATAGCAATGAGCTTTCAGTGATT
CCCGAGAATACGCTTTCTGTAGCAGCAACTAAATTATGGAATGGTCTACC
CTAAAATCTTAGAAAGTCTACCTCGTATATCAGCAGGCTAACTGCTACGT
TCATTTTTCAAGCATTTGAAAGACGAAAGAAACAATAATAGTTAACCATA</code></pre>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(seqinr)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace 'input.fasta' with the name of your multi-sequence fasta file</span></span>
<span id="cb3-4">input_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Apulcra-genome.fa"</span></span>
<span id="cb3-5">sequences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.fasta</span>(input_file)</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set the seed for reproducibility (optional)</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb4-3"></span>
<span id="cb4-4">number_of_sequences_to_select <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sequences) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> number_of_sequences_to_select) {</span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"There are fewer than 10 sequences in the fasta file. All sequences will be selected."</span>)</span>
<span id="cb4-8">  number_of_sequences_to_select <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sequences)</span>
<span id="cb4-9">}</span>
<span id="cb4-10"></span>
<span id="cb4-11">selected_indices <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(sequences), number_of_sequences_to_select)</span>
<span id="cb4-12">selected_sequences <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sequences[selected_indices]</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace 'output.fasta' with your desired output file name</span></span>
<span id="cb5-2">output_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/28-Apul-CpG-Annotation/output.fasta"</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.fasta</span>(selected_sequences, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(selected_sequences), output_file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">open =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"w"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#likely will not need; fix issue where gff and fa name did not match</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sed -i 's/&gt;lcl|/&gt;/g' ../output/10_seqs.fa</span></span></code></pre></div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#needed downstream for IGV</span></span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/samtools-1.12/samtools</span> faidx <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">../output/28-Apul-CpG-Annotation/output.fasta</span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fuzznuc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sequence</span> ../output/28-Apul-CpG-Annotation/output.fasta <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-pattern</span> CG <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-rformat</span> gff <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfile</span> ../output/28-Apul-CpG-Annotation/CGoutput-10seq.gff</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> ../output/28-Apul-CpG-Annotation/CGoutput-10seq.gff</span></code></pre></div>
</section>
<section id="full-run" class="level1">
<h1>2 Full run</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">fuzznuc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sequence</span> ../data/Apulcra-genome.fa <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-pattern</span> CG <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-rformat</span> gff <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfile</span> ../output/28-Apul-CpG-Annotation/Apul-CG-motifs.gff</span></code></pre></div>
</section>
<section id="intersectbed" class="level1">
<h1>3 Intersectbed</h1>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> intersect <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-2">-a ../output/28-Apul-CpG-Annotation/Apul-CG-motifs.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">-b ../data/Apulchra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">-wb <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/28-Apul-CpG-Annotation/intersect_both.gff</span></code></pre></div>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/28-Apul-CpG-Annotation/intersect_both.gff</span></code></pre></div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-50</span> ../data/Apulchra-genome.gff</span></code></pre></div>
<pre><code>ptg000184l  funannotate exon    27291   27416   .   +   .   ID=FUN_044364-T1.exon2;Parent=FUN_044364-T1;
ptg000184l  funannotate exon    27559   27784   .   +   .   ID=FUN_044364-T1.exon3;Parent=FUN_044364-T1;
ptg000184l  funannotate exon    28179   28245   .   +   .   ID=FUN_044364-T1.exon4;Parent=FUN_044364-T1;
ptg000184l  funannotate exon    33400   35016   .   +   .   ID=FUN_044364-T1.exon5;Parent=FUN_044364-T1;
ptg000184l  funannotate CDS 26899   27163   .   +   0   ID=FUN_044364-T1.cds;Parent=FUN_044364-T1;
ptg000184l  funannotate CDS 27291   27416   .   +   2   ID=FUN_044364-T1.cds;Parent=FUN_044364-T1;
ptg000184l  funannotate CDS 27559   27784   .   +   2   ID=FUN_044364-T1.cds;Parent=FUN_044364-T1;
ptg000184l  funannotate CDS 28179   28245   .   +   1   ID=FUN_044364-T1.cds;Parent=FUN_044364-T1;
ptg000184l  funannotate CDS 33400   35016   .   +   0   ID=FUN_044364-T1.cds;Parent=FUN_044364-T1;
ptg000185l  funannotate gene    8952    9296    .   -   .   ID=FUN_044365;
ptg000185l  funannotate mRNA    8952    9296    .   -   .   ID=FUN_044365-T1;Parent=FUN_044365;product=hypothetical protein;
ptg000185l  funannotate exon    8952    9296    .   -   .   ID=FUN_044365-T1.exon1;Parent=FUN_044365-T1;
ptg000185l  funannotate CDS 8952    9296    .   -   0   ID=FUN_044365-T1.cds;Parent=FUN_044365-T1;
ptg000185l  funannotate gene    30137   34494   .   +   .   ID=FUN_044366;
ptg000185l  funannotate mRNA    30137   34494   .   +   .   ID=FUN_044366-T1;Parent=FUN_044366;product=hypothetical protein;
ptg000185l  funannotate exon    30137   30432   .   +   .   ID=FUN_044366-T1.exon1;Parent=FUN_044366-T1;
ptg000185l  funannotate exon    30536   30737   .   +   .   ID=FUN_044366-T1.exon2;Parent=FUN_044366-T1;
ptg000185l  funannotate exon    30865   31414   .   +   .   ID=FUN_044366-T1.exon3;Parent=FUN_044366-T1;
ptg000185l  funannotate exon    33568   34163   .   +   .   ID=FUN_044366-T1.exon4;Parent=FUN_044366-T1;
ptg000185l  funannotate exon    34251   34494   .   +   .   ID=FUN_044366-T1.exon5;Parent=FUN_044366-T1;
ptg000185l  funannotate CDS 30137   30432   .   +   0   ID=FUN_044366-T1.cds;Parent=FUN_044366-T1;
ptg000185l  funannotate CDS 30536   30737   .   +   1   ID=FUN_044366-T1.cds;Parent=FUN_044366-T1;
ptg000185l  funannotate CDS 30865   31414   .   +   0   ID=FUN_044366-T1.cds;Parent=FUN_044366-T1;
ptg000185l  funannotate CDS 33568   34163   .   +   2   ID=FUN_044366-T1.cds;Parent=FUN_044366-T1;
ptg000185l  funannotate CDS 34251   34494   .   +   0   ID=FUN_044366-T1.cds;Parent=FUN_044366-T1;
ptg000186l  funannotate gene    587 1375    .   +   .   ID=FUN_044367;
ptg000186l  funannotate mRNA    587 1375    .   +   .   ID=FUN_044367-T1;Parent=FUN_044367;product=hypothetical protein;
ptg000186l  funannotate exon    587 835 .   +   .   ID=FUN_044367-T1.exon1;Parent=FUN_044367-T1;
ptg000186l  funannotate exon    1070    1375    .   +   .   ID=FUN_044367-T1.exon2;Parent=FUN_044367-T1;
ptg000186l  funannotate CDS 587 835 .   +   0   ID=FUN_044367-T1.cds;Parent=FUN_044367-T1;
ptg000186l  funannotate CDS 1070    1375    .   +   0   ID=FUN_044367-T1.cds;Parent=FUN_044367-T1;
ptg000186l  funannotate gene    2304    2977    .   +   .   ID=FUN_044368;
ptg000186l  funannotate mRNA    2304    2977    .   +   .   ID=FUN_044368-T1;Parent=FUN_044368;product=hypothetical protein;
ptg000186l  funannotate exon    2304    2504    .   +   .   ID=FUN_044368-T1.exon1;Parent=FUN_044368-T1;
ptg000186l  funannotate exon    2576    2977    .   +   .   ID=FUN_044368-T1.exon2;Parent=FUN_044368-T1;
ptg000186l  funannotate CDS 2304    2504    .   +   0   ID=FUN_044368-T1.cds;Parent=FUN_044368-T1;
ptg000186l  funannotate CDS 2576    2977    .   +   0   ID=FUN_044368-T1.cds;Parent=FUN_044368-T1;
ptg000186l  funannotate gene    8523    11277   .   +   .   ID=FUN_044369;
ptg000186l  funannotate mRNA    8523    11277   .   +   .   ID=FUN_044369-T1;Parent=FUN_044369;product=hypothetical protein;
ptg000186l  funannotate exon    8523    8549    .   +   .   ID=FUN_044369-T1.exon1;Parent=FUN_044369-T1;
ptg000186l  funannotate exon    10894   11277   .   +   .   ID=FUN_044369-T1.exon2;Parent=FUN_044369-T1;
ptg000186l  funannotate CDS 8523    8549    .   +   0   ID=FUN_044369-T1.cds;Parent=FUN_044369-T1;
ptg000186l  funannotate CDS 10894   11277   .   +   0   ID=FUN_044369-T1.cds;Parent=FUN_044369-T1;
ptg000186l  funannotate gene    18980   19053   .   -   .   ID=FUN_044370;
ptg000186l  funannotate tRNA    18980   19053   .   -   .   ID=FUN_044370-T1;Parent=FUN_044370;product=tRNA-Thr;
ptg000186l  funannotate exon    18980   19053   .   -   .   ID=FUN_044370-T1.exon1;Parent=FUN_044370-T1;
ptg000187l  funannotate gene    16329   17045   .   -   .   ID=FUN_044371;
ptg000187l  funannotate mRNA    16329   17045   .   -   .   ID=FUN_044371-T1;Parent=FUN_044371;product=hypothetical protein;
ptg000187l  funannotate exon    16329   17045   .   -   .   ID=FUN_044371-T1.exon1;Parent=FUN_044371-T1;
ptg000187l  funannotate CDS 16329   17045   .   -   0   ID=FUN_044371-T1.cds;Parent=FUN_044371-T1;</code></pre>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'\t'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb15-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN {</span></span>
<span id="cb15-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  header = "##gff-version 3"</span></span>
<span id="cb15-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb15-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$0 ~ /^#/ { next }</span></span>
<span id="cb15-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb15-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  outfile = "../output/28-Apul-CpG-Annotation/" $3 ".gff"</span></span>
<span id="cb15-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  if (!(outfile in written)) {</span></span>
<span id="cb15-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print header &gt; outfile</span></span>
<span id="cb15-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    written[outfile] = 1</span></span>
<span id="cb15-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  }</span></span>
<span id="cb15-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  print &gt;&gt; outfile</span></span>
<span id="cb15-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}'</span> ../data/Apulchra-genome.gff</span></code></pre></div>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/28-Apul-CpG-Annotation/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>gff</span></code></pre></div>
<pre><code>../output/28-Apul-CpG-Annotation/Apul-CG-motifs.gff
../output/28-Apul-CpG-Annotation/CDS.gff
../output/28-Apul-CpG-Annotation/CG_intersect_mRNA.gff
../output/28-Apul-CpG-Annotation/CGoutput-10seq.gff
../output/28-Apul-CpG-Annotation/exon.gff
../output/28-Apul-CpG-Annotation/gene.gff
../output/28-Apul-CpG-Annotation/intersect_both.gff
../output/28-Apul-CpG-Annotation/mRNA.gff
../output/28-Apul-CpG-Annotation/tRNA.gff</code></pre>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> intersect <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-2">-a ../output/28-Apul-CpG-Annotation/Apul-CG-motifs.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3">-b ../output/28-Apul-CpG-Annotation/mRNA.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-4">-wb <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-5"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/28-Apul-CpG-Annotation/CG_intersect_mRNA.gff</span></code></pre></div>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/28-Apul-CpG-Annotation/CG_intersect_mRNA.gff</span></code></pre></div>
<pre><code>ntLink_7    fuzznuc nucleotide_motif    97  98  2   +   .   ID=ntLink_7.3;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    99  100 2   +   .   ID=ntLink_7.4;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    124 125 2   +   .   ID=ntLink_7.5;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    127 128 2   +   .   ID=ntLink_7.6;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    141 142 2   +   .   ID=ntLink_7.7;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    145 146 2   +   .   ID=ntLink_7.8;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    155 156 2   +   .   ID=ntLink_7.9;note=*pat pattern:CG  ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    209 210 2   +   .   ID=ntLink_7.10;note=*pat pattern:CG ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    250 251 2   +   .   ID=ntLink_7.11;note=*pat pattern:CG ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;
ntLink_7    fuzznuc nucleotide_motif    303 304 2   +   .   ID=ntLink_7.12;note=*pat pattern:CG ntLink_7    funannotate mRNA    79  4679    .   +   .   ID=FUN_002303-T1;Parent=FUN_002303;product=hypothetical protein;</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/43-intersect/</guid>
  <pubDate>Thu, 15 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_bestblogever_-_main_-_RStudio_2025-05-15_07-08-12.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Megan it</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/42-megan/</link>
  <description><![CDATA[ 





<p>Taking Megan for a spin for Renee</p>
<p>Read files</p>
<pre class="{bash}"><code>ls /home/shared/16TB_HDD_01/fish546/renee/</code></pre>
<pre><code>build
F1B-KM40_merged.fastq.gz
F1B-KM40_trimmed_R1_paired.fastq.gz
F1B-KM40_trimmed_R1_unpaired.fastq.gz
F1B-KM40_trimmed_R2_paired.fastq.gz
F1B-KM40_trimmed_R2_unpaired.fastq.gz
F2R-KM41_merged.fastq.gz
F2R-KM41_trimmed_R1_paired.fastq.gz
F2R-KM41_trimmed_R1_unpaired.fastq.gz
F2R-KM41_trimmed_R2_paired.fastq.gz
F2R-KM41_trimmed_R2_unpaired.fastq.gz
fastp.html
fastp.json
md5checksums_metagenomes_2025.txt
megahit
raw-data
Trimmomatic-0.39</code></pre>
<section id="diamond-blast" class="level2">
<h2 class="anchored" data-anchor-id="diamond-blast">Diamond blast</h2>
<pre class="{bash}"><code>    /home/shared/diamond-2.1.8 blastx \
    --db /home/shared/16TB_HDD_01/sam/databases/blastdbs/ncbi-nr-20250429.dmnd \
    --query /home/shared/16TB_HDD_01/fish546/renee/F2R-KM41_merged.fastq.gz \
    --out ../output/sr-blastx.daa \
    --outfmt 100 \
    --top 5 \
    --block-size 15.0 \
    --index-chunks 4 \
    --threads 32</code></pre>
</section>
<section id="meganizer" class="level2">
<h2 class="anchored" data-anchor-id="meganizer">Meganizer</h2>
<pre class="{bash}"><code>    /home/shared/megan-6.24.20/tools/daa-meganizer \
    --in ../output/sr-blastx.daa \
    --threads 32 \
    --mapDB ../data/megan-map-Feb2022.db</code></pre>
</section>
<section id="daa2rma" class="level2">
<h2 class="anchored" data-anchor-id="daa2rma">daa2rma</h2>
<pre class="{bash}"><code>/home/shared/megan-6.24.20/tools/daa2rma \
--in ../output/sr-blastx.daa \
--mapDB ../data/megan-map-Feb2022.db \
--out ../output/sr-blastx-meganized.rma6 \
--threads 40 2&gt;&amp;1 | tee --append ../output/daa2rma_log.txt
</code></pre>
<p>Open MEGAN on locally and looked at rda file</p>
<p>pdf: <a href="http://gannet.fish.washington.edu/seashell/snaps/sr-blastx-meganized.pdf" class="uri">http://gannet.fish.washington.edu/seashell/snaps/sr-blastx-meganized.pdf</a></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/sr-blastx-meganized.png" class="img-fluid"></p>


<!-- -->

</section>

 ]]></description>
  <category>eDNA</category>
  <category>fish546</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/42-megan/</guid>
  <pubDate>Mon, 05 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_sr-blastx-meganized.rma6_-_MEGAN_Community_Edition_version_6.25.10_built_27_Jun_2024_2025-05-05_13-42-33.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Energy Stating</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/41-RI-coral/</link>
  <description><![CDATA[ 





<p>Tackled two primary tasks</p>
<p>Identified proteins involved in key energy utilization pathways and identified proteins corresponding to epigenetic machinery.</p>
<section id="for-the-energy-utilization-pathways" class="level1">
<h1>For the energy utilization pathways,</h1>
<p>we focused on the following:</p>
<pre><code>- Glycolysis GO:0006096
- Gluconeogenesis GO:0006094
- Lipolysis/lipid catabolism GO:0016042
- Fatty acid beta oxidation GO:0006635
- Starvation GO:0042594
- Lipid biosynthesis GO:0008610
- Protein catabolic process GO:0030163</code></pre>
<p>and ran something on order of.</p>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb2-2">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb2-5"> </span>
<span id="cb2-6">OUT_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/23-Apul-energy-GO/"</span></span>
<span id="cb2-7">evalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1E-20"</span></span>
<span id="cb2-8">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Apulchra-genome.pep.faa"</span></span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb2-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(</span>
<span id="cb2-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OUT_DIR =</span> OUT_DIR,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">evalue =</span> evalue,</span>
<span id="cb2-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta =</span>fasta</span>
<span id="cb2-15">)</span></code></pre></div>
</div>
</section>
<section id="glycolysis-go0006096" class="level1">
<h1>Glycolysis GO:0006096</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0006096"</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Proteins"</span></span>
<span id="cb3-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-11">-in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-14"></span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-17">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-18">-db <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-19">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-20">-evalue <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${evalue}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-21">-num_threads 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-22">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-23">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-24">-outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-25">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>blast_warnings<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.txt</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span>
<span id="cb3-28"></span>
<span id="cb3-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hits"</span></span>
<span id="cb3-30"></span>
<span id="cb3-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span></code></pre></div>
</div>
</section>
<section id="for-machinery" class="level1">
<h1>For Machinery…</h1>
<p>more along the lines of</p>
<p>Apul</p>
<p>https://raw.githubusercontent.com/urol-e5/deep-dive-expression/main/D-Apul/data/Apulchra-genome.pep.faa</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data</span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> Apulchra-genome.pep.faa https://raw.githubusercontent.com/urol-e5/deep-dive-expression/main/D-Apul/data/Apulchra-genome.pep.faa</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Apulchra-genome.pep.faa</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-in ../data/Apulchra-genome.pep.faa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-5">-out ../output/25-Apul-epimods-blast/Apul-proteins</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Machinery.fasta</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Machinery.fasta"</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-4">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-5">-db ../output/25-Apul-epimods-blast/Apul-proteins <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-6">-out ../output/25-Apul-epimods-blast/Mach-blastp-Apul_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-7">-evalue 1E-05 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-8">-num_threads 48 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-9">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-10">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-11">-outfmt 6</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/25-Apul-epimods-blast/Mach-blastp-Apul_out.tab</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/25-Apul-epimods-blast/Mach-blastp-Apul_out.tab</span></code></pre></div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>methylation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/41-RI-coral/</guid>
  <pubDate>Thu, 10 Apr 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_23_GO_Annoations_2025-04-10_12-36-18.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Getting to GO with Phenotype</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/41-Apul-GO/</link>
  <description><![CDATA[ 





<section id="go-annotations" class="level1">
<h1>GO Annotations</h1>
<p>Steven Roberts 2025-03-21</p>
<ul>
<li>Variables</li>
<li>Aerobic respiration (GO:0009060)</li>
<li>Oxidative phosphorylation (GO:0006119)</li>
<li>Canonical glycolysis (GO:0061621)</li>
<li>Tricarboxylic Acid Cycle (GO:0006099)</li>
<li>Summary of blast hits</li>
</ul>
<p>Want to start with grabbing protein with specific GOs</p>
<p>see also https://www.ebi.ac.uk/QuickGO/annotations</p>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb1-2">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb1-5"> </span>
<span id="cb1-6">OUT_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/27-Apul-pheno-annot/"</span></span>
<span id="cb1-7">evalue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1E-20"</span></span>
<span id="cb1-8">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Apulchra-genome.pep.faa"</span></span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb1-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(</span>
<span id="cb1-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OUT_DIR =</span> OUT_DIR,</span>
<span id="cb1-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">evalue =</span> evalue,</span>
<span id="cb1-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta =</span>fasta</span>
<span id="cb1-15">)</span></code></pre></div>
</section>
<section id="aerobic-respiration-go0009060" class="level1">
<h1>Aerobic respiration (GO:0009060)</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0009060"</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Proteins"</span></span>
<span id="cb2-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb2-9"></span>
<span id="cb2-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-11">-in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-12">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-13">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-14"></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-17">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-18">-db <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-19">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-20">-evalue <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${evalue}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-21">-num_threads 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-22">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-23">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-24">-outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-25">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>blast_warnings<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.txt</span>
<span id="cb2-26"></span>
<span id="cb2-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hits"</span></span>
<span id="cb2-30"></span>
<span id="cb2-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span></code></pre></div>
<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
100  673k    0  673k    0     0   378k      0 --:--:--  0:00:01 --:--:--  377k
100 2157k    0 2157k    0     0   768k      0 --:--:--  0:00:02 --:--:--  768k
100 3305k    0 3305k    0     0   868k      0 --:--:--  0:00:03 --:--:--  868k
100 4953k    0 4953k    0     0  1015k      0 --:--:--  0:00:04 --:--:-- 1015k
100 5219k    0 5219k    0     0  1064k      0 --:--:--  0:00:04 --:--:-- 1346k
&gt;sp|A0A096P8D3|IDH_OSTTA Isocitrate dehydrogenase (NAD(+)), mitochondrial OS=Ostreococcus tauri OX=70448 GN=IDH PE=1 SV=1
MTRVERGRVLARAIERAVAHRASARRWTTTTRTPAWMVTGWMGGRGVDRSTAMTRFERCG
STASSKITAAPMVYVRGEEMTAYVMDLIRSRWIEPRVDVGGWETFDLRAKNRDDTEDRVL
RDVIEAGKRIKAIFKEPTVTPTADQVKRLGLRKSWGSPNGAMRRGWNGITISRDTIHIDG
VELGYKKPVLFERHAVGGEYSAGYKNVGKGKLTTTFTPSEGPDAGKTVVVDEREIVDEEA
AVVTYHNPYDNVHDLARFFFGRCLEAKVTPYVVTKKTVFKWQEPFWQIMRTVFDEEFKAQ
FVAAGVMKEGEELVHLLSDAATMKLVQWRQGGFGMAAHNYDGDVLTDELAQVHKSPGFIT
SNLVGVHEDGTLIKEFEASHGTVADMDEARLRGEETSLNPLGMVEGLIGAMNHAADVHNI
DRDRTHAFTTKMRTVIHQLFREGKGTRDLCGPSGLTTEQFIDAVAERLDA
&gt;sp|A0A0D2Y5A7|ODP2_FUSO4 Dihydrolipoyllysine-residue acetyltransferase component of pyruvate dehydrogenase complex, mitochondrial OS=Fusarium oxysporum f. sp. lycopersici (strain 4287 / CBS 123668 / FGSC 9935 / NRRL 34936) OX=426428 GN=LAT1 PE=1 SV=1
Number of Proteins
10978


Building a new DB, current time: 03/21/2025 12:49:44
New DB name:   /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0009060
New DB title:  ../output/27-Apul-pheno-annot/SwissProt-GO:0009060.fa
Sequence type: Protein
Deleted existing Protein BLAST database named /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0009060
Keep MBits: T
Maximum file size: 3000000000B
Adding sequences from FASTA; added 10978 sequences in 0.179029 seconds.


FUN_000047-T1   sp|Q757N1|H3_EREGS  88.971  136 15  0   4   139 1   136 2.14e-86    246
FUN_000049-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000051-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000053-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000055-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000057-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000059-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000061-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000063-T1   sp|Q757N1|H3_EREGS  92.079  101 8   0   1   101 1   101 1.61e-63    190
FUN_000065-T1   sp|Q757N1|H3_EREGS  88.971  136 15  0   4   139 1   136 2.14e-86    246
Number of hits
616 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0009060_out.tab</code></pre>
</section>
<section id="oxidative-phosphorylation-go0006119" class="level1">
<h1>Oxidative phosphorylation (GO:0006119)</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0006119"</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Proteins"</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-11">-in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-12">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-13">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-17">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-18">-db <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-19">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-20">-evalue <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${evalue}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-21">-num_threads 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-22">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-23">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-24">-outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-25">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>blast_warnings<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.txt</span>
<span id="cb4-26"></span>
<span id="cb4-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hits"</span></span>
<span id="cb4-30"></span>
<span id="cb4-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span></code></pre></div>
<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  479k    0  479k    0     0   285k      0 --:--:--  0:00:01 --:--:--  285k
100 2632k    0 2632k    0     0   969k      0 --:--:--  0:00:02 --:--:--  969k
100 2675k    0 2675k    0     0   984k      0 --:--:--  0:00:02 --:--:--  983k
&gt;sp|A0A1D8PHA3|CYT1_CANAL Cytochrome b-c1 complex catalytic subunit, mitochondrial OS=Candida albicans (strain SC5314 / ATCC MYA-2876) OX=237561 GN=CYT1 PE=1 SV=1
MFRTAYKTMNQSMVQKFIAGGVGVTGLTASYLLYQDSMTADAMTAAEHGLHPPAYNWPHN
GMFETFDHASIRRGFQVYREVCAACHSLDRIAWRNLVGVSHTTSEAKAMAEELEYDDEPD
DEGKPRKRPGKLADYIPGPYENEQAARAANQGAYPPDLSLIVKARHGGSDYIFSLLTGYP
DEPPAGVVLPEGSNYNPYFPGGAIAMGRVLFDDLVEYEDGTPATTSQMAKDVSTFLNWAS
EPEHDDRKKWGLKALVVLSSLYLLSIWVKRFKWTPIKNRKFRFDPPKK
&gt;sp|A0A1D8PJX3|RIP1_CANAL Cytochrome b-c1 complex subunit Rieske, mitochondrial OS=Candida albicans (strain SC5314 / ATCC MYA-2876) OX=237561 GN=RIP1 PE=1 SV=1
MSSLAFRTLRNGLGLKSSVRALSTTTTTLSNYQQPDYSSYLNNKSGQGSRNFTYFMVGSM
GLLSAAGAKSTVEAFLSSFAASADVLAMAKVEVKLGAIPEGKNVIIKWQGKPVFIRHRTA
DEIEEANQVDIKTLRDPQNDADRVKKPEWLIMLGICTHLGCVPIGEAGDFGGWFCPCHGS
Number of Proteins
6140


Building a new DB, current time: 03/21/2025 12:50:54
New DB name:   /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0006119
New DB title:  ../output/27-Apul-pheno-annot/SwissProt-GO:0006119.fa
Sequence type: Protein
Deleted existing Protein BLAST database named /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0006119
Keep MBits: T
Maximum file size: 3000000000B
Adding sequences from FASTA; added 6140 sequences in 0.103551 seconds.


FUN_000943-T1   sp|Q791V5|MTCH2_MOUSE   41.549  284 162 2   24  305 8   289 2.00e-80    243
FUN_000977-T1   sp|Q6XHB2|ROCO4_DICDI   30.035  283 163 10  589 848 1023    1293    6.93e-28    119
FUN_001181-T1   sp|O52683|HYDA_THEMA    29.902  408 237 17  115 515 184 549 5.65e-40    151
FUN_001463-T1   sp|Q6XHB2|ROCO4_DICDI   27.059  340 219 14  1552    1876    954 1279    1.37e-23    107
FUN_001483-T1   sp|Q6CFT7|ATPB_YARLI    25.301  415 280 10  45  448 52  447 3.17e-29    117
FUN_001648-T1   sp|P24539|AT5F1_HUMAN   39.691  194 108 3   15  207 62  247 2.52e-38    130
FUN_001648-T2   sp|P24539|AT5F1_HUMAN   40.314  191 105 3   47  236 62  244 2.48e-38    131
FUN_003901-T1   sp|P29410|KAD2_RAT  34.314  204 105 5   30  204 20  223 9.03e-29    105
FUN_004027-T1   sp|Q05752|NDUA7_BOVIN   53.947  76  34  1   1   75  1   76  6.67e-23    83.2
FUN_004095-T1   sp|Q6XHB2|ROCO4_DICDI   28.975  283 175 10  37  301 1015    1289    2.80e-21    96.3
Number of hits
130 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0006119_out.tab</code></pre>
</section>
<section id="canonical-glycolysis-go0061621" class="level1">
<h1>Canonical glycolysis (GO:0061621)</h1>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0061621"</span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Proteins"</span></span>
<span id="cb6-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-11">-in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-12">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-13">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb6-14"></span>
<span id="cb6-15"></span>
<span id="cb6-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-17">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-18">-db <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-19">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-20">-evalue <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${evalue}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-21">-num_threads 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-22">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-23">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-24">-outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-25">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>blast_warnings<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.txt</span>
<span id="cb6-26"></span>
<span id="cb6-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span>
<span id="cb6-28"></span>
<span id="cb6-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hits"</span></span>
<span id="cb6-30"></span>
<span id="cb6-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span></code></pre></div>
<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
100  208k    0  208k    0     0   117k      0 --:--:--  0:00:01 --:--:--  117k
&gt;sp|A1A4J1|PFKAL_BOVIN ATP-dependent 6-phosphofructokinase, liver type OS=Bos taurus OX=9913 GN=PFKL PE=2 SV=1
MASVDLEKLRTTGAGKAIGVLTSGGDAQGMNAAVRAVTRMGIYVGAKVFLIYEGYEGLVE
GGENIKQANWLSVSNIIQLGGTVIGSARCKAFTTREGRRAAAYNLVQRGITNLCVIGGDG
SLTGANIFRSEWGSLLEELVSEGKISEGTAQTYSHLNIAGLVGSIDNDFCGTDMTIGTDS
ALHRIMEVIDAITTTAQSHQRTFVLEVMGRHCGYLALVSALASGADWLFIPEAPPEDGWE
NFMCERLGETRSRGSRLNIIIIAEGAIDRNGKPISSRYVKDLVVQRLGFDTRVTVLGHVQ
RGGTPSAFDRILSSKMGMEAVMALLEATPDTPACVVSLSGNQSVRLPLMECVQMTKEVQK
AMDEKRFDEAIQLRGGSFENNWNIYKLLSHQKISKEKTNFSLAILNVGAPAAGMNAAVRS
AVRSGISQGHTVYVVHDGFEGLAKNQVQEVSWHDVAGWLGRGGSMLGTKRTLPKGFMEKI
VENIRLHNIHALLVIGGFEAYEGVLQLVEARGRYEELCIVMCVIPATISNNVPGTDFSLG
Number of Proteins
394


Building a new DB, current time: 03/21/2025 12:51:31
New DB name:   /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0061621
New DB title:  ../output/27-Apul-pheno-annot/SwissProt-GO:0061621.fa
Sequence type: Protein
Deleted existing Protein BLAST database named /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0061621
Keep MBits: T
Maximum file size: 3000000000B
Adding sequences from FASTA; added 394 sequences in 0.0159671 seconds.


FUN_005030-T1   sp|P85037|FOXK1_HUMAN   51.000  100 48  1   95  194 302 400 4.38e-26    103
FUN_005036-T1   sp|P42128|FOXK1_MOUSE   48.454  97  50  0   30  126 290 386 1.70e-27    105
FUN_005159-T1   sp|Q3UCQ1|FOXK2_MOUSE   52.041  98  45  1   95  190 247 344 7.57e-28    108
FUN_008233-T1   sp|Q7ZX03|FOXK2_XENLA   43.066  137 75  1   37  173 188 321 1.35e-33    125
FUN_009301-T1   sp|Q867C9|PFKAM_HORSE   58.634  776 300 4   70  833 13  779 0.0 935
FUN_010519-T1   sp|P00940|TPIS_CHICK    69.672  244 74  0   3   246 4   247 1.09e-126   353
FUN_012871-T1   sp|P00940|TPIS_CHICK    69.672  244 74  0   3   246 4   247 1.09e-126   353
FUN_013147-T1   sp|Q7ZX03|FOXK2_XENLA   46.939  98  50  1   143 238 215 312 3.77e-24    96.3
FUN_013305-T1   sp|P42128|FOXK1_MOUSE   42.202  109 61  1   47  153 287 395 2.42e-22    86.7
FUN_015434-T1   sp|P05064|ALDOA_MOUSE   72.269  357 97  1   5   359 8   364 0.0 528
Number of hits
37 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0061621_out.tab</code></pre>
</section>
<section id="tricarboxylic-acid-cycle-go0006099" class="level1">
<h1>Tricarboxylic Acid Cycle (GO:0006099)</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GO</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0006099"</span></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accept: text/plain"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://rest.uniprot.org/uniprotkb/stream?format=fasta&amp;query=%28%28go%3A"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%29%29+AND+%28reviewed%3Atrue%29"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Proteins"</span></span>
<span id="cb8-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-11">-in <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-12">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-13">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-14"></span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/ncbi-blast-2.15.0+/bin/blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-17">-query <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fasta</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-18">-db <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>SwissProt-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-19">-out <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-20">-evalue <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${evalue}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-21">-num_threads 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">-max_target_seqs 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">-max_hsps 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">-outfmt 6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25">2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>blast_warnings<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.txt</span>
<span id="cb8-26"></span>
<span id="cb8-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span>
<span id="cb8-28"></span>
<span id="cb8-29"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of hits"</span></span>
<span id="cb8-30"></span>
<span id="cb8-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>Apul_blastp-GO:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GO}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_out.tab</span></code></pre></div>
<pre><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100 31776    0 31776    0     0  26928      0 --:--:--  0:00:01 --:--:-- 26906
100 1726k    0 1726k    0     0   889k      0 --:--:--  0:00:01 --:--:--  889k
&gt;sp|A0A096P8D3|IDH_OSTTA Isocitrate dehydrogenase (NAD(+)), mitochondrial OS=Ostreococcus tauri OX=70448 GN=IDH PE=1 SV=1
MTRVERGRVLARAIERAVAHRASARRWTTTTRTPAWMVTGWMGGRGVDRSTAMTRFERCG
STASSKITAAPMVYVRGEEMTAYVMDLIRSRWIEPRVDVGGWETFDLRAKNRDDTEDRVL
RDVIEAGKRIKAIFKEPTVTPTADQVKRLGLRKSWGSPNGAMRRGWNGITISRDTIHIDG
VELGYKKPVLFERHAVGGEYSAGYKNVGKGKLTTTFTPSEGPDAGKTVVVDEREIVDEEA
AVVTYHNPYDNVHDLARFFFGRCLEAKVTPYVVTKKTVFKWQEPFWQIMRTVFDEEFKAQ
FVAAGVMKEGEELVHLLSDAATMKLVQWRQGGFGMAAHNYDGDVLTDELAQVHKSPGFIT
SNLVGVHEDGTLIKEFEASHGTVADMDEARLRGEETSLNPLGMVEGLIGAMNHAADVHNI
DRDRTHAFTTKMRTVIHQLFREGKGTRDLCGPSGLTTEQFIDAVAERLDA
&gt;sp|A0A3Q0KQY7|FUMC_SCHMA Fumarate hydratase OS=Schistosoma mansoni OX=6183 GN=Smp_158240 PE=1 SV=2
Number of Proteins
2837


Building a new DB, current time: 03/21/2025 12:51:40
New DB name:   /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0006099
New DB title:  ../output/27-Apul-pheno-annot/SwissProt-GO:0006099.fa
Sequence type: Protein
Deleted existing Protein BLAST database named /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/27-Apul-pheno-annot/SwissProt-GO:0006099
Keep MBits: T
Maximum file size: 3000000000B
Adding sequences from FASTA; added 2837 sequences in 0.0586021 seconds.


FUN_000960-T1   sp|P21399|ACOHC_HUMAN   70.588  867 255 0   24  890 21  887 0.0 1312
FUN_001356-T1   sp|A0QMB9|GABD1_MYCA1   30.787  445 291 4   79  508 7   449 5.73e-62    214
FUN_003898-T1   sp|Q9V0D5|MDH_PYRAB 41.694  307 173 3   6   310 7   309 2.54e-71    224
FUN_003899-T1   sp|Q9V0D5|MDH_PYRAB 37.110  353 215 5   28  377 9   357 2.79e-73    229
FUN_004736-T1   sp|Q9VWH4|IDH3A_DROME   72.892  332 89  1   40  371 47  377 0.0 514
FUN_004752-T1   sp|A0QMB9|GABD1_MYCA1   34.848  462 284 6   426 879 3   455 5.01e-74    248
FUN_006329-T1   sp|P09624|DLDH_YEAST    56.557  488 199 7   30  508 15  498 0.0 540
FUN_006649-T1   sp|A4SFT4|MDH_CHLPM 36.093  302 182 4   24  322 2   295 4.65e-64    202
FUN_006864-T1   sp|Q73TP5|GABD1_MYCPA   35.141  461 285 7   65  519 5   457 6.75e-76    244
FUN_006864-T2   sp|Q73TP5|GABD1_MYCPA   35.141  461 285 7   65  519 5   457 2.18e-76    245
Number of hits
82 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0006099_out.tab</code></pre>
</section>
<section id="summary-of-blast-hits" class="level1">
<h1>Summary of blast hits</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>tab</span></code></pre></div>
<pre><code>   82 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0006099_out.tab
  130 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0006119_out.tab
  616 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0009060_out.tab
   37 ../output/27-Apul-pheno-annot/Apul_blastp-GO:0061621_out.tab
  865 total</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>GO</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/41-Apul-GO/</guid>
  <pubDate>Fri, 21 Mar 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-03-21_12-56-06.png" medium="image" type="image/png"/>
</item>
<item>
  <title>OA OA OA</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/40-HawsOA/</link>
  <description><![CDATA[ 





<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid automatic execution</span></span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot width</span></span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot height</span></span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center align plots</span></span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents '##' in output</span></span>
<span id="cb1-10">)</span></code></pre></div>
</div>
<p>Lets redo the bismark with new genome.</p>
<section id="download-reads" class="level1">
<h1>Download Reads</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-P ../../data/Haws-10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*fq.gz"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">https://gannet.fish.washington.edu/spartina/project-oyster-oa/Haws/trimmed-data-2/</span></code></pre></div>
</div>
</section>
<section id="download-new-genome" class="level1">
<h1>Download new genome</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../../data/Haws-10</span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/datasets</span> download genome accession GCF_963853765.1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--include</span> gff3,rna,cds,protein,genome,seq-report</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> ../../data/Haws-10/ncbi_dataset.zip</span></code></pre></div>
</div>
</section>
<section id="genome-prep" class="level1">
<h1>Genome Prep</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directories and programs</span></span>
<span id="cb5-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/Bismark-0.24.0/"</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bowtie2-2.4.4-linux-x86_64/"</span></span>
<span id="cb5-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bismark_genome_preparation</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">--verbose <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">--parallel 12 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9">--path_to_aligner <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span></span></code></pre></div>
</div>
</section>
<section id="checking-alignment-min-scores" class="level1">
<h1>Checking alignment min scores</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../../data/Haws-10/</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set directories and files</span></span>
<span id="cb7-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb7-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb7-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/"</span></span>
<span id="cb7-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">checkpoint_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/completed_samples.log"</span></span>
<span id="cb7-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/Bismark-0.24.0/"</span></span>
<span id="cb7-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bowtie2-2.4.4-linux-x86_64/"</span></span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the checkpoint file if it doesn't exist</span></span>
<span id="cb7-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb7-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_val_2_val_2_val_2.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_val_2_val_2_val_2.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-15"></span>
<span id="cb7-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the sample has already been processed</span></span>
<span id="cb7-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-18">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> already processed. Skipping..."</span></span>
<span id="cb7-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb7-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-21"></span>
<span id="cb7-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define log files for stdout and stderr</span></span>
<span id="cb7-23">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stdout_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stdout.log"</span></span>
<span id="cb7-24">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stderr_log</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_stderr.log"</span></span>
<span id="cb7-25"></span>
<span id="cb7-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the array of score_min parameters to test</span></span>
<span id="cb7-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb7-28">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.4"</span></span>
<span id="cb7-29">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.6"</span></span>
<span id="cb7-30">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.8"</span></span>
<span id="cb7-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-1.0"</span></span>
<span id="cb7-32">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,-1,-0.6"</span></span>
<span id="cb7-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-34"></span>
<span id="cb7-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through each score_min parameter</span></span>
<span id="cb7-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> score_min <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min_params</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[@]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-37">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-38">        </span>
<span id="cb7-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a subdirectory for this parameter</span></span>
<span id="cb7-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">param_output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_score_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-41">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span></span>
<span id="cb7-42"></span>
<span id="cb7-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb7-44">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_dir}</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-45">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-46">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 16 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-47">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> 25000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-48">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-49">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-50">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-51">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_val_1_val_1_val_1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-52">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_val_2_val_2_val_2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-53">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-54">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span>_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-55">            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${param_output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb7-56"></span>
<span id="cb7-57">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the command was successful</span></span>
<span id="cb7-58">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-59">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> processed successfully."</span></span>
<span id="cb7-60">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb7-61">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> failed. Check </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stderr_log}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> for details."</span></span>
<span id="cb7-62">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb7-64"></span>
<span id="cb7-65">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mark the sample as completed in the checkpoint file</span></span>
<span id="cb7-66">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-67">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${checkpoint_file}</span></span>
<span id="cb7-68">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All tests for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> completed."</span></span>
<span id="cb7-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb7-70">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> encountered errors. Check logs for details."</span></span>
<span id="cb7-71">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb7-73"></span>
<span id="cb7-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define summary file</span></span>
<span id="cb7-75"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/parameter_comparison_summary.csv"</span></span>
<span id="cb7-76"></span>
<span id="cb7-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize summary file</span></span>
<span id="cb7-78"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample,Score_Min,Alignment_Rate"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file}</span></span>
<span id="cb7-79"></span>
<span id="cb7-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through parameter output directories</span></span>
<span id="cb7-81"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dir <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_score_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-82">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-83">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name and score_min parameter from directory name</span></span>
<span id="cb7-84">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-85">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dir</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score_.*"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'s/score_//; s/_/,/g'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-86"></span>
<span id="cb7-87">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Locate the summary file</span></span>
<span id="cb7-88">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">summary_file_path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_PE_report.txt"</span></span>
<span id="cb7-89"></span>
<span id="cb7-90">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract metrics</span></span>
<span id="cb7-91">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$summary_file_path</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb7-92">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mapping</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mapping efficiency:"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file_path}</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "mapping efficiency ", $3}'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb7-93">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mapping}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${summary_file}</span></span>
<span id="cb7-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb7-96"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<p>Summary file does not, did manual inspection</p>
</section>
<section id="full-run" class="level1">
<h1>Full Run</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set variables</span></span>
<span id="cb8-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb8-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../data/Haws-10/"</span></span>
<span id="cb8-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../../analyses/Haws-10/"</span></span>
<span id="cb8-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-0.8"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Single value for score_min</span></span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb8-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_val_2_val_2_val_2.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb8-9">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_val_2_val_2_val_2.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb8-10">    </span>
<span id="cb8-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-12"></span>
<span id="cb8-13">    </span>
<span id="cb8-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb8-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/Bismark-0.24.0/bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie2</span> /home/shared/bowtie2-2.4.4-linux-x86_64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1_val_1_val_1_val_1.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2_val_2_val_2_val_2.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--non_directional</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-25">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb8-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">View MultiQC Report</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">htmltools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">iframe</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">src=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-10/multiqc_report.html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"600px"</span>)</span></code></pre></div>
<div class="cell-output-display">
<iframe src="https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-10/multiqc_report.html" width="100%" height="600px"></iframe>
</div>
</div>
</div>
</div>
</div>
<section id="deduplication" class="level2">
<h2 class="anchored" data-anchor-id="deduplication">Deduplication</h2>
<p>Notebook 14</p>
<p>/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 /home/shared/Bismark-0.24.0/deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">--output_dir /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-7">/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-10/{}.bam</span></code></pre></div>
</div>
</section>
<section id="methylation-extraction" class="level2">
<h2 class="anchored" data-anchor-id="methylation-extraction">Methylation Extraction</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/Bismark-0.24.0/bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--multicore</span> 48 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-2">--output /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">{} </span></code></pre></div>
</div>
</section>
<section id="methylation-calls" class="level2">
<h2 class="anchored" data-anchor-id="methylation-calls">Methylation Calls</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 48 /home/shared/Bismark-0.24.0/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-4">--genome_folder /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/data/Haws-10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-5">-o /home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-8">/home/shared/16TB_HDD_01/sr320/github/project-oyster-oa/analyses/Haws-14/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">View MultiQC Report</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">htmltools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>tags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">iframe</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">src=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-14/multiqc_report.html"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"100%"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"600px"</span>)</span></code></pre></div>
<div class="cell-output-display">
<iframe src="https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-14/multiqc_report.html" width="100%" height="600px"></iframe>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="output" class="level2">
<h2 class="anchored" data-anchor-id="output">output</h2>
<p>https://gannet.fish.washington.edu/seashell/bu-github/project-oyster-oa/analyses/Haws-14/</p>
<pre><code>CpG_context_zr3644_10_pe.deduplicated.txt
CpG_context_zr3644_11_pe.deduplicated.txt
CpG_context_zr3644_12_pe.deduplicated.txt
CpG_context_zr3644_13_pe.deduplicated.txt
CpG_context_zr3644_14_pe.deduplicated.txt
CpG_context_zr3644_15_pe.deduplicated.txt
CpG_context_zr3644_16_pe.deduplicated.txt
CpG_context_zr3644_17_pe.deduplicated.txt
CpG_context_zr3644_18_pe.deduplicated.txt
CpG_context_zr3644_19_pe.deduplicated.txt
CpG_context_zr3644_1_pe.deduplicated.txt
CpG_context_zr3644_20_pe.deduplicated.txt
CpG_context_zr3644_21_pe.deduplicated.txt
CpG_context_zr3644_22_pe.deduplicated.txt
CpG_context_zr3644_23_pe.deduplicated.txt
CpG_context_zr3644_24_pe.deduplicated.txt
CpG_context_zr3644_2_pe.deduplicated.txt
CpG_context_zr3644_3_pe.deduplicated.txt
CpG_context_zr3644_4_pe.deduplicated.txt
CpG_context_zr3644_5_pe.deduplicated.txt
CpG_context_zr3644_6_pe.deduplicated.txt
CpG_context_zr3644_7_pe.deduplicated.txt
CpG_context_zr3644_8_pe.deduplicated.txt
CpG_context_zr3644_9_pe.deduplicated.txt
Non_CpG_context_zr3644_10_pe.deduplicated.txt
Non_CpG_context_zr3644_11_pe.deduplicated.txt
Non_CpG_context_zr3644_12_pe.deduplicated.txt
Non_CpG_context_zr3644_13_pe.deduplicated.txt
Non_CpG_context_zr3644_14_pe.deduplicated.txt
Non_CpG_context_zr3644_15_pe.deduplicated.txt
Non_CpG_context_zr3644_16_pe.deduplicated.txt
Non_CpG_context_zr3644_17_pe.deduplicated.txt
Non_CpG_context_zr3644_18_pe.deduplicated.txt
Non_CpG_context_zr3644_19_pe.deduplicated.txt
Non_CpG_context_zr3644_1_pe.deduplicated.txt
Non_CpG_context_zr3644_20_pe.deduplicated.txt
Non_CpG_context_zr3644_21_pe.deduplicated.txt
Non_CpG_context_zr3644_22_pe.deduplicated.txt
Non_CpG_context_zr3644_23_pe.deduplicated.txt
Non_CpG_context_zr3644_24_pe.deduplicated.txt
Non_CpG_context_zr3644_2_pe.deduplicated.txt
Non_CpG_context_zr3644_3_pe.deduplicated.txt
Non_CpG_context_zr3644_4_pe.deduplicated.txt
Non_CpG_context_zr3644_5_pe.deduplicated.txt
Non_CpG_context_zr3644_6_pe.deduplicated.txt
Non_CpG_context_zr3644_7_pe.deduplicated.txt
Non_CpG_context_zr3644_8_pe.deduplicated.txt
Non_CpG_context_zr3644_9_pe.deduplicated.txt
zr3644_10.CpG_report.merged_CpG_evidence.cov
zr3644_10.CpG_report.txt
zr3644_10.cytosine_context_summary.txt
zr3644_10_pe.deduplicated.bam
zr3644_10_pe.deduplicated.bedGraph.gz
zr3644_10_pe.deduplicated.bismark.cov.gz
zr3644_10_pe.deduplicated.M-bias.txt
zr3644_10_pe.deduplicated_splitting_report.txt
zr3644_10_pe.deduplication_report.txt
zr3644_11.CpG_report.merged_CpG_evidence.cov
zr3644_11.CpG_report.txt
zr3644_11.cytosine_context_summary.txt
zr3644_11_pe.deduplicated.bam
zr3644_11_pe.deduplicated.bedGraph.gz
zr3644_11_pe.deduplicated.bismark.cov.gz
zr3644_11_pe.deduplicated.M-bias.txt
zr3644_11_pe.deduplicated_splitting_report.txt
zr3644_11_pe.deduplication_report.txt
zr3644_12.CpG_report.merged_CpG_evidence.cov
zr3644_12.CpG_report.txt
zr3644_12.cytosine_context_summary.txt
zr3644_12_pe.deduplicated.bam
zr3644_12_pe.deduplicated.bedGraph.gz
zr3644_12_pe.deduplicated.bismark.cov.gz
zr3644_12_pe.deduplicated.M-bias.txt
zr3644_12_pe.deduplicated_splitting_report.txt
zr3644_12_pe.deduplication_report.txt
zr3644_13.CpG_report.merged_CpG_evidence.cov
zr3644_13.CpG_report.txt
zr3644_13.cytosine_context_summary.txt
zr3644_13_pe.deduplicated.bam
zr3644_13_pe.deduplicated.bedGraph.gz
zr3644_13_pe.deduplicated.bismark.cov.gz
zr3644_13_pe.deduplicated.M-bias.txt
zr3644_13_pe.deduplicated_splitting_report.txt
zr3644_13_pe.deduplication_report.txt
zr3644_14.CpG_report.merged_CpG_evidence.cov
zr3644_14.CpG_report.txt
zr3644_14.cytosine_context_summary.txt
zr3644_14_pe.deduplicated.bam
zr3644_14_pe.deduplicated.bedGraph.gz
zr3644_14_pe.deduplicated.bismark.cov.gz
zr3644_14_pe.deduplicated.M-bias.txt
zr3644_14_pe.deduplicated_splitting_report.txt
zr3644_14_pe.deduplication_report.txt
zr3644_15.CpG_report.merged_CpG_evidence.cov
zr3644_15.CpG_report.txt
zr3644_15.cytosine_context_summary.txt
zr3644_15_pe.deduplicated.bam
zr3644_15_pe.deduplicated.bedGraph.gz
zr3644_15_pe.deduplicated.bismark.cov.gz
zr3644_15_pe.deduplicated.M-bias.txt
zr3644_15_pe.deduplicated_splitting_report.txt
zr3644_15_pe.deduplication_report.txt
zr3644_16.CpG_report.merged_CpG_evidence.cov
zr3644_16.CpG_report.txt
zr3644_16.cytosine_context_summary.txt
zr3644_16_pe.deduplicated.bam
zr3644_16_pe.deduplicated.bedGraph.gz
zr3644_16_pe.deduplicated.bismark.cov.gz
zr3644_16_pe.deduplicated.M-bias.txt
zr3644_16_pe.deduplicated_splitting_report.txt
zr3644_16_pe.deduplication_report.txt
zr3644_17.CpG_report.merged_CpG_evidence.cov
zr3644_17.CpG_report.txt
zr3644_17.cytosine_context_summary.txt
zr3644_17_pe.deduplicated.bam
zr3644_17_pe.deduplicated.bedGraph.gz
zr3644_17_pe.deduplicated.bismark.cov.gz
zr3644_17_pe.deduplicated.M-bias.txt
zr3644_17_pe.deduplicated_splitting_report.txt
zr3644_17_pe.deduplication_report.txt
zr3644_18.CpG_report.merged_CpG_evidence.cov
zr3644_18.CpG_report.txt
zr3644_18.cytosine_context_summary.txt
zr3644_18_pe.deduplicated.bam
zr3644_18_pe.deduplicated.bedGraph.gz
zr3644_18_pe.deduplicated.bismark.cov.gz
zr3644_18_pe.deduplicated.M-bias.txt
zr3644_18_pe.deduplicated_splitting_report.txt
zr3644_18_pe.deduplication_report.txt
zr3644_19.CpG_report.merged_CpG_evidence.cov
zr3644_19.CpG_report.txt
zr3644_19.cytosine_context_summary.txt
zr3644_19_pe.deduplicated.bam
zr3644_19_pe.deduplicated.bedGraph.gz
zr3644_19_pe.deduplicated.bismark.cov.gz
zr3644_19_pe.deduplicated.M-bias.txt
zr3644_19_pe.deduplicated_splitting_report.txt
zr3644_19_pe.deduplication_report.txt
zr3644_1.CpG_report.merged_CpG_evidence.cov
zr3644_1.CpG_report.txt
zr3644_1.cytosine_context_summary.txt
zr3644_1_pe.deduplicated.bam
zr3644_1_pe.deduplicated.bedGraph.gz
zr3644_1_pe.deduplicated.bismark.cov.gz
zr3644_1_pe.deduplicated.M-bias.txt
zr3644_1_pe.deduplicated_splitting_report.txt
zr3644_1_pe.deduplication_report.txt
zr3644_20.CpG_report.merged_CpG_evidence.cov
zr3644_20.CpG_report.txt
zr3644_20.cytosine_context_summary.txt
zr3644_20_pe.deduplicated.bam
zr3644_20_pe.deduplicated.bedGraph.gz
zr3644_20_pe.deduplicated.bismark.cov.gz
zr3644_20_pe.deduplicated.M-bias.txt
zr3644_20_pe.deduplicated_splitting_report.txt
zr3644_20_pe.deduplication_report.txt
zr3644_21.CpG_report.merged_CpG_evidence.cov
zr3644_21.CpG_report.txt
zr3644_21.cytosine_context_summary.txt
zr3644_21_pe.deduplicated.bam
zr3644_21_pe.deduplicated.bedGraph.gz
zr3644_21_pe.deduplicated.bismark.cov.gz
zr3644_21_pe.deduplicated.M-bias.txt
zr3644_21_pe.deduplicated_splitting_report.txt
zr3644_21_pe.deduplication_report.txt
zr3644_22.CpG_report.merged_CpG_evidence.cov
zr3644_22.CpG_report.txt
zr3644_22.cytosine_context_summary.txt
zr3644_22_pe.deduplicated.bam
zr3644_22_pe.deduplicated.bedGraph.gz
zr3644_22_pe.deduplicated.bismark.cov.gz
zr3644_22_pe.deduplicated.M-bias.txt
zr3644_22_pe.deduplicated_splitting_report.txt
zr3644_22_pe.deduplication_report.txt
zr3644_23.CpG_report.merged_CpG_evidence.cov
zr3644_23.CpG_report.txt
zr3644_23.cytosine_context_summary.txt
zr3644_23_pe.deduplicated.bam
zr3644_23_pe.deduplicated.bedGraph.gz
zr3644_23_pe.deduplicated.bismark.cov.gz
zr3644_23_pe.deduplicated.M-bias.txt
zr3644_23_pe.deduplicated_splitting_report.txt
zr3644_23_pe.deduplication_report.txt
zr3644_24.CpG_report.merged_CpG_evidence.cov
zr3644_24.CpG_report.txt
zr3644_24.cytosine_context_summary.txt
zr3644_24_pe.deduplicated.bam
zr3644_24_pe.deduplicated.bedGraph.gz
zr3644_24_pe.deduplicated.bismark.cov.gz
zr3644_24_pe.deduplicated.M-bias.txt
zr3644_24_pe.deduplicated_splitting_report.txt
zr3644_24_pe.deduplication_report.txt
zr3644_2.CpG_report.merged_CpG_evidence.cov
zr3644_2.CpG_report.txt
zr3644_2.cytosine_context_summary.txt
zr3644_2_pe.deduplicated.bam
zr3644_2_pe.deduplicated.bedGraph.gz
zr3644_2_pe.deduplicated.bismark.cov.gz
zr3644_2_pe.deduplicated.M-bias.txt
zr3644_2_pe.deduplicated_splitting_report.txt
zr3644_2_pe.deduplication_report.txt
zr3644_3.CpG_report.merged_CpG_evidence.cov
zr3644_3.CpG_report.txt
zr3644_3.cytosine_context_summary.txt
zr3644_3_pe.deduplicated.bam
zr3644_3_pe.deduplicated.bedGraph.gz
zr3644_3_pe.deduplicated.bismark.cov.gz
zr3644_3_pe.deduplicated.M-bias.txt
zr3644_3_pe.deduplicated_splitting_report.txt
zr3644_3_pe.deduplication_report.txt
zr3644_4.CpG_report.merged_CpG_evidence.cov
zr3644_4.CpG_report.txt
zr3644_4.cytosine_context_summary.txt
zr3644_4_pe.deduplicated.bam
zr3644_4_pe.deduplicated.bedGraph.gz
zr3644_4_pe.deduplicated.bismark.cov.gz
zr3644_4_pe.deduplicated.M-bias.txt
zr3644_4_pe.deduplicated_splitting_report.txt
zr3644_4_pe.deduplication_report.txt
zr3644_5.CpG_report.merged_CpG_evidence.cov
zr3644_5.CpG_report.txt
zr3644_5.cytosine_context_summary.txt
zr3644_5_pe.deduplicated.bam
zr3644_5_pe.deduplicated.bedGraph.gz
zr3644_5_pe.deduplicated.bismark.cov.gz
zr3644_5_pe.deduplicated.M-bias.txt
zr3644_5_pe.deduplicated_splitting_report.txt
zr3644_5_pe.deduplication_report.txt
zr3644_6.CpG_report.merged_CpG_evidence.cov
zr3644_6.CpG_report.txt
zr3644_6.cytosine_context_summary.txt
zr3644_6_pe.deduplicated.bam
zr3644_6_pe.deduplicated.bedGraph.gz
zr3644_6_pe.deduplicated.bismark.cov.gz
zr3644_6_pe.deduplicated.M-bias.txt
zr3644_6_pe.deduplicated_splitting_report.txt
zr3644_6_pe.deduplication_report.txt
zr3644_7.CpG_report.merged_CpG_evidence.cov
zr3644_7.CpG_report.txt
zr3644_7.cytosine_context_summary.txt
zr3644_7_pe.deduplicated.bam
zr3644_7_pe.deduplicated.bedGraph.gz
zr3644_7_pe.deduplicated.bismark.cov.gz
zr3644_7_pe.deduplicated.M-bias.txt
zr3644_7_pe.deduplicated_splitting_report.txt
zr3644_7_pe.deduplication_report.txt
zr3644_8.CpG_report.merged_CpG_evidence.cov
zr3644_8.CpG_report.txt
zr3644_8.cytosine_context_summary.txt
zr3644_8_pe.deduplicated.bam
zr3644_8_pe.deduplicated.bedGraph.gz
zr3644_8_pe.deduplicated.bismark.cov.gz
zr3644_8_pe.deduplicated.M-bias.txt
zr3644_8_pe.deduplicated_splitting_report.txt
zr3644_8_pe.deduplication_report.txt
zr3644_9.CpG_report.merged_CpG_evidence.cov
zr3644_9.CpG_report.txt
zr3644_9.cytosine_context_summary.txt
zr3644_9_pe.deduplicated.bam
zr3644_9_pe.deduplicated.bedGraph.gz
zr3644_9_pe.deduplicated.bismark.cov.gz
zr3644_9_pe.deduplicated.M-bias.txt
zr3644_9_pe.deduplicated_splitting_report.txt
zr3644_9_pe.deduplication_report.txt</code></pre>


<!-- -->

</section>
</section>

 ]]></description>
  <category>oyster</category>
  <category>methylation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/40-HawsOA/</guid>
  <pubDate>Wed, 12 Mar 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-oyster-oa__RStudio_Server_2025-02-28_18-24-54.png" medium="image" type="image/png"/>
</item>
<item>
  <title>lncRNA Discovery Pipeline</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/39-lncRNA/</link>
  <description><![CDATA[ 





<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This lab notebook documents the process of identifying long non-coding RNAs (lncRNAs) from RNA-seq data. The pipeline includes data acquisition, genome alignment, transcript assembly, filtering, and classification.</p>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display code chunks</span></span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eval =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid automatic execution</span></span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warning =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide warnings</span></span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">message =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hide messages</span></span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot width</span></span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set default plot height</span></span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fig.align =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center align plots</span></span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">comment =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prevents '##' in output</span></span>
<span id="cb1-10">)</span></code></pre></div>
</div>
</section>
<section id="variables" class="level1">
<h1>Variables</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb2-2">knitr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>opts_chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">echo =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb2-5"> </span>
<span id="cb2-6">DATA_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/01-lncRNA"</span></span>
<span id="cb2-7">OUTPUT_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01-lncRNA"</span></span>
<span id="cb2-8">THREADS <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"42"</span></span>
<span id="cb2-9">  </span>
<span id="cb2-10">FASTQ_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20230519-E5_coral-fastqc-fastp-multiqc-RNAseq/P_meandrina/trimmed/"</span></span>
<span id="cb2-11">FASTQ_SUFFIX <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq.gz"</span></span>
<span id="cb2-12">GENOME_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://owl.fish.washington.edu/halfshell/genomic-databank/Pocillopora_meandrina_HIv1.assembly.fasta"</span></span>
<span id="cb2-13"></span>
<span id="cb2-14"></span>
<span id="cb2-15">GTF_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/d5f546705e3df40558eeaa5c18b122c79d2f4453/F-Ptua/data/Pocillopora_meandrina_HIv1.genes-validated.gtf"</span></span>
<span id="cb2-16">GFF_SOURCE <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/deep-dive-expression/F-Ptuh/data/Pocillopora_meandrina_HIv1.genes-validated.gff3"</span></span>
<span id="cb2-17"></span>
<span id="cb2-18">GFFPATTERN <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"|class_code "x"|class_code "o"|class_code "i"'</span></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#RAVEN</span></span>
<span id="cb2-21">HISAT2_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/hisat2-2.2.1/"</span></span>
<span id="cb2-22">SAMTOOLS_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/samtools-1.12/"</span></span>
<span id="cb2-23">STRINGTIE_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/stringtie-2.2.1.Linux_x86_64"</span></span>
<span id="cb2-24">GFFCOMPARE_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/gffcompare-0.12.6.Linux_x86_64"</span></span>
<span id="cb2-25">BEDTOOLS_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/bedtools2/bin"</span></span>
<span id="cb2-26">CPC2_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/shared/CPC2_standalone-1.0.1"</span></span>
<span id="cb2-27">CONDA_PATH <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/anaconda/anaconda3/bin/conda"</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#KLONE</span></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HISAT2_DIR &lt;- ""</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SAMTOOLS_DIR &lt;- ""</span></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># STRINGTIE_DIR &lt;- ""</span></span>
<span id="cb2-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GFFCOMPARE_DIR &lt;- "/srlab/programs/gffcompare-0.12.6.Linux_x86_64/"</span></span>
<span id="cb2-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BEDTOOLS_DIR &lt;- ""</span></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPC2_DIR &lt;- "/srlab/programs/CPC2_standalone-1.0.1/bin/"</span></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CONDA_PATH &lt;- ""</span></span>
<span id="cb2-37"></span>
<span id="cb2-38">GENOME_FASTA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.fasta"</span>)</span>
<span id="cb2-39">GENOME_GTF <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gtf"</span>)</span>
<span id="cb2-40">GENOME_GFF <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gff"</span>)</span>
<span id="cb2-41">FASTQ_DIR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(DATA_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq"</span>)</span>
<span id="cb2-42">GENOME_INDEX <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(OUTPUT_DIR, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.index"</span>)</span>
<span id="cb2-43"></span>
<span id="cb2-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb2-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.setenv</span>(</span>
<span id="cb2-46">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">THREADS =</span> THREADS,</span>
<span id="cb2-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">DATA_DIR =</span> DATA_DIR,</span>
<span id="cb2-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_SOURCE =</span> FASTQ_SOURCE,</span>
<span id="cb2-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX =</span> FASTQ_SUFFIX,</span>
<span id="cb2-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">OUTPUT_DIR =</span> OUTPUT_DIR,</span>
<span id="cb2-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_SOURCE =</span> GENOME_SOURCE,</span>
<span id="cb2-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GTF_SOURCE =</span> GTF_SOURCE,</span>
<span id="cb2-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GFF_SOURCE =</span> GFF_SOURCE,</span>
<span id="cb2-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HISAT2_DIR =</span> HISAT2_DIR,</span>
<span id="cb2-55">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR =</span> SAMTOOLS_DIR,</span>
<span id="cb2-56">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">STRINGTIE_DIR =</span> STRINGTIE_DIR,</span>
<span id="cb2-57">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR =</span> GFFCOMPARE_DIR,</span>
<span id="cb2-58">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR =</span> BEDTOOLS_DIR,</span>
<span id="cb2-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CPC2_DIR =</span> CPC2_DIR,</span>
<span id="cb2-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">CONDA_PATH =</span> CONDA_PATH,</span>
<span id="cb2-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_FASTA =</span> GENOME_FASTA,</span>
<span id="cb2-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_GTF =</span> GENOME_GTF,</span>
<span id="cb2-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_GFF =</span> GENOME_GFF,</span>
<span id="cb2-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FASTQ_DIR =</span> FASTQ_DIR,</span>
<span id="cb2-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">GENOME_INDEX =</span> GENOME_INDEX</span>
<span id="cb2-66">)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DATA_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
</section>
<section id="download-genome-and-reads-for-hisat" class="level1">
<h1>Download Genome and Reads for Hisat</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">-P <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SOURCE}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"></span>
<span id="cb6-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GTF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"></span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gtf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-4"></span>
<span id="cb9-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb9-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FAIL - FFS you downloaded a HTML not and genome feature file!"</span></span>
<span id="cb9-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb9-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb9-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</div>
</section>
<section id="hisat" class="level1">
<h1>HISAT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_exons.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span></span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_splice_sites.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"></span>
<span id="cb11-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2-build"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--exon</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ss</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-build_stats.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over every file ending in .fastq.gz that contains "_R2_"</span></span>
<span id="cb12-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb12-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the basename (filename without path)</span></span>
<span id="cb12-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb12-5">    </span>
<span id="cb12-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Derive a sample name by taking everything before "_R2_"</span></span>
<span id="cb12-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-8">    </span>
<span id="cb12-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding R1 filename by replacing "_R2_" with "_R1_"</span></span>
<span id="cb12-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${r2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_R2_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>_R1_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-11">    </span>
<span id="cb12-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the output SAM file name using the sample name</span></span>
<span id="cb12-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sam"</span></span>
<span id="cb12-14">    </span>
<span id="cb12-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run hisat2 with the paired-end files</span></span>
<span id="cb12-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb12-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<section id="convert-sam-to-bam" class="level2">
<h2 class="anchored" data-anchor-id="convert-sam-to-bam">convert SAM to BAM</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> samfile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-2">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.bam"</span></span>
<span id="cb13-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb13-4">  </span>
<span id="cb13-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert SAM to BAM</span></span>
<span id="cb13-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$samfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-7">  </span>
<span id="cb13-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort BAM</span></span>
<span id="cb13-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-10">  </span>
<span id="cb13-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index sorted BAM</span></span>
<span id="cb13-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> index <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
</section>
<section id="stringtie" class="level1">
<h1>StringTie</h1>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples–an important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-4">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-5">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-6">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.sorted.bam"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-3">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<p>#GFFCOMPARE</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFCOMPARE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gffcompare"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-3">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged.annotated.gtf"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="bedtools" class="level1">
<h1>Bedtools</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BEDTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> getfasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-2">-fi <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-3">-bed <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-4">-fo <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
</div>
<p>#CPC2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb20-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${CPC2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-3">-i <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2"</span></span></code></pre></div>
</div>
<p>Filter</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<p>Subsetting fasta</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> faidx <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define input and output file paths using the OUTPUT_DIR variable</span></span>
<span id="cb24-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb24-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span>
<span id="cb24-4"></span>
<span id="cb24-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line of the input file</span></span>
<span id="cb24-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb24-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "transcript::" from the line</span></span>
<span id="cb24-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">transcript::</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-9">    </span>
<span id="cb24-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the line by ':' to get the chromosome and position string</span></span>
<span id="cb24-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chromosome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pos</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$line</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-12">    </span>
<span id="cb24-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position string by '-' to separate start and end positions</span></span>
<span id="cb24-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">end</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pos</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-15">    </span>
<span id="cb24-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb24-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((start</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb24-18">    </span>
<span id="cb24-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, updated start, and end positions to the output file (tab-separated)</span></span>
<span id="cb24-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\t%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$chromosome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$start</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$end</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb24-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$input</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb27-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN {</span></span>
<span id="cb27-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries = 0;</span></span>
<span id="cb27-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    min_length = 1e9;</span></span>
<span id="cb27-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    max_length = 0;</span></span>
<span id="cb27-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length = 0;</span></span>
<span id="cb27-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"># Skip comment lines</span></span>
<span id="cb27-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/^#/ { next }</span></span>
<span id="cb27-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb27-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (NF &lt; 9) next;</span></span>
<span id="cb27-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries++;</span></span>
<span id="cb27-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    start = $4;</span></span>
<span id="cb27-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    end = $5;</span></span>
<span id="cb27-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    gene_length = end - start + 1;</span></span>
<span id="cb27-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &lt; min_length) min_length = gene_length;</span></span>
<span id="cb27-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &gt; max_length) max_length = gene_length;</span></span>
<span id="cb27-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length += gene_length;</span></span>
<span id="cb27-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    feature[$3]++;</span></span>
<span id="cb27-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    chrom[$1]++;</span></span>
<span id="cb27-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    # Use two-argument match() and then extract the gene_id manually.</span></span>
<span id="cb27-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (match($9, /gene_id "[^"]+"/)) {</span></span>
<span id="cb27-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gene_str = substr($9, RSTART, RLENGTH);</span></span>
<span id="cb27-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Remove the "gene_id " prefix and the quotes.</span></span>
<span id="cb27-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/gene_id "/, "", gene_str);</span></span>
<span id="cb27-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/"/, "", gene_str);</span></span>
<span id="cb27-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        genes[gene_str] = 1;</span></span>
<span id="cb27-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">END {</span></span>
<span id="cb27-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    avg_length = (total_entries &gt; 0) ? sum_length / total_entries : 0;</span></span>
<span id="cb27-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    unique_gene_count = 0;</span></span>
<span id="cb27-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (g in genes)</span></span>
<span id="cb27-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        unique_gene_count++;</span></span>
<span id="cb27-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Basic GTF File Statistics:";</span></span>
<span id="cb27-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "--------------------------";</span></span>
<span id="cb27-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Total entries:      " total_entries;</span></span>
<span id="cb27-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Unique genes:       " unique_gene_count;</span></span>
<span id="cb27-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Min gene length:    " min_length;</span></span>
<span id="cb27-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Max gene length:    " max_length;</span></span>
<span id="cb27-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    printf("Average gene length: %.2f\n", avg_length);</span></span>
<span id="cb27-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nFeature counts:";</span></span>
<span id="cb27-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (f in feature) {</span></span>
<span id="cb27-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " f ": " feature[f];</span></span>
<span id="cb27-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nChromosome counts:";</span></span>
<span id="cb27-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (c in chrom) {</span></span>
<span id="cb27-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " c ": " chrom[c];</span></span>
<span id="cb27-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb27-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb27-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$tf_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>lncRNA</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/39-lncRNA/</guid>
  <pubDate>Fri, 28 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_bestblogever_-_main_-_RStudio_2025-02-28_08-51-47.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Please Klone me</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/38-klone/</link>
  <description><![CDATA[ 





<p>Let’s get everyone up an running with Klone and RStudio.</p>
<section id="log-in" class="level1">
<h1>Log in</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@Stevens-MacBook-Air-184</span> ~ % ssh sr320@klone.hyak.uw.edu</span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@klone.hyak.uw.edu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Password:</span> </span>
<span id="cb1-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sr320@klone.hyak.uw.edu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Duo</span> two-factor login for sr320</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> a passcode or select one of the following options:</span>
<span id="cb1-6"></span>
<span id="cb1-7"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> Duo Push to XXX-XXX-3626</span>
<span id="cb1-8"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> Duo Push to iOS</span>
<span id="cb1-9"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">3.</span> Phone call to XXX-XXX-3626</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Passcode</span> or option <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1-3</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> 1</span></code></pre></div>
</div>
</section>
<section id="cd-to-srlab-directory" class="level1">
<h1>CD to srlab directory</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /gscratch/srlab/</span></code></pre></div>
</div>
<p>Create user directory in srlab (if not present)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> sr320</span></code></pre></div>
</div>
</section>
<section id="add-containers-to-your-local-directory" class="level1">
<h1>Add containers to your local directory</h1>
<pre><code>-rwxr-xr-x 1 samwhite all   3311583232 2024-12-04 srlab-bioinformatics-container-09dfcb2.sif
-rwxrwxr-x 1 samwhite srlab 2985074688 2024-10-17 srlab-bioinformatics-container-2bd5d44.sif
-rwxr-xr-x 1 samwhite all   3008335872 2024-11-06 srlab-bioinformatics-container-586bf21.sif
-rwxr-xr-x 1 samwhite all   3008442368 2024-11-07 srlab-bioinformatics-container-f4142f4.sif
-rwxr-xr-x 1 samwhite all   3380895744 2025-01-04 srlab-R4.4-bioinformatics-container-703094b.sif</code></pre>
<p>Specifically <code>srlab-R4.4-bioinformatics-container-703094b.sif</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#within user directory</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> ../containers/srlab-R4.4-bioinformatics-container-703094b.sif . </span></code></pre></div>
</div>
<p>See Footnotes for more information on containers.</p>
</section>
<section id="slurm-job-script" class="level1">
<h1>SLURM JOB SCRIPT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cp</span> ../sr320/rstudio-server.job .</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>User needs to (maybe) set/change the following in the SLURM script before starting script:</p>
<ul>
<li><p><code>#SBATCH --partition=</code></p></li>
<li><p><code>#SBATCH --time=</code></p></li>
<li><p><code>#SBATCH --cpus-per-task=</code></p></li>
<li><p><code>#SBATCH --mem=</code></p></li>
<li><p><code>#SBATCH --chdir=</code></p></li>
<li><p><code>RSTUDIO_CWD="/gscratch/srlab/sr320" # UPDATE THIS LINE</code></p></li>
<li><p><code>RSTUDIO_SIF="srlab-R4.4-bioinformatics-container-703094b.sif" # UPDATE THIS LINE</code></p></li>
</ul></li>
</ul>
</div>
</div>
<section id="partition-options" class="level2">
<h2 class="anchored" data-anchor-id="partition-options">Partition Options</h2>
<p><code>cpu-g2-mem2x</code> or <code>ckpt</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[sr320@klone-login03</span> containers]$ hyakalloc</span>
<span id="cb7-2">       <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Account</span> resources available to user: sr320        </span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╭─────────┬──────────────┬──────┬────────┬──────┬───────╮</span></span>
<span id="cb7-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> Account │    Partition │ CPUs │ Memory │ GPUs │       │</span>
<span id="cb7-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├─────────┼──────────────┼──────┼────────┼──────┼───────┤</span></span>
<span id="cb7-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   srlab │ cpu-g2-mem2x │   32 │   490G │    0 │ TOTAL │</span>
<span id="cb7-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>         │              │   12 │   100G │    0 │ USED  │</span>
<span id="cb7-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>         │              │   20 │   390G │    0 │ FREE  │</span>
<span id="cb7-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╰─────────┴──────────────┴──────┴────────┴──────┴───────╯</span></span>
<span id="cb7-10"> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Checkpoint</span> Resources  <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ckpt</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb7-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╭───────┬──────┬──────╮</span></span>
<span id="cb7-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>       │ CPUs │ GPUs │</span>
<span id="cb7-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├───────┼──────┼──────┤</span></span>
<span id="cb7-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span> Idle: │ 4557 │  148 │</span>
<span id="cb7-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">╰───────┴──────┴──────╯</span></span></code></pre></div>
</div>
<p>Open</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nano</span> rstudio-server.job</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!/bin/sh</span></span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --job-name=rstudio-server</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --account=srlab</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --partition=cpu-g2-mem2x #update this line - use hyakalloc to find partitions you can use</span></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --time=15-08:00:00</span></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --ntasks=1              # Number of tasks</span></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --cpus-per-task=12     # Increased threads from 4 to 8</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --nodes=1</span></span>
<span id="cb9-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --mem=100G</span></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --signal=USR2</span></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --output=%x_%j.out</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Specify the working directory for this job</span></span>
<span id="cb9-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#SBATCH --chdir=/gscratch/srlab/sr320</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This script will request a single CPU with four threads with 20GB of RAM for 2 hours. </span></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># You can adjust --time, --nodes, --ntasks, and --mem above to adjust these settings for your session.</span></span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --output=%x_%j.out creates a output file called rstudio-server_NNNNNNNN.out </span></span>
<span id="cb9-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># where the %x is short hand for --job-name above and the N's are an 8-digit </span></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># jobID assigned by SLURM when our job is submitted.</span></span>
<span id="cb9-22"></span>
<span id="cb9-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_CWD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gscratch/srlab/sr320"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># UPDATE THIS LINE</span></span>
<span id="cb9-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_SIF</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"srlab-R4.4-bioinformatics-container-703094b.sif"</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># UPDATE THIS LINE</span></span>
<span id="cb9-25"></span>
<span id="cb9-26"></span>
<span id="cb9-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create temp directory for ephemeral content to bind-mount in the container</span></span>
<span id="cb9-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RSTUDIO_TMP</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/usr/bin/python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import tempfile; print(tempfile.mkdtemp())'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-29"></span>
<span id="cb9-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> 700 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/run <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/tmp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/var/lib/rstudio-server</span>
<span id="cb9-34"></span>
<span id="cb9-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/database.conf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">provider=sqlite</span></span>
<span id="cb9-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">directory=/var/lib/rstudio-server</span></span>
<span id="cb9-38"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-39"></span>
<span id="cb9-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set OMP_NUM_THREADS to prevent OpenBLAS (and any other OpenMP-enhanced</span></span>
<span id="cb9-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># libraries used by R) from spawning more threads than the number of processors</span></span>
<span id="cb9-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># allocated to the job.</span></span>
<span id="cb9-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb9-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set R_LIBS_USER to a path specific to rocker/rstudio to avoid conflicts with</span></span>
<span id="cb9-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># personal libraries from any R installation in the host environment</span></span>
<span id="cb9-46"></span>
<span id="cb9-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/rsession.sh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">#!/bin/sh</span></span>
<span id="cb9-49"></span>
<span id="cb9-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export OMP_NUM_THREADS=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_JOB_CPUS_PER_NODE}</span></span>
<span id="cb9-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export R_LIBS_USER=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/R</span></span>
<span id="cb9-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">exec /usr/lib/rstudio-server/bin/rsession "</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{@}"</span></span>
<span id="cb9-53"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-54"></span>
<span id="cb9-55"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span>/rsession.sh</span>
<span id="cb9-56"></span>
<span id="cb9-57"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINER_BIND</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,/gscratch:/gscratch,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/run:/run,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/tmp:/tmp,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/database.conf:/etc/rstudio/database.conf,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rsession.sh:/etc/rstudio/rsession.sh,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_TMP}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/var/lib/rstudio-server:/var/lib/rstudio-server"</span></span>
<span id="cb9-58"></span>
<span id="cb9-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do not suspend idle sessions.</span></span>
<span id="cb9-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Alternative to setting session-timeout-minutes=0 in /etc/rstudio/rsession.conf</span></span>
<span id="cb9-61"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_RSTUDIO_SESSION_TIMEOUT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0</span>
<span id="cb9-62"></span>
<span id="cb9-63"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_USER</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">id</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-un</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-64"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINERENV_PASSWORD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">openssl</span> rand <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-base64</span> 15<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-65"></span>
<span id="cb9-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get unused socket per https://unix.stackexchange.com/a/132524</span></span>
<span id="cb9-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tiny race condition between the python &amp; apptainer commands</span></span>
<span id="cb9-68"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">readonly</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PORT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/mmfs1/sw/pyenv/versions/3.9.5/bin/python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'import socket; s=socket.socket(); s.bind(("", 0)); print(s.getsockname()[1]); s.close()'</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb9-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;END</span></span>
<span id="cb9-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. SSH tunnel from your workstation using the following command:</span></span>
<span id="cb9-71"></span>
<span id="cb9-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   ssh -N -L 8787:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HOSTNAME}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PORT}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">@klone.hyak.uw.edu</span></span>
<span id="cb9-73"></span>
<span id="cb9-74"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   and point your web browser to http://localhost:8787</span></span>
<span id="cb9-75"></span>
<span id="cb9-76"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. log in to RStudio Server using the following credentials:</span></span>
<span id="cb9-77"></span>
<span id="cb9-78"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   user: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span></span>
<span id="cb9-79"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   password: </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_PASSWORD}</span></span>
<span id="cb9-80"></span>
<span id="cb9-81"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">When done using RStudio Server, terminate the job by:</span></span>
<span id="cb9-82"></span>
<span id="cb9-83"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. Exit the RStudio Session ("power" button in the top right corner of the RStudio window)</span></span>
<span id="cb9-84"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. Issue the following command on the login node:</span></span>
<span id="cb9-85"></span>
<span id="cb9-86"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      scancel -f </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SLURM_JOB_ID}</span></span>
<span id="cb9-87"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">END</span></span>
<span id="cb9-88"></span>
<span id="cb9-89"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> /etc/bashrc</span>
<span id="cb9-90"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">module</span> load apptainer</span>
<span id="cb9-91"></span>
<span id="cb9-92"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apptainer</span> exec <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cleanenv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--home</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_CWD}</span>/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${RSTUDIO_SIF}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-93">    rserver <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--www-port</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${PORT}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-94">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-none</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-95">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-pam-helper-path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>pam-helper <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-96">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-stay-signed-in-days</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>30 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-97">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--auth-timeout-minutes</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-98">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rsession-path</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>/etc/rstudio/rsession.sh <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-99">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--server-user</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${APPTAINERENV_USER}</span></span>
<span id="cb9-100"></span>
<span id="cb9-101"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPTAINER_EXIT_CODE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span></span>
<span id="cb9-102"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rserver exited </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$APPTAINER_EXIT_CODE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&amp;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-103"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$APPTAINER_EXIT_CODE</span></span></code></pre></div>
</div>
</section>
</section>
<section id="run" class="level1">
<h1>Run</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sbatch</span> rstudio-server.job</span></code></pre></div>
</div>
</section>
<section id="folllow-instructions-in-output-file-to-connect-to-rstudio." class="level1">
<h1>Folllow Instructions in output file to connect to RStudio.</h1>
<p>eg</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> SSH tunnel from your workstation using the following command:</span>
<span id="cb11-2"></span>
<span id="cb11-3">   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-N</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 8787:n3263:56093 sr320@klone.hyak.uw.edu</span>
<span id="cb11-4"></span>
<span id="cb11-5">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">and</span> point your web browser to http://localhost:8787</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> log in to RStudio Server using the following credentials:</span>
<span id="cb11-8"></span>
<span id="cb11-9">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user:</span> sr320</span>
<span id="cb11-10">   <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">password:</span> PDQlr876755PgP3g37c</span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">When</span> done using RStudio Server, terminate the job by:</span>
<span id="cb11-13"></span>
<span id="cb11-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">1.</span> Exit the RStudio Session <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"power"</span> button in the top right corner of the RStudio window<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb11-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">2.</span> Issue the following command on the login node:</span>
<span id="cb11-16"></span>
<span id="cb11-17">      <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">scancel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> 24359989</span></code></pre></div>
</div>
</section>
<section id="footnotes" class="level1">
<h1>Footnotes</h1>
<pre><code>srlab-bioinformatics-container-&lt;git commit hash&gt;.sif: A "catch-all" container which holds most of the commonly used bioinformatics software
used by the Roberts Lab. The &lt;git commit hash&gt; is taken from the definition file used to construct the container. The definition file can be found at
/gscratch/srlab/gitrepos/RobertsLab/code/apptainer_definition_files/srlab-bioinformatics-container.def.</code></pre>
<section id="definition-file" class="level2">
<h2 class="anchored" data-anchor-id="definition-file">Definition File</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[sr320@klone-login03</span> containers]$ cat /gscratch/srlab/gitrepos/RobertsLab/code/apptainer_definition_files/srlab-bioinformatics-container.def</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To use RepeatMasker with this container, RepeatMasker must be installed on the local computer in the following location:</span></span>
<span id="cb14-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker</span></span>
<span id="cb14-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RepeatMasker must be configured on the local computer prior to running via this container.</span></span>
<span id="cb14-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The container expects the following files:</span></span>
<span id="cb14-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#</span></span>
<span id="cb14-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5</span></span>
<span id="cb14-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config</span></span>
<span id="cb14-11"></span>
<span id="cb14-12"></span>
<span id="cb14-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Bootstrap:</span> docker</span>
<span id="cb14-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">From:</span> rocker/rstudio:4.4.1</span>
<span id="cb14-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%files</span></span>
<span id="cb14-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load file with R package installation commands in to container at /tmp</span></span>
<span id="cb14-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Expects file called "r_packages_installs.R" to be in current directory.</span></span>
<span id="cb14-18">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">r_packages_installs.R</span> /tmp/</span>
<span id="cb14-19"></span>
<span id="cb14-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%setup</span></span>
<span id="cb14-21"></span>
<span id="cb14-22"></span>
<span id="cb14-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%environment</span></span>
<span id="cb14-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Set program locations/versions for system PATH </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb14-25">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">programs_location</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs"</span></span>
<span id="cb14-26">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.24.2"</span></span>
<span id="cb14-27">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5.4"</span></span>
<span id="cb14-28">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1.9"</span></span>
<span id="cb14-29">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastp_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.23.4"</span></span>
<span id="cb14-30">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.12.1"</span></span>
<span id="cb14-31">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gffcompare_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gffcompare-0.12.6"</span></span>
<span id="cb14-32">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">kallisto_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.51.1"</span></span>
<span id="cb14-34">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">miniforge_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24.7.1-0"</span></span>
<span id="cb14-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">multiqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.24.1"</span></span>
<span id="cb14-36">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_blast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.16.0"</span></span>
<span id="cb14-37">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_datasets_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"13.34.0"</span></span>
<span id="cb14-38">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repeatmasker_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.1.7-p1"</span></span>
<span id="cb14-39">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmblast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.14.1"</span></span>
<span id="cb14-40">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">salmon_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.10.0"</span></span>
<span id="cb14-41">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.20"</span></span>
<span id="cb14-42">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stringtie_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-43">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmomatic_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.39"</span></span>
<span id="cb14-44"></span>
<span id="cb14-45">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">mamba_envs_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/envs"</span></span>
<span id="cb14-46"></span>
<span id="cb14-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######################################################</span></span>
<span id="cb14-48"></span>
<span id="cb14-49">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LC_ALL</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>C</span>
<span id="cb14-50">    </span>
<span id="cb14-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">### Set container system PATH </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">###</span></span>
<span id="cb14-52">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/usr/local/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/local/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/usr/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/sbin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-58"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-59"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Bismark-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-60"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bowtie2-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-sra-linux-x86_64:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-61"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/fastqc-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-62"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-63"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-64"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/kallisto-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/build/src:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-65"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-66"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${mamba_envs_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/multiqc_env/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-67"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/ncbi-blast-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">+/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-68"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/ncbi-datasets-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-69"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/RepeatMasker:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-70"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/rmblast-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-71"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/salmon-latest_linux_x86_64/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-72"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/samtools-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-73"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.Linux_x86_64:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-74"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/Trimmomatic-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-75"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${programs_location}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/trf409.linux64"</span></span>
<span id="cb14-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">######################################################</span></span>
<span id="cb14-77"></span>
<span id="cb14-78"></span>
<span id="cb14-79"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%post</span></span>
<span id="cb14-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install common/base libraries/dependencies</span></span>
<span id="cb14-81">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt</span> update <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-82">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-install-recommends</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-83">    apt-utils <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-84">    aptitude <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-85">    automake <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-86">    build-essential <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-87">    bzip2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-88">    cmake <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-89">    coreutils <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-90">    curl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-91">    debconf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-92">    default-jdk <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-93">    dialog <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-94">    emboss <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-95">    gcc-multilib <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-96">    gdebi-core <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-97">    gfortran <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-98">    git <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-99">    gobjc++ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-100">    hmmer <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-101">    htop <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-102">    infernal <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-103">    libapparmor1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-104">    libbz2-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-105">    libc6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-106">    libcurl4-openssl-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-107">    libedit2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-108">    libfontconfig1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-109">    liblzma-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-110">    libncurses5-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-111">    libncurses-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-112">    libncursesw5-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-113">    libpango1.0-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-114">    libpng-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-115">    libreadline-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-116">    libsm6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-117">    libsparsehash-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-118">    libssl-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-119">    liburi-escape-xs-perl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-120">    liburi-perl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-121">    libxml2 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-122">    libxrender1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-123">    libz-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-124">    libbz2-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-125">    liblzma-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-126">    libxt6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-127">    libxtst6 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-128">    libzmq3-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-129">    locales <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-130">    locales-all <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-131">    man <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-132">    nano <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-133">    ncurses-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-134">    net-tools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-135">    openssh-client <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-136">    parallel <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-137">    pkg-config <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-138">    psmisc <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-139">    python3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-140">    python-setuptools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-141">    rsync <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-142">    ruby <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-143">    software-properties-common <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-144">    sqlite3 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-145">    sudo <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-146">    texinfo <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-147">    tree <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-148">    unzip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-149">    wget <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-150">    xorg-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-151">    zlib1g-dev</span>
<span id="cb14-152"></span>
<span id="cb14-153">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run R package installation script file</span></span>
<span id="cb14-154">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Rscript</span> /tmp/r_packages_installs.R</span>
<span id="cb14-155"></span>
<span id="cb14-156">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">########## Set program versions ##########</span></span>
<span id="cb14-157"></span>
<span id="cb14-158">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bedtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v2.31.0"</span></span>
<span id="cb14-159">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bismark_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.24.2"</span></span>
<span id="cb14-160">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bowtie2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5.4"</span></span>
<span id="cb14-161">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diamond_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1.9"</span></span>
<span id="cb14-162">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastp_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.23.4"</span></span>
<span id="cb14-163">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fastqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.12.1"</span></span>
<span id="cb14-164">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gffcompare_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gffcompare-0.12.6"</span></span>
<span id="cb14-165">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hisat2_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-166">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">kallisto_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.51.1"</span></span>
<span id="cb14-167">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">miniforge_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24.7.1-0"</span></span>
<span id="cb14-168">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">multiqc_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.24.1"</span></span>
<span id="cb14-169">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_blast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.16.0"</span></span>
<span id="cb14-170">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ncbi_datasets_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"16.34.0"</span></span>
<span id="cb14-171">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">repeatmasker_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.1.7-p1"</span></span>
<span id="cb14-172">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rmblast_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.14.1"</span></span>
<span id="cb14-173">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">salmon_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.10.0"</span></span>
<span id="cb14-174">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stringtie_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.2.1"</span></span>
<span id="cb14-175">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">samtools_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.20"</span></span>
<span id="cb14-176">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">trimmomatic_version</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.39"</span></span>
<span id="cb14-177"></span>
<span id="cb14-178">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">##########################################</span></span>
<span id="cb14-179">    </span>
<span id="cb14-180"></span>
<span id="cb14-181">    </span>
<span id="cb14-182">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set threads for faster builds</span></span>
<span id="cb14-183">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40"</span></span>
<span id="cb14-184"></span>
<span id="cb14-185">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make programs directory</span></span>
<span id="cb14-186">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> /srlab/programs</span>
<span id="cb14-187"></span>
<span id="cb14-188">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change to installation directory</span></span>
<span id="cb14-189">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-190"></span>
<span id="cb14-191">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Install Miniforge (Conda/Mamba)</span></span>
<span id="cb14-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/conda-forge/miniforge/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>/Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh</span>
<span id="cb14-193">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ./miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span></span>
<span id="cb14-194"></span>
<span id="cb14-195">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:/srlab/programs/miniforge3-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/bin"</span></span>
<span id="cb14-196"></span>
<span id="cb14-197">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> init</span>
<span id="cb14-198">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> ./miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>/etc/profile.d/conda.sh</span>
<span id="cb14-199"></span>
<span id="cb14-200">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> Miniforge3-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${miniforge_version}</span>-Linux-x86_64.sh</span>
<span id="cb14-201"></span>
<span id="cb14-202">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Configure conda channels</span></span>
<span id="cb14-203">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels defaults</span>
<span id="cb14-204">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels bioconda</span>
<span id="cb14-205">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--add</span> channels conda-forge</span>
<span id="cb14-206">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--set</span> channel_priority strict</span>
<span id="cb14-207"></span>
<span id="cb14-208">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install bedtools</span></span>
<span id="cb14-209">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/arq5x/bedtools2/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bedtools_version}</span>/bedtools.static</span>
<span id="cb14-210">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> bedtools.static bedtools</span>
<span id="cb14-211">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> a+x bedtools</span>
<span id="cb14-212"></span>
<span id="cb14-213">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install Bismark</span></span>
<span id="cb14-214">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/FelixKrueger/Bismark/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-215">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-216">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bismark_version}</span>.zip</span>
<span id="cb14-217"></span>
<span id="cb14-218">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install bowtie2</span></span>
<span id="cb14-219">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/BenLangmead/bowtie2/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>/bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-220">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-221">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> bowtie2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${bowtie2_version}</span>-sra-linux-x86_64.zip</span>
<span id="cb14-222"></span>
<span id="cb14-223">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install DIAMOND BLAST</span></span>
<span id="cb14-224">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/bbuchfink/diamond/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${diamond_version}</span>/diamond-linux64.tar.gz</span>
<span id="cb14-225">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> diamond-linux64.tar.gz</span>
<span id="cb14-226">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> diamond-linux64.tar.gz</span>
<span id="cb14-227"></span>
<span id="cb14-228">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install fastp</span></span>
<span id="cb14-229">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://opengene.org/fastp/fastp.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp_version}</span></span>
<span id="cb14-230">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> fastp.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastp_version}</span> fastp</span>
<span id="cb14-231">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> a+x ./fastp</span>
<span id="cb14-232"></span>
<span id="cb14-233">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install FastQC</span></span>
<span id="cb14-234">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-235">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-236">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> FastQC fastqc-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span></span>
<span id="cb14-237">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> fastqc_v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${fastqc_version}</span>.zip</span>
<span id="cb14-238"></span>
<span id="cb14-239">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install gffcompare</span></span>
<span id="cb14-240">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://ccb.jhu.edu/software/stringtie/dl/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-241">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-242">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${gffcompare_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-243"></span>
<span id="cb14-244">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install HISAT2</span></span>
<span id="cb14-245">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/DaehwanKimLab/hisat2/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-246">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-247">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> hisat2-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span></span>
<span id="cb14-248">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb14-249">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb14-250">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${hisat2_version}</span>.tar.gz</span>
<span id="cb14-251"></span>
<span id="cb14-252">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install kallisto</span></span>
<span id="cb14-253">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/pachterlab/kallisto/archive/refs/tags/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-254">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-255">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> kallisto-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span></span>
<span id="cb14-256">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> build</span>
<span id="cb14-257">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> build</span>
<span id="cb14-258">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cmake</span> ..</span>
<span id="cb14-259">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span></span>
<span id="cb14-260">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-261">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${kallisto_version}</span>.tar.gz</span>
<span id="cb14-262"></span>
<span id="cb14-263">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install MultiQC</span></span>
<span id="cb14-264">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> multiqc_env multiqc=1.24.1</span>
<span id="cb14-265"></span>
<span id="cb14-266">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install NCBI datasets</span></span>
<span id="cb14-267">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parents</span> ncbi-datasets-v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span></span>
<span id="cb14-268"></span>
<span id="cb14-269">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ncbi-datasets-v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_datasets_version}</span></span>
<span id="cb14-270">    </span>
<span id="cb14-271">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/ncbi/datasets/releases/download/v16.34.0/linux-amd64.cli.package.zip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-272">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> linux-amd64.cli.package.zip <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-273">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> linux-amd64.cli.package.zip</span>
<span id="cb14-274"></span>
<span id="cb14-275">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> /srlab/programs</span>
<span id="cb14-276"></span>
<span id="cb14-277">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install NCBI BLAST</span></span>
<span id="cb14-278">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>/ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-279">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-zxvpf</span> ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-280">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> ncbi-blast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${ncbi_blast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-281"></span>
<span id="cb14-282">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RepeatMasker conda environment with Python3 and h5py using mamba</span></span>
<span id="cb14-283">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mamba</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> repeatmasker-env python=3.8 h5py <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb14-284"></span>
<span id="cb14-285">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install RepeatMasker</span></span>
<span id="cb14-286">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.repeatmasker.org/RepeatMasker/RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-287">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-288">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> RepeatMasker-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${repeatmasker_version}</span>.tar.gz</span>
<span id="cb14-289"></span>
<span id="cb14-290">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## Remove default RepeatMasker DB</span></span>
<span id="cb14-291">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> /srlab/programs/RepeatMasker/Libraries/famdb/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb14-292"></span>
<span id="cb14-293">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up symlinks to RepeatMasker files on Klone</span></span>
<span id="cb14-294">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5 /srlab/programs/RepeatMasker/Libraries/famdb/dfam38_full.0.h5</span>
<span id="cb14-295">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ln</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> /gscratch/srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config /srlab/programs/RepeatMasker/Libraries/famdb/rmlib.config</span>
<span id="cb14-296"></span>
<span id="cb14-297">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install RMBLAST</span></span>
<span id="cb14-298">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://www.repeatmasker.org/rmblast/rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-299">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-300">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> rmblast-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${rmblast_version}</span>+-x64-linux.tar.gz</span>
<span id="cb14-301"></span>
<span id="cb14-302">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install salmon</span></span>
<span id="cb14-303">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/COMBINE-lab/salmon/releases/download/v<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>/salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-304">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-305">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> salmon-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${salmon_version}</span>_linux_x86_64.tar.gz</span>
<span id="cb14-306"></span>
<span id="cb14-307">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install samtools</span></span>
<span id="cb14-308">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/samtools/samtools/releases/download/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>/samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-309">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xjvf</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-310">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span></span>
<span id="cb14-311">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">./configure</span></span>
<span id="cb14-312">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${threads}</span></span>
<span id="cb14-313">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb14-314">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> samtools-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samtools_version}</span>.tar.bz2</span>
<span id="cb14-315"></span>
<span id="cb14-316">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install trimmomatic</span></span>
<span id="cb14-317">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-318">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-319">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span></span>
<span id="cb14-320">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> Trimmomatic-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${trimmomatic_version}</span>.zip</span>
<span id="cb14-321"></span>
<span id="cb14-322">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install StringTie</span></span>
<span id="cb14-323">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> http://ccb.jhu.edu/software/stringtie/dl/stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-324">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tar</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-xzvf</span> stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-325">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> stringtie-<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${stringtie_version}</span>.Linux_x86_64.tar.gz</span>
<span id="cb14-326"></span>
<span id="cb14-327">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install TRF</span></span>
<span id="cb14-328">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/Benson-Genomics-Lab/TRF/releases/download/v4.09.1/trf409.linux64</span>
<span id="cb14-329">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> +x trf409.linux64</span>
<span id="cb14-330"></span>
<span id="cb14-331"></span>
<span id="cb14-332"></span>
<span id="cb14-333"></span>
<span id="cb14-334"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%labels</span></span>
<span id="cb14-335">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Author</span> Sam White</span>
<span id="cb14-336">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Version</span> v0.0.5</span>
<span id="cb14-337">    </span>
<span id="cb14-338"></span>
<span id="cb14-339"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">%help</span></span>
<span id="cb14-340">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">This</span> is an Apptainer definition file for an Ubuntu container containing bioinformatics software for the Roberts Lab.</span></code></pre></div>
</div>


<!-- -->

</section>
</section>

 ]]></description>
  <category>hyak</category>
  <category>hpc</category>
  <category>RStudio</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/38-klone/</guid>
  <pubDate>Wed, 19 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_sr320__sr320klone-login03__ssh_klone.hyak.uw.edu__9830_2025-02-20_09-08-29.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Apul Time Series Methylation</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/</link>
  <description><![CDATA[ 





<p>Here we take the first set of time series methylation data to CpG level percent methylation.</p>
<section id="data-was-trimmed" class="level1">
<h1>Data was trimmed</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Trimming---A.pulchra-WGBS-with-fastp-FastQC-and-MultiQC-on-Raven/</a></p>
</div>
</div>
<p>To reproduce the trimming and quality control (QC) of <em>Acropora pulchra</em> Whole Genome Bisulfite Sequencing (WGBS) data, obtain the raw FastQ files and use <strong>fastp</strong> to trim <strong>25bp from the 5’ end</strong> while removing adapters, polyG, and polyA sequences; if errors occur, attempt repair with <strong>BBTools’ repair.sh</strong> before re-trimming. Evaluate trimmed reads with <strong>FastQC</strong>, then summarize results using <strong>MultiQC</strong>. The complete workflow, including commands and scripts, is available in the project repository, and output files can be accessed <a href="https://gannet.fish.washington.edu/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/">here</a>.</p>
</section>
<section id="reads-were-aligned" class="level1">
<h1>Reads were aligned</h1>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-01-02-Bismark-Alignments---A.pulchra-Trimmed-Reads-Using-Bismark-on-Hyak/</a></p>
</div>
</div>
<p>To align <em>Acropora pulchra</em> WGBS reads using <strong>Bismark</strong> on the <strong>Hyak</strong> cluster, trimmed FastQ files were prepared, and a <strong>fastq_pairs.txt</strong> file was generated. The alignment process was initiated by submitting a SLURM array job using sbatch –array=1-$(wc -l &lt; ../output/01.20-D-Apul-WGBS-trimming-fastp-FastQC-MultiQC/fastq_pairs.txt) 02.20-D-Apul-WGBS-alignment-SLURM-job.sh, which allowed each node to process a unique FastQ pair. The job script (02.20-D-Apul-WGBS-alignment-SLURM_array-bismark.sh) configured directories, allocated computational resources (bismark_threads=5), extracted FastQ filenames, and executed <strong>Bismark</strong> with <strong>Bowtie2</strong> using the parameters –score_min L,0,-0.6 –non_directional –gzip -p 5. The SLURM script (02.20-D-Apul-WGBS-alignment-SLURM-job.sh) defined job parameters (#SBATCH –cpus-per-task=20 –mem=100G –time=72:00:00) and executed the containerized Bismark workflow via <strong>Apptainer</strong>.</p>
</section>
<section id="taking-bams-to-tables" class="level1">
<h1>Taking BAMS to tables</h1>
<section id="deduplicated" class="level2">
<h2 class="anchored" data-anchor-id="deduplicated">Deduplicated</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _R1_001.fastp-trim_bismark_bt2_pe.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-6">--output_dir ../output/15-Apul-bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-7">/gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/output/02.20-D-Apul-WGBS-alignment-SLURM_array-bismark//{}_R1_001.fastp-trim_bismark_bt2_pe.bam</span></code></pre></div>
</section>
<section id="sorted" class="level2">
<h2 class="anchored" data-anchor-id="sorted">Sorted</h2>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> 24 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">../output/15-Apul-bismark/{}_R1_001.fastp-trim_bismark_bt2_pe.deduplicated.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">-o ../output/15-Apul-bismark/{}.sorted.bam</span></code></pre></div>
</section>
<section id="methylation-extraction" class="level2">
<h2 class="anchored" data-anchor-id="methylation-extraction">Methylation Extraction</h2>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2">bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3">--multicore 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> ../output/15-Apul-bismark <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{}"</span></span></code></pre></div>
</section>
<section id="methylation-call" class="level2">
<h2 class="anchored" data-anchor-id="methylation-call">Methylation call</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/15-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 24 coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">--genome_folder /gscratch/srlab/sam/gitrepos/urol-e5/timeseries_molecular/D-Apul/data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-o ../output/15-Apul-bismark/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../output/15-Apul-bismark/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
</section>
<section id="rename-cov-files" class="level2">
<h2 class="anchored" data-anchor-id="rename-cov-files">Rename cov files</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the CSV file and create an associative array - hand edited 3 filenames first</span></span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">declare</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_map</span></span>
<span id="cb5-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col3</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col4</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">azenta_sample_name</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">col6</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-4">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$azenta_sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample_name</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> ../../M-multi-species/data/e5_DNA_Azenta_metadata.csv</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/15.5-Apul-bismark/</span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate over all *.cov files and rename them</span></span>
<span id="cb5-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.cov<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the portion before the first underscore</span></span>
<span id="cb5-12">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-13">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb5-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">new_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_map</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$prefix</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mv</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$new_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span>
<span id="cb5-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="made-bedgraph" class="level2">
<h2 class="anchored" data-anchor-id="made-bedgraph">Made bedgraph</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../output/15.5-Apul-bismark/</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>merged_CpG_evidence.cov</span>
<span id="cb6-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb6-5">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">STEM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _R1_001.fastp-trim_bismark_bt2.CpG_report.merged_CpG_evidence.cov<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-F</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN {OFS = FS} {if ($5+$6 &gt;= 10) {print $1, $2, $3, $4}}'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-7">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STEM}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>_10x.bedgraph</span>
<span id="cb6-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="created-modified-tables" class="level2">
<h2 class="anchored" data-anchor-id="created-modified-tables">Created modified tables</h2>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/15.5-Apul-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb7-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{print "CpG_"_$1"_"$2, $4}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_processed.txt"</span></span>
<span id="cb7-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_httpsgannet.fish.washington.eduseashellbu-githubtimeseries_molecularD-Apuloutput15.5-Apul-bismarkACR-139-TP2_10x_proc_2025-02-08_05-03-16.png" class="img-fluid"></p>
<p>Now there are files for each of the Apul samples @ <a href="https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/" class="uri">https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/</a></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>methylation</category>
  <category>coral</category>
  <category>bismark</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/37-Apul-meth/</guid>
  <pubDate>Sat, 08 Feb 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_urol-e5timeseries_molecular_2025-02-08_04-42-58.png" medium="image" type="image/png"/>
</item>
<item>
  <title>We wish you a Merry Mytilus!</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/36-merry/</link>
  <description><![CDATA[ 





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/mm.gif" class="img-fluid figure-img"></p>
<figcaption>merry</figcaption>
</figure>
</div>
<p>Following Bismark alignment took data through methylkit to identify DMLs.</p>
<p>In case methyKit needs an installation</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">requireNamespace</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quietly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb1-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BiocManager"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4">BiocManager<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"methylKit"</span>)</span></code></pre></div>
<p>Used cov files to import into methylkit</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">-P ../data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*cov"</span> https://gannet.fish.washington.edu/seashell/bu-github/project-mytilus-methylation/output/09-meth-quant/</span></code></pre></div>
<p>Get a list of said files</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">analysisFilescov <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-2">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/105M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/106M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/107M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/109M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/239M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/240M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/241M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/242M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-10">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/269M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/270M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/271M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/272M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-14">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/69M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-15">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/70M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-16">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/71M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-17">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/72M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-18">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/78M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/79M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-20">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/80M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-21">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/81M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/92M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-23">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/94M.CpG_report.merged_CpG_evidence.cov"</span>,</span>
<span id="cb3-24">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/github/project-mytilus-methylation/data/95M.CpG_report.merged_CpG_evidence.cov"</span></span>
<span id="cb3-25">) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Put all .bam files into a list for analysis.</span></span></code></pre></div>
<p>Create a methylKit object with 2x coverage</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">myobj_23 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">methRead</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> analysisFilescov, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample.id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"105M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"106M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"107M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"109M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"239M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"240M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"241M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"242M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"269M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"270M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"271M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"272M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"69M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"70M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"71M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"72M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"78M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"79M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"80M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"81M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"92M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"94M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"95M"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assembly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mt"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pipeline =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bismarkCoverage"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">context=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mincov=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">treatment =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<p>Filter methylKit object for 5x coverage</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">filtered.myobj<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filterByCoverage</span>(myobj_23,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lo.count=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lo.perc=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-2">                                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hi.count=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hi.perc=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">98</span>)</span></code></pre></div>
<p>Unite methylKit object such that need data for 10 samples per group.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">meth_filter<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>methylKit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(filtered.myobj, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.per.group=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destrand=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<p>Visualize the data</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clusterSamples</span>(meth_filter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dist=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"correlation"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PCASamples</span>(meth_filter)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-mytilus-methylation____RStudio_Server_2024-12-24_07-39-59.png" class="img-fluid figure-img"></p>
<figcaption>cluster</figcaption>
</figure>
</div>
<p>Find Differences</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">myDiff<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">calculateDiffMeth</span>(meth_filter,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mc.cores=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>)</span></code></pre></div>
<p>Get DMLs at 55% Difference</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get all diffentially methylated bases</span></span>
<span id="cb9-2">myDiff_1055p<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getMethylDiff</span>(myDiff,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">difference=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">qvalue=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.table</span>(myDiff_1055p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11-methylkit-klone/myDiff_1055p.tab"</span>)</span></code></pre></div>
<p>Convert to Bedgraph</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input and output file names</span></span>
<span id="cb11-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11-methylkit-klone/myDiff_1055p.tab"</span></span>
<span id="cb11-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV/myDiff1055p.bedgraph"</span></span>
<span id="cb11-4"></span>
<span id="cb11-5"></span>
<span id="cb11-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the BEDGRAPH header</span></span>
<span id="cb11-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"track type=bedGraph name=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MethDiff</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> description=</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Methylation difference data</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-8"></span>
<span id="cb11-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process the input file to remove quotes and convert it to BEDGRAPH format</span></span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NR &gt; 1 {gsub(/"/, "", $2); print $2 "\t" $3-1 "\t" $4 "\t" $8}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$INPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-11"></span>
<span id="cb11-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Conversion complete. Output saved to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
<pre><code>track type=bedGraph name="MethDiff" description="Methylation difference data"
NC_086373.1 90626337    90626340    56.3226247436774
NC_086373.1 105503508   105503511   -57.8638497652582
NC_086374.1 34742950    34742953    58.2670906200318
NC_086375.1 31938078    31938081    -60.6923802783675
NC_086375.1 43581687    43581690    58.1981981981982
NC_086375.1 90876603    90876606    55.8823529411765
NC_086376.1 5631155 5631158 58.9955022488756
NC_086378.1 6633120 6633123 -55.241935483871
NC_086379.1 1603829 1603832 -60.822949869603
NC_086379.1 47961733    47961736    56.4495530012771
NC_086379.1 64017639    64017642    -63.5951772013153
NC_086379.1 64017774    64017777    -59.1351928466569
NC_086381.1 21212099    21212102    -56.0704607046071
NC_086382.1 25952233    25952236    -55.8318584070797
NC_086382.1 36708760    36708763    -56.5044858523119
NC_086386.1 17736432    17736435    -58.4235938927313</code></pre>
<p>Using IGV for some visualization!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/mm.gif" class="img-fluid figure-img"></p>
<figcaption>merry</figcaption>
</figure>
</div>
<p>Intersecting BEDGRAPH with GFF files to get gene information of where DMLs are located.</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Input files</span></span>
<span id="cb13-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BEDGRAPH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV/myDiff1055p.bedgraph"</span></span>
<span id="cb13-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GFF_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/12-IGV"</span></span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory for intersect results</span></span>
<span id="cb13-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-intersectbed/"</span></span>
<span id="cb13-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_DIR</span></span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through all GFF files in the directory</span></span>
<span id="cb13-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> GFF <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF_DIR</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gff<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">BASENAME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .gff<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-12">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTPUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_DIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BASENAME}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_intersect.bed"</span></span>
<span id="cb13-13">    </span>
<span id="cb13-14">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Intersecting </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$BEDGRAPH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb13-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> intersect <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-loj</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$BEDGRAPH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$GFF</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-19">    </span>
<span id="cb13-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Result saved to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTPUT_FILE</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span>
<span id="cb13-22"></span>
<span id="cb13-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"All intersections completed!"</span></span></code></pre></div>
<p>TLDR</p>
<ol type="1">
<li><p><strong>LOC134690221</strong>: <strong>GRAM domain-containing protein 4-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+56.32).</p>
<p>• <strong>Function</strong>: Involved in membrane-associated processes like signaling or vesicle trafficking.</p></li>
<li><p><strong>LOC134695637</strong>: <strong>Otoferlin-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-57.86).</p>
<p>• <strong>Function</strong>: Plays a role in vesicle-mediated transport and sensory signaling.</p></li>
<li><p><strong>LOC134707074</strong>: <strong>Receptor-type tyrosine-protein phosphatase N2-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+58.27).</p>
<p>• <strong>Function</strong>: Regulates cell signaling pathways affecting growth and differentiation.</p></li>
<li><p><strong>LOC134711256</strong>: <strong>Cancer-related nucleoside-triphosphatase homolog</strong></p>
<p>• <strong>Methylation status</strong>:</p>
<p>• Hypomethylated (-60.69).</p>
<p>• Hypermethylated (+58.20).</p>
<p>• <strong>Function</strong>: Involved in DNA/RNA metabolism and stress responses.</p></li>
<li><p><strong>LOC134712818</strong>: <strong>Uncharacterized protein</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+55.88).</p>
<p>• <strong>Function</strong>: Unknown.</p></li>
<li><p><strong>LOC134714536</strong>: <strong>Coatomer subunit epsilon-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypermethylated (+58.99).</p>
<p>• <strong>Function</strong>: Key player in intracellular vesicle trafficking.</p></li>
<li><p><strong>LOC134720671</strong>: <strong>Roundabout homolog 1-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-55.24).</p>
<p>• <strong>Function</strong>: Guides axon growth and cell migration.</p></li>
<li><p><strong>LOC134724475</strong>: <strong>Uncharacterized protein</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-60.82).</p>
<p>• <strong>Function</strong>: Unknown.</p></li>
<li><p><strong>LOC134725187</strong>: <strong>Membrane protein BRI3-like</strong></p>
<p>• <strong>Methylation status</strong>:</p>
<p>• Hypermethylated (+56.45).</p>
<p>• Hypomethylated (-63.60, -59.14).</p>
<p>• <strong>Function</strong>: Participates in signaling and membrane dynamics.</p></li>
<li><p><strong>LOC134685297</strong>: <strong>Tumor protein p53-inducible protein 11-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-56.07).</p>
<p>• <strong>Function</strong>: Responds to cellular stress, regulates apoptosis, and growth arrest.</p></li>
<li><p><strong>LOC134687110</strong>: <strong>Alpha-ketoglutarate-dependent dioxygenase alkB homolog 3-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-55.83).</p>
<p>• <strong>Function</strong>: Modifies nucleic acids or lipids, involved in repair and metabolism.</p></li>
<li><p><strong>LOC134687290</strong>: <strong>Mitogen-activated protein kinase kinase kinase 5-like</strong></p>
<p>• <strong>Methylation status</strong>: Hypomethylated (-56.50).</p>
<p>• <strong>Function</strong>: Key regulator of stress response and cellular signaling.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/dml.gif" class="img-fluid figure-img"></p>
<figcaption>dml</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>Pollution impacts DNA methylation in mussels as an adaptive or maladaptive response to environmental stress. This epigenetic flexibility allows mussels to fine-tune gene expression for survival, repair, and detoxification under polluted conditions. However, prolonged or excessive changes can lead to impaired growth, reproduction, or transgenerational effects, ultimately affecting mussel populations and ecosystem health.</p>
</blockquote>


<!-- -->


 ]]></description>
  <category>mytilus</category>
  <category>methylation</category>
  <category>methylkit</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/36-merry/</guid>
  <pubDate>Tue, 24 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Userssr320Desktopigv_session.xml_2024-12-24_07-26-36.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Time-series Apul lncRNA count matrix</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/34-Apul-lncRNA/</link>
  <description><![CDATA[ 





<p>I started with a bed file from discovery (see below) and used it to count the number of lncRNAs in each sample from Time Series data (Apul)</p>
<section id="converted-bed-to-gtf" class="level2">
<h2 class="anchored" data-anchor-id="converted-bed-to-gtf">Converted Bed to GTF</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/10.1-Apul-lncRNA/Apul_lncRNA.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/05-Apul-lncRNA/lncRNAs.gtf</span></code></pre></div>
<pre><code>==&gt; /home/shared/8TB_HDD_03/sr320/github/deep-dive-expression/D-Apul/output/10.1-Apul-lncRNA/Apul_lncRNA.bed &lt;==
ntLink_0    84514   93551
ntLink_0    15627   19151
ntLink_0    23443   23874
ntLink_1    7484    9525
ntLink_1    51265   51766
ntLink_2    217051  217761
ntLink_2    330551  331392
ntLink_3    56721   62176
ntLink_3    76352   81676
ntLink_3    95705   100623</code></pre>
<section id="gtf" class="level3">
<h3 class="anchored" data-anchor-id="gtf">GTF</h3>
<pre><code>ntLink_0    .   lncRNA  84514   93551   .   +   .   gene_id "lncRNA_001";
ntLink_0    .   lncRNA  15627   19151   .   +   .   gene_id "lncRNA_002";
ntLink_0    .   lncRNA  23443   23874   .   +   .   gene_id "lncRNA_003";
ntLink_1    .   lncRNA  7484    9525    .   +   .   gene_id "lncRNA_004";
ntLink_1    .   lncRNA  51265   51766   .   +   .   gene_id "lncRNA_005";
ntLink_2    .   lncRNA  217051  217761  .   +   .   gene_id "lncRNA_006";</code></pre>
</section>
</section>
<section id="feature-count" class="level2">
<h2 class="anchored" data-anchor-id="feature-count">Feature Count</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/subread-2.0.5-Linux-x86_64/bin/featureCounts</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2">-T 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">-a ../output/05-Apul-lncRNA/lncRNAs.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">-o ../output/05-Apul-lncRNA/counts.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-t lncRNA <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">-g gene_id <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">-p <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../data/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>sorted.bam</span></code></pre></div>
</section>
<section id="count-matrix" class="level2">
<h2 class="anchored" data-anchor-id="count-matrix">Count Matrix</h2>
<p><a href="https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/output/05-Apul-lncRNA/counts.txt" class="uri">https://github.com/urol-e5/timeseries_molecular/blob/main/D-Apul/output/05-Apul-lncRNA/counts.txt</a></p>
<hr>
<p>Before I did that, first lncRNA were discovered. This was done with the deep-dive expression samples (n=5)</p>
</section>
<section id="discovery" class="level1">
<h1>Discovery</h1>
<section id="stringtie" class="level2">
<h2 class="anchored" data-anchor-id="stringtie">StringTie</h2>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples–an important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/07-Apul-Hisat/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>sorted.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">-p 42 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">-G ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6">-o ../output/10.1-Apul-lncRNA/{}.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">../output/07-Apul-Hisat/{}.sorted.bam</span></code></pre></div>
<p>Merges all individual GTF assemblies into a single merged GTF file.</p>
<p>This is used to create a non-redundant set of transcripts after running StringTie separately on multiple RNA-Seq datasets.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-G ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-o ../output/10.1-Apul-lncRNA/stringtie_merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-5">../output/10.1-Apul-lncRNA/RNA<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</section>
<section id="gffcompare" class="level2">
<h2 class="anchored" data-anchor-id="gffcompare">GFFcompare</h2>
<p>https://ccb.jhu.edu/software/stringtie/gffcompare.shtml</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/gffcompare-0.12.6.Linux_x86_64/gffcompare</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2">-r ../data/Apulcra-genome.gff <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">-o ../output/10.1-Apul-lncRNA/gffcompare_merged <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">../output/10.1-Apul-lncRNA/stringtie_merged.gtf</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">Filter</h2>
<p>Filters the combined GTF output from GFFcompare to select only the lines representing “transcripts” and excluding lines starting with “#” (these are lines in the output format from GFFcompare that don’t contain transcript information). This step further filters for a class code of “u”, and keep only those with lengths greater than 199 bases. The “u’ class code from the GFFcompare step is for”unknown” transcripts, that is those that are not previously annotated in our reference GFF as protein coding. The size filter of +200nt is a common filtering step for isolating lncRNAs.</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-2">../output/10.1-Apul-lncRNA/gffcompare_merged.annotated.gtf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"\|class_code "x"|\class_code "i"\|class_code "y"'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.gtf</span></code></pre></div>
</section>
<section id="bedtools" class="level2">
<h2 class="anchored" data-anchor-id="bedtools">Bedtools</h2>
<p>Extracts the sequence data from the <code>$FASTA</code> reference file based on the coordinates from the filtered GTF. The resulting sequences represent potential lncRNA candidates.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/bedtools2/bin/fastaFromBed</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-2">-fi ../data/Apulcra-genome.fa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-3">-bed ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">-fo ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fgrep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta </span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta </span></code></pre></div>
</section>
<section id="cpc2" class="level2">
<h2 class="anchored" data-anchor-id="cpc2">CPC2</h2>
<p>Initializes a conda environment (Anaconda) and runs CPC2, a software to predict whether a transcript is coding or non-coding. The results are saved to the $OUTPUT_DIR. CPC2 uses ORF (Open Reading Frame) Analysis, Isometric Feature Mapping (Isomap), Sequence Homology, RNA Sequence Features, and Quality of Translation to assess coding potential and flag any transcripts we would want to exclude using the FASTA generated in the previous step.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/CPC2_standalone-1.0.1/bin/CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-3">-i ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-4">-o ../output/10.1-Apul-lncRNA/Apul_CPC2</span></code></pre></div>
</section>
<section id="filter-1" class="level2">
<h2 class="anchored" data-anchor-id="filter-1">Filter</h2>
<p>Filters the CPC2 results to get only noncoding transcripts (using the class “noncoding” from the CPC2 results) and extracts their IDs and matches these IDs with the sequences from the previous step to generate a GTF of long noncoding transcripts.</p>
<p>Matches these IDs with the sequences from the previous step to generate a GTF of noncoding transcripts.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> ../output/10.1-Apul-lncRNA/Apul_CPC2.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt</span></code></pre></div>
</section>
</section>
<section id="subsetting-fasta" class="level1">
<h1>subsetting fasta</h1>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/samtools-1.12/samtools</span> faidx ../output/10.1-Apul-lncRNA/Apul_lncRNA_candidates.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-2">-r ../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/10.1-Apul-lncRNA/Apul_lncRNA.fasta</span></code></pre></div>
</section>
<section id="getting-genome-feature-track" class="level1">
<h1>Getting genome feature track</h1>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Open the input file and the output file</span></span>
<span id="cb14-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../output/10.1-Apul-lncRNA/Apul_noncoding_transcripts_ids.txt'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> infile, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../output/10.1-Apul-lncRNA/Apul_lncRNA.bed'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outfile:</span>
<span id="cb14-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line in the input file</span></span>
<span id="cb14-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> infile:</span>
<span id="cb14-6">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove 'transcript::' and then split the line by ':' to extract the relevant parts</span></span>
<span id="cb14-7">        parts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line.strip().replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'transcript::'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>).split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span>)</span>
<span id="cb14-8">        chromosome <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb14-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position part by '-' to get start and end positions</span></span>
<span id="cb14-10">        start, end <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>)</span>
<span id="cb14-11">        </span>
<span id="cb14-12">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BED format requires the start position to be 0-based</span></span>
<span id="cb14-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb14-14">        start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(start) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-15">        </span>
<span id="cb14-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, start, and end positions to the output file</span></span>
<span id="cb14-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Separate each field with a tab character</span></span>
<span id="cb14-18">        outfile.write(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chromosome<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>end<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb14-19"></span>
<span id="cb14-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># After running this script, 'output.bed' will contain the converted data in BED format.</span></span></code></pre></div>
<ul>
<li>note that when you take this bed and make gtf you get -1 starts that make program fail - of course the 0-based / 1-based issue that will eventually need to be looked into.</li>
</ul>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>lncRNA</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/34-Apul-lncRNA/</guid>
  <pubDate>Fri, 20 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries_molecular__RStudio_Server_2024-12-20_03-51-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Mytilus DNA methylation calls</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/35-myt-meth/</link>
  <description><![CDATA[ 





<p>Following the genome prep did an alignment. This was preceded by an assessment of min_score variable. Selection was based on high alignment rate with minimal non CpG methylation.</p>
<p>Based on <a href="https://marineomics.github.io/FUN_02_DNA_methylation.html" class="uri">https://marineomics.github.io/FUN_02_DNA_methylation.html</a></p>
<section id="alignment" class="level1">
<h1>Alignment</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set variables</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">reads_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/"</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">genome_folder</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/"</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/01.2-bismark"</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">score_min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L,0,-1.0"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Single value for score_min</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the list of sample files and corresponding sample names</span></span>
<span id="cb1-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> file <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R1.fastp-trim.fq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-9">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample_name</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1.fastp-trim.fq.gz"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-10">    </span>
<span id="cb1-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running Bismark for sample </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> with score_min </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13">    </span>
<span id="cb1-14">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run Bismark alignment</span></span>
<span id="cb1-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/Bismark-0.24.0/bismark</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-16">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path_to_bowtie2</span> /home/shared/bowtie2-2.4.4-linux-x86_64 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-genome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${genome_folder}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-score_min</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${score_min}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R1.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${reads_dir}${sample_name}</span>_R2.fastp-trim.fq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--basename</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-24">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample_name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-bismark_summary.txt"</span></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="deduplication" class="level1">
<h1>deduplication</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/01.2-bismark/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 8 /home/shared/Bismark-0.24.0/deduplicate_bismark <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">--bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">--paired <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">--output_dir ../output/09-meth-quant <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">../output/01.2-bismark/{}.bam</span></code></pre></div>
</section>
<section id="methylation-extraction" class="level1">
<h1>Methylation extraction</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/09-meth-quant/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/Bismark-0.24.0/bismark_methylation_extractor <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--bedGraph</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--counts</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--comprehensive</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge_non_CpG</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--multicore</span> 24 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--buffer_size</span> 75% <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> ../output/09-meth-quant {} </span></code></pre></div>
</section>
<section id="methylation-call" class="level1">
<h1>Methylation call</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> ../output/09-meth-quant/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> _pe.deduplicated.bismark.cov.gz <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-j</span> 48 /home/shared/Bismark-0.24.0/coverage2cytosine <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">--genome_folder ../data/ <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">-o ../output/09-meth-quant/{} <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">--merge_CpG <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">--zero_based <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">../output/09-meth-quant/{}_pe.deduplicated.bismark.cov.gz</span></code></pre></div>
<p>This resulted in CpG_report.merged_CpG_evidence.cov files..</p>
</section>
<section id="sorted-bams" class="level1">
<h1>Sorted bams</h1>
<p>deduplicated sorted bams were also sorted..</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> /home/shared/samtools-1.12/samtools <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--threads</span> 48 {}.bam <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">-o {}.sorted.bam</span></code></pre></div>


<!-- -->

</section>

 ]]></description>
  <category>mytilus</category>
  <category>methylation</category>
  <category>bismark</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/35-myt-meth/</guid>
  <pubDate>Thu, 19 Dec 2024 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-mytilus-methylation__RStudio_Server_2024-12-20_04-34-37.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
