{
  "hash": "bdb28ff563c097882849841eace41944",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Git that Pro GO\"\ndescription: \"Deep dive Protein Annotation\"\ncategories: [blast, e5]\n#citation: \ndate: 08-25-2024\nimage: http://gannet.fish.washington.edu/seashell/snaps/Monosnap__in_UniProtKB_search_571864__UniProt_2024-08-23_16-18-03.png # finding a good image\n\nauthor:\n  - name: Steven Roberts\n    url: \n    orcid: 0000-0001-8302-1138\n    affiliation: Professor, UW - School of Aquatic and Fishery Sciences\n    affiliation-url: https://robertslab.info\n  #url:  # self-defined\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nformat:\n  html:\n    code-fold: FALSE\n    code-tools: true\n    code-copy: true\n    highlight-style: github\n    code-overflow: wrap\n---\n\n\n\n\ntldr:\n\nGot GO annotations for Deep Dive Protein sets:\n\n\nhttps://raw.githubusercontent.com/urol-e5/deep-dive/main/D-Apul/output/20-Apul-gene-annotation/Apul-protein-GO.tsv\n\nhttps://raw.githubusercontent.com/urol-e5/deep-dive/main/E-Peve/output/20-Peve-gene-annotation/Peve-protein-GO.tsv\n\nhttps://github.com/urol-e5/deep-dive/raw/main/F-Pmea/output/20-Pmea-gene-annotation/Pmea-protein-GO.tsv\n\n\n---\n\n\nHere is example code\n\n20-Apul Annotation\n================\nSteven Roberts\n25 August, 2024\n\n\n\nApul\n\n# Protein\n\n``` bash\ncd ../data\n\ncurl -O https://gannet.fish.washington.edu/seashell/snaps/GCF_013753865.1_Amil_v2.1.protein.faa\n```\n\n``` bash\nhead ../data/GCF_013753865.1_Amil_v2.1.protein.faa\n```\n\n``` bash\nls ../../data/blast_dbs\n```\n\n\n# Swiss Prot download\n``` bash\ncd ../../data/blast_dbs\ncurl -O https://ftp.uniprot.org/pub/databases/uniprot/current_release/knowledgebase/complete/uniprot_sprot.fasta.gz\nmv uniprot_sprot.fasta.gz uniprot_sprot_r2024_04.fasta.gz\ngunzip -k uniprot_sprot_r2024_04.fasta.gz\n```\n\n``` bash\nhead ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta\necho \"Number of Sequences\"\ngrep -c \">\" ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta\n```\n\n``` bash\n/home/shared/ncbi-blast-2.15.0+/bin/makeblastdb \\\n-in ../../data/blast_dbs/uniprot_sprot_r2024_04.fasta \\\n-dbtype prot \\\n-out ../../data/blast_dbs/uniprot_sprot_r2024_04\n```\n\n# Blastp\n\n``` bash\nfasta=\"../data/GCF_013753865.1_Amil_v2.1.protein.faa\"\n\n/home/shared/ncbi-blast-2.15.0+/bin/blastp \\\n-query $fasta \\\n-db ../../data/blast_dbs/uniprot_sprot_r2024_04 \\\n-out ../output/20-Apul-gene-annotation/blastp_out.tab \\\n-evalue 1E-05 \\\n-num_threads 48 \\\n-max_target_seqs 1 \\\n-max_hsps 1 \\\n-outfmt 6\n```\n\n``` bash\nwc -l ../output/20-Apul-gene-annotation/blastp_out.tab\n```\n\n``` bash\ntr '|' '\\t' < ../output/20-Apul-gene-annotation/blastp_out.tab \\\n> ../output/20-Apul-gene-annotation/blastp_out_sep.tab\n\nhead -1 ../output/20-Apul-gene-annotation/blastp_out_sep.tab\n```\n\n\n# Download GO info\n\n![](http://gannet.fish.washington.edu/seashell/snaps/Monosnap__in_UniProtKB_search_571864__UniProt_2024-08-23_16-18-03.png)\n\n\n\n    sr320@raven:/home/shared/8TB_HDD_01/sr320/github/deep-dive/data$ curl -H \"Accept: text/plain; format=tsv\" \"https://rest.uniprot.org/uniprotkb/stream?fields=accession%2Creviewed%2Cid%2Cprotein_name%2Cgene_names%2Corganism_name%2Clength%2Cgo_p%2Cgo_c%2Cgo%2Cgo_f%2Cgo_id&format=tsv&query=%28*%29+AND+%28reviewed%3Atrue%29\" -o SwissProt-Annot-GO_082324.tsv\n\n``` bash\nwc -l ../../data/SwissProt-Annot-GO_082324.tsv \n```\n\n#  **Join blast with GO info**\n\n``` r\nbltabl <- read.csv(\"../output/20-Apul-gene-annotation/blastp_out_sep.tab\", sep = '\\t', header = FALSE)\n\nspgo <- read.csv(\"../../data/SwissProt-Annot-GO_082324.tsv\", sep = '\\t', header = TRUE)\n```\n\n``` r\nannot_tab <- left_join(bltabl, spgo, by = c(\"V3\" = \"Entry\")) %>%\n  select(\n    query = V1,\n    blast_hit = V3,\n    evalue = V13,\n    ProteinNames = Protein.names,\n    BiologicalProcess = Gene.Ontology..biological.process.,\n    GeneOntologyIDs = Gene.Ontology.IDs\n  )\n```\n\n``` r\nhead(annot_tab)\n```\n\n``` r\nwrite.table(annot_tab, \n            file = \"../output/20-Apul-gene-annotation/Apul-protein-GO.tsv\", \n            sep = \"\\t\", \n            row.names = FALSE, \n            quote = FALSE)\n```\n\n``` bash\nhead ../output/20-Apul-gene-annotation/Apul-protein-GO.tsv\n```\n\n\n--- \n\nActual code at\n\nhttps://github.com/urol-e5/deep-dive/blob/main/D-Apul/code/20-Apul-gene-annotation.Rmd\n\nhttps://github.com/urol-e5/deep-dive/blob/main/E-Peve/code/20-Peve-gene-annotation.Rmd\n\nhttps://github.com/urol-e5/deep-dive/blob/main/F-Pmea/code/20-Pmea-gene-annotation.Rmd\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}