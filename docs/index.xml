<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Tumbling Oysters</title>
<link>https://sr320.github.io/tumbling-oysters/</link>
<atom:link href="https://sr320.github.io/tumbling-oysters/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.7.32</generator>
<lastBuildDate>Sat, 29 Nov 2025 08:00:00 GMT</lastBuildDate>
<item>
  <title>Calcifying Contra</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/63-contra/</link>
  <description><![CDATA[ 






<p>First off in time-series-calcification</p>
<p>https://github.com/urol-e5/timeseries-molecular-calcification/blob/main/M-multi-species/scripts/34-biomin-pathway-compare.rmd</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-22-16.png" class="img-fluid"> <img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-23-06.png" class="img-fluid" alt="ortho-spread"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-23-48.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/000010.png" class="img-fluid" alt="genelevel"> <img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-25-38.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-26-36.png" class="img-fluid"></p>
<section id="contra" class="level1">
<h1>Contra</h1>
<p>Then took onto ConTra‚Ä¶ with new script</p>
<pre><code>Duro:ConTra sr320$ python3 code/run_biomin_species_comparison.py                                         ======================================================================
üß¨ CROSS-SPECIES BIOMIN CONTEXT-DEPENDENT ANALYSIS
======================================================================
Workspace: /Users/sr320/GitHub/ConTra
Comparison output: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251129_144655
======================================================================</code></pre>
<pre><code> Using context_dependent_analysis_20251129_192544 for apul
  Using context_dependent_analysis_20251129_162258 for peve
  Using context_dependent_analysis_20251129_144655 for ptua

============================================================
LOADING SPECIES RESULTS
============================================================

üìÇ Loading A. pulchra...
  ‚úÖ Loaded methylation_mirna_context.csv: 33270 rows

üìÇ Loading P. evermanni...
  ‚úÖ Loaded methylation_mirna_context.csv: 27150 rows

üìÇ Loading P. tuahiniensis...
  ‚úÖ Loaded methylation_mirna_context.csv: 51150 rows

============================================================
COMPARING METHYLATION-MIRNA CONTEXT ACROSS SPECIES
============================================================

üìä Summary:
  Total unique OGs across all species: 611
  OGs in 2+ species: 358
  OGs in all 3 species: 100

‚úÖ Saved comparison table: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/cross_species_methylation_mirna_comparison.csv

üèÜ Top 15 Conserved Context-Dependent OGs (in 2+ species):
   og_id  n_species  mean_context_strength  apul_context_strength  peve_context_strength  ptua_context_strength
OG_01155          3               1.310726               1.521005               0.996267               1.414906
OG_02619          3               1.295301               1.468612               1.024492               1.392800
OG_06119          3               1.236816               0.971755               1.252635               1.486059
OG_08793          3               1.236346               0.808764               1.450764               1.449511
OG_05366          3               1.199557               0.939276               1.174450               1.484946
OG_03291          3               1.199266               1.186752               0.799569               1.611478
OG_05637          3               1.192262               1.166134               1.165108               1.245543
OG_01452          3               1.191146               1.526632               0.922735               1.124072
OG_07153          3               1.174770               0.979025               1.358085               1.187201
OG_01414          3               1.161650               1.680689               0.775683               1.028577
OG_01753          3               1.160818               1.140792               1.097454               1.244207
OG_08663          3               1.138407               0.935220               1.247335               1.232668
OG_09796          3               1.133137               1.016265               1.074893               1.308253
OG_04467          3               1.121429               1.075908               1.254588               1.033790
OG_07892          3               1.113713               1.090661               0.877698               1.372780

============================================================
GENERATING VISUALIZATIONS
============================================================
/Users/sr320/GitHub/ConTra/code/run_biomin_species_comparison.py:397: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.violinplot(data=strength_df, x='species', y='context_strength',
‚úÖ Saved comparison plots: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/plots/species_comparison_overview.png
‚úÖ Saved comparison report: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506/cross_species_comparison_report.md

======================================================================
üéâ CROSS-SPECIES COMPARISON COMPLETE!
======================================================================
Results saved to: /Users/sr320/GitHub/ConTra/output/biomin_comparison_20251130_052506
======================================================================</code></pre>
<section id="what-the-script-does" class="level2">
<h2 class="anchored" data-anchor-id="what-the-script-does"><strong>What the script does:</strong></h2>
<ol type="1">
<li><p><strong>Runs analysis on all 3 species</strong> in <a href="vscode-file://vscode-app/Applications/Visual Studio Code.app/Contents/Resources/app/out/vs/code/electron-browser/workbench/workbench.html">full-species-biomin</a>:</p>
<ul>
<li><p>A. pulchra (apul)</p></li>
<li><p>P. evermanni (peve)</p></li>
<li><p>P. tuahiniensis (ptua)</p></li>
</ul></li>
<li><p><strong>Extracts OG IDs</strong> from the results using regex to parse formats like:</p>
<ul>
<li><p><code>"('OG_13910', 'FUN_002435')"</code></p></li>
<li><p><code>OG_13910</code></p></li>
</ul></li>
<li><p><strong>Compares results across species</strong>:</p>
<ul>
<li><p>Finds OGs present in 2+ species</p></li>
<li><p>Ranks by conservation and context strength</p></li>
<li><p>Calculates correlations between species</p></li>
</ul></li>
<li><p><strong>Generates outputs</strong>:</p>
<ul>
<li><p><code>cross_species_methylation_mirna_comparison.csv</code> - Full comparison table</p></li>
<li><p><code>plots/species_comparison_overview.png</code> - 4-panel visualization</p></li>
<li><p><code>cross_species_comparison_report.md</code> - Summary report</p></li>
</ul></li>
</ol>
<hr>
</section>
</section>
<section id="cross-species-biomin-context-dependent-analysis-comparison" class="level1">
<h1>Cross-Species Biomin Context-Dependent Analysis Comparison</h1>
<p><strong>Generated:</strong> 2025-11-30 05:25:07</p>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This report compares context-dependent regulatory interactions across three coral species:</p>
<ul>
<li><strong>A. pulchra</strong> (<code>apul</code>)</li>
<li><strong>P. evermanni</strong> (<code>peve</code>)</li>
<li><strong>P. tuahiniensis</strong> (<code>ptua</code>)</li>
</ul>
</section>
<section id="per-species-summary" class="level2">
<h2 class="anchored" data-anchor-id="per-species-summary">Per-Species Summary</h2>
<section id="a.-pulchra-apul" class="level3">
<h3 class="anchored" data-anchor-id="a.-pulchra-apul">A. pulchra (apul)</h3>
<ul>
<li>Total methylation-miRNA interactions: 33270</li>
<li>Context-dependent interactions: 3039</li>
<li>Mean context strength: 0.311</li>
<li>Unique OGs: 334</li>
</ul>
</section>
<section id="p.-evermanni-peve" class="level3">
<h3 class="anchored" data-anchor-id="p.-evermanni-peve">P. evermanni (peve)</h3>
<ul>
<li>Total methylation-miRNA interactions: 27150</li>
<li>Context-dependent interactions: 3935</li>
<li>Mean context strength: 0.371</li>
<li>Unique OGs: 309</li>
</ul>
</section>
<section id="p.-tuahiniensis-ptua" class="level3">
<h3 class="anchored" data-anchor-id="p.-tuahiniensis-ptua">P. tuahiniensis (ptua)</h3>
<ul>
<li>Total methylation-miRNA interactions: 51150</li>
<li>Context-dependent interactions: 8765</li>
<li>Mean context strength: 0.346</li>
<li>Unique OGs: 474</li>
</ul>
</section>
</section>
<section id="cross-species-conservation" class="level2">
<h2 class="anchored" data-anchor-id="cross-species-conservation">Cross-Species Conservation</h2>
<ul>
<li><strong>Total unique OGs:</strong> 611</li>
<li><strong>OGs in 2+ species:</strong> 358 (58.6%)</li>
<li><strong>OGs in all 3 species:</strong> 100 (16.4%)</li>
</ul>
<section id="top-conserved-ogs-context-dependent-in-multiple-species" class="level3">
<h3 class="anchored" data-anchor-id="top-conserved-ogs-context-dependent-in-multiple-species">Top Conserved OGs (Context-Dependent in Multiple Species)</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>OG ID</th>
<th># Species</th>
<th>Mean Strength</th>
<th>A. pulchra</th>
<th>P. evermanni</th>
<th>P. tuahiniensis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>OG_01155</td>
<td>3</td>
<td>1.311</td>
<td>1.521</td>
<td>0.996</td>
<td>1.415</td>
</tr>
<tr class="even">
<td>OG_02619</td>
<td>3</td>
<td>1.295</td>
<td>1.469</td>
<td>1.024</td>
<td>1.393</td>
</tr>
<tr class="odd">
<td>OG_06119</td>
<td>3</td>
<td>1.237</td>
<td>0.972</td>
<td>1.253</td>
<td>1.486</td>
</tr>
<tr class="even">
<td>OG_08793</td>
<td>3</td>
<td>1.236</td>
<td>0.809</td>
<td>1.451</td>
<td>1.450</td>
</tr>
<tr class="odd">
<td>OG_05366</td>
<td>3</td>
<td>1.200</td>
<td>0.939</td>
<td>1.174</td>
<td>1.485</td>
</tr>
<tr class="even">
<td>OG_03291</td>
<td>3</td>
<td>1.199</td>
<td>1.187</td>
<td>0.800</td>
<td>1.611</td>
</tr>
<tr class="odd">
<td>OG_05637</td>
<td>3</td>
<td>1.192</td>
<td>1.166</td>
<td>1.165</td>
<td>1.246</td>
</tr>
<tr class="even">
<td>OG_01452</td>
<td>3</td>
<td>1.191</td>
<td>1.527</td>
<td>0.923</td>
<td>1.124</td>
</tr>
<tr class="odd">
<td>OG_07153</td>
<td>3</td>
<td>1.175</td>
<td>0.979</td>
<td>1.358</td>
<td>1.187</td>
</tr>
<tr class="even">
<td>OG_01414</td>
<td>3</td>
<td>1.162</td>
<td>1.681</td>
<td>0.776</td>
<td>1.029</td>
</tr>
<tr class="odd">
<td>OG_01753</td>
<td>3</td>
<td>1.161</td>
<td>1.141</td>
<td>1.097</td>
<td>1.244</td>
</tr>
<tr class="even">
<td>OG_08663</td>
<td>3</td>
<td>1.138</td>
<td>0.935</td>
<td>1.247</td>
<td>1.233</td>
</tr>
<tr class="odd">
<td>OG_09796</td>
<td>3</td>
<td>1.133</td>
<td>1.016</td>
<td>1.075</td>
<td>1.308</td>
</tr>
<tr class="even">
<td>OG_04467</td>
<td>3</td>
<td>1.121</td>
<td>1.076</td>
<td>1.255</td>
<td>1.034</td>
</tr>
<tr class="odd">
<td>OG_07892</td>
<td>3</td>
<td>1.114</td>
<td>1.091</td>
<td>0.878</td>
<td>1.373</td>
</tr>
<tr class="even">
<td>OG_07150</td>
<td>3</td>
<td>1.111</td>
<td>0.796</td>
<td>1.339</td>
<td>1.197</td>
</tr>
<tr class="odd">
<td>OG_02190</td>
<td>3</td>
<td>1.110</td>
<td>1.233</td>
<td>1.204</td>
<td>0.894</td>
</tr>
<tr class="even">
<td>OG_00355</td>
<td>3</td>
<td>1.100</td>
<td>1.065</td>
<td>1.244</td>
<td>0.992</td>
</tr>
<tr class="odd">
<td>OG_06712</td>
<td>3</td>
<td>1.076</td>
<td>1.348</td>
<td>0.619</td>
<td>1.262</td>
</tr>
<tr class="even">
<td>OG_08849</td>
<td>3</td>
<td>1.073</td>
<td>1.007</td>
<td>1.049</td>
<td>1.163</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>OGs (orthologous groups) that show context-dependent regulation in multiple species suggest:</p>
<ol type="1">
<li><strong>Conserved regulatory mechanisms</strong> - These genes may have fundamental roles where regulation is evolutionarily maintained</li>
<li><strong>Robust biological signals</strong> - Conservation across species reduces the likelihood of false positives</li>
<li><strong>Candidates for functional validation</strong> - These genes are high-priority targets for experimental follow-up</li>
</ol>
</section>
<section id="files-generated" class="level2">
<h2 class="anchored" data-anchor-id="files-generated">Files Generated</h2>
<ul>
<li><code>cross_species_methylation_mirna_comparison.csv</code> - Full comparison table</li>
<li><code>plots/species_comparison_overview.png</code> - Visualization of cross-species patterns</li>
<li><code>cross_species_comparison_report.md</code> - This report</li>
</ul>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.4     ‚úî readr     2.1.5
‚úî forcats   1.0.1     ‚úî stringr   1.5.2
‚úî ggplot2   4.0.0     ‚úî tibble    3.3.0
‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1
‚úî purrr     1.1.0     
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(reactable)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(htmltools)</span>
<span id="cb5-3"></span>
<span id="cb5-4">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/biomin_comparison_20251130_052506/cross_species_methylation_mirna_comparison.csv"</span></span>
<span id="cb5-5">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Format all numeric columns to 2 digits after decimal</span></span>
<span id="cb5-8">df_fmt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">where</span>(is.numeric), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%.2f"</span>, .x)))</span>
<span id="cb5-10"></span>
<span id="cb5-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactable</span>(</span>
<span id="cb5-12">  df_fmt,</span>
<span id="cb5-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">searchable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filterable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pagination =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlight =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">striped =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">defaultPageSize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb5-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sortable =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> reactable<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reactableTheme</span>(</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">highlightColor =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EAF2F8"</span></span>
<span id="cb5-22">  )</span>
<span id="cb5-23">)</span></code></pre></div>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-11ae47822f820c2fff8e" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-11ae47822f820c2fff8e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"og_id":["OG_01155","OG_02619","OG_06119","OG_08793","OG_05366","OG_03291","OG_05637","OG_01452","OG_07153","OG_01414","OG_01753","OG_08663","OG_09796","OG_04467","OG_07892","OG_07150","OG_02190","OG_00355","OG_06712","OG_08849","OG_09106","OG_08920","OG_08192","OG_06616","OG_04799","OG_09596","OG_01177","OG_09310","OG_05718","OG_01630","OG_06592","OG_10121","OG_03673","OG_01611","OG_07252","OG_10205","OG_09174","OG_06955","OG_01384","OG_03484","OG_00752","OG_03330","OG_08259","OG_06999","OG_00297","OG_04165","OG_03857","OG_02666","OG_07958","OG_05666","OG_06908","OG_06430","OG_07389","OG_07404","OG_07821","OG_00171","OG_03628","OG_02090","OG_08545","OG_02124","OG_08842","OG_06247","OG_08874","OG_09511","OG_06599","OG_01023","OG_09455","OG_01317","OG_04789","OG_03429","OG_02088","OG_05819","OG_04694","OG_08144","OG_05514","OG_05304","OG_10004","OG_10039","OG_00176","OG_03451","OG_04243","OG_00460","OG_06004","OG_06655","OG_00378","OG_02176","OG_09024","OG_06775","OG_09003","OG_06198","OG_02317","OG_09423","OG_02148","OG_05952","OG_00466","OG_05856","OG_01748","OG_05713","OG_06875","OG_07042","OG_06610","OG_11813","OG_05250","OG_13910","OG_11360","OG_02000","OG_15303","OG_02408","OG_05303","OG_10758","OG_14180","OG_02537","OG_14711","OG_15374","OG_10515","OG_05010","OG_14803","OG_16627","OG_13792","OG_12611","OG_06152","OG_06998","OG_04756","OG_00643","OG_11957","OG_10472","OG_11234","OG_02163","OG_02220","OG_18223","OG_16000","OG_09598","OG_01121","OG_12050","OG_08331","OG_13882","OG_05749","OG_12722","OG_02186","OG_14612","OG_15877","OG_13886","OG_00842","OG_08528","OG_07508","OG_14257","OG_05717","OG_12990","OG_10936","OG_00807","OG_07620","OG_10522","OG_15086","OG_08622","OG_06279","OG_14674","OG_13201","OG_18057","OG_14804","OG_14279","OG_14623","OG_13877","OG_03288","OG_11381","OG_17186","OG_04698","OG_14915","OG_08083","OG_04651","OG_18058","OG_06373","OG_04515","OG_08856","OG_12320","OG_05950","OG_10814","OG_11907","OG_14262","OG_15009","OG_05498","OG_13451","OG_10251","OG_16489","OG_04327","OG_16307","OG_11964","OG_16092","OG_02012","OG_12880","OG_15020","OG_09897","OG_06719","OG_08145","OG_14322","OG_06158","OG_15375","OG_17157","OG_11984","OG_16573","OG_08768","OG_12878","OG_02184","OG_08878","OG_03856","OG_10811","OG_14140","OG_15087","OG_04723","OG_12805","OG_01117","OG_13197","OG_01147","OG_14037","OG_00514","OG_13016","OG_01353","OG_07641","OG_01608","OG_08497","OG_12646","OG_14189","OG_18262","OG_08432","OG_07531","OG_00246","OG_13026","OG_03269","OG_06717","OG_07183","OG_08096","OG_14382","OG_11852","OG_06754","OG_14540","OG_11839","OG_17479","OG_13154","OG_13050","OG_14563","OG_18258","OG_10109","OG_14793","OG_14500","OG_17098","OG_14615","OG_08639","OG_01579","OG_06234","OG_00510","OG_14206","OG_01724","OG_11359","OG_01475","OG_15334","OG_11833","OG_11642","OG_09986","OG_11019","OG_08717","OG_06711","OG_15550","OG_15459","OG_03289","OG_01781","OG_10988","OG_17286","OG_02102","OG_11870","OG_03671","OG_08658","OG_13066","OG_05087","OG_01758","OG_10055","OG_14038","OG_10759","OG_11084","OG_10675","OG_16539","OG_04209","OG_02924","OG_11307","OG_16856","OG_04115","OG_16980","OG_00572","OG_14627","OG_06101","OG_01354","OG_11423","OG_13916","OG_09657","OG_18229","OG_03267","OG_06181","OG_03850","OG_00030","OG_12318","OG_05121","OG_16011","OG_14276","OG_04443","OG_16192","OG_14710","OG_03626","OG_06931","OG_15383","OG_10938","OG_10367","OG_14505","OG_06954","OG_10579","OG_02690","OG_00632","OG_01999","OG_01223","OG_01312","OG_06922","OG_08077","OG_12248","OG_12286","OG_09487","OG_12683","OG_14094","OG_16585","OG_12888","OG_14380","OG_16862","OG_17751","OG_17245","OG_16158","OG_14626","OG_09424","OG_12162","OG_04537","OG_03298","OG_17389","OG_01489","OG_16209","OG_14100","OG_08271","OG_15312","OG_06670","OG_12166","OG_16592","OG_09806","OG_05568","OG_11983","OG_08143","OG_07772","OG_02358","OG_07000","OG_17015","OG_12165","OG_00298","OG_03780","OG_17012","OG_13428","OG_07265","OG_14547","OG_10509","OG_12496","OG_12612","OG_12102","OG_12406","OG_12447","OG_12616","OG_16747","OG_15816","OG_16145","OG_13032","OG_10818","OG_17106","OG_10355","OG_14588","OG_08347","OG_11365","OG_11379","OG_14381","OG_11429","OG_04247","OG_11038","OG_09969","OG_13481","OG_10838","OG_10516","OG_16122","OG_10008","OG_09896","OG_12125","OG_10480","OG_10183","OG_10937","OG_13239","OG_10520","OG_12785","OG_11156","OG_10267","OG_00843","OG_16469","OG_03268","OG_11653","OG_11292","OG_12007","OG_17347","OG_10475","OG_13033","OG_14685","OG_15544","OG_15070","OG_13684","OG_11794","OG_15594","OG_16944","OG_10007","OG_00314","OG_16389","OG_12331","OG_18159","OG_12475","OG_05210","OG_15754","OG_15604","OG_13091","OG_15021","OG_14455","OG_15551","OG_09597","OG_09942","OG_15648","OG_13215","OG_04331","OG_11380","OG_16359","OG_16883","OG_07394","OG_16383","OG_17150","OG_07331","OG_10002","OG_15121","OG_14681","OG_15644","OG_12476","OG_16485","OG_13465","OG_12107","OG_10523","OG_06236","OG_12371","OG_16279","OG_13466","OG_17806","OG_04514","OG_15815","OG_12032","OG_12046","OG_11420","OG_15089","OG_12647","OG_10681","OG_14790","OG_01568","OG_16544","OG_14407","OG_13013","OG_11899","OG_15906","OG_12242","OG_17596","OG_11017","OG_02070","OG_15796","OG_07807","OG_02146","OG_11541","OG_14066","OG_06384","OG_15137","OG_07330","OG_03270","OG_02439","OG_13149","OG_01486","OG_12844","OG_01747","OG_00305","OG_00430","OG_12160","OG_11171","OG_17591","OG_00302","OG_14514","OG_12108","OG_13484","OG_12889","OG_10907","OG_17285","OG_12019","OG_10815","OG_18263","OG_15682","OG_02316","OG_17600","OG_14012","OG_17045","OG_04538","OG_14792","OG_10584","OG_13190","OG_05875","OG_12952","OG_17058","OG_02967","OG_14994","OG_15060","OG_11215","OG_13059","OG_05874","OG_11296","OG_17533","OG_16586","OG_01981","OG_05308","OG_04238","OG_17027","OG_15617","OG_15140","OG_17497","OG_11831","OG_17666","OG_09638","OG_13153","OG_12163","OG_17646","OG_02260","OG_11245","OG_13191","OG_18275","OG_16159","OG_17124","OG_10274","OG_07822","OG_11291","OG_13685","OG_14408","OG_15831","OG_13594","OG_13211","OG_11419","OG_10450","OG_10265","OG_13031","OG_01277","OG_14889","OG_12109","OG_18078","OG_11644","OG_18224","OG_14156","OG_12424","OG_14158","OG_04560","OG_18118","OG_16654","OG_12568","OG_17739","OG_12518","OG_02935","OG_15759","OG_16380","OG_12837","OG_18325","OG_17961","OG_13334","OG_15462","OG_01727","OG_12927","OG_15208","OG_12972","OG_10812","OG_09486","OG_11762","OG_07836","OG_17800","OG_02149","OG_10525","OG_16879","OG_08914","OG_02219","OG_17222","OG_17483","OG_10350","OG_04547","OG_06607","OG_17176","OG_12560","OG_17014","OG_18285","OG_16707","OG_16139","OG_16270","OG_05228","OG_16789","OG_05367","OG_11812","OG_11074","OG_12645","OG_16665","OG_17453","OG_14295"],"n_species":["3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","3.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","2.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00","1.00"],"apul_context_strength":["1.52","1.47","0.97","0.81","0.94","1.19","1.17","1.53","0.98","1.68","1.14","0.94","1.02","1.08","1.09","0.80","1.23","1.06","1.35","1.01","0.68","1.77","0.98","0.70","0.97","0.98","1.18","0.89","0.84","0.75","0.97","1.30","1.30","1.26","1.21","1.17","0.48","0.91","1.07","1.03","0.70","1.11","0.61","0.98","0.80","0.90","0.95","0.39","0.81","0.70","0.68","1.04","1.02","0.85","0.60","0.77","0.98","1.30","0.72","0.73","0.97","0.57","0.99","0.93","0.67","0.80","1.26","0.98","0.69","0.40","0.89","0.91","1.03","0.94","0.81","1.13","0.87","0.89","0.26","1.05","0.64","0.72","0.90","0.89","0.51","1.06","0.92","0.64","0.95","0.91","0.99","0.62","0.72","0.55","0.33","0.73","0.67","0.42","0.40","0.59","1.27","NA","1.38","1.56","NA","NA","1.58","1.18","0.92","NA","1.45","1.81","1.01","1.14","NA","1.15","1.34","1.29","1.15","NA","1.02","NA","1.31","1.19","NA","NA","NA","0.88","1.01","1.37","1.19","NA","1.51","NA","0.88","1.18","1.13","NA","NA","1.20","1.24","1.05","0.83","1.11","0.85","0.96","NA","NA","NA","NA","NA","NA","1.19","1.49","NA","1.17","NA","1.02","1.56","1.27","1.29","1.02","0.82","NA","1.19","NA","1.21","1.30","0.73","1.05","1.17","1.42","1.19","NA","1.03","NA","NA","1.16","0.97","1.09","NA","0.88","1.13","NA","1.08","NA","0.96","NA","NA","0.87","0.85","NA","1.36","1.13","1.25","0.99","1.05","NA","0.96","1.15","NA","0.94","1.29","0.85","NA","0.86","0.69","1.60","NA","0.53","NA","NA","0.73","1.05","NA","NA","1.15","1.20","0.99","NA","0.91","0.85","NA","0.86","NA","NA","0.66","1.20","NA","0.76","0.66","NA","1.00","0.88","NA","0.85","NA","NA","1.20","1.25","1.11","1.19","1.08","1.25","1.39","0.95","0.92","0.62","0.87","0.79","0.51","NA","0.75","0.75","NA","NA","NA","NA","0.91","0.51","1.05","0.64","NA","NA","NA","0.69","0.74","NA","0.94","NA","NA","0.60","0.82","0.67","0.79","NA","NA","NA","0.57","0.62","1.05","NA","0.85","NA","0.97","0.99","0.84","NA","1.11","NA","0.91","0.93","0.54","NA","1.26","0.57","NA","NA","NA","1.39","0.58","0.61","1.26","0.78","NA","0.93","0.46","NA","NA","0.98","0.92","NA","0.49","0.50","0.89","0.90","0.76","NA","0.75","NA","NA","0.64","NA","0.77","0.90","NA","0.70","0.77","0.92","0.46","0.65","1.03","0.69","NA","0.57","0.42","0.60","0.84","0.73","0.29","NA","0.65","NA","NA","0.77","0.49","0.72","NA","0.55","0.61","0.42","0.40","0.57","NA","0.53","0.10","0.95","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.48","1.47","1.44","NA","NA","1.40","NA","NA","NA","NA","NA","NA","NA","1.37","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.30","NA","NA","NA","NA","1.28","NA","NA","NA","NA","NA","NA","NA","1.24","1.24","NA","NA","1.23","NA","1.23","NA","NA","1.21","1.21","NA","1.21","NA","NA","NA","NA","1.20","NA","NA","NA","NA","1.19","NA","1.19","1.18","NA","NA","NA","NA","1.16","NA","1.16","NA","NA","NA","NA","NA","1.14","NA","NA","1.14","1.13","NA","NA","NA","1.13","NA","NA","NA","NA","1.11","NA","NA","NA","1.10","NA","1.09","NA","NA","1.08","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.02","NA","NA","1.01","1.01","NA","1.01","1.01","1.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.97","0.97","0.96","NA","NA","0.96","0.96","NA","0.96","NA","0.95","NA","NA","NA","0.94","0.94","NA","NA","0.93","NA","NA","NA","0.92","NA","NA","NA","NA","NA","NA","NA","NA","0.88","NA","NA","NA","NA","NA","NA","0.83","NA","NA","NA","NA","0.81","0.81","NA","0.80","NA","NA","NA","NA","NA","NA","0.72","NA","NA","NA","NA","0.70","NA","NA","0.66","NA","NA","0.64","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.51","0.51","NA","0.51","NA","NA","0.48","NA","NA","NA","NA","0.32","0.27","0.14"],"apul_context_dependent":[false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,true,false,false,false,false,false,false,true,true,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,true,null,false,false,null,null,false,false,false,null,true,true,false,false,null,false,true,false,false,null,false,null,false,false,null,null,null,false,false,true,false,null,false,null,true,true,false,null,null,true,false,false,false,false,false,false,null,null,null,null,null,null,true,false,null,false,null,false,false,false,false,false,false,null,false,null,false,false,false,false,false,false,false,null,false,null,null,true,false,false,null,false,false,null,false,null,false,null,null,false,false,null,false,false,false,false,false,null,false,false,null,false,false,false,null,true,false,true,null,false,null,null,false,false,null,null,false,false,false,null,false,true,null,false,null,null,true,false,null,false,false,null,false,false,null,false,null,null,true,false,true,false,false,false,false,false,false,false,false,false,false,null,false,false,null,null,null,null,false,false,false,false,null,null,null,false,false,null,false,null,null,false,false,false,true,null,null,null,false,false,true,null,false,null,true,false,false,null,false,null,false,false,false,null,false,false,null,null,null,true,false,false,false,false,null,false,false,null,null,false,false,null,false,false,false,false,false,null,false,null,null,false,null,false,false,null,false,false,false,true,false,false,false,null,false,false,false,false,false,false,null,false,null,null,false,false,false,null,false,false,false,false,false,null,false,false,false,null,null,null,null,null,null,null,null,null,null,false,false,true,null,null,true,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,false,null,null,null,null,null,null,null,false,false,null,null,false,null,false,null,null,true,false,null,false,null,null,null,null,false,null,null,null,null,false,null,false,false,null,null,null,null,true,null,false,null,null,null,null,null,true,null,null,false,false,null,null,null,false,null,null,null,null,false,null,null,null,false,null,true,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,null,null,true,true,null,false,false,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,false,false,null,null,false,false,null,false,null,false,null,null,null,false,false,null,null,false,null,null,null,false,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,false,null,null,null,null,true,false,null,true,null,null,null,null,null,null,false,null,null,null,null,false,null,null,false,null,null,false,null,null,false,null,null,null,null,null,null,null,null,null,false,false,null,false,null,null,false,null,null,null,null,false,true,true],"apul_improvement":["0.05","0.00","0.01","0.01","0.02","0.01","0.00","0.26","0.00","0.02","0.03","0.01","0.01","0.00","0.01","0.00","0.06","0.00","0.03","0.00","0.01","0.02","0.01","0.17","0.00","0.01","0.00","0.00","0.00","0.01","0.04","0.08","0.00","0.05","0.00","0.06","0.00","0.04","0.01","0.04","0.04","0.01","0.00","0.00","0.03","0.00","0.00","0.07","0.02","0.01","0.03","0.11","0.00","0.04","0.00","0.02","0.00","0.00","0.00","0.05","0.01","0.01","0.04","0.00","0.03","0.00","0.01","0.06","0.00","0.01","0.08","0.02","0.01","0.04","0.01","0.00","0.02","0.00","0.00","0.00","0.13","0.08","0.01","0.00","0.00","0.01","0.05","0.01","0.00","0.00","0.03","0.00","0.08","0.00","0.00","0.01","0.00","0.00","0.01","0.00","0.09","NA","0.01","0.00","NA","NA","0.00","0.00","0.04","NA","0.10","0.04","0.00","0.01","NA","0.00","0.05","0.00","0.01","NA","0.00","NA","0.01","0.00","NA","NA","NA","0.00","0.02","0.07","0.01","NA","0.02","NA","0.08","0.15","0.00","NA","NA","0.15","0.04","0.03","0.05","0.02","0.01","0.03","NA","NA","NA","NA","NA","NA","0.09","0.03","NA","0.00","NA","0.01","0.00","0.01","0.01","0.00","0.01","NA","0.02","NA","0.00","0.00","0.03","0.01","0.00","0.04","0.01","NA","0.00","NA","NA","0.07","0.02","0.02","NA","0.00","0.00","NA","0.00","NA","0.01","NA","NA","0.00","0.00","NA","0.05","0.00","0.01","0.01","0.01","NA","0.00","0.00","NA","0.00","0.01","0.05","NA","0.06","0.00","0.13","NA","0.03","NA","NA","0.03","0.00","NA","NA","0.00","0.01","0.00","NA","0.05","0.09","NA","0.01","NA","NA","0.09","0.00","NA","0.01","0.06","NA","0.02","0.00","NA","0.03","NA","NA","0.05","0.02","0.03","0.03","0.01","0.00","0.01","0.04","0.02","0.02","0.00","0.04","0.01","NA","0.01","0.02","NA","NA","NA","NA","0.00","0.00","0.01","0.00","NA","NA","NA","0.00","0.01","NA","0.00","NA","NA","0.00","0.01","0.01","0.08","NA","NA","NA","0.00","0.00","0.04","NA","0.00","NA","0.02","0.00","0.01","NA","0.01","NA","0.01","0.00","0.06","NA","0.01","0.01","NA","NA","NA","0.04","0.00","0.01","0.00","0.00","NA","0.03","0.00","NA","NA","0.01","0.03","NA","0.01","0.01","0.01","0.04","0.00","NA","0.03","NA","NA","0.02","NA","0.01","0.00","NA","0.01","0.02","0.00","0.06","0.00","0.01","0.02","NA","0.01","0.05","0.04","0.02","0.02","0.00","NA","0.00","NA","NA","0.00","0.00","0.00","NA","0.00","0.00","0.00","0.02","0.00","NA","0.01","0.02","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.02","0.01","0.10","NA","NA","0.06","NA","NA","NA","NA","NA","NA","NA","0.03","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.00","0.02","NA","NA","0.00","NA","0.00","NA","NA","0.10","0.01","NA","0.02","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.00","NA","0.02","0.04","NA","NA","NA","NA","0.05","NA","0.00","NA","NA","NA","NA","NA","0.05","NA","NA","0.00","0.00","NA","NA","NA","0.00","NA","NA","NA","NA","0.01","NA","NA","NA","0.00","NA","0.09","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.03","NA","NA","0.13","0.10","NA","0.00","0.00","0.07","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","0.00","0.00","NA","NA","0.00","0.01","NA","0.01","NA","0.01","NA","NA","NA","0.02","0.00","NA","NA","0.00","NA","NA","NA","0.02","NA","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","0.02","NA","NA","NA","NA","0.09","0.00","NA","0.10","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","0.00","NA","NA","0.00","NA","NA","0.00","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","0.06","NA","0.00","NA","NA","0.01","NA","NA","NA","NA","0.01","0.02","0.03"],"apul_r2":["0.55","0.60","0.56","0.62","0.50","0.71","0.56","0.66","0.58","0.52","0.69","0.75","0.59","0.52","0.48","0.69","0.70","0.52","0.68","0.68","0.42","0.57","0.48","0.70","0.62","0.48","0.81","0.73","0.58","0.65","0.73","0.80","0.70","0.64","0.63","0.76","0.63","0.54","0.48","0.65","0.51","0.72","0.55","0.59","0.47","0.69","0.54","0.62","0.56","0.47","0.55","0.52","0.50","0.64","0.54","0.46","0.53","0.61","0.41","0.50","0.68","0.56","0.58","0.49","0.53","0.56","0.56","0.66","0.46","0.49","0.68","0.51","0.56","0.53","0.45","0.61","0.58","0.45","0.60","0.53","0.68","0.53","0.61","0.66","0.60","0.66","0.46","0.43","0.43","0.51","0.50","0.48","0.55","0.88","0.51","0.49","0.50","0.47","0.46","0.44","0.47","NA","0.72","0.50","NA","NA","0.54","0.72","0.59","NA","0.79","0.77","0.68","0.64","NA","0.62","0.70","0.71","0.63","NA","0.59","NA","0.61","0.97","NA","NA","NA","0.46","0.55","0.58","0.58","NA","0.53","NA","0.56","0.60","0.67","NA","NA","0.60","0.62","0.52","0.56","0.55","0.48","0.70","NA","NA","NA","NA","NA","NA","0.59","0.58","NA","0.58","NA","0.78","0.72","0.52","0.53","0.69","0.57","NA","0.87","NA","0.88","0.44","0.48","0.66","0.50","0.52","0.67","NA","0.60","NA","NA","0.74","0.58","0.53","NA","0.78","0.63","NA","0.54","NA","0.51","NA","NA","0.51","0.63","NA","0.57","0.62","0.77","0.64","0.65","NA","0.55","0.71","NA","0.42","0.80","0.51","NA","0.83","0.60","0.55","NA","0.64","NA","NA","0.48","0.48","NA","NA","0.73","0.64","0.55","NA","0.63","0.54","NA","0.62","NA","NA","0.69","0.58","NA","0.69","0.54","NA","0.65","0.51","NA","0.52","NA","NA","0.68","0.62","0.83","0.68","0.57","0.62","0.59","0.49","0.50","0.76","0.56","0.65","0.90","NA","0.82","0.57","NA","NA","NA","NA","0.47","0.43","0.42","0.75","NA","NA","NA","0.58","0.49","NA","0.87","NA","NA","0.47","0.59","0.60","0.62","NA","NA","NA","0.51","0.48","0.72","NA","0.79","NA","0.93","0.55","0.67","NA","0.81","NA","0.52","0.54","0.52","NA","0.45","0.49","NA","NA","NA","0.80","0.42","0.55","0.64","0.47","NA","0.61","0.59","NA","NA","0.58","0.69","NA","0.69","0.48","0.45","0.63","0.49","NA","0.49","NA","NA","0.57","NA","0.69","0.68","NA","0.56","0.62","0.46","0.69","0.58","0.67","0.49","NA","0.74","0.60","0.67","0.47","0.54","0.69","NA","0.60","NA","NA","0.48","0.69","0.50","NA","0.49","0.53","0.41","0.72","0.49","NA","0.55","0.84","0.78","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.54","0.56","0.50","NA","NA","0.81","NA","NA","NA","NA","NA","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.70","NA","NA","NA","NA","0.54","NA","NA","NA","NA","NA","NA","NA","0.66","0.73","NA","NA","0.52","NA","0.91","NA","NA","0.86","0.74","NA","0.49","NA","NA","NA","NA","0.77","NA","NA","NA","NA","0.57","NA","0.57","0.64","NA","NA","NA","NA","0.76","NA","0.61","NA","NA","NA","NA","NA","0.84","NA","NA","0.47","0.75","NA","NA","NA","0.52","NA","NA","NA","NA","0.56","NA","NA","NA","0.75","NA","0.65","NA","NA","0.89","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","0.71","0.66","NA","0.47","0.69","0.63","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.56","0.62","0.68","NA","NA","0.58","0.72","NA","0.45","NA","0.63","NA","NA","NA","0.64","0.43","NA","NA","0.51","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","0.55","NA","NA","NA","NA","NA","NA","0.55","NA","NA","NA","NA","0.57","0.50","NA","0.75","NA","NA","NA","NA","NA","NA","0.53","NA","NA","NA","NA","0.49","NA","NA","0.56","NA","NA","0.67","NA","NA","0.51","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.40","0.56","NA","0.72","NA","NA","0.47","NA","NA","NA","NA","0.50","0.88","0.88"],"peve_context_strength":["1.00","1.02","1.25","1.45","1.17","0.80","1.17","0.92","1.36","0.78","1.10","1.25","1.07","1.25","0.88","1.34","1.20","1.24","0.62","1.05","0.93","0.93","1.08","1.00","1.29","0.93","0.78","1.34","1.26","1.20","0.70","1.02","1.01","1.13","0.65","0.95","1.34","0.90","1.01","0.75","0.88","1.11","0.94","1.30","0.73","0.98","0.84","1.33","0.82","1.00","1.12","1.11","0.93","0.79","1.18","0.86","0.85","0.39","0.93","0.62","0.52","0.64","0.91","0.72","1.37","0.79","0.48","0.73","0.77","1.14","0.44","0.45","0.73","0.82","1.23","0.59","0.63","0.77","1.09","0.46","1.17","0.65","0.85","0.27","0.90","1.03","0.95","1.02","0.39","0.50","0.68","1.09","1.08","0.75","0.75","0.30","0.59","0.47","0.37","0.73","NA","1.52","NA","NA","1.39","1.34","NA","NA","NA","1.32","NA","NA","NA","NA","1.16","NA","NA","1.28","NA","1.22","NA","1.22","NA","NA","1.20","1.11","1.24","NA","NA","1.06","1.22","1.19","NA","1.25","NA","NA","NA","1.19","1.20","NA","1.11","NA","NA","NA","NA","NA","1.07","0.91","0.91","1.18","1.20","1.30","NA","NA","1.13","NA","0.85","1.24","NA","NA","NA","NA","NA","0.97","1.05","1.19","NA","NA","NA","1.18","NA","NA","NA","1.21","NA","1.14","1.03","NA","NA","NA","1.15","1.29","1.04","0.84","1.07","1.08","1.17","0.90","1.04","NA","NA","1.32","NA","NA","NA","NA","1.04","1.20","1.12","NA","0.89","1.13","NA","NA","0.31","NA","NA","NA","0.77","NA","0.92","1.21","NA","NA","0.87","1.15","NA","NA","NA","1.13","NA","1.12","0.45","NA","0.89","0.97","NA","NA","1.20","1.17","NA","0.65","NA","NA","0.92","1.06","0.92","0.79","NA","0.64","NA","NA","NA","0.61","NA","NA","NA","NA","NA","NA","NA","0.67","NA","NA","0.42","0.77","0.80","0.80","NA","NA","NA","NA","0.54","1.03","1.12","1.08","NA","0.55","NA","0.83","0.69","1.15","NA","NA","NA","1.23","0.33","0.66","1.15","NA","NA","0.58","0.86","0.92","0.73","NA","NA","1.01","NA","0.78","NA","NA","1.13","0.68","NA","NA","0.61","0.50","0.78","0.25","NA","NA","0.37","NA","0.89","NA","NA","0.65","0.54","NA","NA","0.29","NA","NA","NA","NA","NA","0.38","NA","0.44","0.53","NA","0.49","NA","0.61","0.85","NA","0.71","0.56","0.99","0.79","NA","NA","0.49","NA","NA","0.79","NA","0.62","NA","0.68","NA","0.53","0.16","0.51","NA","0.48","0.40","0.64","NA","NA","NA","0.53","0.43","0.51","NA","0.07","0.58","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.34","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.31","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.24","1.24","NA","NA","NA","NA","NA","1.23","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.19","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.15","NA","1.15","NA","NA","NA","1.14","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.11","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.06","NA","NA","NA","1.05","NA","NA","1.04","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","1.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.92","0.92","0.92","NA","NA","0.91","NA","0.90","0.90","0.90","NA","NA","NA","NA","NA","NA","NA","0.85","0.84","NA","NA","NA","NA","NA","NA","NA","0.81","NA","NA","NA","0.75","0.75","NA","0.73","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","NA","NA","NA","NA","0.60","0.59","NA","NA","NA","0.54","NA","NA","NA","0.51","NA","0.49","0.48","NA","NA","NA","NA","0.32","NA","NA","NA"],"peve_context_dependent":[false,false,true,false,false,false,false,false,true,false,true,false,false,true,false,true,false,false,true,true,false,false,false,false,true,false,false,true,true,true,true,false,false,true,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,true,false,true,true,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,true,false,false,false,true,true,false,false,true,false,false,true,false,true,false,false,true,false,false,false,false,false,true,false,false,false,false,false,false,false,false,null,false,null,null,true,false,null,null,null,true,null,null,null,null,false,null,null,true,null,true,null,false,null,null,true,true,true,null,null,true,false,true,null,false,null,null,null,true,true,null,false,null,null,null,null,null,false,false,false,false,false,false,null,null,true,null,false,false,null,null,null,null,null,false,false,true,null,null,null,false,null,null,null,true,null,false,false,null,null,null,false,false,false,true,false,false,true,false,false,null,null,false,null,null,null,null,true,false,false,null,false,false,null,null,false,null,null,null,false,null,false,false,null,null,false,false,null,null,null,true,null,true,false,null,false,false,null,null,false,false,null,false,null,null,false,false,false,false,null,false,null,null,null,false,null,null,null,null,null,null,null,false,null,null,false,true,false,true,null,null,null,null,false,false,false,true,null,false,null,false,false,true,null,null,null,false,false,false,false,null,null,false,true,true,true,null,null,false,null,false,null,null,true,false,null,null,false,false,false,false,null,null,true,null,false,null,null,false,false,null,null,false,null,null,null,null,null,false,null,false,true,null,false,null,false,true,null,true,false,false,false,null,null,false,null,null,true,null,false,null,false,null,false,false,false,null,false,true,false,null,null,null,false,false,false,null,true,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,true,false,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,true,null,false,null,null,null,false,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,true,null,null,null,false,null,null,false,null,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,null,null,null,true,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,false,false,false,null,null,false,null,false,false,false,null,null,null,null,null,null,null,false,true,null,null,null,null,null,null,null,false,null,null,null,false,false,null,false,null,null,null,null,null,null,null,null,null,null,false,null,null,null,null,null,null,false,false,null,null,null,false,null,null,null,false,null,false,false,null,null,null,null,false,null,null,null],"peve_improvement":["0.03","0.04","0.06","0.03","0.00","0.00","0.02","0.02","0.08","0.02","0.03","0.04","0.01","0.17","0.03","0.06","0.00","0.03","0.08","0.14","0.03","0.00","0.02","0.02","0.08","0.02","0.05","0.13","0.05","0.14","0.06","0.00","0.02","0.12","0.05","0.00","0.13","0.00","0.05","0.02","0.01","0.01","0.01","0.00","0.03","0.01","0.00","0.01","0.01","0.06","0.05","0.02","0.08","0.10","0.02","0.05","0.06","0.00","0.00","0.04","0.00","0.01","0.00","0.08","0.00","0.00","0.00","0.05","0.00","0.08","0.00","0.01","0.02","0.13","0.08","0.01","0.06","0.08","0.00","0.02","0.09","0.00","0.07","0.00","0.01","0.07","0.04","0.00","0.01","0.03","0.00","0.08","0.03","0.00","0.04","0.00","0.01","0.01","0.01","0.04","NA","0.03","NA","NA","0.13","0.05","NA","NA","NA","0.09","NA","NA","NA","NA","0.02","NA","NA","0.07","NA","0.12","NA","0.00","NA","NA","0.09","0.07","0.07","NA","NA","0.15","0.00","0.09","NA","0.03","NA","NA","NA","0.10","0.05","NA","0.01","NA","NA","NA","NA","NA","0.03","0.00","0.04","0.03","0.04","0.00","NA","NA","0.07","NA","0.01","0.01","NA","NA","NA","NA","NA","0.00","0.01","0.07","NA","NA","NA","0.03","NA","NA","NA","0.09","NA","0.03","0.02","NA","NA","NA","0.01","0.01","0.02","0.12","0.00","0.01","0.12","0.06","0.06","NA","NA","0.00","NA","NA","NA","NA","0.04","0.00","0.00","NA","0.00","0.01","NA","NA","0.00","NA","NA","NA","0.00","NA","0.02","0.02","NA","NA","0.01","0.00","NA","NA","NA","0.09","NA","0.07","0.03","NA","0.05","0.00","NA","NA","0.04","0.00","NA","0.04","NA","NA","0.00","0.03","0.02","0.03","NA","0.04","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","0.00","0.12","0.04","0.10","NA","NA","NA","NA","0.02","0.04","0.00","0.08","NA","0.00","NA","0.01","0.01","0.04","NA","NA","NA","0.00","0.01","0.01","0.00","NA","NA","0.06","0.05","0.09","0.06","NA","NA","0.02","NA","0.00","NA","NA","0.04","0.05","NA","NA","0.02","0.01","0.00","0.01","NA","NA","0.05","NA","0.04","NA","NA","0.01","0.02","NA","NA","0.06","NA","NA","NA","NA","NA","0.00","NA","0.01","0.05","NA","0.03","NA","0.07","0.09","NA","0.10","0.01","0.01","0.00","NA","NA","0.00","NA","NA","0.10","NA","0.04","NA","0.02","NA","0.02","0.00","0.01","NA","0.02","0.09","0.00","NA","NA","NA","0.00","0.01","0.01","NA","0.01","0.02","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.05","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.03","0.02","NA","NA","NA","NA","NA","0.16","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.08","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.09","NA","0.02","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.08","NA","NA","NA","0.05","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.09","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","0.03","0.03","NA","NA","0.04","NA","0.01","0.04","0.03","NA","NA","NA","NA","NA","NA","NA","0.02","0.07","NA","NA","NA","NA","NA","NA","NA","0.00","NA","NA","NA","0.03","0.01","NA","0.01","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.01","NA","NA","NA","NA","NA","NA","0.00","0.01","NA","NA","NA","0.03","NA","NA","NA","0.00","NA","0.04","0.00","NA","NA","NA","NA","0.01","NA","NA","NA"],"peve_r2":["0.52","0.49","0.75","0.59","0.68","0.68","0.68","0.59","0.67","0.52","0.80","0.50","0.45","0.84","0.51","0.74","0.65","0.74","0.55","0.67","0.39","0.36","0.72","0.59","0.65","0.76","0.53","0.69","0.73","0.77","0.54","0.55","0.56","0.56","0.49","0.46","0.54","0.32","0.52","0.47","0.43","0.53","0.43","0.64","0.49","0.58","0.37","0.51","0.82","0.55","0.93","0.46","0.44","0.51","0.50","0.42","0.51","0.61","0.39","0.45","0.48","0.45","0.47","0.49","0.55","0.45","0.43","0.45","0.46","0.68","0.48","0.48","0.39","0.55","0.63","0.45","0.48","0.47","0.44","0.43","0.70","0.43","0.55","0.75","0.42","0.69","0.57","0.46","0.44","0.57","0.50","0.68","0.48","0.48","0.43","0.57","0.59","0.39","0.50","0.47","NA","0.45","NA","NA","0.52","0.57","NA","NA","NA","0.70","NA","NA","NA","NA","0.45","NA","NA","0.62","NA","0.60","NA","0.52","NA","NA","0.59","0.99","0.75","NA","NA","0.65","0.57","0.73","NA","0.41","NA","NA","NA","0.59","0.63","NA","0.49","NA","NA","NA","NA","NA","0.61","0.60","0.65","0.61","0.67","0.72","NA","NA","0.51","NA","0.44","0.60","NA","NA","NA","NA","NA","0.72","0.62","0.46","NA","NA","NA","0.55","NA","NA","NA","0.99","NA","0.63","0.48","NA","NA","NA","0.53","0.46","0.74","0.46","0.44","0.61","0.77","0.49","0.54","NA","NA","0.54","NA","NA","NA","NA","0.82","0.59","0.75","NA","0.42","0.73","NA","NA","0.62","NA","NA","NA","0.44","NA","0.52","0.53","NA","NA","0.41","0.47","NA","NA","NA","0.63","NA","0.85","0.45","NA","0.42","0.53","NA","NA","0.68","0.46","NA","0.44","NA","NA","0.41","0.50","0.53","0.45","NA","0.51","NA","NA","NA","0.45","NA","NA","NA","NA","NA","NA","NA","0.38","NA","NA","0.78","0.62","0.44","0.57","NA","NA","NA","NA","0.39","0.47","0.73","0.96","NA","0.46","NA","0.40","0.42","0.73","NA","NA","NA","0.66","0.42","0.53","0.82","NA","NA","0.46","0.75","0.51","0.69","NA","NA","0.47","NA","0.35","NA","NA","0.78","0.50","NA","NA","0.47","0.66","0.47","0.51","NA","NA","0.74","NA","0.51","NA","NA","0.59","0.43","NA","NA","0.45","NA","NA","NA","NA","NA","0.42","NA","0.55","0.71","NA","0.42","NA","0.45","0.51","NA","0.59","0.48","0.58","0.42","NA","NA","0.67","NA","NA","0.53","NA","0.50","NA","0.39","NA","0.43","0.78","0.57","NA","0.39","0.68","0.45","NA","NA","NA","0.53","0.63","0.49","NA","0.93","0.37","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.79","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.39","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.91","0.68","NA","NA","NA","NA","NA","0.79","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.92","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.73","NA","0.46","NA","NA","NA","0.65","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.65","NA","NA","NA","0.47","NA","NA","0.66","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.69","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.57","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.51","0.41","0.55","NA","NA","0.53","NA","0.44","0.51","0.51","NA","NA","NA","NA","NA","NA","NA","0.39","0.54","NA","NA","NA","NA","NA","NA","NA","0.41","NA","NA","NA","0.42","0.52","NA","0.63","NA","NA","NA","NA","NA","NA","NA","NA","NA","NA","0.59","NA","NA","NA","NA","NA","NA","0.43","0.44","NA","NA","NA","0.46","NA","NA","NA","0.39","NA","0.48","0.57","NA","NA","NA","NA","0.73","NA","NA","NA"],"ptua_context_strength":["1.41","1.39","1.49","1.45","1.48","1.61","1.25","1.12","1.19","1.03","1.24","1.23","1.31","1.03","1.37","1.20","0.89","0.99","1.26","1.16","1.61","0.50","1.14","1.50","0.93","1.27","1.21","0.93","1.07","1.20","1.44","0.80","0.79","0.69","1.18","0.90","1.19","1.18","0.88","1.18","1.37","0.73","1.35","0.62","1.35","1.01","1.10","1.15","1.24","1.15","1.03","0.68","0.87","1.16","1.02","1.16","0.95","1.09","1.11","1.42","1.27","1.54","0.85","1.07","0.67","1.10","0.94","0.96","1.18","1.06","1.27","1.22","0.82","0.82","0.53","0.81","1.02","0.87","1.18","1.01","0.71","1.07","0.69","1.24","0.98","0.27","0.46","0.64","0.95","0.85","0.57","0.51","0.36","0.82","1.00","1.04","0.80","0.98","1.08","0.43","1.83","1.50","1.60","1.40","1.51","1.55","1.26","1.63","1.88","1.47","1.32","0.89","1.67","1.49","1.43","1.44","1.24","NA","1.39","1.31","1.50","1.28","1.19","1.31","1.28","1.37","1.21","1.57","1.43","NA","NA","1.21","0.88","1.14","1.51","1.19","1.24","1.17","1.16","1.16","NA","1.29","1.51","1.22","1.47","1.36","1.25","1.40","1.40","1.13","1.10","1.00","1.11","0.78","1.14","1.10","1.41","NA","0.69","0.99","0.96","1.23","1.43","1.27","NA","1.05","1.03","0.93","1.50","NA","1.06","0.81","1.03","1.00","1.19","1.08","1.17","1.04","1.23","1.09","1.03","NA","NA","1.32","NA","1.06","NA","1.24","1.08","1.25","1.26","0.79","0.75","0.97","0.85","1.10","NA","0.88","NA","0.93","1.19","NA","0.78","1.23","1.76","1.20","1.37","0.45","1.26","1.50","1.09","0.81","1.28","0.96","1.14","0.86","0.85","0.80","1.00","0.86","1.08","NA","1.53","1.11","1.08","1.00","1.29","0.75","0.74","NA","1.26","1.27","0.91","1.04","0.99","NA","0.98","1.11","0.70","NA","0.77","0.68","0.78","NA","0.46","0.90","0.91","1.21","0.96","1.05","1.32","1.15","1.08","1.07","1.40","1.04","0.99","0.99","0.88","1.29","0.74","1.14","1.25","0.75","0.66","NA","1.04","1.22","0.82","0.93","1.06","NA","0.93","1.08","0.95","0.51","1.41","1.08","NA","1.10","0.67","1.14","NA","0.79","NA","0.71","0.85","0.69","0.58","0.91","0.77","0.74","NA","0.99","0.41","1.09","1.05","1.15","0.88","NA","1.07","1.04","NA","0.85","0.73","0.69","1.17","0.97","1.08","0.62","0.68","1.31","1.10","1.10","0.69","0.67","0.81","1.19","0.81","1.10","1.00","0.89","1.03","0.74","NA","0.65","0.80","NA","NA","NA","NA","0.41","0.75","0.94","0.85","1.00","NA","0.54","NA","1.06","0.64","0.67","0.79","1.15","NA","0.78","NA","0.80","NA","0.57","0.75","0.73","NA","0.65","NA","0.94","NA","0.39","1.88","1.87","1.84","1.63","1.59","1.53","1.53","1.51","1.48","NA","NA","NA","1.44","1.43","NA","1.39","1.38","1.38","1.38","1.37","1.37","1.37","NA","1.36","1.36","1.36","1.35","1.35","NA","1.34","1.34","1.33","1.33","1.33","1.32","1.32","1.32","1.31","1.31","NA","1.31","NA","1.30","1.30","1.29","1.28","NA","1.28","1.27","1.27","1.26","1.25","NA","NA","NA","NA","1.24","1.24","NA","NA","NA","1.21","1.21","NA","NA","1.21","NA","1.21","1.20","1.20","1.20","NA","1.20","1.20","1.20","NA","NA","1.19","NA","NA","1.18","1.17","1.17","1.17","NA","1.16","NA","1.16","NA","1.15","NA","1.15","NA","1.14","NA","NA","NA","1.13","1.13","1.13","NA","1.12","1.12","1.11","NA","NA","1.11","1.11","1.10","NA","1.09","NA","1.09","1.08","NA","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","NA","1.06","1.05","1.05","NA","1.05","1.04","NA","1.03","1.03","1.03","1.03","1.03","1.02","NA","1.02","1.02","NA","NA","NA","NA","NA","NA","1.01","1.00","1.00","1.00","1.00","1.00","NA","0.99","0.99","0.99","0.99","0.98","0.98","0.97","NA","NA","NA","0.96","0.96","NA","NA","0.96","NA","0.96","NA","0.95","0.95","0.94","NA","NA","0.93","0.93","NA","NA","NA","NA","NA","0.92","NA","0.91","NA","NA","NA","0.89","0.88","NA","0.86","0.85","0.85","0.85","NA","NA","NA","0.82","0.82","0.82","0.82","NA","NA","NA","NA","0.76","0.76","NA","NA","0.74","NA","NA","0.72","0.72","0.71","0.70","NA","0.68","0.67","NA","0.66","NA","NA","0.63","0.62","NA","0.61","0.61","NA","NA","0.59","0.58","0.55","NA","0.53","NA","NA","NA","NA","NA","NA","NA","0.47","0.46","0.33","NA","NA","NA","NA"],"ptua_context_dependent":[false,true,true,false,false,false,true,false,true,true,false,true,true,true,false,true,true,false,false,true,false,true,true,true,false,false,true,false,false,false,true,false,false,true,false,false,false,true,false,false,false,false,false,false,false,true,false,true,false,true,true,false,false,false,true,false,false,false,false,false,true,false,false,true,false,false,false,false,false,false,true,true,false,false,false,false,true,false,true,false,true,true,false,true,false,false,false,false,false,false,false,false,false,true,true,false,false,false,false,false,false,true,true,true,false,false,false,false,true,true,true,true,false,false,false,true,false,null,false,false,false,true,true,true,false,true,false,false,false,null,null,false,true,true,false,true,true,false,false,true,null,true,false,true,false,false,true,true,false,true,false,true,true,false,true,false,true,null,false,false,true,true,false,true,null,false,false,false,false,null,false,false,false,false,false,true,false,false,true,false,false,null,null,true,null,false,null,false,true,true,true,true,false,false,false,true,null,false,null,false,false,null,false,false,false,true,true,true,false,false,false,false,false,false,false,true,false,true,true,false,true,null,false,false,false,false,false,false,true,null,true,true,false,false,false,null,false,false,false,null,false,false,true,null,false,false,false,true,false,true,true,true,false,false,false,false,true,true,false,true,false,false,false,false,false,null,false,false,false,false,false,null,true,true,false,true,true,false,null,false,true,false,null,false,null,false,true,false,false,true,false,false,null,true,false,false,true,false,false,null,false,false,null,false,false,false,true,false,false,true,false,true,false,true,false,false,false,false,false,false,false,false,true,false,null,true,false,null,null,null,null,false,false,false,false,false,null,false,null,false,false,false,false,false,null,false,null,true,null,false,false,false,null,false,null,false,null,false,false,false,false,false,false,false,true,true,true,null,null,null,true,true,null,false,true,true,false,true,true,true,null,true,false,false,false,true,null,true,true,true,true,false,true,false,false,false,false,null,true,null,true,false,false,false,null,true,true,true,false,true,null,null,null,null,true,true,null,null,null,false,true,null,null,false,null,true,false,false,true,null,true,false,false,null,null,true,null,null,false,false,false,false,null,true,null,false,null,false,null,false,null,false,null,null,null,true,false,false,null,false,true,false,null,null,true,false,false,null,false,null,true,false,null,true,false,false,false,false,false,true,true,false,true,null,false,true,false,null,false,false,null,false,false,true,true,false,false,null,false,true,null,null,null,null,null,null,true,true,true,true,false,true,null,true,false,false,false,false,false,false,null,null,null,true,false,null,null,false,null,true,null,false,false,false,null,null,false,false,null,null,null,null,null,false,null,true,null,null,null,false,false,null,false,false,false,true,null,null,null,true,false,false,false,null,null,null,null,false,false,null,null,false,null,null,false,false,false,false,null,false,false,null,false,null,null,false,false,null,false,false,null,null,false,false,false,null,false,null,null,null,null,null,null,null,false,false,false,null,null,null,null],"ptua_improvement":["0.03","0.06","0.11","0.00","0.01","0.06","0.11","0.00","0.13","0.10","0.00","0.05","0.14","0.10","0.03","0.04","0.12","0.00","0.00","0.08","0.06","0.08","0.09","0.15","0.03","0.00","0.10","0.02","0.01","0.02","0.14","0.01","0.02","0.08","0.06","0.00","0.01","0.08","0.01","0.02","0.04","0.00","0.03","0.00","0.06","0.20","0.01","0.07","0.00","0.06","0.07","0.03","0.01","0.04","0.06","0.01","0.02","0.00","0.01","0.02","0.05","0.01","0.03","0.07","0.02","0.00","0.02","0.04","0.00","0.04","0.07","0.12","0.01","0.01","0.00","0.00","0.08","0.00","0.15","0.05","0.13","0.08","0.05","0.18","0.01","0.02","0.01","0.02","0.00","0.05","0.04","0.00","0.05","0.13","0.09","0.00","0.00","0.02","0.01","0.01","0.00","0.09","0.34","0.08","0.05","0.01","0.02","0.03","0.06","0.13","0.18","0.06","0.04","0.01","0.02","0.12","0.02","NA","0.04","0.00","0.00","0.06","0.10","0.10","0.00","0.17","0.01","0.00","0.06","NA","NA","0.04","0.09","0.10","0.00","0.18","0.11","0.03","0.02","0.08","NA","0.09","0.03","0.11","0.02","0.02","0.09","0.07","0.02","0.08","0.01","0.09","0.07","0.01","0.15","0.03","0.06","NA","0.02","0.02","0.10","0.21","0.01","0.10","NA","0.04","0.05","0.00","0.04","NA","0.03","0.01","0.01","0.05","0.03","0.05","0.02","0.04","0.20","0.00","0.01","NA","NA","0.14","NA","0.01","NA","0.03","0.07","0.09","0.09","0.08","0.02","0.00","0.02","0.07","NA","0.00","NA","0.03","0.03","NA","0.03","0.00","0.01","0.07","0.24","0.06","0.03","0.02","0.02","0.01","0.01","0.06","0.04","0.12","0.01","0.09","0.18","0.01","0.08","NA","0.01","0.03","0.01","0.01","0.04","0.01","0.08","NA","0.06","0.19","0.04","0.03","0.01","NA","0.01","0.04","0.01","NA","0.04","0.00","0.06","NA","0.01","0.00","0.03","0.05","0.03","0.14","0.08","0.13","0.03","0.05","0.00","0.03","0.12","0.09","0.03","0.05","0.02","0.05","0.00","0.02","0.01","NA","0.04","0.02","0.03","0.01","0.05","NA","0.19","0.13","0.00","0.04","0.12","0.01","NA","0.01","0.08","0.04","NA","0.01","NA","0.02","0.07","0.01","0.00","0.08","0.02","0.03","NA","0.11","0.04","0.02","0.10","0.05","0.05","NA","0.02","0.03","NA","0.02","0.03","0.05","0.21","0.02","0.03","0.06","0.00","0.12","0.00","0.13","0.00","0.00","0.01","0.03","0.00","0.01","0.02","0.01","0.14","0.01","NA","0.11","0.00","NA","NA","NA","NA","0.02","0.00","0.03","0.02","0.03","NA","0.00","NA","0.05","0.01","0.06","0.04","0.00","NA","0.00","NA","0.08","NA","0.01","0.02","0.02","NA","0.05","NA","0.01","NA","0.02","0.02","0.02","0.00","0.02","0.01","0.06","0.18","0.11","0.23","NA","NA","NA","0.07","0.04","NA","0.04","0.16","0.07","0.03","0.21","0.21","0.05","NA","0.14","0.05","0.03","0.00","0.08","NA","0.10","0.11","0.03","0.12","0.00","0.06","0.01","0.00","0.00","0.03","NA","0.15","NA","0.12","0.01","0.05","0.01","NA","0.11","0.15","0.07","0.00","0.06","NA","NA","NA","NA","0.06","0.07","NA","NA","NA","0.05","0.11","NA","NA","0.00","NA","0.08","0.04","0.03","0.07","NA","0.17","0.07","0.00","NA","NA","0.14","NA","NA","0.03","0.02","0.03","0.01","NA","0.10","NA","0.01","NA","0.04","NA","0.00","NA","0.01","NA","NA","NA","0.24","0.00","0.03","NA","0.01","0.09","0.05","NA","NA","0.06","0.00","0.03","NA","0.01","NA","0.08","0.01","NA","0.17","0.02","0.01","0.00","0.00","0.02","0.09","0.09","0.03","0.13","NA","0.06","0.20","0.04","NA","0.00","0.04","NA","0.06","0.00","0.14","0.07","0.00","0.01","NA","0.03","0.11","NA","NA","NA","NA","NA","NA","0.13","0.15","0.15","0.07","0.01","0.09","NA","0.16","0.05","0.03","0.02","0.05","0.03","0.00","NA","NA","NA","0.09","0.05","NA","NA","0.01","NA","0.10","NA","0.02","0.05","0.03","NA","NA","0.02","0.03","NA","NA","NA","NA","NA","0.02","NA","0.08","NA","NA","NA","0.02","0.02","NA","0.02","0.00","0.03","0.16","NA","NA","NA","0.07","0.01","0.00","0.04","NA","NA","NA","NA","0.02","0.00","NA","NA","0.01","NA","NA","0.06","0.06","0.01","0.00","NA","0.03","0.05","NA","0.00","NA","NA","0.00","0.00","NA","0.00","0.02","NA","NA","0.01","0.00","0.00","NA","0.01","NA","NA","NA","NA","NA","NA","NA","0.00","0.01","0.00","NA","NA","NA","NA"],"ptua_r2":["0.56","0.50","0.55","0.61","0.43","0.46","0.82","0.44","0.63","0.64","0.58","0.76","0.56","0.54","0.38","0.70","0.48","0.62","0.47","0.64","0.50","0.51","0.48","0.54","0.46","0.35","0.59","0.40","0.44","0.44","0.66","0.44","0.44","0.44","0.42","0.47","0.48","0.63","0.45","0.65","0.63","0.30","0.56","0.50","0.48","0.58","0.40","0.46","0.57","0.75","0.53","0.46","0.33","0.49","0.53","0.56","0.40","0.53","0.43","0.45","0.66","0.47","0.36","0.45","0.46","0.55","0.52","0.50","0.59","0.54","0.51","0.56","0.54","0.36","0.46","0.65","0.71","0.54","0.47","0.51","0.50","0.54","0.49","0.74","0.49","0.67","0.47","0.48","0.43","0.49","0.41","0.44","0.45","0.49","0.63","0.38","0.52","0.49","0.55","0.43","0.58","0.78","0.79","0.46","0.51","0.50","0.68","0.67","0.58","0.73","0.68","0.53","0.51","0.69","0.43","0.76","0.59","NA","0.68","0.47","0.52","0.72","0.47","0.66","0.47","0.90","0.38","0.78","0.45","NA","NA","0.42","0.60","0.63","0.61","0.59","0.62","0.43","0.60","0.51","NA","0.54","0.59","0.63","0.39","0.54","0.57","0.50","0.56","0.54","0.59","0.69","0.46","0.40","0.64","0.35","0.93","NA","0.84","0.34","0.51","0.97","0.46","0.70","NA","0.45","0.43","0.47","0.56","NA","0.42","0.37","0.47","0.53","0.45","0.62","0.43","0.59","0.62","0.62","0.47","NA","NA","0.48","NA","0.59","NA","0.56","0.47","0.65","0.63","0.65","0.50","0.56","0.40","0.61","NA","0.62","NA","0.40","0.50","NA","0.55","0.43","0.54","0.82","0.73","0.49","0.39","0.39","0.62","0.47","0.53","0.46","0.48","0.50","0.47","0.45","0.56","0.43","0.55","NA","0.65","0.43","0.51","0.39","0.45","0.51","0.54","NA","0.68","0.78","0.61","0.51","0.62","NA","0.58","0.46","0.49","NA","0.54","0.57","0.58","NA","0.51","0.41","0.47","0.89","0.50","0.52","0.43","0.62","0.45","0.47","0.39","0.49","0.45","0.44","0.46","0.66","0.35","0.42","0.60","0.45","0.45","NA","0.50","0.56","0.40","0.42","0.47","NA","0.75","0.63","0.41","0.76","0.60","0.71","NA","0.57","0.51","0.61","NA","0.58","NA","0.38","0.48","0.59","0.39","0.53","0.48","0.45","NA","0.57","0.48","0.48","0.52","0.41","0.51","NA","0.33","0.51","NA","0.49","0.38","0.57","0.59","0.44","0.40","0.56","0.49","0.82","0.50","0.56","0.38","0.37","0.44","0.49","0.43","0.43","0.41","0.32","0.50","0.39","NA","0.58","0.37","NA","NA","NA","NA","0.50","0.56","0.67","0.44","0.47","NA","0.44","NA","0.51","0.50","0.42","0.49","0.52","NA","0.33","NA","0.58","NA","0.54","0.37","0.40","NA","0.48","NA","0.45","NA","0.69","0.47","0.58","0.74","0.82","0.61","0.44","0.79","0.63","0.84","NA","NA","NA","0.63","0.66","NA","0.68","0.72","0.48","0.66","0.74","0.74","0.79","NA","0.73","0.42","0.51","0.38","0.83","NA","0.52","0.58","0.78","0.71","0.46","0.75","0.42","0.74","0.81","0.48","NA","0.76","NA","0.88","0.69","0.61","0.51","NA","0.66","0.96","0.51","0.69","0.79","NA","NA","NA","NA","0.57","0.45","NA","NA","NA","0.56","0.52","NA","NA","0.57","NA","0.44","0.57","0.44","0.50","NA","0.75","0.37","0.40","NA","NA","0.66","NA","NA","0.41","0.40","0.43","0.59","NA","0.69","NA","0.52","NA","0.47","NA","0.60","NA","0.46","NA","NA","NA","0.72","0.71","0.59","NA","0.54","0.50","0.42","NA","NA","0.52","0.37","0.35","NA","0.65","NA","0.51","0.48","NA","0.63","0.40","0.49","0.64","0.40","0.46","0.42","0.59","0.68","0.60","NA","0.46","0.60","0.45","NA","0.39","0.59","NA","0.42","0.39","0.47","0.65","0.47","0.50","NA","0.40","0.63","NA","NA","NA","NA","NA","NA","0.64","0.51","0.59","0.52","0.35","0.38","NA","0.58","0.51","0.36","0.34","0.46","0.42","0.56","NA","NA","NA","0.40","0.46","NA","NA","0.53","NA","0.51","NA","0.41","0.61","0.67","NA","NA","0.50","0.51","NA","NA","NA","NA","NA","0.40","NA","0.53","NA","NA","NA","0.55","0.51","NA","0.48","0.41","0.59","0.50","NA","NA","NA","0.90","0.52","0.60","0.41","NA","NA","NA","NA","0.48","0.35","NA","NA","0.42","NA","NA","0.43","0.43","0.48","0.40","NA","0.55","0.44","NA","0.42","NA","NA","0.40","0.47","NA","0.56","0.41","NA","NA","0.61","0.48","0.36","NA","0.45","NA","NA","NA","NA","NA","NA","NA","0.39","0.51","0.66","NA","NA","NA","NA"],"mean_context_strength":["1.31","1.30","1.24","1.24","1.20","1.20","1.19","1.19","1.17","1.16","1.16","1.14","1.13","1.12","1.11","1.11","1.11","1.10","1.08","1.07","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.05","1.04","1.04","1.03","1.02","1.01","1.01","1.01","1.00","0.99","0.99","0.99","0.98","0.97","0.97","0.96","0.96","0.96","0.96","0.96","0.95","0.94","0.94","0.94","0.94","0.94","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.91","0.91","0.90","0.90","0.90","0.89","0.88","0.87","0.87","0.86","0.86","0.86","0.86","0.84","0.84","0.84","0.84","0.84","0.84","0.81","0.81","0.80","0.80","0.79","0.78","0.77","0.76","0.75","0.75","0.74","0.72","0.71","0.69","0.69","0.69","0.62","0.62","0.58","1.55","1.51","1.49","1.48","1.45","1.44","1.42","1.41","1.40","1.39","1.38","1.35","1.34","1.31","1.30","1.30","1.29","1.28","1.27","1.27","1.26","1.25","1.25","1.25","1.24","1.24","1.22","1.22","1.22","1.21","1.20","1.20","1.20","1.20","1.20","1.19","1.18","1.18","1.18","1.18","1.17","1.17","1.17","1.17","1.16","1.16","1.16","1.16","1.15","1.15","1.15","1.15","1.15","1.14","1.14","1.14","1.13","1.13","1.13","1.13","1.13","1.13","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.12","1.11","1.11","1.11","1.11","1.11","1.10","1.10","1.10","1.09","1.09","1.09","1.08","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.05","1.05","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.04","1.03","1.03","1.02","1.02","1.01","1.01","1.01","1.01","1.00","1.00","1.00","1.00","1.00","1.00","0.99","0.99","0.99","0.99","0.99","0.98","0.98","0.98","0.98","0.97","0.96","0.96","0.96","0.96","0.96","0.96","0.95","0.95","0.95","0.95","0.95","0.94","0.94","0.93","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.91","0.91","0.91","0.91","0.91","0.91","0.90","0.90","0.90","0.90","0.89","0.89","0.89","0.89","0.89","0.89","0.89","0.88","0.88","0.88","0.88","0.88","0.87","0.87","0.87","0.87","0.87","0.87","0.86","0.86","0.86","0.86","0.86","0.85","0.85","0.85","0.85","0.85","0.85","0.85","0.84","0.84","0.84","0.84","0.83","0.83","0.83","0.83","0.83","0.82","0.82","0.82","0.82","0.81","0.81","0.81","0.81","0.81","0.81","0.80","0.80","0.80","0.80","0.80","0.79","0.79","0.79","0.79","0.78","0.77","0.76","0.76","0.76","0.76","0.75","0.75","0.75","0.74","0.74","0.73","0.72","0.72","0.72","0.72","0.71","0.71","0.69","0.69","0.68","0.67","0.66","0.66","0.66","0.65","0.64","0.63","0.60","0.60","0.59","0.59","0.58","0.56","0.55","0.54","0.52","0.52","0.51","0.49","1.88","1.87","1.84","1.63","1.59","1.53","1.53","1.51","1.48","1.48","1.47","1.44","1.44","1.43","1.40","1.39","1.38","1.38","1.38","1.37","1.37","1.37","1.37","1.36","1.36","1.36","1.35","1.35","1.34","1.34","1.34","1.33","1.33","1.33","1.32","1.32","1.32","1.31","1.31","1.31","1.31","1.30","1.30","1.30","1.29","1.28","1.28","1.28","1.27","1.27","1.26","1.25","1.24","1.24","1.24","1.24","1.24","1.24","1.23","1.23","1.23","1.21","1.21","1.21","1.21","1.21","1.21","1.21","1.20","1.20","1.20","1.20","1.20","1.20","1.20","1.19","1.19","1.19","1.19","1.18","1.18","1.17","1.17","1.17","1.16","1.16","1.16","1.16","1.15","1.15","1.15","1.15","1.14","1.14","1.14","1.14","1.13","1.13","1.13","1.13","1.13","1.12","1.12","1.11","1.11","1.11","1.11","1.11","1.10","1.10","1.09","1.09","1.09","1.08","1.08","1.08","1.07","1.07","1.07","1.07","1.06","1.06","1.06","1.06","1.06","1.06","1.06","1.05","1.05","1.05","1.05","1.04","1.04","1.03","1.03","1.03","1.03","1.03","1.02","1.02","1.02","1.02","1.01","1.01","1.01","1.01","1.01","1.01","1.01","1.00","1.00","1.00","1.00","1.00","1.00","0.99","0.99","0.99","0.99","0.98","0.98","0.97","0.97","0.97","0.96","0.96","0.96","0.96","0.96","0.96","0.96","0.96","0.95","0.95","0.95","0.94","0.94","0.94","0.93","0.93","0.93","0.92","0.92","0.92","0.92","0.92","0.91","0.91","0.90","0.90","0.90","0.89","0.88","0.88","0.86","0.85","0.85","0.85","0.85","0.84","0.83","0.82","0.82","0.82","0.82","0.81","0.81","0.81","0.80","0.76","0.76","0.75","0.75","0.74","0.73","0.72","0.72","0.72","0.71","0.70","0.70","0.68","0.67","0.66","0.66","0.65","0.64","0.63","0.62","0.61","0.61","0.61","0.60","0.59","0.59","0.58","0.55","0.54","0.53","0.51","0.51","0.51","0.51","0.49","0.48","0.48","0.47","0.46","0.33","0.32","0.32","0.27","0.14"]},"columns":[{"id":"og_id","name":"og_id","type":"character"},{"id":"n_species","name":"n_species","type":"character"},{"id":"apul_context_strength","name":"apul_context_strength","type":"character"},{"id":"apul_context_dependent","name":"apul_context_dependent","type":"logical"},{"id":"apul_improvement","name":"apul_improvement","type":"character"},{"id":"apul_r2","name":"apul_r2","type":"character"},{"id":"peve_context_strength","name":"peve_context_strength","type":"character"},{"id":"peve_context_dependent","name":"peve_context_dependent","type":"logical"},{"id":"peve_improvement","name":"peve_improvement","type":"character"},{"id":"peve_r2","name":"peve_r2","type":"character"},{"id":"ptua_context_strength","name":"ptua_context_strength","type":"character"},{"id":"ptua_context_dependent","name":"ptua_context_dependent","type":"logical"},{"id":"ptua_improvement","name":"ptua_improvement","type":"character"},{"id":"ptua_r2","name":"ptua_r2","type":"character"},{"id":"mean_context_strength","name":"mean_context_strength","type":"character"}],"filterable":true,"searchable":true,"defaultPageSize":20,"highlight":true,"striped":true,"theme":{"highlightColor":"#EAF2F8"},"dataKey":"ce6bba268a40618e309dde535081d2dc"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="full-on-statiscal-robust-contra" class="level1">
<h1>Full on, Statiscal Robust ConTra</h1>
<pre><code>sr320@n3439:/mmfs1/gscratch/scrubbed/sr320/github/ConTra$ python code/context_dependent_analysis.py   --data-dir data/full-species-biomin/cleaned_peve   --enable-empirical-fdr   --null-replicates 1   --fdr-alpha 0.3   --enable-lncrna-context   --enable-multi-way
üöÄ Initializing optimized context-dependent analysis with 192 parallel workers
üíæ Available RAM: 2963.0 GB
üìÅ Output directory: /mmfs1/gscratch/scrubbed/sr320/github/ConTra/output/context_dependent_analysis_20251130_091333
üìÇ Loading cleaned datasets with parallel processing...
‚úÖ Loaded gene expression: (553, 36)
‚úÖ Loaded lncRNA expression: (8319, 36)
‚úÖ Loaded miRNA expression: (48, 36)
‚úÖ Loaded DNA methylation: (104459, 36)
‚úì All datasets aligned with 36 samples
Time points: ['TP1', 'TP2', 'TP3', 'TP4']
Conditions: ['216', '236', '245', '260', '262', '69', '72', '73', '74', '83']</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/63-contra/</guid>
  <pubDate>Sat, 29 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-30_08-27-36.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Calcification Count Matrices</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/62-biomin/</link>
  <description><![CDATA[ 






<p>Pulling out calcification / biomin gene counts.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
TLDR
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/apul_biomin_counts.csv</li>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/peve_biomin_counts.csv</li>
<li>https://raw.githubusercontent.com/urol-e5/timeseries-molecular-calcification/refs/heads/main/M-multi-species/output/33-biomin-pathway-counts/ptua_biomin_counts.csv</li>
</ul>
</div>
</div>
<p>Have list of biomineralization genes from coral literature (e.g., Takeuchi et al.&nbsp;2016, Ramos-Silva et al.&nbsp;2013)</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">makeblastdb</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">-in ../output/31-biomin-pathway/Stylo-biomin.fasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">-dbtype prot <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">-out ../output/31-biomin-pathway/Stylo-biomin-db</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> ../output/11.3-ortholog-annotation/representative_sequences.faa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> ../output/31-biomin-pathway/Stylo-biomin-db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 qseqid sseqid evalue bitscore"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-evalue</span> 1e-20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 10</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths</span></span>
<span id="cb3-5">blast_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv"</span></span>
<span id="cb3-6">mapping_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read BLAST results</span></span>
<span id="cb3-9">blast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(</span>
<span id="cb3-10">  blast_file,</span>
<span id="cb3-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evalue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>)</span>
<span id="cb3-12">)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read ortholog mapping</span></span>
<span id="cb3-15">mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(mapping_file)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join to add group_id to each gene in blast results</span></span>
<span id="cb3-18">annotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> blast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapping <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb3-20"></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write out CSV</span></span>
<span id="cb3-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(annotated, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>)</span>
<span id="cb3-24"></span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View result</span></span>
<span id="cb3-27">annotated</span></code></pre></div>
<pre><code>gene_id,hit,evalue,score,group_id
FUN_000236-T1,XP_022780303.1,6.1399999999999995e-24,102,OG_00030
FUN_000857-T1,XP_022795459.1,1.3899999999999998e-159,447,OG_00171
FUN_000867-T1,XP_022780694.1,1.6e-34,125,OG_00176
FUN_001009-T1,XP_022789591.1,7.039999999999999e-107,338,OG_00246
FUN_001088-T1,XP_022783044.1,3.9e-35,130,OG_00297
FUN_001089-T1,XP_022783044.1,2.1699999999999998e-23,93.2,OG_00298
FUN_001101-T1,XP_022783044.1,1.22e-31,118,OG_00302
FUN_001107-T1,XP_022795459.1,9.45e-59,190,OG_00305
FUN_001118-T1,XP_022801359.1,1.33e-35,124,OG_00314</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb5-2"></span>
<span id="cb5-3">ogs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/biomin-OG.txt"</span>,</span>
<span id="cb5-4">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>)</span>
<span id="cb5-5"></span>
<span id="cb5-6">map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span>)</span>
<span id="cb5-7"></span>
<span id="cb5-8">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">semi_join</span>(ogs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt;&lt; KEY FIX</span></span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb6-2"></span>
<span id="cb6-3">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/MOSAiC/refs/heads/main/data/orthologs"</span></span>
<span id="cb6-4"></span>
<span id="cb6-5">apul <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"apul-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb6-6">peve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"peve-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb6-7">ptua <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(base_url, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ptua-gene_count_matrix.csv"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_col_types =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id format matches count matrices</span></span>
<span id="cb7-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter apul &amp; add group_id as first column</span></span>
<span id="cb7-8">apul_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> apul <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb7-10">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Apul"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb7-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt;&lt; KEY LINEter(species == "Apul") </span></span>
<span id="cb7-14"></span>
<span id="cb7-15"></span>
<span id="cb7-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb7-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb7-18">  apul_filt,</span>
<span id="cb7-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/apul_biomin_counts.csv"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id in mapping file matches (remove transcript suffix)</span></span>
<span id="cb8-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb8-6"></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter Peve matrix, normalize gene_id, join, move group_id to column 1</span></span>
<span id="cb8-8">peve_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> peve <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^gene-"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt; FIX HERE</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb8-11">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peve"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb8-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)</span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb8-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb8-18">  peve_filt,</span>
<span id="cb8-19">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/peve_biomin_counts.csv"</span></span>
<span id="cb8-20">)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure gene_id in mapping file matches count matrix format</span></span>
<span id="cb9-4">filtered <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-T</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>))</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter Ptua matrix, normalize gene_id, join, move group_id to column 1</span></span>
<span id="cb9-8">ptua_filt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ptua <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(gene_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^gene-"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt;&lt;&lt; KEY FIX</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(</span>
<span id="cb9-11">    filtered <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ptua"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-13">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id),</span>
<span id="cb9-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span></span>
<span id="cb9-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relocate</span>(group_id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.before =</span> gene_id)</span>
<span id="cb9-17"></span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># write to CSV</span></span>
<span id="cb9-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb9-21">  ptua_filt,</span>
<span id="cb9-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/33-biomin-pathway-counts/ptua_biomin_counts.csv"</span></span>
<span id="cb9-23">)</span></code></pre></div>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/62-biomin/</guid>
  <pubDate>Wed, 26 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-26_10-46-20.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Timeseries Gene Level methylation</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/61-gene-meth/</link>
  <description><![CDATA[ 






<p>Getting gene-level methylation using 10xbedgraphs‚Ä¶</p>
<p>Here is a walk through of one species..</p>
<section id="gene-model-preparation" class="level2">
<h2 class="anchored" data-anchor-id="gene-model-preparation">Gene Model Preparation</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3</span></code></pre></div>
<pre><code>##gff-version 3
##sequence-region   Pocillopora_meandrina_HIv1___xfSc0000716 887 39392
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    gene    887 6811    .   -   .   ID=gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    mRNA    887 6811    .   -   .   ID=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 887 973 .   -   0   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    887 973 .   -   0   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 1828    1882    .   -   1   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    1828    1882    .   -   1   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-2;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    CDS 2308    2371    .   -   2   ID=cds-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    AUGUSTUS    exon    2308    2371    .   -   2   ID=exon-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1-3;Parent=mrna-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1</code></pre>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f3</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^#"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nr</span></span></code></pre></div>
<pre><code> 208535 exon
 208535 CDS
  31840 mRNA
  31840 gene</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gawk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3=="gene" {</span></span>
<span id="cb5-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    split($9, a, ";");</span></span>
<span id="cb5-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for(i in a){</span></span>
<span id="cb5-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        if(a[i] ~ /^ID=/){</span></span>
<span id="cb5-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            sub("ID=", "", a[i]);</span></span>
<span id="cb5-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            gene_id = a[i];</span></span>
<span id="cb5-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        }</span></span>
<span id="cb5-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb5-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print $1 "\t" $4-1 "\t" $5 "\t" gene_id;</span></span>
<span id="cb5-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}'</span> ../data/Pocillopora_meandrina_HIv1.genes-validated.gff3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___xfSc0000716    886 6811    gene-Pocillopora_meandrina_HIv1___RNAseq.g29951.t1
Pocillopora_meandrina_HIv1___xfSc0000716    7304    12239   gene-Pocillopora_meandrina_HIv1___RNAseq.g29952.t1
Pocillopora_meandrina_HIv1___xfSc0000716    21621   23112   gene-Pocillopora_meandrina_HIv1___RNAseq.g29953.t1
Pocillopora_meandrina_HIv1___xfSc0000716    25312   26016   gene-Pocillopora_meandrina_HIv1___RNAseq.g29954.t1
Pocillopora_meandrina_HIv1___xfSc0000716    34770   39392   gene-Pocillopora_meandrina_HIv1___RNAseq.g29955.t1
Pocillopora_meandrina_HIv1___Sc0000029  18377   30613   gene-Pocillopora_meandrina_HIv1___RNAseq.g10233.t1
Pocillopora_meandrina_HIv1___Sc0000029  35435   38326   gene-Pocillopora_meandrina_HIv1___RNAseq.g10234.t1
Pocillopora_meandrina_HIv1___Sc0000029  39901   40640   gene-Pocillopora_meandrina_HIv1___RNAseq.g10235.t1
Pocillopora_meandrina_HIv1___Sc0000029  56431   56839   gene-Pocillopora_meandrina_HIv1___RNAseq.g10236.t1
Pocillopora_meandrina_HIv1___Sc0000029  96446   105523  gene-Pocillopora_meandrina_HIv1___RNAseq.g10237.t1
31840 ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed</code></pre>
</section>
<section id="prepping-bedgraphs" class="level1">
<h1>Prepping bedgraphs</h1>
<pre><code>mkdir -p ../data/10xbedgraph
cd ../data/10xbedgraph
wget -r -l1 --no-parent -nd -A '*10x.bedgraph' \
     'https://gannet.fish.washington.edu/metacarcinus/E5/Ptuahiniensis/20250821_meth_Ptua/'</code></pre>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/10xbedgraph/POC-40-TP1_10x.bedgraph</span></code></pre></div>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../data/10xbedgraph/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_10x.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb10-2">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k2,2n</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span>.sorted.bedgraph</span>
<span id="cb10-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../data/10xbedgraph/POC-40-TP1_10x.sorted.bedgraph</span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___Sc0000000  2852    2854    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  2908    2910    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  3375    3377    6.666667
Pocillopora_meandrina_HIv1___Sc0000000  3384    3386    7.142857
Pocillopora_meandrina_HIv1___Sc0000000  3429    3431    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  3570    3572    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  5128    5130    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  6101    6103    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  6110    6112    0.000000
Pocillopora_meandrina_HIv1___Sc0000000  9318    9320    0.000000</code></pre>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/09-Ptua-Gene-Methylation/</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k1,1</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k2,2n</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-4">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.sorted.bed</span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../data/10xbedgraph/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_10x.sorted.bedgraph<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb13-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _10x.sorted.bedgraph<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-8"></span>
<span id="cb13-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> map <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-a</span> ../data/Pocillopora_meandrina_HIv1.GENESonly-validated.sorted.bed <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-11">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-12">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> mean,count <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-14">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/09-Ptua-Gene-Methylation/gene_methylation_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.tsv</span>
<span id="cb13-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<pre><code>Pocillopora_meandrina_HIv1___Sc0000000  10770   23652   gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  77.1836165  18
Pocillopora_meandrina_HIv1___Sc0000000  25128   33764   gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  60.81863374 38
Pocillopora_meandrina_HIv1___Sc0000000  33907   39296   gene-Pocillopora_meandrina_HIv1___TS.g25664.t1  20.83649989 45
Pocillopora_meandrina_HIv1___Sc0000000  44371   50798   gene-Pocillopora_meandrina_HIv1___RNAseq.g20905.t1  0.2109149468    282
Pocillopora_meandrina_HIv1___Sc0000000  52049   53624   gene-Pocillopora_meandrina_HIv1___RNAseq.g20906.t1  0.2717391282    39
Pocillopora_meandrina_HIv1___Sc0000000  54620   71869   gene-Pocillopora_meandrina_HIv1___RNAseq.g20907.t1  9.341014667 255
Pocillopora_meandrina_HIv1___Sc0000000  75141   87120   gene-Pocillopora_meandrina_HIv1___RNAseq.g20908.t1  35.22936122 74
Pocillopora_meandrina_HIv1___Sc0000000  89333   101789  gene-Pocillopora_meandrina_HIv1___RNAseq.g20909.t1  32.38789587 97
Pocillopora_meandrina_HIv1___Sc0000000  104428  116100  gene-Pocillopora_meandrina_HIv1___RNAseq.g20910.t1  54.14505446 61
Pocillopora_meandrina_HIv1___Sc0000000  117505  121120  gene-Pocillopora_meandrina_HIv1___RNAseq.g20911.t1  27.60554107 54</code></pre>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/09-Ptua-Gene-Methylation/gene_methylation<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.tsv<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb15-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">out</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">_gt10.tsv"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb15-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$6 &gt; 10'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$out</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/09-Ptua-Gene-Methylation/gene_methylation_POC-40-TP<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_gt10.tsv</span></code></pre></div>
<pre><code>==&gt; ../output/09-Ptua-Gene-Methylation/gene_methylation_POC-40-TP1_gt10.tsv &lt;==
Pocillopora_meandrina_HIv1___Sc0000000  10770   23652   gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  78.86871104 24
Pocillopora_meandrina_HIv1___Sc0000000  25128   33764   gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  66.12523937 38
Pocillopora_meandrina_HIv1___Sc0000000  33907   39296   gene-Pocillopora_meandrina_HIv1___TS.g25664.t1  25.66347985 41
Pocillopora_meandrina_HIv1___Sc0000000  44371   50798   gene-Pocillopora_meandrina_HIv1___RNAseq.g20905.t1  0.61153482  250
Pocillopora_meandrina_HIv1___Sc0000000  52049   53624   gene-Pocillopora_meandrina_HIv1___RNAseq.g20906.t1  1.662464711 38
Pocillopora_meandrina_HIv1___Sc0000000  54620   71869   gene-Pocillopora_meandrina_HIv1___RNAseq.g20907.t1  8.299407695 256
Pocillopora_meandrina_HIv1___Sc0000000  75141   87120   gene-Pocillopora_meandrina_HIv1___RNAseq.g20908.t1  32.24347769 74
Pocillopora_meandrina_HIv1___Sc0000000  89333   101789  gene-Pocillopora_meandrina_HIv1___RNAseq.g20909.t1  29.81549905 94
Pocillopora_meandrina_HIv1___Sc0000000  104428  116100  gene-Pocillopora_meandrina_HIv1___RNAseq.g20910.t1  54.3217754  63
Pocillopora_meandrina_HIv1___Sc0000000  117505  121120  gene-Pocillopora_meandrina_HIv1___RNAseq.g20911.t1  22.62597314 65</code></pre>
<section id="combined-matrix" class="level2">
<h2 class="anchored" data-anchor-id="combined-matrix">Combined Matrix</h2>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing all filtered tsv files</span></span>
<span id="cb18-4">indir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation"</span></span>
<span id="cb18-5"></span>
<span id="cb18-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># List all filtered files</span></span>
<span id="cb18-7">files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(indir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_methylation.*_gt10.tsv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read and combine</span></span>
<span id="cb18-10">df_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(files, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(f) {</span>
<span id="cb18-11">  sample_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_methylation_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> _) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb18-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_gt10.tsv"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> _)</span>
<span id="cb18-14"></span>
<span id="cb18-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(f, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb18-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(X4, X5) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb18-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> X4, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample_name :=</span> X5)</span>
<span id="cb18-18">})</span>
<span id="cb18-19"></span>
<span id="cb18-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Full join all files by gene_id</span></span>
<span id="cb18-21">merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(df_list, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb18-22"></span>
<span id="cb18-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- NEW PART: keep genes present in &gt;=75% of samples ----</span></span>
<span id="cb18-24">merged_75 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb18-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fraction of samples with non-NA values (ignores gene_id column)</span></span>
<span id="cb18-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frac_nonNA =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gene_id)))</span>
<span id="cb18-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb18-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(frac_nonNA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb18-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac_nonNA)</span>
<span id="cb18-31"></span>
<span id="cb18-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save 75% filtered matrix</span></span>
<span id="cb18-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_tsv</span>(merged_75, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span></code></pre></div>
<pre><code>23370 ../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv
gene_id POC-201-TP1 POC-201-TP2 POC-219-TP1 POC-219-TP2 POC-219-TP3 POC-219-TP4 POC-222-TP1 POC-222-TP3 POC-222-TP4 POC-255-TP1 POC-255-TP2 POC-255-TP3 POC-259-TP1 POC-259-TP2 POC-40-TP1  POC-40-TP2  POC-40-TP3  POC-40-TP4  POC-42-TP2  POC-42-TP4  POC-52-TP1  POC-52-TP2  POC-52-TP3  POC-52-TP4  POC-53-TP1  POC-53-TP2  POC-53-TP3  POC-53-TP4  POC-57-TP1  POC-57-TP2  POC-57-TP3  POC-57-TP4
gene-Pocillopora_meandrina_HIv1___RNAseq.g20902.t1  55.94819507 65  NA  56.71798513 70.75064638 72.97016588 69.38569095 61.48214065 60.15602938 68.71286394 68.121314   NA  80.14404553 81.65033473 78.86871104 75.75863129 73.52938063 77.1836165  63.71908893 73.56089086 NA  63.53896107 61.79727092 NA  69.83198112 66.01362921 48.35913809 NA  71.90167729 75.73253744 74.34254614 65.64244627
gene-Pocillopora_meandrina_HIv1___RNAseq.g20903.t1  62.07071959 64.30941694 57.89994524 57.9764581  62.95167124 61.53853367 59.22841108 59.25982624 56.56210374 57.61653049 56.71230877 62.92154108 61.34633203 67.04912922 66.12523937 64.45467636 63.47604045 60.81863374 58.51124484 60.36185731 57.97446009 60.10673518 56.45465472 53.58677349 57.63890561 60.56861659 56.60354664 54.7309886  62.98476886 62.72254031 66.12983122 63.81437656</code></pre>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb20-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb20-8"></span>
<span id="cb20-9">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb20-12"></span>
<span id="cb20-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1 ‚Äî Impute NA with row means</span></span>
<span id="cb20-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-16">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb20-17"></span>
<span id="cb20-18"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb20-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all-NA rows</span></span>
<span id="cb20-20">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb20-21">}</span>
<span id="cb20-22"></span>
<span id="cb20-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2 ‚Äî Remove zero-variance rows</span></span>
<span id="cb20-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-26">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb20-27">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb20-28"></span>
<span id="cb20-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3 ‚Äî Remove rows still containing Inf/NaN</span></span>
<span id="cb20-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-32">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb20-33"></span>
<span id="cb20-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heatmap 1 ‚Äî Scaled (same as before)</span></span>
<span id="cb20-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb20-38">  mat2,</span>
<span id="cb20-39">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"row"</span>,</span>
<span id="cb20-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb20-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb20-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene-level Methylation Patterns (Scaled)"</span></span>
<span id="cb20-43">)</span>
<span id="cb20-44"></span>
<span id="cb20-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Heatmap 2 ‚Äî Actual methylation values (Unscaled)</span></span>
<span id="cb20-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------------------</span></span>
<span id="cb20-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb20-49">  mat2,</span>
<span id="cb20-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb20-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb20-52">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb20-53">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gene-level Methylation Values (Raw)"</span>,</span>
<span id="cb20-54">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optional nicer palette</span></span>
<span id="cb20-55">)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-49.png" class="img-fluid figure-img"></p>
<figcaption>heatmap_scaled</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(RColorBrewer)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load data</span></span>
<span id="cb21-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>)</span>
<span id="cb21-8"></span>
<span id="cb21-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to matrix</span></span>
<span id="cb21-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-12">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb21-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb21-15"></span>
<span id="cb21-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1: Impute NA with row means</span></span>
<span id="cb21-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-19">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-20"></span>
<span id="cb21-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb21-22">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if entire row is NA</span></span>
<span id="cb21-23">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb21-24">}</span>
<span id="cb21-25"></span>
<span id="cb21-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2: Remove zero-variance genes </span></span>
<span id="cb21-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (these blow up PCA scaling)</span></span>
<span id="cb21-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-30">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb21-31">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, ]</span>
<span id="cb21-32"></span>
<span id="cb21-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3: Remove genes containing any Inf/NaN</span></span>
<span id="cb21-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-36">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), ]</span>
<span id="cb21-37"></span>
<span id="cb21-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4: Transpose (samples as rows)</span></span>
<span id="cb21-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-41">mat2_t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(mat2)</span>
<span id="cb21-42"></span>
<span id="cb21-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample group</span></span>
<span id="cb21-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-46">sample_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(mat2_t), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POC-[0-9]+"</span>)</span>
<span id="cb21-47"></span>
<span id="cb21-48">ngroups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(sample_groups))</span>
<span id="cb21-49"></span>
<span id="cb21-50">colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, ngroups), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>ngroups]</span>
<span id="cb21-51">group_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setNames</span>(colors, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(sample_groups))</span>
<span id="cb21-52"></span>
<span id="cb21-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 5: Run PCA safely</span></span>
<span id="cb21-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-56">pca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prcomp</span>(mat2_t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-57"></span>
<span id="cb21-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 6: Build plotting DF</span></span>
<span id="cb21-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-61">pca_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb21-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PC1 =</span> pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb21-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PC2 =</span> pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb21-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sample =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(pca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb21-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> sample_groups</span>
<span id="cb21-66">)</span>
<span id="cb21-67"></span>
<span id="cb21-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 7: Plot PCA</span></span>
<span id="cb21-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------</span></span>
<span id="cb21-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(pca_df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(PC1, PC2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> sample)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> group_colors) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb21-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb21-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PCA of Gene-Level Methylation"</span>,</span>
<span id="cb21-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample Group"</span></span>
<span id="cb21-79">  )</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-17.png" class="img-fluid figure-img"></p>
<figcaption>pca</figcaption>
</figure>
</div>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and convert to matrix</span></span>
<span id="cb22-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-7">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/09-Ptua-Gene-Methylation/Ptua-gene-methylation_75pct.tsv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 1 ‚Äî Impute NA with row means</span></span>
<span id="cb22-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-14">row_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowMeans</span>(mat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb22-15"></span>
<span id="cb22-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(mat))) {</span>
<span id="cb22-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(row_means[i])) row_means[i] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handles all-NA rows</span></span>
<span id="cb22-18">  mat[i, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(mat[i, ])] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> row_means[i]</span>
<span id="cb22-19">}</span>
<span id="cb22-20"></span>
<span id="cb22-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 2 ‚Äî Remove zero-variance genes</span></span>
<span id="cb22-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (these make correlation produce NA columns)</span></span>
<span id="cb22-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-25">keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb22-26">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat[keep, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb22-27"></span>
<span id="cb22-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 3 ‚Äî Remove any rows still containing Inf/NaN</span></span>
<span id="cb22-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-31">mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mat2[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(mat2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x))), , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb22-32"></span>
<span id="cb22-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 4 ‚Äî Compute correlation matrix safely</span></span>
<span id="cb22-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-36">cor_mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cor</span>(mat2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pairwise.complete.obs"</span>)</span>
<span id="cb22-37"></span>
<span id="cb22-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 5 ‚Äî Remove NA rows/columns in correlation matrix (if any remain)</span></span>
<span id="cb22-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-41">finite_cols <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apply</span>(cor_mat, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(x)))</span>
<span id="cb22-42">cor_mat2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cor_mat[finite_cols, finite_cols]</span>
<span id="cb22-43"></span>
<span id="cb22-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Step 6 ‚Äî Plot sample‚Äìsample correlation heatmap</span></span>
<span id="cb22-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ------------------------------------------------</span></span>
<span id="cb22-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(cor_mat2,</span>
<span id="cb22-48">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample‚ÄìSample Correlation"</span>,</span>
<span id="cb22-49">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>,</span>
<span id="cb22-50">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>)</span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-05-08.png" class="img-fluid figure-img"></p>
<figcaption>samplesample</figcaption>
</figure>
</div>
</section>
<section id="quick-species-comparison" class="level2">
<h2 class="anchored" data-anchor-id="quick-species-comparison">Quick Species Comparison</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>Apul</th>
<th>Peve</th>
<th>Ptua</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-14-56.png" width="250"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-16-52.png" width="250"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_11-02-49.png" width="250"></td>
</tr>
</tbody>
</table>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/61-gene-meth/</guid>
  <pubDate>Tue, 25 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_timeseries-molecular-calcification__RStudio_Server_2025-11-25_10-10-01.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Biomineraliztion in dark matter</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/58-biomin/</link>
  <description><![CDATA[ 





<p>Have list of biomineralization genes from coral literature (e.g., Takeuchi et al.&nbsp;2016, Ramos-Silva et al.&nbsp;2013)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Accession / GeneID</th>
<th>Blasted protein in Stylophora</th>
<th>Definition</th>
<th>Reference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AAD11470.1</td>
<td>XP_022803851.1</td>
<td>L-type calcium channel alpha-1 subunit</td>
<td>Zoccola et al., 1999</td>
</tr>
<tr class="even">
<td>AAR13013.1</td>
<td>XP_022785723.1</td>
<td>plasma membrane calcium ATPase</td>
<td>Zoccola et al., 2004</td>
</tr>
<tr class="odd">
<td>ACE95141.1</td>
<td>XP_022799914.1</td>
<td>carbonic anhydrase</td>
<td>Moya et al., 2008</td>
</tr>
<tr class="even">
<td>AGE35225.2</td>
<td>XP_022785805.1</td>
<td>CARP1</td>
<td>Mass et al., 2013</td>
</tr>
<tr class="odd">
<td>AGE35226.1</td>
<td>XP_022794102.1</td>
<td>CARP3</td>
<td>Mass et al., 2013</td>
</tr>
<tr class="even">
<td>AGG36361.1</td>
<td>XP_022784808.1</td>
<td>Protoacadherin (PC4)</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>AJQ31790.1</td>
<td>XP_022788307.1</td>
<td>solute carrier family 4 member gamma</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>aug_v2a.00002.t1</td>
<td>XP_022808048.1, XP_022808045.1, XP_022790310.1</td>
<td>EP-like 2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.01440.t1 (aug_v2a.01441.t1)</td>
<td>XP_022780690.1</td>
<td>Adi-SAARP2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.02830</td>
<td>XP_022782704.1, XP_022782703.1</td>
<td>PKD1-related protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.02830.t1</td>
<td>XP_022782704.1, XP_022782703.1</td>
<td>PKD1-related protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.05945.t1</td>
<td>XP_022783430.1</td>
<td>TSP-1 and VWA domain-containing</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.06122.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.06123.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.06327.t1</td>
<td>XP_022781839.1, XP_022781915.1</td>
<td>SAARP3</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.07627.t1</td>
<td>XP_022806326.1</td>
<td>Zona pellucida domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.09809.t1</td>
<td>XP_022801334.1</td>
<td>Mucin4-like protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.09968.t1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDLr domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.09969.t1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDLr domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.11068.t1</td>
<td>XP_022782398.1</td>
<td>SAARP1</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.15064.t1</td>
<td>XP_022808152.1</td>
<td>Cysteine-rich</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.15065.t1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>galaxin2</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.15580.t1</td>
<td>XP_022804012.1</td>
<td>Laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.18631.t1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>galaxin</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.19518.t1</td>
<td>XP_022784808.1</td>
<td>Protocadherin-like</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.22918.t1</td>
<td>XP_022808048.1, XP_022808045.1, XP_022790310.1</td>
<td>EP-like1</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>aug_v2a.24015.t1</td>
<td>XP_022788227.1</td>
<td>Hephaestin-like protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="even">
<td>aug_v2a.24512.t1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Takeuchi et al., 2016</td>
</tr>
<tr class="odd">
<td>EU532164.1</td>
<td>XP_022799914.1</td>
<td>carbonic anhydrase 2</td>
<td>Bertucci et al., 2011</td>
</tr>
<tr class="even">
<td>Gene:g29033.t1</td>
<td>XP_022799914.1</td>
<td>Carbonic Anhydrase (STPCA2-1)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g3745.t1</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:10186</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC2)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g10186</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g10187</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC3)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g10188</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC3)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g11190</td>
<td>XP_022783323.1</td>
<td>USOMP12</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g13552</td>
<td>XP_022781839.1</td>
<td>Acidic SOMP (p27)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g14733</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g1484</td>
<td>XP_022785805.1</td>
<td>CARP1</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g15294.t1</td>
<td>XP_022779720.1</td>
<td>Vitellogenin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g15955</td>
<td>XP_022794736.1</td>
<td>MAM LDL-2</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g2115</td>
<td>XP_022784808.1</td>
<td>Cadherin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g2116</td>
<td>XP_022784808.1</td>
<td>Protocadherin (PC1)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g22569</td>
<td>XP_022810031.1</td>
<td>Fibronectin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g24177</td>
<td>XP_022798258.1</td>
<td>Protocadherin (PC5)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g27814</td>
<td>XP_022801359.1</td>
<td>carbonic anhydrase (STPCA2-2)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g2829</td>
<td>XP_022783414.1, XP_022783413.1</td>
<td>Thrombospondin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g2829.t1</td>
<td>XP_022783415.1</td>
<td>Coadhesin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g29034.t1</td>
<td>XP_022799914.1</td>
<td>Carbonic Anhydrase</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g30</td>
<td>XP_022784808.1</td>
<td>Protoacadherin (PC4)</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g30385.t1</td>
<td>XP_022780049.1</td>
<td>USOMPS13</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g34749</td>
<td>XP_022804012.1</td>
<td>EGF &amp; LamininG-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g37058</td>
<td>XP_022804608.1</td>
<td>Fibronectin-2</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g38128</td>
<td>XP_022783430.1</td>
<td>Œ±-Collagen</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g38881</td>
<td>XP_022790556.1, XP_022790555.1</td>
<td>USOMP14</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g39770</td>
<td>XP_022795871.1</td>
<td>Kielin-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g5735.t1</td>
<td>XP_022799127.1</td>
<td>Tolloid-Like</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g7086</td>
<td>XP_022804012.1</td>
<td>EGF LamG1</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g8396</td>
<td>XP_022803859.1</td>
<td>CARP6-partial</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>Gene:g907</td>
<td>XP_022806326.1</td>
<td>Zona Pellucida</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="odd">
<td>Gene:g9094</td>
<td>XP_022795459.1, XP_022777933.1</td>
<td>Actin</td>
<td>Mummadisetti et al., 2021</td>
</tr>
<tr class="even">
<td>HM163215</td>
<td>XP_029187982.1</td>
<td>Acropora millepora galaxin</td>
<td>Reyes-Bermudez et al., 2009</td>
</tr>
<tr class="odd">
<td>JN631095.1</td>
<td>XP_029195765.1</td>
<td>hypothetical protein p251_4</td>
<td>Hayward et al., 2011</td>
</tr>
<tr class="even">
<td>JR971508.1</td>
<td>XP_022793420.1, XP_022793422.1</td>
<td>USOMP6</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR972076.1</td>
<td>XP_022781839.1, XP_022781915.1</td>
<td>Acidic SOMP</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR973117.1</td>
<td>XP_022808048.1, XP_022808045.1</td>
<td>USOMP-5</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR976690.1</td>
<td>XP_022794122.1, XP_022794121.1</td>
<td>Galaxin 2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR980881.1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G protein</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR982706.1</td>
<td>XP_022808152.1</td>
<td>USOMP-2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR986059.1</td>
<td>XP_022782738.1</td>
<td>Cephalotoxin-like</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR991083.1</td>
<td>XP_022779335.1</td>
<td>Collagen Œ±-1 chain</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR991407.1</td>
<td>XP_022780690.1</td>
<td>SAARP2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR994474.1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDL-receptor protein 2</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR997000.1</td>
<td>XP_022807628.1, XP_022807627.1</td>
<td>USOMP-3</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JR998014.1</td>
<td>XP_022799897.1, XP_022801331.1</td>
<td>Putative carbonic anhydrase</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JR998260.1</td>
<td>XP_022803212.1</td>
<td>USOMP7</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT001945.1</td>
<td>XP_022782398.1</td>
<td>SAARP1</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JT004498.1</td>
<td>XP_022780690.1</td>
<td>USOMP-4</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT011118.1</td>
<td>XP_022794736.1</td>
<td>MAM LDL receptor protein 1</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>JT014391.1</td>
<td>XP_022797021.1</td>
<td>USOMP-8</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="odd">
<td>JT016638.1</td>
<td>XP_022783430.1</td>
<td>Coadhesin</td>
<td>Ramos-Silva et al., 2013</td>
</tr>
<tr class="even">
<td>MG182344.1</td>
<td>XP_022792788.1</td>
<td>Acropora yongei Na+/Ca2+ exchanger</td>
<td>Barron et al., 2018</td>
</tr>
<tr class="odd">
<td>MG182345.1</td>
<td>XP_022784107.1</td>
<td>Acropora yongei Na+/Ca2+ exchanger</td>
<td>Barron et al., 2018</td>
</tr>
<tr class="even">
<td>P12_g2385</td>
<td>XP_022796981.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P13_g6918</td>
<td>XP_022803207.1</td>
<td>Sushi domain-containing</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P14_g9951</td>
<td>XP_022783415.1</td>
<td>collagen-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P15_g1532</td>
<td>XP_022780640.1, XP_022783414.1</td>
<td>CARP9</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P16_g11702</td>
<td>XP_022780049.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P18_g810</td>
<td>XP_022783430.1</td>
<td>collagen-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P19_g20041</td>
<td>XP_022804012.1</td>
<td>Contactin-associated protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P2_g11187</td>
<td>XP_022782364.1</td>
<td>CARP8</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P20_g6066</td>
<td>XP_022794736.1</td>
<td>MAM domain anchor protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P21_g18277</td>
<td>XP_022806326.1</td>
<td>Zona pellucida</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P22_g19762</td>
<td>XP_022785540.1</td>
<td>hypothetical protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P23_g1057</td>
<td>XP_022808083.1, XP_022808082.1</td>
<td>Protocadherin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P24_g15888</td>
<td>XP_022779720.1</td>
<td>vitellogenin-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P26_g1441</td>
<td>XP_022794920.1</td>
<td>vitellogenin-like protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P27_g18472</td>
<td>XP_022781915.1</td>
<td>Integrin-alpha</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P28_g11651</td>
<td>XP_022793421.1</td>
<td>Late embryogenesis protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P3_g12510</td>
<td>XP_022783415.1</td>
<td>Thrombospondin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P31_g20420</td>
<td>XP_022804012.1</td>
<td>Neurexin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P32_g5540</td>
<td>XP_022795871.1</td>
<td>Kielin/chordin-like</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P33_g8985</td>
<td>XP_022781364.1</td>
<td>Flagellar associated protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P34_g1714</td>
<td>XP_022794736.1</td>
<td>MAM/LDL receptor domain protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P36_g13890</td>
<td>XP_022794736.1</td>
<td>Zonadhesion-like precursor</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P4_g9861</td>
<td>XP_022797264.1</td>
<td>Viral inclusion protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P5_g11674</td>
<td>XP_022783415.1</td>
<td>Hemicentin</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>P8_g9654</td>
<td>XP_022786917.1, XP_022786918.1</td>
<td>Major yolk protein</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="odd">
<td>P9_g10811; P1_g11108; P10_g11107</td>
<td>XP_022784808.1</td>
<td>Protocadherin fat-like</td>
<td>Drake et al., 2013</td>
</tr>
<tr class="even">
<td>PFX13778.1</td>
<td>XP_022808646.1</td>
<td>Sacsin</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX14205.1</td>
<td>XP_022808089.1</td>
<td>Ret receptor kinase (partial)</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX15740.1</td>
<td>XP_022806058.1</td>
<td>Protein FAM208A</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX16398.1</td>
<td>XP_022805070.1</td>
<td>hypothetical protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX18785.1</td>
<td>XP_022801334.1, XP_022801335.1</td>
<td>Mucin-4</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX26597.1</td>
<td>XP_022788977.1</td>
<td>Complement C3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX26751.1</td>
<td>XP_022788730.1</td>
<td>Transmembrane protease serine 9</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>PFX27832.1</td>
<td>XP_022786864.1</td>
<td>PARP11</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>PFX30903.1</td>
<td>XP_022781839.1</td>
<td>hypothetical protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022778254.1</td>
<td>XP_022778254.1</td>
<td>uncharacterized protein LOC111319781</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022778283.1</td>
<td>XP_022778283.1</td>
<td>uncharacterized protein LOC111319816</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022779720.1</td>
<td>XP_022779720.1</td>
<td>vitellogenin-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022780303.1</td>
<td>XP_022780303.1</td>
<td>uncharacterized protein LOC111321626</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022780690.1</td>
<td>XP_022780690.1</td>
<td>CARP5</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022780694.1</td>
<td>XP_022780694.1</td>
<td>CUB &amp; peptidase domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022781731.1</td>
<td>XP_022781731.1</td>
<td>sulfate anion transporter-like 2C</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022782398.1</td>
<td>XP_022782398.1</td>
<td>CARP4</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783031.1</td>
<td>XP_022783031.1</td>
<td>sodium bicarbonate transporter-like 11</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022783044.1</td>
<td>XP_022783044.1</td>
<td>uncharacterized protein LOC111323869</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783323.1</td>
<td>XP_022783323.1</td>
<td>VHS3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022783415.1</td>
<td>XP_022783415.1</td>
<td>coadhesin-like isoform X3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022783952.1</td>
<td>XP_022783952.1</td>
<td>collagenase 3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022784623.1</td>
<td>XP_022784623.1</td>
<td>sperm-associated cation channel</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022786582.1</td>
<td>XP_022786582.1</td>
<td>synapsin-2-like isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022786918.1</td>
<td>XP_022786918.1</td>
<td>major yolk protein-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022788227.1</td>
<td>XP_022788227.1</td>
<td>hephaestin-like protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022788270.1</td>
<td>XP_022788270.1</td>
<td>band 3 anion transport protein-like</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022788730.1</td>
<td>XP_022788730.1</td>
<td>elastase-like peptidase</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022789591.1</td>
<td>XP_022789591.1</td>
<td>endothelin-converting enzyme 1-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022789932.1</td>
<td>XP_022789932.1</td>
<td>MAGUK p55 subfamily member 7-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022790441.1</td>
<td>XP_022790441.1</td>
<td>PHD finger protein 21A-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022791567.1</td>
<td>XP_022791567.1</td>
<td>anion exchange protein 2-like</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022792212.1</td>
<td>XP_022792212.1</td>
<td>ras-like protein 3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022794122.1</td>
<td>XP_022794122.1</td>
<td>galaxin-like isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022794351.1</td>
<td>XP_022794351.1</td>
<td>ependymin-related protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022794736.1</td>
<td>XP_022794736.1</td>
<td>MAM &amp; LDL receptor protein 2-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022796981.1</td>
<td>XP_022796981.1</td>
<td>skeletal organic matrix protein 8-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022796982.1</td>
<td>XP_022796982.1</td>
<td>uncharacterized protein LOC111335364</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022798902.1</td>
<td>XP_022798902.1</td>
<td>LDL receptor-related protein 8-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022799089.1</td>
<td>XP_022799089.1</td>
<td>CUB domain protein isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022799541.1</td>
<td>XP_022799541.1</td>
<td>uncharacterized protein LOC111337489</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022800320.1</td>
<td>XP_022800320.1</td>
<td>sulfate anion transporter 1-like X1</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022800329.1</td>
<td>XP_022800329.1</td>
<td>sulfate anion transporter 1-like X2</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022800339.1</td>
<td>XP_022800339.1</td>
<td>sulfate anion transporter 1-like X1</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="even">
<td>XP_022801463.1</td>
<td>XP_022801463.1</td>
<td>bicarbonate cotransporter 3-like X2</td>
<td>Zoccola et al., 2015</td>
</tr>
<tr class="odd">
<td>XP_022803524.1</td>
<td>XP_022803524.1</td>
<td>digestive cysteine proteinase 1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022803808.1</td>
<td>XP_022803808.1</td>
<td>tumor suppressor DMBT1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022803872.1</td>
<td>XP_022803872.1</td>
<td>spore wall protein 2-like X3</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022803894.1</td>
<td>XP_022803894.1</td>
<td>uncharacterized protein LOC111341206</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022804012.1</td>
<td>XP_022804012.1</td>
<td>EGF &amp; laminin G domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022804785.1</td>
<td>XP_022804785.1</td>
<td>thioredoxin reductase 1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022805470.1</td>
<td>XP_022805470.1</td>
<td>uncharacterized protein LOC111342641</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022806326.1</td>
<td>XP_022806326.1</td>
<td>ZP domain protein</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022806664.1</td>
<td>XP_022806664.1</td>
<td>protein lingerer-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022806928.1</td>
<td>XP_022806928.1</td>
<td>SLIT-ROBO RhoGAP1-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022807143.1</td>
<td>XP_022807143.1</td>
<td>condensin-2 subunit D3-like</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022807256.1</td>
<td>XP_022807256.1</td>
<td>uncharacterized protein LOC111344300</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022807807.1</td>
<td>XP_022807807.1</td>
<td>uncharacterized protein LOC111344812</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022808163.1</td>
<td>XP_022808163.1</td>
<td>uncharacterized protein LOC111345150</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022808576.1</td>
<td>XP_022808576.1</td>
<td>LOC111345553 isoform X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022809269.1</td>
<td>XP_022809269.1</td>
<td>microtubule-associated tumor suppressor 1-like X1</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="odd">
<td>XP_022809270.1</td>
<td>XP_022809270.1</td>
<td>microtubule-associated tumor suppressor 1-like X2</td>
<td>Peled et al., 2020</td>
</tr>
<tr class="even">
<td>XP_022810585.1</td>
<td>XP_022810585.1</td>
<td>vWF D + EGF domain protein (partial)</td>
<td>Peled et al., 2020</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">seqkit</span> grep <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> ../data/biomin-ids.txt ../data/GCF_002571385.2_Stylophora_pistillata_v1.1_protein.faa <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/31-biomin-pathway/Stylo-biomin.fasta</span></code></pre></div>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">blastp</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-query</span> ../output/11.3-ortholog-annotation/representative_sequences.faa <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-db</span> ../output/31-biomin-pathway/Stylo-biomin-db <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-out</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-outfmt</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 qseqid sseqid evalue bitscore"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-evalue</span> 1e-20 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_target_seqs</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-max_hsps</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-num_threads</span> 10</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv</span></code></pre></div>
<pre><code>FUN_000236-T1   XP_022780303.1  6.14e-24    102
FUN_000857-T1   XP_022795459.1  1.39e-159   447
FUN_000867-T1   XP_022780694.1  1.60e-34    125
FUN_001009-T1   XP_022789591.1  7.04e-107   338
FUN_001088-T1   XP_022783044.1  3.90e-35    130
FUN_001089-T1   XP_022783044.1  2.17e-23    93.2
FUN_001101-T1   XP_022783044.1  1.22e-31    118
FUN_001107-T1   XP_022795459.1  9.45e-59    190
FUN_001118-T1   XP_022801359.1  1.33e-35    124
FUN_001185-T1   XP_022798902.1  0.0 870</code></pre>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv</span></code></pre></div>
<pre><code>gene_id,species,group_id,type,conservation_level
FUN_000185-T1,Apul,OG_00001,three_way,medium
Peve_00037402,Peve,OG_00001,three_way,medium
Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,Ptua,OG_00001,three_way,medium
FUN_000189-T1,Apul,OG_00002,three_way,medium
Peve_00038462,Peve,OG_00002,three_way,medium
Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,Ptua,OG_00002,three_way,medium
FUN_000190-T1,Apul,OG_00003,three_way,low
Peve_00038463,Peve,OG_00003,three_way,low
Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,Ptua,OG_00003,three_way,low</code></pre>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readr)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paths</span></span>
<span id="cb7-5">blast_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin-results.tsv"</span></span>
<span id="cb7-6">mapping_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/11.3-ortholog-annotation/gene_to_ortholog_mapping.csv"</span></span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read BLAST results</span></span>
<span id="cb7-9">blast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(</span>
<span id="cb7-10">  blast_file,</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hit"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evalue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>)</span>
<span id="cb7-12">)</span>
<span id="cb7-13"></span>
<span id="cb7-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read ortholog mapping</span></span>
<span id="cb7-15">mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(mapping_file)</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join to add group_id to each gene in blast results</span></span>
<span id="cb7-18">annotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> blast <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(mapping <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(gene_id, group_id), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb7-20"></span>
<span id="cb7-21"></span>
<span id="cb7-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write out CSV</span></span>
<span id="cb7-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(annotated, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>)</span>
<span id="cb7-24"></span>
<span id="cb7-25"></span>
<span id="cb7-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View result</span></span>
<span id="cb7-27">annotated</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_15-57-58.png" class="img-fluid"></p>
<section id="matches-in-barnacle" class="level1">
<h1>Matches in Barnacle</h1>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Load the Stylo-biomin group_id list</span></span>
<span id="cb8-4">stylo_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span></span>
<span id="cb8-5"></span>
<span id="cb8-6">stylo_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(stylo_file) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(group_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb8-9"></span>
<span id="cb8-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Get all *_top100.csv files</span></span>
<span id="cb8-11">path_top100 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/22-Visualizing-Rank-outs"</span></span>
<span id="cb8-12"></span>
<span id="cb8-13">top100_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(</span>
<span id="cb8-14">  path_top100,</span>
<span id="cb8-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*_top100.csv"</span>,</span>
<span id="cb8-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb8-17">)</span>
<span id="cb8-18"></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. For each file, find matching group IDs in column 1</span></span>
<span id="cb8-20">results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(top100_files, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(f) {</span>
<span id="cb8-21"></span>
<span id="cb8-22">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(f, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb8-23"></span>
<span id="cb8-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># assume the first column has the group_ids</span></span>
<span id="cb8-25">  col1_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb8-26"></span>
<span id="cb8-27">  matches <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect</span>(stylo_groups, col1_ids)</span>
<span id="cb8-28"></span>
<span id="cb8-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb8-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(f),</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">matched_group_id =</span> matches</span>
<span id="cb8-32">  )</span>
<span id="cb8-33">})</span>
<span id="cb8-34"></span>
<span id="cb8-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show results</span></span>
<span id="cb8-36">results</span>
<span id="cb8-37"></span>
<span id="cb8-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Write out summary file</span></span>
<span id="cb8-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(</span>
<span id="cb8-40">  results,</span>
<span id="cb8-41">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/Stylo-biomin_matches_in_top100.csv"</span></span>
<span id="cb8-42">)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the file: it has two columns (file, group_id)</span></span>
<span id="cb9-4">res <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/Stylo-biomin_matches_in_top100.csv"</span>,</span>
<span id="cb9-5">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"group_id"</span>))</span>
<span id="cb9-6"></span>
<span id="cb9-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count occurrences of each file (column 1)</span></span>
<span id="cb9-8">file_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> res <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n_occurrences"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(n_occurrences))</span>
<span id="cb9-11"></span>
<span id="cb9-12">file_counts</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-00-08.png" class="img-fluid"></p>
</section>
<section id="wgcna-module-enrichment" class="level1">
<h1>WGCNA module enrichment</h1>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Load biomin group IDs</span></span>
<span id="cb10-4">biomin_groups <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/31-biomin-pathway/OG-repseq_Stylo-biomin.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(group_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb10-7"></span>
<span id="cb10-8">n_biomin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(biomin_groups)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># total number of biomin groups</span></span>
<span id="cb10-9"></span>
<span id="cb10-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Load module assignments (must contain group_id and module_label)</span></span>
<span id="cb10-11">assignments <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(</span>
<span id="cb10-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/GitHub/timeseries_molecular/M-multi-species/output/18-ortholog-wgcna/gene_module_assignments.csv"</span></span>
<span id="cb10-13">)</span>
<span id="cb10-14"></span>
<span id="cb10-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Mark biomin matches</span></span>
<span id="cb10-16">assignments2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> assignments <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">is_biomin =</span> group_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> biomin_groups)</span>
<span id="cb10-18"></span>
<span id="cb10-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Summarize by module_label</span></span>
<span id="cb10-20">module_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> assignments2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(module_label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb10-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_group_ids_in_module =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n_distinct</span>(group_id),</span>
<span id="cb10-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_biomin_in_module =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(is_biomin),</span>
<span id="cb10-25">    </span>
<span id="cb10-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percent of BIOMIN groups captured by this module</span></span>
<span id="cb10-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_of_all_biomin =</span> (n_biomin_in_module <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_biomin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb10-28">    </span>
<span id="cb10-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># percent of module that is biomin</span></span>
<span id="cb10-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_of_module_that_is_biomin =</span> (n_biomin_in_module <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_group_ids_in_module) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb10-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(pct_of_all_biomin))</span>
<span id="cb10-33"></span>
<span id="cb10-34">module_summary</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-01-10.png" class="img-fluid"></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/58-biomin/</guid>
  <pubDate>Sat, 15 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-16_16-01-54.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Functional annotation summary for WGCNA modules</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/59-wgcna-annotation/</link>
  <description><![CDATA[ 





<p>Implementation</p>
<ul>
<li><p><strong>Script</strong>:&nbsp;<code>19-annotate-wgcna-modules.py</code>&nbsp;joins&nbsp;<code>wgcna_ortholog_module_assignments.csv</code>&nbsp;with&nbsp;<code>ortholog_groups_annotated.csv</code>&nbsp;on&nbsp;<code>group_id</code>&nbsp;(OG_xxxxx)</p></li>
<li><p><strong>Summarization</strong>: Counts and ranks GO terms (BP/CC/MF), GO Slim pathways, and protein functions per module</p></li>
<li><p><strong>Output</strong>: 7 files in&nbsp;<code>M-multi-species/output/18-ortholog-wgcna/</code>:</p>
<ul>
<li><p><code>wgcna_module_annotation_summary.txt</code>&nbsp;- detailed report with top 10 terms per category for all 15 modules</p></li>
<li><p><code>wgcna_module_overview.csv</code>&nbsp;- per-module statistics (size, coverage, dominant terms)</p></li>
<li><p>5 CSV matrices showing term distributions across modules (GO BP/CC/MF, GO Slim, proteins)</p></li>
</ul></li>
</ul>
<hr>
<p>All output:<a href="https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/18-ortholog-wgcna" class="uri">https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/18-ortholog-wgcna</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/refs/heads/main/M-multi-species/output/18-ortholog-wgcna/wgcna_module_go_bp_summary.csv"</span></span>
<span id="cb1-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stringsAsFactors =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                    term
1 positive regulation of transcription by RNA polymerase II [GO:0045944]
2 negative regulation of transcription by RNA polymerase II [GO:0000122]
3          regulation of transcription by RNA polymerase II [GO:0006357]
4        positive regulation of DNA-templated transcription [GO:0045893]
5                                               proteolysis [GO:0006508]
6                                         protein transport [GO:0015031]
  module_0 module_1 module_2 module_3 module_4 module_5 module_6 module_7
1       14       33       40       16       21       35        9       13
2       16       36       25       16       17       23       15       13
3       22       28       28       18       14       27        0        0
4       14       26       29       14        0       22        0        0
5        0       35       19       20       15        0        0       16
6        9       33        0       21        0       17       12       12
  module_8 module_9 module_10 module_11 module_12 module_13 module_14 total
1        8        4         0         0         3         0         4   200
2        7        0         0         0         3         0         2   173
3        0        0         3         0         0         0         3   143
4        5        0         0         0         3         0         0   113
5        0        0         2         0         0         3         0   110
6        0        0         0         0         0         0         0   104</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DT)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">datatable</span>(</span>
<span id="cb3-4">  df,</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pageLength =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">autoWidth =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-8">  ),</span>
<span id="cb3-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filter =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'top'</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># column filters at the top</span></span>
<span id="cb3-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-11">)</span></code></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0fb88eec8b62dde94752" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0fb88eec8b62dde94752">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"22\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"45\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"40\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"21\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"21\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"35\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"16\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"10\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"200\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["positive regulation of transcription by RNA polymerase II [GO:0045944]","negative regulation of transcription by RNA polymerase II [GO:0000122]","regulation of transcription by RNA polymerase II [GO:0006357]","positive regulation of DNA-templated transcription [GO:0045893]","proteolysis [GO:0006508]","protein transport [GO:0015031]","cell division [GO:0051301]","apoptotic process [GO:0006915]","protein ubiquitination [GO:0016567]","cilium assembly [GO:0060271]","signal transduction [GO:0007165]","intracellular signal transduction [GO:0035556]","DNA repair [GO:0006281]","negative regulation of DNA-templated transcription [GO:0045892]","DNA damage response [GO:0006974]","negative regulation of apoptotic process [GO:0043066]","cell differentiation [GO:0030154]","positive regulation of gene expression [GO:0010628]","protein stabilization [GO:0050821]","spermatogenesis [GO:0007283]","G protein-coupled receptor signaling pathway [GO:0007186]","neurogenesis [GO:0022008]","cell population proliferation [GO:0008283]","negative regulation of cell population proliferation [GO:0008285]","inflammatory response [GO:0006954]","mRNA splicing, via spliceosome [GO:0000398]","RNA splicing [GO:0008380]","mRNA processing [GO:0006397]","chromatin remodeling [GO:0006338]","protein folding [GO:0006457]","flagellated sperm motility [GO:0030317]","translation [GO:0006412]","positive regulation of cell population proliferation [GO:0008284]","sperm axoneme assembly [GO:0007288]","epithelial cilium movement involved in extracellular fluid movement [GO:0003351]","positive regulation of MAPK cascade [GO:0043410]","rhythmic process [GO:0048511]","positive regulation of proteasomal ubiquitin-dependent protein catabolic process [GO:0032436]","proteasome-mediated ubiquitin-dependent protein catabolic process [GO:0043161]","chordate embryonic development [GO:0043009]","endoplasmic reticulum to Golgi vesicle-mediated transport [GO:0006888]","intracellular protein transport [GO:0006886]","gluconeogenesis [GO:0006094]","malate metabolic process [GO:0006108]","malate-aspartate shuttle [GO:0043490]","tricarboxylic acid cycle [GO:0006099]","angiogenesis [GO:0001525]","negative regulation of cell differentiation [GO:0045596]","spermatid development [GO:0007286]","protein localization [GO:0008104]"],[14,16,22,14,0,9,0,11,9,11,12,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[33,36,28,26,35,33,45,0,0,34,0,0,33,0,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[40,25,28,29,19,0,0,15,28,0,0,18,0,0,0,19,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[16,16,18,14,20,21,0,12,0,18,14,0,0,0,0,0,0,0,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[21,17,14,0,15,0,0,16,15,0,14,0,0,14,0,0,0,0,0,0,14,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[35,23,27,22,0,17,17,17,0,0,16,16,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[9,15,0,0,0,12,14,9,10,0,0,0,11,8,0,8,0,0,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[13,13,0,0,16,12,10,0,9,0,0,11,0,0,0,0,0,0,0,0,0,0,9,11,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8,7,0,5,0,0,0,0,0,6,0,0,0,5,0,0,0,0,6,0,0,0,0,0,0,10,8,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,2,0,3,0,0,0,0,0,2,2,2,2,2,0,0,0,0,0,0,0,0],[0,0,3,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,3,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,0,0],[0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,2,0,0,2,0,0,0,0,0,0,0,0,0,2,4,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2],[3,3,0,3,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,2,3,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[200,173,143,113,110,104,86,83,71,69,63,49,44,36,32,27,26,20,17,16,14,13,13,11,11,10,8,8,8,4,4,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>term<\/th>\n      <th>module_0<\/th>\n      <th>module_1<\/th>\n      <th>module_2<\/th>\n      <th>module_3<\/th>\n      <th>module_4<\/th>\n      <th>module_5<\/th>\n      <th>module_6<\/th>\n      <th>module_7<\/th>\n      <th>module_8<\/th>\n      <th>module_9<\/th>\n      <th>module_10<\/th>\n      <th>module_11<\/th>\n      <th>module_12<\/th>\n      <th>module_13<\/th>\n      <th>module_14<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]},{"name":"term","targets":0},{"name":"module_0","targets":1},{"name":"module_1","targets":2},{"name":"module_2","targets":3},{"name":"module_3","targets":4},{"name":"module_4","targets":5},{"name":"module_5","targets":6},{"name":"module_6","targets":7},{"name":"module_7","targets":8},{"name":"module_8","targets":9},{"name":"module_9","targets":10},{"name":"module_10","targets":11},{"name":"module_11","targets":12},{"name":"module_12","targets":13},{"name":"module_13","targets":14},{"name":"module_14","targets":15},{"name":"total","targets":16}],"order":[],"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/59-wgcna-annotation/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_05-28-34.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Contra on 24</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/58-contra-24/</link>
  <description><![CDATA[ 





<p>Took the top 100 genes in component 24 (of 35 rank) and did Context Dependent Regulation Ananysis</p>
<p>Summary of output</p>
<p>These CSV files contain the detailed results of context-dependent regulatory analysis, including interaction statistics, p-values, context strengths, and regulatory relationships for each analyzed gene-regulator pair.</p>
<p>high_methylation_gene_lncrna_correlations.csv (29626.7 KB) high_methylation_gene_methylation_correlations.csv (339626.1 KB) high_methylation_gene_mirna_correlations.csv (40.0 KB) lncrna_mirna_context.csv (1544.7 KB) low_mirna_gene_lncrna_correlations.csv (36676.7 KB) low_mirna_gene_methylation_correlations.csv (341486.6 KB) low_mirna_gene_mirna_correlations.csv (81.5 KB) methylation_mirna_context.csv (1898.0 KB) multi_way_interactions.csv (248.9 KB)</p>
<section id="ptua" class="level1">
<h1>Ptua</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_151255/tables/multi_way_interactions.csv</code></p>
</section>
<section id="peve" class="level1">
<h1>Peve</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_144034/tables/multi_way_interactions.csv</code></p>
</section>
<section id="apul" class="level1">
<h1>Apul</h1>
<p>Report: <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/reports/context_dependent_analysis_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/reports/context_dependent_analysis_report.html</a></p>
<p>Multiway Regulation: <code>https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/ConTra/output/context_dependent_analysis_20251108_140602/tables/multi_way_interactions.csv</code></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/58-contra-24/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_04-58-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>More Random Please</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/60-contra-random/</link>
  <description><![CDATA[ 






<section id="status" class="level3">
<h3 class="anchored" data-anchor-id="status">Status</h3>
<ul>
<li><strong>Randomization done</strong>: For each of cleaned_apul, cleaned_peve, and cleaned_ptua, the three requested files have been randomized:</li>
</ul>
<!-- -->
<ul>
<li><strong>Value ranges preserved</strong>:</li>
</ul>
<p>For each file, I computed the global numeric <strong>min/max</strong> and re-generated every numeric entry uniformly within that range.</p>
<p>Sparsity is roughly preserved by probabilistically setting some randomized values to zero using the original zero fraction.</p>
<p><strong>Summaries updated</strong>:</p>
<p>Features and Samples remain the same; Sparsity has been recomputed from the new randomized data (e.g., in cleaned_apul, lncrna sparsity is now <strong>3.76%</strong>, mirrored in both lncrna_counts_summary.txt and combined_summary.txt).</p>
<pre><code>python code/context_dependent_analysis.py --data-dir data/full-species-24-random/cleaned_apul </code></pre>
</section>
<section id="random-v-real" class="level1">
<h1>Random v Real</h1>
<p>TLDR</p>
<ul>
<li>Real data has much stronger baseline signal (especially for lncRNA‚Äìgene relationships: high R¬≤ and high correlations).</li>
<li>Interaction improvements and counts of ‚Äúcontext-dependent‚Äù pairs are similar or stronger in random data, for both methylation‚ÄìmiRNA and lncRNA‚ÄìmiRNA, and especially for lncRNA‚ÄìmiRNA.</li>
<li>Methylation‚ÄìmiRNA context_strength stands out as a metric where real &gt; random, while lncRNA‚ÄìmiRNA context_strength does not (and often random ‚â• real).</li>
</ul>
<hr>
<section id="where-empirical-fdr-shows-up" class="level3">
<h3 class="anchored" data-anchor-id="where-empirical-fdr-shows-up">Where empirical FDR shows up</h3>
<p>When you run with ‚Äìenable-empirical-fdr (and ‚Äìnull-replicates &gt; 0):</p>
<ul>
<li><strong>In the tables directory of that run</strong> (e.g.&nbsp;output/context_dependent_analysis_YYYYMMDD_HHMMSS/tables/), the file:</li>
</ul>
<!-- -->
<ul>
<li><strong>methylation_mirna_context.csv</strong> gets three extra columns:</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_threshold</strong>: the scalar context_strength threshold chosen for the run (same value in every row).</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_estimated</strong>: the estimated global FDR at that threshold (same in every row).</li>
</ul>
<!-- -->
<ul>
<li><strong>empirical_fdr_significant</strong>: <strong>True/False</strong> per interaction, indicating whether context_strength &gt;= empirical_fdr_threshold.</li>
</ul>
<hr>
</section>
<section id="overview" class="level3">
<h3 class="anchored" data-anchor-id="overview">Overview</h3>
<ul>
<li><strong>Real-data run</strong>: output/context_dependent_analysis_20251108_140602 using data/full-species-24/cleaned_apul.</li>
</ul>
<!-- -->
<ul>
<li><strong>Random-data run</strong>: output/context_dependent_analysis_20251119_071813 using data/full-species-24-random/cleaned_apul.</li>
</ul>
<!-- -->
<ul>
<li>Both runs did the same core analyses (methylation‚ÄìmiRNA context, lncRNA‚ÄìmiRNA context, multi-way interactions) and produced the same types of context tables and plots.</li>
</ul>
<hr>
</section>
<section id="sidebyside-numerical-comparison" class="level3">
<h3 class="anchored" data-anchor-id="sidebyside-numerical-comparison">Side‚Äëby‚Äëside numerical comparison</h3>
<section id="methylationmirna-context-methylation_mirna_context.csv" class="level4">
<h4 class="anchored" data-anchor-id="methylationmirna-context-methylation_mirna_context.csv">1. Methylation‚ÄìmiRNA context (methylation_mirna_context.csv)</h4>
<ul>
<li><strong>Number of pairs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 13,065 pairs</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 7,125 pairs</li>
</ul>
<!-- -->
<ul>
<li>So the random run considered roughly half as many context pairs (this is likely due to code/parameter differences, not biology).</li>
</ul>
<!-- -->
<ul>
<li><strong>Context-dependent interaction counts (from reports)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 1,464 context-dependent interactions (‚âà11% of all)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 1,152 context-dependent interactions (‚âà16% of all)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random actually has a higher fraction</strong> of pairs flagged as context-dependent.</li>
</ul>
<!-- -->
<ul>
<li><strong>Variance explained (R¬≤)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.392</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.481</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.502</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.345</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.406</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.437</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: Real data clearly has <strong>stronger overall predictive signal</strong> (higher R¬≤ at every stage).</li>
</ul>
<!-- -->
<ul>
<li><strong>Effect sizes / improvements</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_regulator2: <strong>0.089</strong></li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: <strong>0.021</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_regulator2: <strong>0.061</strong></li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: <strong>0.031</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Top interaction improvements</strong> (from reports):</li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> top 10: up to <strong>0.251</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> top 10: up to <strong>0.261</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Adding a second regulator boosts R¬≤ <strong>more in real data</strong> (+0.089 vs +0.061), consistent with real structure.</li>
</ul>
<!-- -->
<ul>
<li>The <strong>interaction term itself</strong> (improvement_from_interaction) is <strong>not smaller in random</strong>; in fact its mean is slightly <strong>larger in random</strong> (0.031 vs 0.021), with similar max values. So interaction ‚Äúgains‚Äù alone do <strong>not</strong> cleanly separate real vs random.</li>
</ul>
<!-- -->
<ul>
<li><strong>Context strength</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: mean context_strength <strong>0.321</strong> (p90 ‚âà 0.674, max ‚âà 1.843)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: mean context_strength <strong>0.255</strong> (p90 ‚âà 0.546, max ‚âà 1.323)</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: For methylation‚ÄìmiRNA, real data has <strong>moderately stronger context signals on average</strong>, but random still produces many pairs with non-trivial context_strength.</li>
</ul>
<hr>
</section>
<section id="lncrnamirna-context-lncrna_mirna_context.csv" class="level4">
<h4 class="anchored" data-anchor-id="lncrnamirna-context-lncrna_mirna_context.csv">2. lncRNA‚ÄìmiRNA context (lncrna_mirna_context.csv)</h4>
<ul>
<li><strong>Number of pairs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 13,065</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 7,125</li>
</ul>
<!-- -->
<ul>
<li><strong>Context-dependent interaction counts (from reports)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: 1,812 context-dependent interactions (‚âà14%)</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: 1,165 context-dependent interactions (‚âà16%)</li>
</ul>
<!-- -->
<ul>
<li>Again, <strong>similar absolute scale</strong>, with <strong>random slightly higher in proportion</strong>.</li>
</ul>
<!-- -->
<ul>
<li><strong>Variance explained (R¬≤)</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.716</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.739</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.751</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong> (means):</li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_only: <strong>0.288</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_regulator1_regulator2: <strong>0.359</strong></li>
</ul>
<!-- -->
<ul>
<li>r2_with_interaction: <strong>0.392</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: Huge separation here ‚Äî real data shows <strong>very strong baseline fits</strong> (R¬≤ ~0.72‚Äì0.75), while random is much weaker (~0.29‚Äì0.39). This is clear evidence that the overall lncRNA‚Äìgene relationships are real and not reproduced by randomization.</li>
</ul>
<!-- -->
<ul>
<li><strong>Effect sizes / improvements</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>:</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: mean <strong>0.012</strong>, p90 ‚âà 0.034, max ‚âà 0.231</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>:</li>
</ul>
<!-- -->
<ul>
<li>improvement_from_interaction: mean <strong>0.033</strong>, p90 ‚âà 0.087, max ‚âà 0.322</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>On <strong>random data</strong>, the <strong>interaction term looks stronger on average</strong> (higher mean, higher upper tail) than on real data.</li>
</ul>
<!-- -->
<ul>
<li>This strongly suggests that <strong>‚Äúinteraction improvements‚Äù on their own are not a clean signal of biology</strong>, and you can get quite substantial-looking interaction gains from noise.</li>
</ul>
<!-- -->
<ul>
<li><strong>Context strength</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: mean context_strength <strong>0.175</strong>, p90 ‚âà 0.381, max ‚âà 1.737</li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: mean context_strength <strong>0.265</strong>, p90 ‚âà 0.549, max ‚âà 1.306</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>: For lncRNA‚ÄìmiRNA, <strong>random data actually has larger average context_strength</strong> and more mass in the upper tail. So the context metric here is <strong>not uniquely elevated in real data</strong>.</li>
</ul>
<hr>
</section>
<section id="multi-way-interactions-multi_way_interactions.csv" class="level4">
<h4 class="anchored" data-anchor-id="multi-way-interactions-multi_way_interactions.csv">3. Multi-way interactions (multi_way_interactions.csv)</h4>
<ul>
<li><strong>Both runs</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Total genes analyzed</strong>: 100</li>
</ul>
<!-- -->
<ul>
<li><strong>Genes with significant interactions</strong>: <strong>0</strong> in both random and real runs.</li>
</ul>
<!-- -->
<ul>
<li><strong>Mean improvement from interactions</strong>:</li>
</ul>
<!-- -->
<ul>
<li><strong>Real</strong>: <strong>0.671</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Random</strong>: <strong>0.811</strong></li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation</strong>:</li>
</ul>
<!-- -->
<ul>
<li>The multi-way model produces <strong>substantial mean improvements</strong> in both datasets, even larger in the random run, yet <strong>none are called significant</strong> under your threshold.</li>
</ul>
<!-- -->
<ul>
<li>So the <strong>raw improvement metric alone is not discriminative</strong>, and the ‚Äúsignificant interactions‚Äù filter is what‚Äôs preventing you from calling many clearly-noisy multi-way effects.</li>
</ul>
<hr>
</section>
</section>
<section id="overlap-and-qualitative-patterns" class="level3">
<h3 class="anchored" data-anchor-id="overlap-and-qualitative-patterns">Overlap and qualitative patterns</h3>
<ul>
<li><strong>Top hits differ</strong>, but there is <strong>some gene overlap</strong> (e.g.&nbsp;FUN_028275, FUN_000398, FUN_040206 appear as top regulators in one or both runs), which suggests:</li>
</ul>
<!-- -->
<ul>
<li>Either those genes have generic properties (e.g.&nbsp;high variance, many regulators) that make them prone to being selected in many settings, or</li>
</ul>
<!-- -->
<ul>
<li>The pipeline‚Äôs ranking is influenced by structural aspects (feature counts, model behaviour) that can re-surface the same genes even on randomized expression.</li>
</ul>
<!-- -->
<ul>
<li><strong>File sizes and counts</strong> (e.g.&nbsp;context tables, correlation tables) differ between runs, but that‚Äôs mostly reflecting different filtering / setup rather than a biologically interpretable signal.</li>
</ul>
<hr>
</section>
<section id="interpretation-do-random-and-real-give-similar-results" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-do-random-and-real-give-similar-results">Interpretation: do random and real give ‚Äúsimilar‚Äù results?</h3>
<ul>
<li><strong>Where they are clearly different</strong>:</li>
</ul>
<!-- -->
<ul>
<li><strong>Real data shows much stronger base signal</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Higher R¬≤ for gene prediction from regulators (especially lncRNA‚ÄìmiRNA‚Äìgene, where real R¬≤ ‚âà 0.75 vs random ‚âà 0.39).</li>
</ul>
<!-- -->
<ul>
<li>Stronger, more consistent correlations (corr_high_regulator2, corr_low_regulator2 are ~0.6‚Äì0.8 in real vs near 0 on average in random).</li>
</ul>
<!-- -->
<ul>
<li>For methylation‚ÄìmiRNA, <strong>context_strength is somewhat higher in real</strong>.</li>
</ul>
<!-- -->
<ul>
<li><strong>Where they look surprisingly similar (or random looks ‚Äústronger‚Äù)</strong>:</li>
</ul>
<!-- -->
<ul>
<li>The <strong>number of context-dependent interactions</strong> is large in both and not dramatically reduced in random; the <strong>fraction of pairs flagged context-dependent is actually slightly higher in random</strong> for both context analyses.</li>
</ul>
<!-- -->
<ul>
<li><strong>Mean interaction improvements</strong> (improvement_from_interaction) and their upper tails are <strong>of the same order in real and random</strong>, and frequently <strong>larger in the random run</strong>, particularly for lncRNA‚ÄìmiRNA and multi-way models.</li>
</ul>
<!-- -->
<ul>
<li>Thus, <strong>raw interaction ‚Äúgain‚Äù and context_strength values alone can be generated by noise</strong>, and do not serve as a strong discriminator between real and randomized data.</li>
</ul>
<hr>
</section>
<section id="bottom-line" class="level3">
<h3 class="anchored" data-anchor-id="bottom-line">Bottom line</h3>
<ul>
<li><strong>Yes, the pipeline produces superficially similar-looking context-dependent interaction metrics on random data and real data</strong>: thousands of candidate interactions, similar or even larger mean interaction improvements and context_strengths, and comparable top effect sizes.</li>
</ul>
<!-- -->
<ul>
<li><strong>The main quantitative separation lives in the baseline fit quality (R¬≤ and correlations), not in the interaction metrics themselves.</strong> Real data has much stronger overall gene‚Äìregulator relationships, but the extra improvement attributed to context/interaction is not dramatically suppressed in the random run.</li>
</ul>
<!-- -->
<ul>
<li><strong>Interpretation-wise</strong>, this suggests that <strong>context-dependent interaction scores require a proper null/thresholding strategy (e.g.&nbsp;empirical FDR vs randomizations)</strong>; taken at face value, they are not by themselves strong evidence of biology because similar magnitudes arise from randomized data.</li>
</ul>
</section>
</section>
<section id="what-is-contra-doing" class="level1">
<h1>What is Contra Doing?</h1>
<section id="highlevel-idea" class="level3">
<h3 class="anchored" data-anchor-id="highlevel-idea">High‚Äëlevel idea</h3>
<p><strong>context_dependent_analysis.py is a pipeline that asks:</strong></p>
<p>‚ÄúFor each gene, do its regulators (miRNAs, lncRNAs, DNA methylation sites) affect it differently in different contexts (e.g., when a regulator is high vs low)?‚Äù</p>
<p>It takes the four matched datasets (genes, lncRNAs, miRNAs, methylation), runs a lot of regression and correlation models in parallel, and then writes out tables and plots summarizing which interactions look context‚Äëdependent.</p>
<hr>
</section>
<section id="step-1-load-and-align-the-omics-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-load-and-align-the-omics-data">Step 1 ‚Äì Load and align the omics data</h3>
<ul>
<li><strong>Loads four matrices</strong> from gene_counts_cleaned.csv, lncrna_counts_cleaned.csv, mirna_counts_cleaned.csv, wgbs_counts_cleaned.csv.</li>
</ul>
<!-- -->
<ul>
<li>Rows = features (genes, lncRNAs, miRNAs, CpGs)</li>
</ul>
<!-- -->
<ul>
<li>Columns = the same 40 samples.</li>
</ul>
<!-- -->
<ul>
<li><strong>Checks that sample IDs match across all four</strong>, so everything is aligned per sample.</li>
</ul>
<!-- -->
<ul>
<li>Stores convenient arrays so it can do fast, parallel calculations.</li>
</ul>
<hr>
</section>
<section id="step-2-methylationmirnagene-context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-2-methylationmirnagene-context-analysis">Step 2 ‚Äì Methylation‚ÄìmiRNA‚Äìgene context analysis</h3>
<p>For <strong>each gene</strong>:</p>
<ul>
<li><strong>Finds top‚Äëcorrelated miRNAs and CpG sites</strong> with that gene (using Pearson correlation, keeping only those with somewhat small p‚Äëvalues).</li>
</ul>
<!-- -->
<ul>
<li>For each <strong>gene‚ÄìmiRNA‚ÄìCpG trio</strong>, it fits three regression models:</li>
</ul>
<ol type="1">
<li>Gene ~ methylation</li>
</ol>
<!-- -->
<ol type="1">
<li>Gene ~ methylation + miRNA</li>
</ol>
<!-- -->
<ol type="1">
<li>Gene ~ methylation + miRNA + (methylation √ó miRNA interaction term)</li>
</ol>
<ul>
<li>It then <strong>asks whether including the interaction term significantly improves the model fit</strong> (using an F‚Äëtest).</li>
</ul>
<!-- -->
<ul>
<li>If yes, it flags that <strong>the effect of methylation on the gene depends on miRNA level</strong> (context‚Äëdependent regulation).</li>
</ul>
<!-- -->
<ul>
<li>It also <strong>splits samples into ‚Äúhigh miRNA‚Äù vs ‚Äúlow miRNA‚Äù</strong> and compares the methylation‚Äìgene correlation in those two groups, to quantify how strong and in which direction the context effect is.</li>
</ul>
<p>All results are collected into a big table (one row per trio).</p>
<hr>
</section>
<section id="step-3-lncrnamirnagene-context-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-3-lncrnamirnagene-context-analysis">Step 3 ‚Äì lncRNA‚ÄìmiRNA‚Äìgene context analysis</h3>
<p>This is analogous to Step 2, but now:</p>
<ul>
<li><strong>Regulator1 = lncRNA</strong>, <strong>Regulator2 = miRNA</strong> for each gene.</li>
</ul>
<!-- -->
<ul>
<li>Same workflow: pick top regulators, fit 3 nested models, test whether <strong>lncRNA‚Äôs effect on the gene depends on miRNA level</strong>, and compare correlations in high vs low miRNA contexts.</li>
</ul>
<!-- -->
<ul>
<li>Produces another large table describing <strong>lncRNA‚ÄìmiRNA‚Äìgene</strong> context‚Äëdependent interactions.</li>
</ul>
<hr>
</section>
<section id="step-4-multiway-regulatory-interactions" class="level3">
<h3 class="anchored" data-anchor-id="step-4-multiway-regulatory-interactions">Step 4 ‚Äì Multi‚Äëway regulatory interactions</h3>
<p>For a subset or all genes (depending on script version):</p>
<ul>
<li>For each gene, <strong>collects a set of top regulators</strong> (a mix of miRNAs, lncRNAs, and methylation sites that correlate with the gene).</li>
</ul>
<!-- -->
<ul>
<li>Builds two models:</li>
</ul>
<!-- -->
<ul>
<li><strong>Base model</strong>: gene ~ the strongest single regulator.</li>
</ul>
<!-- -->
<ul>
<li><strong>Full model</strong>: gene ~ all selected regulators together.</li>
</ul>
<!-- -->
<ul>
<li>Tests whether <strong>adding all these regulators significantly improves the explanation of gene expression</strong>, again via a model comparison (F‚Äëtest).</li>
</ul>
<!-- -->
<ul>
<li>This highlights genes with <strong>complex, multi‚Äëregulator control</strong> (many regulators acting together, not just one).</li>
</ul>
<hr>
</section>
<section id="step-5-contextspecific-networks-highlow-regulator-states" class="level3">
<h3 class="anchored" data-anchor-id="step-5-contextspecific-networks-highlow-regulator-states">Step 5 ‚Äì ‚ÄúContext‚Äëspecific networks‚Äù (high/low regulator states)</h3>
<p>The script defines simple contexts like:</p>
<ul>
<li><strong>High miRNA</strong>, <strong>low miRNA</strong>, <strong>high methylation</strong>, based on z‚Äëscored levels of a ‚Äúsentinel‚Äù miRNA or CpG across samples.</li>
</ul>
<p>For each context:</p>
<ul>
<li>Subsets samples that fall into that context (e.g., high miRNA).</li>
</ul>
<!-- -->
<ul>
<li>Within that subset, <strong>recalculates correlations</strong>:</li>
</ul>
<!-- -->
<ul>
<li>gene‚ÄìmiRNA</li>
</ul>
<!-- -->
<ul>
<li>gene‚ÄìlncRNA</li>
</ul>
<!-- -->
<ul>
<li>gene‚Äìmethylation</li>
</ul>
<!-- -->
<ul>
<li>This gives <strong>context‚Äëspecific correlation networks</strong>, showing which regulatory edges are present when, say, a particular miRNA or CpG is high vs low.</li>
</ul>
<hr>
</section>
<section id="step-6-outputs-plots-and-reports" class="level3">
<h3 class="anchored" data-anchor-id="step-6-outputs-plots-and-reports">Step 6 ‚Äì Outputs, plots, and reports</h3>
<p>Finally, the script:</p>
<ul>
<li><strong>Saves all result tables</strong> (interactions, p‚Äëvalues, context strength, etc.) as CSVs in an output/‚Ä¶/tables folder.</li>
</ul>
<!-- -->
<ul>
<li><strong>Generates plots</strong>:</li>
</ul>
<!-- -->
<ul>
<li>Distributions of ‚Äúinteraction improvement‚Äù (how much the interaction term helps).</li>
</ul>
<!-- -->
<ul>
<li>Distributions of context strength.</li>
</ul>
<!-- -->
<ul>
<li>Bar charts summarizing how many edges of each type exist in each context.</li>
</ul>
<!-- -->
<ul>
<li><strong>Produces Markdown and HTML reports</strong> that summarize:</li>
</ul>
<!-- -->
<ul>
<li>How many interactions were tested.</li>
</ul>
<!-- -->
<ul>
<li>How many look context‚Äëdependent.</li>
</ul>
<!-- -->
<ul>
<li>Top examples for each interaction type.</li>
</ul>
<!-- -->
<ul>
<li>Links to the generated CSV files.</li>
</ul>
<hr>
</section>
<section id="in-biologist-terms" class="level3">
<h3 class="anchored" data-anchor-id="in-biologist-terms">In biologist terms</h3>
<ul>
<li>Think of it as an <strong>automatic screen for context‚Äëdependent regulation</strong> across all genes and all regulators you have.</li>
</ul>
<!-- -->
<ul>
<li>It‚Äôs looking for cases where <strong>‚Äúregulator A only affects gene X when regulator B is high (or low)‚Äù</strong>, and formalizes that with regression models, significance tests, and context‚Äëspecific networks.</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/60-contra-random/</guid>
  <pubDate>Thu, 13 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-13_05-28-34.png" medium="image" type="image/png"/>
</item>
<item>
  <title>More Sparsity?</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/57-barnacle-35opt/</link>
  <description><![CDATA[ 





<p>Based on overlap of genes across components wanted to increase sparsity be increasing lambda-gene values..</p>
<p>Ran with multiple values</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDAS_GENE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.00 0.01 0.05 0.1 0.2 0.4 0.8"</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_SAMPLE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.1</span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">LAMBDA_TIME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>0.05</span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">RANK</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>35</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR_BASE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>../output/26-rank35-optimization</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> LG <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDAS_GENE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-10">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUTDIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTDIR_BASE}</span>/lambda_gene_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${LG}</span></span>
<span id="cb1-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-12"></span>
<span id="cb1-13">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/Users/sr320/.local/bin/uv</span> run python ../scripts/14.1-barnacle/build_tensor_and_run.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--input-file</span> ../output/14-pca-orthologs/vst_counts_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output-dir</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$OUTDIR</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--rank</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$RANK</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-gene</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LG</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-sample</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_SAMPLE</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--lambda-time</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$LAMBDA_TIME</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-iter</span> 2000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--tol</span> 1e-5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--seed</span> 81</span>
<span id="cb1-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-05_14-01-07.png" class="img-fluid"></p>
<p>Move forward with lamda_gene of 0.2‚Ä¶</p>
<section id="sample" class="level1">
<h1>Sample</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-16-18.png" class="img-fluid"></p>
</section>
<section id="time" class="level1">
<h1>Time</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File path</span></span>
<span id="cb2-4">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/barnacle_factors/time_factors.csv"</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read data</span></span>
<span id="cb2-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute variance of each component across timepoints</span></span>
<span id="cb2-10">var_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb2-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb2-13">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(Component) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Variance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">var</span>(Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(Variance))</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select top 10 most variable components</span></span>
<span id="cb2-19">top10_components <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_components <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(Variance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(Component)</span>
<span id="cb2-20"></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare data for plotting</span></span>
<span id="cb2-22">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb2-24">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb2-25">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> top10_components)</span>
<span id="cb2-27"></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line plot</span></span>
<span id="cb2-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> OG_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> Component, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Component)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb2-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Top 10 Most Variable Components Across Timepoints"</span>,</span>
<span id="cb2-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb2-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component Value"</span></span>
<span id="cb2-38">  )</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-18-17.png" class="img-fluid"></p>
</section>
<section id="pick-your-component" class="level1">
<h1>Pick your component</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File path</span></span>
<span id="cb3-4">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/barnacle_factors/time_factors.csv"</span></span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- USER INPUT ----</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick the component you want to plot (e.g., "Component_5")</span></span>
<span id="cb3-8">selected_component <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_24"</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------</span></span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read data</span></span>
<span id="cb3-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb3-13"></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to long format</span></span>
<span id="cb3-15">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component_"</span>),</span>
<span id="cb3-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>,</span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span></span>
<span id="cb3-20">  )</span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check that the chosen component exists</span></span>
<span id="cb3-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(selected_component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(df_long<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Component))) {</span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Component"</span>, selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not found in data!"</span>))</span>
<span id="cb3-25">}</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the selected component</span></span>
<span id="cb3-28">df_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(Component <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> selected_component)</span>
<span id="cb3-29"></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot single component across timepoints</span></span>
<span id="cb3-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_sel, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> OG_ID, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"steelblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(selected_component, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Across Timepoints"</span>),</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Time Point"</span>,</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Loading Value"</span></span>
<span id="cb3-40">  )</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-20-36.png" class="img-fluid"></p>
</section>
<section id="gene-factor-loading" class="level1">
<h1>Gene Factor Loading</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-21-34.png" class="img-fluid"></p>
</section>
<section id="annotation" class="level1">
<h1>Annotation</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/testddd.png" class="img-fluid"></p>
</section>
<section id="an-annotation---u-pick" class="level1">
<h1>An Annotation - U pick!</h1>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(pheatmap)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- File path ----</span></span>
<span id="cb4-5">file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/26-rank35-optimization/lambda_gene_0.2/top_genes_per_component/goslim_term_counts.csv"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change to your actual CSV path</span></span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- User input ----</span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Enter one or more GO terms (exact or partial match)</span></span>
<span id="cb4-9">selected_terms <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"protein catabolic process"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lipid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"immune system process"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"carbohydrate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"antioxidant activity"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mitochondrion"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inflammatory response"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reproductive"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Options ----</span></span>
<span id="cb4-12">row_normalize <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># TRUE for row-normalized (z-score), FALSE for raw</span></span>
<span id="cb4-13">log_transform <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># TRUE to apply log10(x+1) before plotting</span></span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Load and prepare data ----</span></span>
<span id="cb4-16">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file_path)</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove total column if present</span></span>
<span id="cb4-19">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any_of</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total"</span>))</span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter by GO term (partial match supported)</span></span>
<span id="cb4-22">df_sel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_any</span>(term, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(.x, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(selected_terms, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>))))</span>
<span id="cb4-24"></span>
<span id="cb4-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df_sel) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"‚ö†Ô∏è No matching GO terms found. Check spelling or capitalization."</span>)</span>
<span id="cb4-27">}</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to matrix</span></span>
<span id="cb4-30">mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_sel <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"term"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>()</span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional log-transform</span></span>
<span id="cb4-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (log_transform) {</span>
<span id="cb4-36">  mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log10</span>(mat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-37">}</span>
<span id="cb4-38"></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional row normalization</span></span>
<span id="cb4-40"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (row_normalize) {</span>
<span id="cb4-41">  mat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">t</span>(mat)))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># z-score per row</span></span>
<span id="cb4-42">}</span>
<span id="cb4-43"></span>
<span id="cb4-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---- Plot heatmap ----</span></span>
<span id="cb4-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pheatmap</span>(</span>
<span id="cb4-46">  mat,</span>
<span id="cb4-47">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colorRampPalette</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firebrick3"</span>))(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb4-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clustering_method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>,</span>
<span id="cb4-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show_rownames =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(</span>
<span id="cb4-52">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GO Term Heatmap ‚Äî"</span>,</span>
<span id="cb4-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (row_normalize) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Row-normalized"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Raw values"</span>,</span>
<span id="cb4-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (log_transform) <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(log10)"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb4-55">  )</span>
<span id="cb4-56">)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Image_2025-11-06_07-25-48.png" class="img-fluid"></p>


<!-- -->

</section>

 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/57-barnacle-35opt/</guid>
  <pubDate>Wed, 05 Nov 2025 08:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-05_13-57-12.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Deep Dive on Rank 35</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/56-barnacle/</link>
  <description><![CDATA[ 





<p>Sam had run a series of ranks to see which one was most appropriate. Specifically he ran from 5-75.</p>
<p>It looks like 35 is where we go forward</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-13-35.png" class="img-fluid"></p>
<ul>
<li>‚Ä¢ Gene sparsity increases sharply after rank 35.</li>
</ul>
<hr>
<p>Heatmaps at 35</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-30-11.png" class="img-fluid"></p>
<p>Figures for all ranks can be seen at <a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/scripts/22-Visualizing-Rank-outs.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/timeseries_molecular/M-multi-species/scripts/22-Visualizing-Rank-outs.html</a></p>
<p>Comparison of GO terms</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-46-24.png" class="img-fluid"> Full report:</p>
<p>Key Findings The top 5 biological processes across all rank 35 components are:<br>
- Innate immune response - 80 occurrences across 27 components.<br>
- Proteolysis - 79 occurrences across 25 components.<br>
- Positive regulation of gene expression - 78 occurrences across 27 components.<br>
- Defense response to Gram-negative bacterium - 76 occurrences across 30 components.<br>
- Positive regulation of transcription by RNA polymerase II - 76 occurrences across 21 components.</p>
<p>Some of this is part is driven by Group IDs in multiple components</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-55-02.png" class="img-fluid"></p>


<!-- -->


 ]]></description>
  <category>e5</category>
  <category>barnacle</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/56-barnacle/</guid>
  <pubDate>Sun, 02 Nov 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-02_09-06-29.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Lets talk Cod</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/55-cod-talk/</link>
  <description><![CDATA[ 





<p>The directory <code>/volume1/web/nightingales/G_macrocephalus</code> contains seven sequencing projects, each representing a distinct Azenta sequencing batch or data delivery. The projects vary in size and file-naming conventions but consistently use paired-end FASTQ/FQ files with clear sample identifiers. Two projects (30-1067895835, 30-1149633765) are earlier batches, while others correspond to newer Azenta runs (<code>AN00025267</code>, <code>AN00025268</code>, <code>H202SC23041287</code>).</p>
<ul>
<li><strong>30-1067895835</strong> ‚Äî Single-sample pilot sequencing set (<code>1D11</code>), paired-end reads, includes Azenta report.<br>
</li>
<li><strong>30-1149633765</strong> ‚Äî Large-scale sequencing project (<code>EXP###</code>, <code>MHW###</code> prefixes), paired-end reads with checksums and HTML report.<br>
</li>
<li><strong>30-1149634506</strong> ‚Äî Moderate batch (<code>ET##</code> prefix), paired-end reads with standard naming and report.<br>
</li>
<li><strong>30-943133806</strong> ‚Äî Mixed sample identifiers (e.g., <code>19-G</code>, <code>RESUB-###</code>), includes supplemental folder and Azenta report.<br>
</li>
<li><strong>AN00025267 / AN00025268</strong> ‚Äî Consistent naming (<code>##B_1.fastq.gz</code> / <code>_2.fastq.gz</code>), likely replicate or continuation projects.<br>
</li>
<li><strong>H202SC23041287</strong> ‚Äî Deeply nested structure (<code>GM##</code> samples, multiple lanes per run), each sample has multiple files and MD5 checksums.</li>
</ul>
<hr>
<section id="section" class="level1">
<h1>30-1067895835</h1>
<p><strong>30-1067895835</strong> is test aging sample, noting there are also some comparable shark sample(s). refers to WGBS from a single cod fin clip (experimental cod with ‚Äúgenetic sampling count‚Äù = 84 from <a href="https://github.com/RobertsLab/project-cod-temperature/blob/main/data/temp-experiment.csv">this table</a> - that cod was held at 9C).</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 18%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Project</th>
<th>Sample ID</th>
<th>Barcode Sequence</th>
<th># Reads</th>
<th>Yield (Mbases)</th>
<th>Mean Quality Score</th>
<th>% Bases &gt;= 30</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30-1067895835</td>
<td>1D11</td>
<td>CAACACAG+TGGCTATC</td>
<td>47,537,334</td>
<td>14,261</td>
<td>37.27</td>
<td>87.02</td>
</tr>
</tbody>
</table>
<p>Direct links - <code>https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1067895835/1D11_R1_001.fastq.gz</code> - <code>https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1067895835/1D11_R2_001.fastq.gz</code></p>
<hr>
</section>
<section id="an00025267-an00025268" class="level1">
<h1>AN00025267 / AN00025268</h1>
<p><strong>AN00025267 / AN00025268</strong> are paired RNA-seq / WGBS samples. Samples 1-36 are blood from cod held at 16C and samples 44-74 are blood from cod held at 0C. Note we also have lcWGS (~3x depth, a few samples higher) for the same cod individuals, should we want to, say, compare SNPs pulled from WGBS and lcWGS, or do a similar genetic + epigenetic variation paper (like the Silliman &amp; Spencer Oly paper).</p>
<section id="an00025267" class="level2">
<h2 class="anchored" data-anchor-id="an00025267">AN00025267</h2>
<p>Link to <strong>AN00025267</strong> report:</p>
<p><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/202508_AN00025267_Report/report.html" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/202508_AN00025267_Report/report.html</a></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-07-03.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-08-09.png" width="50%"></p>
<p>Link to data - <a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025267/</a></p>
<hr>
</section>
<section id="an00025268" class="level2">
<h2 class="anchored" data-anchor-id="an00025268">AN00025268</h2>
<p>Link to Report</p>
<p><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/202508_AN00025268_Report/report.html" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/202508_AN00025268_Report/report.html</a></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-16-46.png" width="75%"></p>
<p>Link to data</p>
<ul>
<li><a href="https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/" class="uri">https://owl.fish.washington.edu/nightingales/G_macrocephalus/AN00025268/</a></li>
</ul>
<hr>
</section>
</section>
<section id="genome" class="level1">
<h1>Genome</h1>
<p><a href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_031168955.1/" class="uri">https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_031168955.1/</a></p>
<hr>
</section>
<section id="larger-effort" class="level1">
<h1>Larger Effort</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 4%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 45%">
<col style="width: 7%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Project</th>
<th>Type</th>
<th style="text-align: right;">Unique samples</th>
<th style="text-align: right;">FASTQ/FQ files</th>
<th>Naming schema</th>
<th>Examples</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>30-943133806</td>
<td>RNA-seq</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">160</td>
<td><code>NN[_SUFFIX]_R{1,2}_001.fastq.gz</code>, <code>RESUB-###_R{1,2}_001.fastq.gz</code></td>
<td><code>100_R1_001.fastq.gz</code>, <code>19-G_R1_001.fastq.gz</code>, <code>RESUB-76_R1_001.fastq.gz</code></td>
<td>Complete - WGCNA analysis identified temperature-responsive genes (0, 5, 9, 16C)</td>
</tr>
<tr class="even">
<td>H202SC23041287</td>
<td>lcWGS</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">314*</td>
<td><code>GM##_*_{1,2}.fq.gz</code> (sample <code>GM##</code>, multiple lanes/runs)</td>
<td><code>GM1_CKDN230011839-1A_H5NNGDSX7_L1_1.fq.gz</code></td>
<td>Complete - Population assignment, RDA, GWAS, eQTL analyses</td>
</tr>
<tr class="odd">
<td>30-1149633765</td>
<td>WGS</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">700</td>
<td><code>EXP###_R{1,2}_001.fastq.gz</code>, <code>MHW###_R{1,2}_001.fastq.gz</code></td>
<td><code>EXP001_R1_001.fastq.gz</code>, <code>MHW001_R1_001.fastq.gz</code></td>
<td>In progress - heatwave genetics study (2008-2023) + experimental resequencing</td>
</tr>
<tr class="even">
<td>30-1149634506</td>
<td>WGS</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">32</td>
<td><code>ET##_R{1,2}_001.fastq.gz</code></td>
<td><code>ET22_R1_001.fastq.gz</code></td>
<td>In progress - pilot ecotype sequencing (shallow/deep)</td>
</tr>
<tr class="odd">
<td>AN00025267**</td>
<td>BS-seq</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">64</td>
<td><code>##B_{1,2}.fastq.gz</code> (paired reads as <code>_1</code>/<code>_2</code>)</td>
<td><code>01B_1.fastq.gz</code>, <code>01B_2.fastq.gz</code></td>
<td>In progress - nf-core/methylseq pipeline (17.nextflow)</td>
</tr>
<tr class="even">
<td>AN00025268**</td>
<td>BS-seq</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">64</td>
<td><code>##B_{1,2}.fastq.gz</code> (paired reads as <code>_1</code>/<code>_2</code>)</td>
<td><code>01B_1.fastq.gz</code>, <code>01B_2.fastq.gz</code></td>
<td>Planned</td>
</tr>
<tr class="odd">
<td>30-1067895835**</td>
<td>WGBS</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td><code>SAMPLE_R{1,2}_001.fastq.gz</code></td>
<td><code>1D11_R1_001.fastq.gz</code></td>
<td>trial WGBS for Pacific cod methylation and depth, in progress</td>
</tr>
</tbody>
</table>
<section id="key-results-to-date" class="level3">
<h3 class="anchored" data-anchor-id="key-results-to-date">Key Results to Date</h3>
<ul>
<li><strong>RNA-seq differential expression</strong>: Weighted gene correlation network analysis (WGCNA) identified genes expressed in the liver that are temperature-responsive, and those that correlate with juvenile cod performance (e.g.&nbsp;liver lipid content) within temperatures, particularly warming.<br>
</li>
<li><strong>Gene ontology enrichment</strong>: GO term enrichment analysis performed using DAVID on DEGs.</li>
<li><strong>Population genetics</strong>: lcWGS data analyzed to assign experimental fish to known Pacific cod spawning populations using WGSassign, PCA, which indicated that all were from the GOA spawning aggregation. Redundancy analysis (RDA) indicated that genetic variation associated with GOA populations (eGOA, wGOA) was not strongly linked to phenotypic responses in warming (16C), while there was some evidence for population-associated variation in cold acclimation (e.g.&nbsp;polar lipid concentrations). Additional genetic structure (within the wGOA population) existed that was not associated with the wGOA and eGOA populations that correlated with trait variation.</li>
<li><strong>Genome-Wide Association Study (GWAS)</strong>: lcWGS data paired with per-individual traits (growth, condition, liver lipid content) measured across four temperatures (0-16C) identified genetic variants associated with trait variation.<br>
</li>
<li><strong>Growth and physiology</strong>: Significant treatment effects observed on growth rates (SGRww, SGRsl), condition indices (Kwet, HSI), and liver lipid composition. Temperature-dependent models were constructed.</li>
</ul>


<!-- -->

</section>
</section>

 ]]></description>
  <category>cod</category>
  <category>methylation</category>
  <category>RNA-seq</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/55-cod-talk/</guid>
  <pubDate>Sat, 01 Nov 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_06-14-45.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Lake Trout PacBio Data</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/54-lake-trout-QC/</link>
  <description><![CDATA[ 





<p>PacBio data came from Wisconsin</p>
<p>Raw data at <a href="https://owl.fish.washington.edu/nightingales/S_namaycush/LakeTrout/" class="uri">https://owl.fish.washington.edu/nightingales/S_namaycush/LakeTrout/</a></p>
<p>have 4 lean and 4 siscowets</p>
<p>they were run in three pools</p>
<p>Pool 1.</p>
<p>Lean FA047 bc2041 TATGATCACTGAGTAT.<br>
Siscowet FA097 bc2071 CGAGTCTAGCGAGTAT.<br>
Siscowet FA099 bc2072 TATCAGTAGTGAGTAT.</p>
<p>Pool 2.</p>
<p>Lean FA094 bc2069 TCTATGACATGAGTAT.<br>
Lean FA095 bc2070 TACTGCTCACGAGTAT.<br>
Siscowet FA100 bc2073 ATCACTAGTCGAGTAT.</p>
<p>Pool 3.</p>
<p>Lean FA092 - bc2068 ACTACGTGATGAGTAT.<br>
Siscowet FA253 - bc2096 ATGTACTAGTGAGTAT.</p>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">TLDR</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Type</th>
<th>Sample ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lean</td>
<td>bc2041</td>
</tr>
<tr class="even">
<td>Lean</td>
<td>bc2068</td>
</tr>
<tr class="odd">
<td>Lean</td>
<td>bc2069</td>
</tr>
<tr class="even">
<td>Lean</td>
<td>bc2070</td>
</tr>
<tr class="odd">
<td>Siscowet</td>
<td>bc2071</td>
</tr>
<tr class="even">
<td>Siscowet</td>
<td>bc2072</td>
</tr>
<tr class="odd">
<td>Siscowet</td>
<td>bc2073</td>
</tr>
<tr class="even">
<td>Siscowet</td>
<td>bc2096</td>
</tr>
</tbody>
</table>
<p>Fastq files @ https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/data/pacbio-reads/fastq2/</p>
<hr>
<p>The first two pools arrived as Bams, and Sam demultiplexed. <a href="https://robertslab.github.io/sams-notebook/posts/2025/2025-10-23-Demultiplexing---S.namaychush-PacBio-Sequencing-Using-Lima/" class="uri">https://robertslab.github.io/sams-notebook/posts/2025/2025-10-23-Demultiplexing---S.namaychush-PacBio-Sequencing-Using-Lima/</a></p>
<p>The third pool arrived demultiplexed.</p>
<p>Sam generated corresponding fastq files</p>
<hr>
</section>
<section id="nanoplot" class="level2">
<h2 class="anchored" data-anchor-id="nanoplot">NanoPlot</h2>
<p>For each of the 8 files ran</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/envs/nanoplot_env/bin/NanoPlot</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-2">-t 40 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-3">--fastq ../data/pacbio-reads/fastq2/m84082_250614_101514_s4.hifi_reads.demux.bc2069--bc2069.fastq.gz <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-4">-o ../analyses/08-nanoplot/bc2069 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-5">--prefix bc2069_</span></code></pre></div>
<p>which created</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_05-31-35.png" class="img-fluid"></p>
</section>
<section id="multiqc" class="level2">
<h2 class="anchored" data-anchor-id="multiqc">MultiQC</h2>
<p>after all were complete ran multiqc</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">multiqc</span> ../analyses/08-nanoplot/ <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../analyses/08-multiqc</span></code></pre></div>
<p><a href="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html" class="uri">https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html</a></p>
<hr>
<iframe src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-lake-trout/analyses/08-multiqc/multiqc_report.html" width="100%" height="800px" style="border:none;">
</iframe>


<!-- -->

</section>

 ]]></description>
  <category>lake trout</category>
  <category>methylation</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/54-lake-trout-QC/</guid>
  <pubDate>Mon, 27 Oct 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/2025-11-01_05-35-03.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Ortholog Selection for Physiological Processes</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/53-ortho-select/</link>
  <description><![CDATA[ 





<section id="ortho-select" class="level1">
<h1>13-ortho-select</h1>
<p>TLDR: <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/13-ortho-select/selected_orthologs.csv" class="uri">https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/13-ortho-select/selected_orthologs.csv</a></p>
<section id="overview-of-annotated-orthologs" class="level2">
<h2 class="anchored" data-anchor-id="overview-of-annotated-orthologs">Overview of Annotated Orthologs</h2>
<p>First, let‚Äôs examine the annotated ortholog data from the previous analysis:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/11-orthology-analysis/ortholog_groups.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity
OG_00001,FUN_000185-T1,Peve_00037402,Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,three_way,71.059
OG_00002,FUN_000189-T1,Peve_00038462,Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,three_way,68.72583333333334
OG_00003,FUN_000190-T1,Peve_00038463,Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,three_way,55.1975
OG_00004,FUN_000191-T1,Peve_00038464,Pocillopora_meandrina_HIv1___RNAseq.g28890.t1,three_way,72.047
OG_00005,FUN_000192-T1,Peve_00038466,Pocillopora_meandrina_HIv1___RNAseq.g28893.t1,three_way,81.15866666666666
OG_00006,FUN_000193-T1,Peve_00038467,Pocillopora_meandrina_HIv1___RNAseq.g28894.t1,three_way,70.21933333333334
OG_00007,FUN_000194-T1,Peve_00038470,Pocillopora_meandrina_HIv1___RNAseq.g28898.t1,three_way,77.11833333333334
OG_00008,FUN_000195-T1,Peve_00038471,Pocillopora_meandrina_HIv1___RNAseq.g28899.t1,three_way,68.38
OG_00009,FUN_000197-T1,Peve_00027182,Pocillopora_meandrina_HIv1___RNAseq.g28901.t1,three_way,56.498333333333335</code></pre>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/11-orthology-analysis/ortholog_groups.csv</span></code></pre></div>
<pre><code>18327 ../output/11-orthology-analysis/ortholog_groups.csv</code></pre>
</section>
<section id="annotated-orthologs" class="level2">
<h2 class="anchored" data-anchor-id="annotated-orthologs">Annotated Orthologs</h2>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity,query,accession,id,reviewed,protein_name,organism,pident,length,evalue,bitscore,title,go_ids,go_bp,go_cc,go_mf,goslim_ids,goslim_names
OG_00001,FUN_000185-T1,Peve_00037402,Pocillopora_meandrina_HIv1___RNAseq.g28886.t1,three_way,71.059,FUN_000185-T1,Q32LQ0,AMPE_BOVIN,,Glutamyl aminopeptidase (EAP) (EC 3.4.11.7) (Aminopeptidase A) (AP-A) (CD antigen CD249),Bos taurus (Bovine),41.5,881.0,1.4e-197,691.4,sp|Q32LQ0|AMPE_BOVIN Glutamyl aminopeptidase OS=Bos taurus OX=9913 GN=ENPEP PE=2 SV=1,GO:0003081; GO:0004177; GO:0004230; GO:0005615; GO:0005737; GO:0005886; GO:0006508; GO:0008217; GO:0008270; GO:0008283; GO:0016477; GO:0042277; GO:0043171; GO:0070006,cell migration [GO:0016477]; cell population proliferation [GO:0008283]; peptide catabolic process [GO:0043171]; proteolysis [GO:0006508]; regulation of blood pressure [GO:0008217]; regulation of systemic arterial blood pressure by renin-angiotensin [GO:0003081],cytoplasm [GO:0005737]; extracellular space [GO:0005615]; plasma membrane [GO:0005886],aminopeptidase activity [GO:0004177]; glutamyl aminopeptidase activity [GO:0004230]; metalloaminopeptidase activity [GO:0070006]; peptide binding [GO:0042277]; zinc ion binding [GO:0008270],GO:0003824; GO:0005615; GO:0005886; GO:0016787; GO:0048870; GO:0050886; GO:0140096,"catalytic activity; extracellular space; plasma membrane; hydrolase activity; cell motility; endocrine process; catalytic activity, acting on a protein"
OG_00002,FUN_000189-T1,Peve_00038462,Pocillopora_meandrina_HIv1___RNAseq.g28888.t3,three_way,68.72583333333334,FUN_000189-T1,Q9DCT6,,,,,38.0,171.0,4.6e-18,92.8,sp|Q9DCT6|BAP18_MOUSE BPTF-associated chromatin complex component 1 OS=Mus musculus OX=10090 GN=Bacc1 PE=1 SV=1,,,,,,
OG_00003,FUN_000190-T1,Peve_00038463,Pocillopora_meandrina_HIv1___RNAseq.g28889.t1,three_way,55.1975,,,,,,,,,,,,,,,,,
OG_00004,FUN_000191-T1,Peve_00038464,Pocillopora_meandrina_HIv1___RNAseq.g28890.t1,three_way,72.047,FUN_000191-T1,Q95108,,,,,44.1,136.0,3.3e-29,129.4,"sp|Q95108|THIOM_BOVIN Thioredoxin, mitochondrial OS=Bos taurus OX=9913 GN=TXN2 PE=1 SV=2",,,,,,
OG_00005,FUN_000192-T1,Peve_00038466,Pocillopora_meandrina_HIv1___RNAseq.g28893.t1,three_way,81.15866666666666,FUN_000192-T1,Q1LWX3,,,,,54.3,188.0,3.5e-53,209.5,sp|Q1LWX3|NTAQ1_DANRE Protein N-terminal glutamine amidohydrolase OS=Danio rerio OX=7955 GN=ntaq1 PE=2 SV=1,,,,,,
OG_00006,FUN_000193-T1,Peve_00038467,Pocillopora_meandrina_HIv1___RNAseq.g28894.t1,three_way,70.21933333333334,FUN_000193-T1,Q5I0K7,,,,,53.2,158.0,3.4e-41,169.5,sp|Q5I0K7|ALG13_RAT UDP-N-acetylglucosamine transferase subunit ALG13 OS=Rattus norvegicus OX=10116 GN=Alg13 PE=1 SV=1,,,,,,
OG_00007,FUN_000194-T1,Peve_00038470,Pocillopora_meandrina_HIv1___RNAseq.g28898.t1,three_way,77.11833333333334,FUN_000194-T1,P70182,,,,,60.2,447.0,3.4e-147,523.5,sp|P70182|PI51A_MOUSE Phosphatidylinositol 4-phosphate 5-kinase type-1 alpha OS=Mus musculus OX=10090 GN=Pip5k1a PE=1 SV=2,,,,,,
OG_00008,FUN_000195-T1,Peve_00038471,Pocillopora_meandrina_HIv1___RNAseq.g28899.t1,three_way,68.38,FUN_000195-T1,B8D9S0,,,,,38.5,148.0,9e-19,95.1,sp|B8D9S0|FMT_BUCA5 Methionyl-tRNA formyltransferase OS=Buchnera aphidicola subsp. Acyrthosiphon pisum (strain 5A) OX=563178 GN=fmt PE=3 SV=1,,,,,,
OG_00009,FUN_000197-T1,Peve_00027182,Pocillopora_meandrina_HIv1___RNAseq.g28901.t1,three_way,56.498333333333335,FUN_000197-T1,Q8TCT7,,,,,44.7,488.0,1.6e-89,331.6,sp|Q8TCT7|SPP2B_HUMAN Signal peptide peptidase-like 2B OS=Homo sapiens OX=9606 GN=SPPL2B PE=1 SV=2,,,,,,</code></pre>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv</span></code></pre></div>
<pre><code>18373 ../output/12-ortho-annot/ortholog_groups_annotated.csv</code></pre>
</section>
</section>
<section id="physiology-based-selection" class="level1">
<h1>Physiology Based Selection</h1>
<section id="filter-for-specific-go-terms" class="level2">
<h2 class="anchored" data-anchor-id="filter-for-specific-go-terms">Filter for Specific GO Terms</h2>
<p>We‚Äôll filter the annotated orthologs for genes involved in metabolic and stress-related processes that are relevant to coral physiology:</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter orthologs for metabolic and stress-related processes</span></span>
<span id="cb9-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Filtering for:"</span></span>
<span id="cb9-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Glycolysis (GO:0006096)"</span></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Gluconeogenesis (GO:0006094)"</span></span>
<span id="cb9-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Lipolysis/lipid catabolism (GO:0016042)"</span></span>
<span id="cb9-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Fatty acid beta oxidation (GO:0006635)"</span></span>
<span id="cb9-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Starvation (GO:0042594)"</span></span>
<span id="cb9-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Lipid biosynthesis (GO:0008610)"</span></span>
<span id="cb9-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Protein catabolic process (GO:0030163)"</span></span>
<span id="cb9-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"- Reproductive Process (GO:0022414)"</span></span>
<span id="cb9-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb9-12"></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create output directory if it doesn't exist</span></span>
<span id="cb9-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/13-ortho-select</span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract header</span></span>
<span id="cb9-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> ../output/12-ortho-annot/ortholog_groups_annotated.csv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/13-ortho-select/selected_orthologs.csv</span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the specified GO terms and reproduction-related processes</span></span>
<span id="cb9-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006096|GO:0006094|GO:0016042|GO:0006635|GO:0042594|GO:0008610|GO:0030163|GO:0022414'</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-21">  ../output/12-ortho-annot/ortholog_groups_annotated.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-22">  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ../output/13-ortho-select/selected_orthologs.csv</span>
<span id="cb9-23"></span>
<span id="cb9-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total orthologs selected:"</span></span>
<span id="cb9-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> ../output/13-ortho-select/selected_orthologs.csv</span></code></pre></div>
<pre><code>Filtering for:
- Glycolysis (GO:0006096)
- Gluconeogenesis (GO:0006094)
- Lipolysis/lipid catabolism (GO:0016042)
- Fatty acid beta oxidation (GO:0006635)
- Starvation (GO:0042594)
- Lipid biosynthesis (GO:0008610)
- Protein catabolic process (GO:0030163)
- Reproductive Process (GO:0022414)

Total orthologs selected:
787 ../output/13-ortho-select/selected_orthologs.csv</code></pre>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show first few selected orthologs</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> ../output/13-ortho-select/selected_orthologs.csv</span></code></pre></div>
<pre><code>group_id,apul,peve,ptua,type,avg_identity,query,accession,id,reviewed,protein_name,organism,pident,length,evalue,bitscore,title,go_ids,go_bp,go_cc,go_mf,goslim_ids,goslim_names
OG_00044,FUN_000272-T1,Peve_00027798,Pocillopora_meandrina_HIv1___RNAseq.g28985.t1,three_way,70.59733333333334,FUN_000272-T1,O75031,HSF2B_HUMAN,,Heat shock factor 2-binding protein,Homo sapiens (Human),43.2,190.0,5.9e-32,139.0,sp|O75031|HSF2B_HUMAN Heat shock factor 2-binding protein OS=Homo sapiens OX=9606 GN=HSF2BP PE=1 SV=1,GO:0005654; GO:0005694; GO:0005829; GO:0006366; GO:0007141; GO:0007144; GO:0007283; GO:1990918,double-strand break repair involved in meiotic recombination [GO:1990918]; female meiosis I [GO:0007144]; male meiosis I [GO:0007141]; spermatogenesis [GO:0007283]; transcription by RNA polymerase II [GO:0006366],chromosome [GO:0005694]; cytosol [GO:0005829]; nucleoplasm [GO:0005654],,GO:0005654; GO:0005694; GO:0005829; GO:0006281; GO:0006351; GO:0022414; GO:0043226; GO:0140013,nucleoplasm; chromosome; cytosol; DNA repair; DNA-templated transcription; reproductive process; organelle; meiotic nuclear division
OG_00086,FUN_000437-T1,Peve_00011193,Pocillopora_meandrina_HIv1___RNAseq.g2323.t1,three_way,77.881,FUN_000437-T1,F1MNN4,FBXW7_BOVIN,,F-box/WD repeat-containing protein 7 (F-box and WD-40 domain-containing protein 7),Bos taurus (Bovine),36.4,195.0,1.9999999999999998e-26,122.5,sp|F1MNN4|FBXW7_BOVIN F-box/WD repeat-containing protein 7 OS=Bos taurus OX=9913 GN=FBXW7 PE=1 SV=3,GO:0005634; GO:0005654; GO:0005694; GO:0005737; GO:0006281; GO:0006974; GO:0007062; GO:0010629; GO:0010992; GO:0019005; GO:0030332; GO:0031146; GO:0031398; GO:0031625; GO:0042752; GO:0042802; GO:0043130; GO:0043161; GO:0050816; GO:0050821; GO:0070374; GO:0070534; GO:0097027; GO:1901524; GO:1901800; GO:1903378; GO:1903955; GO:1990452; GO:1990756; GO:2000060; GO:2001205,DNA damage response [GO:0006974]; DNA repair [GO:0006281]; negative regulation of gene expression [GO:0010629]; negative regulation of osteoclast development [GO:2001205]; positive regulation of ERK1 and ERK2 cascade [GO:0070374]; positive regulation of oxidative stress-induced neuron intrinsic apoptotic signaling pathway [GO:1903378]; positive regulation of proteasomal protein catabolic process [GO:1901800]; positive regulation of protein targeting to mitochondrion [GO:1903955]; positive regulation of protein ubiquitination [GO:0031398]; positive regulation of ubiquitin-dependent protein catabolic process [GO:2000060]; proteasome-mediated ubiquitin-dependent protein catabolic process [GO:0043161]; protein K63-linked ubiquitination [GO:0070534]; protein stabilization [GO:0050821]; regulation of circadian rhythm [GO:0042752]; regulation of mitophagy [GO:1901524]; SCF-dependent proteasomal ubiquitin-dependent protein catabolic process [GO:0031146]; sister chromatid cohesion [GO:0007062]; ubiquitin recycling [GO:0010992],chromosome [GO:0005694]; cytoplasm [GO:0005737]; nucleoplasm [GO:0005654]; nucleus [GO:0005634]; Parkin-FBXW7-Cul1 ubiquitin ligase complex [GO:1990452]; SCF ubiquitin ligase complex [GO:0019005],cyclin binding [GO:0030332]; identical protein binding [GO:0042802]; phosphothreonine residue binding [GO:0050816]; ubiquitin binding [GO:0043130]; ubiquitin protein ligase binding [GO:0031625]; ubiquitin-like ligase-substrate adaptor activity [GO:1990756]; ubiquitin-protein transferase activator activity [GO:0097027],GO:0005634; GO:0005654; GO:0005694; GO:0006281; GO:0030163; GO:0043226; GO:0060090; GO:0098772,nucleus; nucleoplasm; chromosome; DNA repair; protein catabolic process; organelle; molecular adaptor activity; molecular function regulator activity
OG_00107,FUN_000499-T1,Peve_00024155,Pocillopora_meandrina_HIv1___RNAseq.g2414.t1,three_way,82.06683333333332,FUN_000499-T1,Q14432,PDE3A_HUMAN,,"cGMP-inhibited 3',5'-cyclic phosphodiesterase 3A (EC 3.1.4.17) (Cyclic GMP-inhibited phosphodiesterase A) (CGI-PDE A) (cGMP-inhibited cAMP phosphodiesterase) (cGI-PDE)",Homo sapiens (Human),37.6,1034.0,2.2e-143,511.5,"sp|Q14432|PDE3A_HUMAN cGMP-inhibited 3',5'-cyclic phosphodiesterase 3A OS=Homo sapiens OX=9606 GN=PDE3A PE=1 SV=3",GO:0001556; GO:0004114; GO:0004115; GO:0004119; GO:0005829; GO:0006629; GO:0007186; GO:0009410; GO:0016020; GO:0019933; GO:0019934; GO:0030284; GO:0040020; GO:0043066; GO:0043116; GO:0043117; GO:0046872; GO:0047555; GO:0060282; GO:0060700; GO:0071321; GO:0071560; GO:0097190; GO:0099130; GO:0106072; GO:0141162,apoptotic signaling pathway [GO:0097190]; cAMP-mediated signaling [GO:0019933]; cellular response to cGMP [GO:0071321]; cellular response to transforming growth factor beta stimulus [GO:0071560]; cGMP-mediated signaling [GO:0019934]; G protein-coupled receptor signaling pathway [GO:0007186]; lipid metabolic process [GO:0006629]; negative regulation of adenylate cyclase-activating G protein-coupled receptor signaling pathway [GO:0106072]; negative regulation of apoptotic process [GO:0043066]; negative regulation of cAMP/PKA signal transduction [GO:0141162]; negative regulation of vascular permeability [GO:0043116]; oocyte maturation [GO:0001556]; positive regulation of oocyte development [GO:0060282]; positive regulation of vascular permeability [GO:0043117]; regulation of meiotic nuclear division [GO:0040020]; regulation of ribonuclease activity [GO:0060700]; response to xenobiotic stimulus [GO:0009410],cytosol [GO:0005829]; membrane [GO:0016020],"3',5'-cGMP-inhibited cyclic-nucleotide phosphodiesterase activity [GO:0004119]; 3',5'-cyclic-AMP phosphodiesterase activity [GO:0004115]; 3',5'-cyclic-GMP phosphodiesterase activity [GO:0047555]; 3',5'-cyclic-nucleotide phosphodiesterase activity [GO:0004114]; estrogen binding [GO:0099130]; metal ion binding [GO:0046872]; nuclear estrogen receptor activity [GO:0030284]",GO:0003013; GO:0003824; GO:0005829; GO:0006629; GO:0016787; GO:0022414; GO:0060089; GO:0140110,circulatory system process; catalytic activity; cytosol; lipid metabolic process; hydrolase activity; reproductive process; molecular transducer activity; transcription regulator activity
OG_00142,FUN_000582-T1,Peve_00034702,Pocillopora_meandrina_HIv1___TS.g6501.t1,three_way,59.576166666666666,FUN_000582-T1,D2X8K2,PA2_CONGI,,Phospholipase A2 A2-actitoxin-Cgg2a (A2-AITX-Cgg2a) (EC 3.1.1.4) (CgPLA2) (Phosphatidylcholine 2-acylhydrolase),Condylactis gigantea (Giant Caribbean anemone) (Condylactis passiflora),43.7,119.0,3.5e-25,116.3,sp|D2X8K2|PA2_CONGI Phospholipase A2 A2-actitoxin-Cgg2a OS=Condylactis gigantea OX=47073 PE=1 SV=1,GO:0005509; GO:0005543; GO:0005576; GO:0006644; GO:0016042; GO:0042151; GO:0044398; GO:0044470; GO:0044522; GO:0047498; GO:0050482; GO:0090729,arachidonate secretion [GO:0050482]; lipid catabolic process [GO:0016042]; phospholipid metabolic process [GO:0006644]; venom-mediated edema in another organism [GO:0044398]; venom-mediated myocyte killing in another organism [GO:0044522]; venom-mediated suppression of blood coagulation [GO:0044470],extracellular region [GO:0005576]; nematocyst [GO:0042151],calcium ion binding [GO:0005509]; calcium-dependent phospholipase A2 activity [GO:0047498]; phospholipid binding [GO:0005543]; toxin activity [GO:0090729],GO:0003824; GO:0005576; GO:0006629; GO:0008289; GO:0016787; GO:0043226; GO:0090729,catalytic activity; extracellular region; lipid metabolic process; lipid binding; hydrolase activity; organelle; toxin activity
OG_00192,FUN_000898-T1,Peve_00009741,Pocillopora_meandrina_HIv1___RNAseq.g29449.t1,three_way,80.12233333333333,FUN_000898-T1,O43903,GAS2_HUMAN,,Growth arrest-specific protein 2 (GAS-2),Homo sapiens (Human),42.6,256.0,1.3e-48,194.9,sp|O43903|GAS2_HUMAN Growth arrest-specific protein 2 OS=Homo sapiens OX=9606 GN=GAS2 PE=1 SV=1,GO:0001544; GO:0001547; GO:0001725; GO:0005829; GO:0005884; GO:0006915; GO:0008017; GO:0008360; GO:0008593; GO:0016020; GO:0030728; GO:0051015; GO:0051726; GO:0051764; GO:0071711,actin crosslink formation [GO:0051764]; antral ovarian follicle growth [GO:0001547]; apoptotic process [GO:0006915]; basement membrane organization [GO:0071711]; initiation of primordial ovarian follicle growth [GO:0001544]; ovulation [GO:0030728]; regulation of cell cycle [GO:0051726]; regulation of cell shape [GO:0008360]; regulation of Notch signaling pathway [GO:0008593],actin filament [GO:0005884]; cytosol [GO:0005829]; membrane [GO:0016020]; stress fiber [GO:0001725],actin filament binding [GO:0051015]; microtubule binding [GO:0008017],GO:0005829; GO:0008092; GO:0012501; GO:0022414; GO:0030198,cytosol; cytoskeletal protein binding; programmed cell death; reproductive process; extracellular matrix organization
OG_00195,FUN_000905-T1,Peve_00009733,Pocillopora_meandrina_HIv1___RNAseq.g29456.t1,three_way,66.77466666666666,FUN_000905-T1,P70627,FOLH1_RAT,,Glutamate carboxypeptidase 2 (EC 3.4.17.21) (Folate hydrolase 1) (Folylpoly-gamma-glutamate carboxypeptidase) (FGCP) (Glutamate carboxypeptidase II) (GCPII) (Membrane glutamate carboxypeptidase) (mGCP) (N-acetylated-alpha-linked acidic dipeptidase I) (NAALADase I) (Prostate-specific membrane antigen homolog) (Pteroylpoly-gamma-glutamate carboxypeptidase),Rattus norvegicus (Rat),37.3,753.0,5.9e-130,466.5,sp|P70627|FOLH1_RAT Glutamate carboxypeptidase 2 OS=Rattus norvegicus OX=10116 GN=Folh1 PE=1 SV=1,GO:0004180; GO:0004181; GO:0005886; GO:0006508; GO:0006760; GO:0008233; GO:0009986; GO:0016020; GO:0016805; GO:0030163; GO:0043065; GO:0046872; GO:1904492; GO:1904493,folic acid-containing compound metabolic process [GO:0006760]; positive regulation of apoptotic process [GO:0043065]; protein catabolic process [GO:0030163]; proteolysis [GO:0006508],cell surface [GO:0009986]; membrane [GO:0016020]; plasma membrane [GO:0005886],Ac-Asp-Glu binding [GO:1904492]; carboxypeptidase activity [GO:0004180]; dipeptidase activity [GO:0016805]; metal ion binding [GO:0046872]; metallocarboxypeptidase activity [GO:0004181]; peptidase activity [GO:0008233]; tetrahydrofolyl-poly(glutamate) polymer binding [GO:1904493],GO:0003824; GO:0005886; GO:0006575; GO:0016787; GO:0030163; GO:0140096,"catalytic activity; plasma membrane; modified amino acid metabolic process; hydrolase activity; protein catabolic process; catalytic activity, acting on a protein"
OG_00207,FUN_000926-T1,Peve_00009718,Pocillopora_meandrina_HIv1___RNAseq.g29467.t1,three_way,63.42333333333334,FUN_000926-T1,Q9R0N8,SYT6_MOUSE,,Synaptotagmin-6 (Synaptotagmin VI) (SytVI),Mus musculus (Mouse),29.5,319.0,9.1e-33,142.9,sp|Q9R0N8|SYT6_MOUSE Synaptotagmin-6 OS=Mus musculus OX=10090 GN=Syt6 PE=1 SV=2,GO:0001786; GO:0005544; GO:0005829; GO:0005886; GO:0007340; GO:0009898; GO:0016020; GO:0030672; GO:0042802; GO:0042803; GO:0046872; GO:0046982; GO:0048306; GO:0097038,acrosome reaction [GO:0007340],cytoplasmic side of plasma membrane [GO:0009898]; cytosol [GO:0005829]; membrane [GO:0016020]; perinuclear endoplasmic reticulum [GO:0097038]; plasma membrane [GO:0005886]; synaptic vesicle membrane [GO:0030672],calcium-dependent phospholipid binding [GO:0005544]; calcium-dependent protein binding [GO:0048306]; identical protein binding [GO:0042802]; metal ion binding [GO:0046872]; phosphatidylserine binding [GO:0001786]; protein heterodimerization activity [GO:0046982]; protein homodimerization activity [GO:0042803],GO:0005829; GO:0005886; GO:0008289; GO:0022414,cytosol; plasma membrane; lipid binding; reproductive process
OG_00237,FUN_000992-T1,Peve_00004455,Pocillopora_meandrina_HIv1___RNAseq.g29194.t1,three_way,92.068,FUN_000992-T1,P82471,GNAQ_RAT,,Guanine nucleotide-binding protein G(q) subunit alpha (EC 3.6.5.-) (Guanine nucleotide-binding protein alpha-q),Rattus norvegicus (Rat),82.2,353.0,8.9e-169,594.3,sp|P82471|GNAQ_RAT Guanine nucleotide-binding protein G(q) subunit alpha OS=Rattus norvegicus OX=10116 GN=Gnaq PE=2 SV=2,GO:0001501; GO:0001508; GO:0001664; GO:0003924; GO:0003925; GO:0005096; GO:0005525; GO:0005737; GO:0005794; GO:0005834; GO:0005886; GO:0005901; GO:0007186; GO:0007189; GO:0007200; GO:0007206; GO:0007207; GO:0007208; GO:0007215; GO:0007218; GO:0007507; GO:0008217; GO:0009791; GO:0010543; GO:0016020; GO:0016322; GO:0021884; GO:0030234; GO:0030425; GO:0031683; GO:0031965; GO:0032024; GO:0034695; GO:0042711; GO:0042733; GO:0043066; GO:0043267; GO:0044297; GO:0044877; GO:0045634; GO:0046872; GO:0047391; GO:0048066; GO:0050821; GO:0060158; GO:0060828; GO:0086100; GO:0098793; GO:0099524; GO:1904888; GO:1990806,action potential [GO:0001508]; adenylate cyclase-activating G protein-coupled receptor signaling pathway [GO:0007189]; cranial skeletal system development [GO:1904888]; developmental pigmentation [GO:0048066]; embryonic digit morphogenesis [GO:0042733]; endothelin receptor signaling pathway [GO:0086100]; forebrain neuron development [GO:0021884]; G protein-coupled receptor signaling pathway [GO:0007186]; glutamate receptor signaling pathway [GO:0007215]; heart development [GO:0007507]; ligand-gated ion channel signaling pathway [GO:1990806]; maternal behavior [GO:0042711]; negative regulation of apoptotic process [GO:0043066]; negative regulation of potassium ion transport [GO:0043267]; neuron remodeling [GO:0016322]; neuropeptide signaling pathway [GO:0007218]; phospholipase C-activating dopamine receptor signaling pathway [GO:0060158]; phospholipase C-activating G protein-coupled acetylcholine receptor signaling pathway [GO:0007207]; phospholipase C-activating G protein-coupled glutamate receptor signaling pathway [GO:0007206]; phospholipase C-activating G protein-coupled receptor signaling pathway [GO:0007200]; phospholipase C-activating serotonin receptor signaling pathway [GO:0007208]; positive regulation of insulin secretion [GO:0032024]; post-embryonic development [GO:0009791]; protein stabilization [GO:0050821]; regulation of blood pressure [GO:0008217]; regulation of canonical Wnt signaling pathway [GO:0060828]; regulation of melanocyte differentiation [GO:0045634]; regulation of platelet activation [GO:0010543]; response to prostaglandin E [GO:0034695]; skeletal system development [GO:0001501],caveola [GO:0005901]; cell body [GO:0044297]; cytoplasm [GO:0005737]; dendrite [GO:0030425]; Golgi apparatus [GO:0005794]; heterotrimeric G-protein complex [GO:0005834]; membrane [GO:0016020]; nuclear membrane [GO:0031965]; plasma membrane [GO:0005886]; postsynaptic cytosol [GO:0099524]; presynapse [GO:0098793],alkylglycerophosphoethanolamine phosphodiesterase activity [GO:0047391]; enzyme regulator activity [GO:0030234]; G protein activity [GO:0003925]; G protein-coupled receptor binding [GO:0001664]; G-protein beta/gamma-subunit complex binding [GO:0031683]; GTP binding [GO:0005525]; GTPase activator activity [GO:0005096]; GTPase activity [GO:0003924]; metal ion binding [GO:0046872]; protein-containing complex binding [GO:0044877],GO:0003824; GO:0003924; GO:0005794; GO:0005829; GO:0005886; GO:0016787; GO:0022414; GO:0043226; GO:0048856; GO:0098772,catalytic activity; GTPase activity; Golgi apparatus; cytosol; plasma membrane; hydrolase activity; reproductive process; organelle; anatomical structure development; molecular function regulator activity
OG_00248,FUN_001011-T1,Peve_00041060,Pocillopora_meandrina_HIv1___RNAseq.g29164.t1,three_way,70.763,FUN_001011-T1,Q6ZUX7,LHPL2_HUMAN,,LHFPL tetraspan subfamily member 2 protein (Lipoma HMGIC fusion partner-like 2 protein),Homo sapiens (Human),43.1,232.0,6.4e-43,175.6,sp|Q6ZUX7|LHPL2_HUMAN LHFPL tetraspan subfamily member 2 protein OS=Homo sapiens OX=9606 GN=LHFPL2 PE=1 SV=2,GO:0005886; GO:0007338; GO:0016020; GO:0031092; GO:0046545; GO:0046546; GO:1905516,development of primary female sexual characteristics [GO:0046545]; development of primary male sexual characteristics [GO:0046546]; positive regulation of fertilization [GO:1905516]; single fertilization [GO:0007338],membrane [GO:0016020]; plasma membrane [GO:0005886]; platelet alpha granule membrane [GO:0031092],,GO:0005886; GO:0022414,plasma membrane; reproductive process</code></pre>
</section>
<section id="summary-by-go-category" class="level2">
<h2 class="anchored" data-anchor-id="summary-by-go-category">Summary by GO Category</h2>
<p>Let‚Äôs examine how many orthologs were identified for each physiological process:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count orthologs by each GO category</span></span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Glycolysis (GO:0006096) ==="</span></span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006096'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Gluconeogenesis (GO:0006094) ==="</span></span>
<span id="cb13-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006094'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-7"></span>
<span id="cb13-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Lipolysis/lipid catabolism (GO:0016042) ==="</span></span>
<span id="cb13-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0016042'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-10"></span>
<span id="cb13-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Fatty acid beta oxidation (GO:0006635) ==="</span></span>
<span id="cb13-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0006635'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Starvation (GO:0042594) ==="</span></span>
<span id="cb13-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0042594'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Lipid biosynthesis (GO:0008610) ==="</span></span>
<span id="cb13-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0008610'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-19"></span>
<span id="cb13-20"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Protein catabolic process (GO:0030163) ==="</span></span>
<span id="cb13-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0030163'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span>
<span id="cb13-22"></span>
<span id="cb13-23"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"=== Reproductive Process (GO:0022414) ==="</span></span>
<span id="cb13-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GO:0022414'</span> ../output/13-ortho-select/selected_orthologs.csv <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span></span></code></pre></div>
<pre><code>=== Glycolysis (GO:0006096) ===
10
=== Gluconeogenesis (GO:0006094) ===
13
=== Lipolysis/lipid catabolism (GO:0016042) ===
21
=== Fatty acid beta oxidation (GO:0006635) ===
22
=== Starvation (GO:0042594) ===
12
=== Lipid biosynthesis (GO:0008610) ===
7
=== Protein catabolic process (GO:0030163) ===
235
=== Reproductive Process (GO:0022414) ===
496</code></pre>
</section>
<section id="results-summary" class="level2">
<h2 class="anchored" data-anchor-id="results-summary">Results Summary</h2>
<p>From the 18,326 annotated ortholog groups, we selected <strong>787 orthologs</strong> that are involved in key physiological processes relevant to coral metabolism and reproduction:</p>
<section id="metabolic-processes" class="level3">
<h3 class="anchored" data-anchor-id="metabolic-processes">Metabolic Processes</h3>
<ul>
<li><strong>Glycolysis</strong>: 10 orthologs - Energy production through glucose breakdown</li>
<li><strong>Gluconeogenesis</strong>: 13 orthologs - Glucose synthesis from non-carbohydrate sources</li>
<li><strong>Lipolysis/Lipid catabolism</strong>: 21 orthologs - Breakdown of lipids for energy</li>
<li><strong>Fatty acid beta oxidation</strong>: 22 orthologs - Oxidation of fatty acids in mitochondria</li>
<li><strong>Lipid biosynthesis</strong>: 7 orthologs - Synthesis of new lipids</li>
<li><strong>Starvation response</strong>: 12 orthologs - Cellular responses to nutrient deprivation</li>
</ul>
</section>
<section id="protein-turnover" class="level3">
<h3 class="anchored" data-anchor-id="protein-turnover">Protein Turnover</h3>
<ul>
<li><strong>Protein catabolic process</strong>: 235 orthologs - Protein degradation and recycling</li>
</ul>
</section>
<section id="reproduction" class="level3">
<h3 class="anchored" data-anchor-id="reproduction">Reproduction</h3>
<ul>
<li><strong>Reproductive processes</strong>: 496 orthologs - Genes involved in reproductive development and function</li>
</ul>
<p>These selected orthologs represent conserved genes across all three coral species that play crucial roles in:</p>
<ol type="1">
<li><p><strong>Energy metabolism</strong> - particularly relevant for understanding coral responses to bleaching and thermal stress</p></li>
<li><p><strong>Lipid metabolism</strong> - important for energy storage and membrane maintenance</p></li>
<li><p><strong>Reproduction</strong> - critical for understanding coral spawning and life cycle processes</p></li>
<li><p><strong>Protein homeostasis</strong> - essential for cellular function and stress responses</p></li>
</ol>
<p>This filtered set of orthologs provides a focused gene list for downstream expression analysis, particularly for studies examining coral physiological responses to environmental stressors.</p>


<!-- -->

</section>
</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/53-ortho-select/</guid>
  <pubDate>Sat, 04 Oct 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MOSAiC_orthologs__Tumbling_Oysters_2025-08-31_08-16-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>MOSAiC orthologs</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</link>
  <description><![CDATA[ 





<section id="orthologous-protein-identification-across-three-coral-species" class="level1">
<h1>Orthologous Protein Identification Across Three Coral Species</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Understanding the evolutionary relationships between genes across different species is fundamental to comparative genomics. In this analysis, we identified orthologous proteins across three distinct coral species using a reciprocal best hits (RBH) approach. This methodology provides a robust foundation for cross-species comparisons and evolutionary studies.</p>
</section>
<section id="study-species" class="level2">
<h2 class="anchored" data-anchor-id="study-species">Study Species</h2>
<p>Our analysis focused on three coral species representing different growth forms and ecological strategies:</p>
<ul>
<li><strong>Acropora pulchra</strong> (D-Apul): A fast-growing, branching coral species</li>
<li><strong>Porites evermanni</strong> (E-Peve): A slow-growing, massive coral species<br>
</li>
<li><strong>Pocillopora tuahiniensis</strong> (F-Ptua): An intermediate growth, branching coral species</li>
</ul>
<p>These species represent different evolutionary strategies within the coral phylogeny, making them ideal candidates for comparative genomic analysis.</p>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="orthology-identification-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="orthology-identification-pipeline">Orthology Identification Pipeline</h3>
<p>We employed a comprehensive orthology identification pipeline using the following parameters:</p>
<ul>
<li><strong>BLAST algorithm</strong>: All-vs-all protein BLAST comparisons</li>
<li><strong>Orthology criterion</strong>: Reciprocal best hits (RBH)</li>
<li><strong>E-value threshold</strong>: 1e-5 (stringent significance threshold)</li>
<li><strong>Minimum identity</strong>: 30% (allowing for evolutionary divergence)</li>
<li><strong>Minimum coverage</strong>: 50% (ensuring substantial sequence overlap)</li>
</ul>
</section>
<section id="computational-workflow" class="level3">
<h3 class="anchored" data-anchor-id="computational-workflow">Computational Workflow</h3>
<ol type="1">
<li><strong>Database Preparation</strong>: Created BLAST databases for each species‚Äô protein sequences</li>
<li><strong>All-vs-All Comparisons</strong>: Performed bidirectional BLAST searches between all species pairs</li>
<li><strong>Reciprocal Best Hits</strong>: Identified protein pairs that are mutual best matches</li>
<li><strong>Ortholog Grouping</strong>: Organized orthologs into groups based on presence across species</li>
<li><strong>Quality Filtering</strong>: Applied identity and coverage thresholds to ensure orthology confidence</li>
</ol>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="protein-sequence-statistics" class="level3">
<h3 class="anchored" data-anchor-id="protein-sequence-statistics">Protein Sequence Statistics</h3>
<p>The analysis began with comprehensive protein datasets from each species:</p>
<ul>
<li><strong>Acropora pulchra</strong>: 15,664 total proteins from genome annotation</li>
<li><strong>Porites evermanni</strong>: 16,693 total proteins from genome assembly</li>
<li><strong>Pocillopora tuahiniensis</strong>: 16,060 total proteins from genome annotation</li>
</ul>
<p>These datasets represent the complete protein complement for each species, providing a comprehensive foundation for orthology analysis.</p>
</section>
<section id="orthology-classification" class="level3">
<h3 class="anchored" data-anchor-id="orthology-classification">Orthology Classification</h3>
<p>Our analysis identified several categories of orthologous relationships:</p>
<ol type="1">
<li><strong>Three-way orthologs</strong>: 10,346 proteins present in all three species (highest confidence)</li>
<li><strong>Two-way orthologs</strong>: 7,980 proteins shared between specific species pairs</li>
<li><strong>Total ortholog groups</strong>: 18,326 distinct ortholog groups identified</li>
</ol>
</section>
<section id="pairwise-orthology-results" class="level3">
<h3 class="anchored" data-anchor-id="pairwise-orthology-results">Pairwise Orthology Results</h3>
<p>The reciprocal best hits analysis revealed strong orthology relationships between species pairs:</p>
<ul>
<li><strong>Acropora pulchra vs Porites evermanni</strong>: 13,782 orthologous protein pairs</li>
<li><strong>Acropora pulchra vs Pocillopora tuahiniensis</strong>: 13,320 orthologous protein pairs<br>
</li>
<li><strong>Porites evermanni vs Pocillopora tuahiniensis</strong>: 14,303 orthologous protein pairs</li>
</ul>
</section>
<section id="key-findings" class="level3">
<h3 class="anchored" data-anchor-id="key-findings">Key Findings</h3>
<p>The orthology analysis revealed substantial conservation across the three coral species:</p>
<ul>
<li><strong>High conservation</strong>: ~66% of Acropora pulchra proteins have orthologs in both other species</li>
<li><strong>Strong pairwise relationships</strong>: Each species pair shares 80-86% of their protein complement</li>
<li><strong>Core gene set</strong>: 10,346 proteins (three-way orthologs) represent the conserved ancestral gene set</li>
<li><strong>Lineage-specific genes</strong>: ~7,980 proteins show species-specific orthology patterns, indicating potential lineage-specific adaptations</li>
</ul>
</section>
</section>
<section id="technical-implementation" class="level2">
<h2 class="anchored" data-anchor-id="technical-implementation">Technical Implementation</h2>
<section id="computational-resources" class="level3">
<h3 class="anchored" data-anchor-id="computational-resources">Computational Resources</h3>
<p>The analysis utilized:<br>
- <strong>BLAST databases</strong>: Custom-built for each species<br>
- <strong>Parallel processing</strong>: Multi-threaded BLAST searches for efficiency<br>
- <strong>Quality control</strong>: Multiple filtering steps to ensure orthology confidence<br>
</p>
</section>
<section id="data-management" class="level3">
<h3 class="anchored" data-anchor-id="data-management">Data Management</h3>
<p>Results were organized into:<br>
- <strong>Ortholog groups</strong>: Hierarchical classification of orthologous relationships<br>
- <strong>Pairwise comparisons</strong>: Detailed RBH results for each species pair<br>
- <strong>Summary statistics</strong>: Comprehensive overview of orthology patterns</p>
</section>
<section id="output-files" class="level3">
<h3 class="anchored" data-anchor-id="output-files">Output Files</h3>
<p>All analysis results are available in the <a href="https://github.com/urol-e5/timeseries_molecular/tree/main/M-multi-species/output/11-orthology-analysis">orthology analysis output directory</a>:</p>
<p><strong>Core Results:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/ortholog_groups.csv"><code>ortholog_groups.csv</code></a> - Complete ortholog group assignments (18,326 groups)<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/orthology_summary.csv"><code>orthology_summary.csv</code></a> - Summary statistics and counts</p>
<p><strong>Pairwise Comparisons:</strong><br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_peve_rbh.csv"><code>apul_peve_rbh.csv</code></a> - Acropora pulchra vs Porites evermanni reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/apul_ptua_rbh.csv"><code>apul_ptua_rbh.csv</code></a> - Acropora pulchra vs Pocillopora tuahiniensis reciprocal best hits<br>
- <a href="https://github.com/urol-e5/timeseries_molecular/blob/main/M-multi-species/output/11-orthology-analysis/peve_ptua_rbh.csv"><code>peve_ptua_rbh.csv</code></a> - Porites evermanni vs Pocillopora tuahiniensis reciprocal best hits<br>
</p>
<p><strong>Raw BLAST Results:</strong><br>
- BLAST output files for all pairwise comparisons (Apul_vs_Peve.blastp, Peve_vs_Apul.blastp, etc.)<br>
- BLAST databases for each species (Apul_proteins.<em>, Peve_proteins.</em>, Ptua_proteins.*)</p>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>The identification of orthologous proteins across three coral species establishes a critical resource for comparative coral genomics. This analysis reveals both conserved and divergent aspects of coral biology, providing insights into the evolutionary processes that have shaped coral diversity.</p>
<p>The orthology assignments generated here will serve as a reference for future studies investigating coral biology, evolution, and responses to environmental change. By understanding the genetic relationships between these species, we can better predict how different coral lineages may respond to changing environmental conditions.</p>
<hr>
<p><em>This analysis represents a key step in our multi-species comparative genomics pipeline, providing the foundation for cross-species comparisons and evolutionary studies in coral biology.</em></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>e5</category>
  <category>coral</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/52-e5-orthologs/</guid>
  <pubDate>Sun, 31 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_MOSAiC_orthologs__Tumbling_Oysters_2025-08-31_08-16-09.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Next leveling RNAseq</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</link>
  <description><![CDATA[ 





<p>Started over with merged genome‚Ä¶.</p>
<section id="minimap2" class="level1">
<h1>minimap2</h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb1-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of threads</span></span>
<span id="cb1-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set paths</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref_genome</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/merged_out.fasta.TBtools.fa"</span></span>
<span id="cb1-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1"</span></span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over each FASTQ file</span></span>
<span id="cb1-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${input_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb1-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name (e.g., Pum_barcode02 from Pum_barcode02_combined.fastq.gz)</span></span>
<span id="cb1-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb1-18"></span>
<span id="cb1-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run minimap2 and samtools sort</span></span>
<span id="cb1-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">minimap2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ax</span> splice <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k14</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--MD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ref_genome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb1-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-22"></span>
<span id="cb1-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb1-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb1-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="stringtie" class="level1">
<h1>Stringtie</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_out</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb2-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/04-align-v1/stringtie_out/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/04-align-v1/stringtie_out/mergelist.txt</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../data/GN.gene.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">    ../output/04-align-v1/stringtie_out/mergelist.txt</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/04-align-v1/stringtie_quant</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/04-align-v1/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb4-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../output/04-align-v1/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/04-align-v1/stringtie_quant/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf</span>
<span id="cb4-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="matrix" class="level1">
<h1>matrix</h1>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/stringtie-2.2.1.Linux_x86_64/prepDE.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2">-i ../output/04-align-v1/stringtie_quant/samplelist.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">-g ../output/04-align-v1/stringtie_quant/gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">-t ../output/04-align-v1/stringtie_quant/transcript_count_matrix.csv</span></code></pre></div>
<section id="normalize-matrix" class="level2">
<h2 class="anchored" data-anchor-id="normalize-matrix">normalize matrix</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(DESeq2)</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load raw counts</span></span>
<span id="cb6-4">gene_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/04-align-v1/stringtie_quant/gene_count_matrix.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make sample metadata</span></span>
<span id="cb6-7">sample_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb6-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(gene_counts),</span>
<span id="cb6-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condition =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># example</span></span>
<span id="cb6-10">)</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DESeq2 object and normalization</span></span>
<span id="cb6-13">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeqDataSetFromMatrix</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">countData =</span> gene_counts, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colData =</span> sample_info, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">design =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> condition)</span>
<span id="cb6-14">dds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DESeq</span>(dds)</span>
<span id="cb6-15">norm_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">counts</span>(dds, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalized =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</section>
</section>
<section id="limma-differential-expression" class="level1">
<h1>limma (differential expression)</h1>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(limma)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare expression matrix (genes x samples)</span></span>
<span id="cb7-5">expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(norm_counts)</span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create design matrix</span></span>
<span id="cb7-8">group <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Pum"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pum"</span>,</span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Qui"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui"</span>,</span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(expr), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Rio"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Rio"</span></span>
<span id="cb7-12">))</span>
<span id="cb7-13"></span>
<span id="cb7-14">design <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">model.matrix</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> group)</span>
<span id="cb7-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(design) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(group)</span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fit linear model</span></span>
<span id="cb7-18">fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmFit</span>(expr, design)</span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create contrast for all pairwise comparisons</span></span>
<span id="cb7-21">contrast_matrix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeContrasts</span>(</span>
<span id="cb7-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Qui =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Qui,</span>
<span id="cb7-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Pum_vs_Rio =</span> Pum <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Qui_vs_Rio =</span> Qui <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Rio,</span>
<span id="cb7-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> design</span>
<span id="cb7-26">)</span>
<span id="cb7-27"></span>
<span id="cb7-28">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">contrasts.fit</span>(fit, contrast_matrix)</span>
<span id="cb7-29">fit2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">eBayes</span>(fit2)</span>
<span id="cb7-30"></span>
<span id="cb7-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get top DE genes across comparisons</span></span>
<span id="cb7-32">top_table <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Qui_vs_Rio"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(top_table)</span></code></pre></div>
<section id="get-all-contrast" class="level2">
<h2 class="anchored" data-anchor-id="get-all-contrast">Get all Contrast</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get all contrast names</span></span>
<span id="cb8-2">contrast_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(fit2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrasts)</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract all DEGs per contrast</span></span>
<span id="cb8-5">deg_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(contrast_names, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(contrast) {</span>
<span id="cb8-6">  tt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topTable</span>(fit2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef =</span> contrast, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">number =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all genes</span></span>
<span id="cb8-7">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(tt)</span>
<span id="cb8-8">  tt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrast <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> contrast</span>
<span id="cb8-9">  tt</span>
<span id="cb8-10">})</span>
<span id="cb8-11"></span>
<span id="cb8-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine into one long data frame</span></span>
<span id="cb8-13">all_degs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(deg_list)</span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(contrast)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-37-58.png" class="img-fluid"></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(UpSetR)</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make DEG sets by contrast</span></span>
<span id="cb10-4">deg_sets <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sig_degs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(contrast) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">genes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(gene_id)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">deframe</span>()</span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">upset</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromList</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nsets =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(deg_sets), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order.by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"freq"</span>)</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-39-02.png" class="img-fluid"></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 29%">
<col style="width: 18%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 4%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">gene_id</th>
<th style="text-align: left;">contrast</th>
<th style="text-align: left;">X1</th>
<th style="text-align: left;">X2</th>
<th style="text-align: right;">X3</th>
<th style="text-align: right;">X4</th>
<th style="text-align: right;">X5</th>
<th style="text-align: right;">X6</th>
<th style="text-align: right;">X7</th>
<th style="text-align: right;">X8</th>
<th style="text-align: right;">X9</th>
<th style="text-align: right;">X10</th>
<th style="text-align: right;">X11</th>
<th style="text-align: right;">X12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6914</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.19435</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28904</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21022</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Qui</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.6508</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.28403</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.3067</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.1953</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.29102</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.21000|GN016607.1</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.31664</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5499</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.26734</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">MSTRG.26734::Chromosome_7B:129126903-129127351(.)</td>
<td style="text-align: left;">sp|Q9BXX0|EMIL2_HUMAN</td>
<td style="text-align: right;">40.5</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">431</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">906</td>
<td style="text-align: right;">977</td>
<td style="text-align: right;">4.5e-06</td>
<td style="text-align: right;">48.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.31461</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.18807</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.30588</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.2111</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.9920</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.21438</td>
<td style="text-align: left;">Pum_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.27106</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.16036</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24262</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312406-170333998(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4152</td>
<td style="text-align: right;">4439</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5573</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5573::Chromosome_1B:170312557-170362327(+)</td>
<td style="text-align: left;">sp|Q5TZA2|CROCC_HUMAN</td>
<td style="text-align: right;">48.0</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4001</td>
<td style="text-align: right;">4288</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">77.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.17542</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.25471</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.25471::Chromosome_7B:80510238-80537915(+)</td>
<td style="text-align: left;">sp|A9ULZ2|BIR7B_XENLA</td>
<td style="text-align: right;">32.6</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10080</td>
<td style="text-align: right;">10538</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">343</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">112.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24917</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.10366</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.25453</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27117</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.5075</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.27111</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.24906</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.5929</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.5929::Chromosome_1B:186679521-186686006(+)</td>
<td style="text-align: left;">sp|Q6DIY8|M17L2_XENTR</td>
<td style="text-align: right;">38.4</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5682</td>
<td style="text-align: right;">6266</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">196</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">124.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">MSTRG.6115</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MSTRG.22169</td>
<td style="text-align: left;">Qui_vs_Rio</td>
<td style="text-align: left;">MSTRG.22169::Chromosome_6B:76312513-76318400(-)</td>
<td style="text-align: left;">sp|Q8BFQ2|T229B_MOUSE</td>
<td style="text-align: right;">60.9</td>
<td style="text-align: right;">161</td>
<td style="text-align: right;">57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5323</td>
<td style="text-align: right;">5787</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">0.0e+00</td>
<td style="text-align: right;">208.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_01.png" class="img-fluid" alt="Page 1"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_02.png" class="img-fluid" alt="Page 2"> <img src="https://gannet.fish.washington.edu/v1_web/owlshell/bu-github/project-ostrea-chil/output/04-align-v1/DEG_boxplots_page_03.png" class="img-fluid" alt="Page 3"></p>


<!-- -->

</section>
</section>

 ]]></description>
  <category>oyster</category>
  <category>chile</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/51-nano-next/</guid>
  <pubDate>Mon, 04 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-04_20-31-31.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Getting on with Nanopore cDNA data</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/50-nano-cDNA/</link>
  <description><![CDATA[ 





<p>Went in a few directions but will try to layout properly here. Experiment - 3 populations, 4 pooled (n=5) libraires - thus 20 individuals represented per population.</p>
<section id="data-as-provided" class="level1">
<h1>Data as provided</h1>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Screen_Capture_on_2025-08-01_at_17-36-23.gif" class="img-fluid"></p>
</section>
<section id="combining" class="level1">
<h1>Combining</h1>
<p>Here is an example from one species</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode01 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode01_combined.fastq.gz</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode01_1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode01_1_combined.fastq.gz</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode02_1 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode02_1_combined.fastq.gz</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> /home/shared/16TB_HDD_01/valentina/data/Quilhua/barcode12 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fastq.gz"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-print0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-0</span> zcat <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gzip</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/Qui_barcode12_combined.fastq.gz</span></code></pre></div>
</section>
<section id="align" class="level1">
<h1>Align</h1>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/anaconda/anaconda3/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set number of threads</span></span>
<span id="cb2-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">threads</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set paths</span></span>
<span id="cb2-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ref_genome</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/Och_HapA_assembly.fa"</span></span>
<span id="cb2-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb2-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_dir</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/02-RNAseq"</span></span>
<span id="cb2-11"></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over each FASTQ file</span></span>
<span id="cb2-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fq <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${input_dir}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.fastq.gz<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb2-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract sample name (e.g., Pum_barcode02 from Pum_barcode02_combined.fastq.gz)</span></span>
<span id="cb2-15">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .fastq.gz<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb2-16"></span>
<span id="cb2-17">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sample</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb2-18"></span>
<span id="cb2-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run minimap2 and samtools sort</span></span>
<span id="cb2-20">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">minimap2</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ax</span> splice <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-k14</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--MD</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ref_genome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$fq</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb2-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$threads</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb2-22"></span>
<span id="cb2-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb2-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${output_dir}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb2-25"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</section>
<section id="stringtie" class="level1">
<h1>Stringtie</h1>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/02-RNAseq/stringtie_out</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/02-RNAseq/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb3-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb3-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_out/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 32 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span></span>
<span id="cb3-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> ../output/02-RNAseq/stringtie_out/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ../output/02-RNAseq/stringtie_out/mergelist.txt</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--merge</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../data/GN.gene.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-7">    ../output/02-RNAseq/stringtie_out/mergelist.txt</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../output/02-RNAseq/stringtie_quant</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ../output/02-RNAseq/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>combined.sorted.bam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> _combined.sorted.bam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/shared/stringtie-2.2.1.Linux_x86_64/stringtie</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-B</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-9">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-G</span> ../output/02-RNAseq/stringtie_out/merged.gtf <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-10">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> ../output/02-RNAseq/stringtie_quant/<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span>.gtf</span>
<span id="cb5-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /home/shared/stringtie-2.2.1.Linux_x86_64/prepDE.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">-i ../output/02-RNAseq/stringtie_quant/samplelist.txt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-3">-g ../output/02-RNAseq/stringtie_quant/gene_count_matrix.csv <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-4">-t ../output/02-RNAseq/stringtie_quant/transcript_count_matrix.csv</span></code></pre></div>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-01_17-48-48.png" class="img-fluid"></p>
</section>
<section id="next" class="level1">
<h1>Next?</h1>
<p>Normalize, QC?, Annotate (many are novel genes)</p>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>chile</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/50-nano-cDNA/</guid>
  <pubDate>Fri, 01 Aug 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-ostrea-chil__RStudio_Server_2025-08-01_17-33-00.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Oyster Pickup and Cleaning</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/49-ptwhit/</link>
  <description><![CDATA[ 





<section id="dock" class="level1">
<h1>Dock</h1>
<p>Inspected bags at dock. Retrieved one PolyIC and Control bag. This left two of each on dock. For all others replaced bags.</p>
<p>Right Line</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-20-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-23-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-23-45.png" class="img-fluid"></p>
<p>Left Line</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-21-07.png" class="img-fluid"></p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-21-57.png" class="img-fluid"></p>
<p>PolyIC Bags</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-22-34.png" class="img-fluid"></p>
</section>
<section id="heath-trays" class="level1">
<h1>Heath Trays</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<tbody>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-27-55.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-28-16.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-28-46.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-09.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-32.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-29-56.png" class="img-fluid"></td>
</tr>
<tr class="odd">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-15.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-36.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-30-58.png" class="img-fluid"></td>
</tr>
<tr class="even">
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-13.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-40.png" class="img-fluid"></td>
<td><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-31-57.png" class="img-fluid"></td>
</tr>
</tbody>
</table>
</section>
<section id="section" class="level1">
<h1></h1>


<!-- -->

</section>

 ]]></description>
  <category>oyster</category>
  <category>aquaculture</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/49-ptwhit/</guid>
  <pubDate>Wed, 23 Jul 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Monosnap_2025-07-23_16-18-25.png" medium="image" type="image/png"/>
</item>
<item>
  <title>Cod alignment</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/48-cod-bwa/</link>
  <description><![CDATA[ 





<section id="genome" class="level1">
<h1>Genome</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-O</span> https://owl.fish.washington.edu/halfshell/genomic-databank/GCF_031168955.1_ASM3116895v1_genomic.fna</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bwa</span> index ../data/GCF_031168955.1_ASM3116895v1_genomic.fna</span></code></pre></div>
</div>
</section>
<section id="reads---getting-on-raven" class="level1">
<h1>Reads - getting on raven</h1>
<p>ecotype</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ../data/fastq-ecotype</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ../data/fastq-ecotype</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-np</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nd</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.gz"</span> https://owl.fish.washington.edu/nightingales/G_macrocephalus/30-1149634506/00_fastq/</span></code></pre></div>
</div>
</section>
<section id="align" class="level1">
<h1>Align</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Path to reference genome (must be indexed with bwa index)</span></span>
<span id="cb4-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">REFERENCE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/GCF_031168955.1_ASM3116895v1_genomic.fna"</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of threads per BWA job</span></span>
<span id="cb4-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb4-6"></span>
<span id="cb4-7"></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing fastq files</span></span>
<span id="cb4-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FASTQ_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/fastq-ecotype"</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory (you can change this)</span></span>
<span id="cb4-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span></span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File suffixes</span></span>
<span id="cb4-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R1_001.fastq.gz"</span></span>
<span id="cb4-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_R2_001.fastq.gz"</span></span>
<span id="cb4-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_SUFFIX</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".sam"</span></span>
<span id="cb4-18"></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------</span></span>
<span id="cb4-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RUN BWA IN PARALLEL</span></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------</span></span>
<span id="cb4-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run loop</span></span>
<span id="cb4-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sample <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sed</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">//"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb4-24">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R1_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${R1_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-25">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R2_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${R2_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-26">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_FILE</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}${OUT_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-27"></span>
<span id="cb4-28">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Running BWA on </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb4-29">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bwa</span> mem <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${REFERENCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R1_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${R2_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_FILE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb4-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
<section id="convert-sam-to-bam" class="level1">
<h1>Convert SAM to BAM</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Directory containing .sam files</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">SAM_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Output directory (can be same as SAM_DIR or different)</span></span>
<span id="cb5-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OUT_DIR</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/14-BWA"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change this if you want bams elsewhere</span></span>
<span id="cb5-7"></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of threads for sorting</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">THREADS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>42</span>
<span id="cb5-11"></span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop through all .sam files</span></span>
<span id="cb5-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAM_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb5-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get base name (e.g., sample1)</span></span>
<span id="cb5-16">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sam}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> .sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb5-17"></span>
<span id="cb5-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define output file</span></span>
<span id="cb5-19">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bam</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb5-20"></span>
<span id="cb5-21">  <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Converting </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> to </span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">..."</span></span>
<span id="cb5-22"></span>
<span id="cb5-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert and sort</span></span>
<span id="cb5-24">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$THREADS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$THREADS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-25"></span>
<span id="cb5-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index the sorted BAM</span></span>
<span id="cb5-27">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">samtools</span> index <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bam</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>


<!-- -->

</section>

 ]]></description>
  <category>cod</category>
  <category>wgs</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/48-cod-bwa/</guid>
  <pubDate>Tue, 08 Jul 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_project-cod-temperature__RStudio_Server_2025-07-09_08-43-39.png" medium="image" type="image/png"/>
</item>
<item>
  <title>The lncRNA repertoire of Ptuh</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/47-ffs/</link>
  <description><![CDATA[ 





<section id="tldr" class="level1">
<h1>TLDR</h1>
<p>fasta - https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/Ptuh-lncRNA.fasta</p>
<p>gtf - https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/Ptuh-lncRNA.gtf</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># URLs</span></span>
<span id="cb1-2">bed_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.bed"</span></span>
<span id="cb1-3">gtf_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span></span>
<span id="cb1-4">fasta_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.fasta"</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### BED file</span></span>
<span id="cb1-7">bed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_tsv</span>(bed_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_names =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chrom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>))</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BED file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>BED file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(bed))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 3
  chrom                                   start    end
  &lt;chr&gt;                                   &lt;dbl&gt;  &lt;dbl&gt;
1 Pocillopora_meandrina_HIv1___Sc0000000 130006 130942
2 Pocillopora_meandrina_HIv1___Sc0000000 164394 165221
3 Pocillopora_meandrina_HIv1___Sc0000000 164596 165221
4 Pocillopora_meandrina_HIv1___Sc0000000 168916 182502
5 Pocillopora_meandrina_HIv1___Sc0000000 245808 248612
6 Pocillopora_meandrina_HIv1___Sc0000000 282742 283165</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for BED</span></span>
<span id="cb5-2">bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BED file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
BED file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of features:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(bed), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of features: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean length: 3125.615 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(bed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median length: 702 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### GTF file</span></span>
<span id="cb13-2">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(gtf_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GTF file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
GTF file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(gtf))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>GRanges object with 6 ranges and 5 metadata columns:
                    seqnames        ranges strand |   source     type     score
                       &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt; &lt;factor&gt; &lt;numeric&gt;
  [1] Pocillopora_meandrin.. 130006-130942      + |       NA   lncRNA        NA
  [2] Pocillopora_meandrin.. 164394-165221      + |       NA   lncRNA        NA
  [3] Pocillopora_meandrin.. 164596-165221      + |       NA   lncRNA        NA
  [4] Pocillopora_meandrin.. 168916-182502      + |       NA   lncRNA        NA
  [5] Pocillopora_meandrin.. 245808-248612      + |       NA   lncRNA        NA
  [6] Pocillopora_meandrin.. 282742-283165      + |       NA   lncRNA        NA
          phase     gene_id
      &lt;integer&gt; &lt;character&gt;
  [1]      &lt;NA&gt;  lncRNA_001
  [2]      &lt;NA&gt;  lncRNA_002
  [3]      &lt;NA&gt;  lncRNA_003
  [4]      &lt;NA&gt;  lncRNA_004
  [5]      &lt;NA&gt;  lncRNA_005
  [6]      &lt;NA&gt;  lncRNA_006
  -------
  seqinfo: 175 sequences from an unspecified genome; no seqlengths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for GTF</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GTF file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
GTF file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of entries:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(gtf), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of entries: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unique feature types:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(gtf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>type), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique feature types: lncRNA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### FASTA file</span></span>
<span id="cb23-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(fasta_url)</span>
<span id="cb23-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">FASTA file head:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FASTA file head:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:130007-130942"
[2] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:164395-165221"
[3] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:164597-165221"
[4] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:168917-182502"
[5] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:245809-248612"
[6] "transcript::Pocillopora_meandrina_HIv1___Sc0000000:282743-283165"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(fasta[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6-letter DNAString object
seq: GCCTTG</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Basic stats for FASTA</span></span>
<span id="cb29-2">seq_lengths <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">width</span>(fasta)</span>
<span id="cb29-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">FASTA file stats:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FASTA file stats:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of sequences:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(fasta), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of sequences: 16153 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mean sequence length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(seq_lengths), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean sequence length: 3123.615 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Median sequence length:"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(seq_lengths), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median sequence length: 700 </code></pre>
</div>
</div>
</section>
<section id="renaming-fasta" class="level1">
<h1>Renaming fasta</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># File paths</span></span>
<span id="cb37-2">fasta_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.fasta"</span></span>
<span id="cb37-3">gtf_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span></span>
<span id="cb37-4"></span>
<span id="cb37-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in FASTA and GTF</span></span>
<span id="cb37-6">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(fasta_url)</span>
<span id="cb37-7">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(gtf_url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb37-8"></span>
<span id="cb37-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract gene_id from GTF</span></span>
<span id="cb37-10">gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(gtf)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, x))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove quotes</span></span>
<span id="cb37-11">unique_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(gene_ids)</span>
<span id="cb37-12"></span>
<span id="cb37-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generate new FASTA headers</span></span>
<span id="cb37-14">new_headers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ptuh_"</span>, unique_gene_ids)</span>
<span id="cb37-15"></span>
<span id="cb37-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Confirm lengths match</span></span>
<span id="cb37-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(fasta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(new_headers)) {</span>
<span id="cb37-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mismatch between number of FASTA sequences and GTF gene IDs."</span>)</span>
<span id="cb37-19">}</span>
<span id="cb37-20"></span>
<span id="cb37-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename sequences</span></span>
<span id="cb37-22"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> new_headers</span>
<span id="cb37-23"></span>
<span id="cb37-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write new FASTA</span></span>
<span id="cb37-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">writeXStringSet</span>(fasta, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filepath =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta"</span>)</span>
<span id="cb37-26"></span>
<span id="cb37-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FASTA headers renamed and saved to lncRNA_renamed.fasta</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> lncRNA_renamed.fasta <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> </span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read renamed FASTA and original GTF</span></span>
<span id="cb39-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>)</span>
<span id="cb39-3">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb39-4"></span>
<span id="cb39-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract gene IDs from GTF</span></span>
<span id="cb39-6">gtf_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mcols</span>(gtf)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove quotes</span></span>
<span id="cb39-7"></span>
<span id="cb39-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract IDs from FASTA headers</span></span>
<span id="cb39-9">fasta_headers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)</span>
<span id="cb39-10">fasta_gene_ids <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Ptuh_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fasta_headers)</span>
<span id="cb39-11"></span>
<span id="cb39-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare</span></span>
<span id="cb39-13">all_match <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(fasta_gene_ids <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> gtf_gene_ids) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(gtf_gene_ids <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> fasta_gene_ids)</span>
<span id="cb39-14"></span>
<span id="cb39-15"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (all_match) {</span>
<span id="cb39-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"‚úÖ FASTA headers match gene_ids in GTF exactly.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-17">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb39-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"‚ùå Mismatch found between FASTA headers and GTF gene_ids.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-19"></span>
<span id="cb39-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Optional: show what's missing</span></span>
<span id="cb39-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">In FASTA but not GTF:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(fasta_gene_ids, gtf_gene_ids))</span>
<span id="cb39-23"></span>
<span id="cb39-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">In GTF but not FASTA:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb39-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setdiff</span>(gtf_gene_ids, fasta_gene_ids))</span>
<span id="cb39-26">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>‚úÖ FASTA headers match gene_ids in GTF exactly.</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read files</span></span>
<span id="cb41-2">fasta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readDNAStringSet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lncRNA_renamed.fasta"</span>)</span>
<span id="cb41-3">gtf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">import</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/deep-dive-expression/refs/heads/main/F-Ptuh/output/17-Ptuh-lncRNA/lncRNA.gtf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf"</span>)</span>
<span id="cb41-4"></span>
<span id="cb41-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean gene_id and extract relevant fields</span></span>
<span id="cb41-6">gtf_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(gtf)</span>
<span id="cb41-7">gtf_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'"'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>, gtf_df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gene_id)</span>
<span id="cb41-8">gtf_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gtf_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-9">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(seqnames, start, end, gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-10">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(gene_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-11">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gtf_length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(end <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span>)</span>
<span id="cb41-12"></span>
<span id="cb41-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract FASTA lengths</span></span>
<span id="cb41-14">fasta_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb41-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gene_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^Ptuh_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)),</span>
<span id="cb41-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta_length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">width</span>(fasta),</span>
<span id="cb41-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fasta_header =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(fasta)</span>
<span id="cb41-18">)</span>
<span id="cb41-19"></span>
<span id="cb41-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Join and compare</span></span>
<span id="cb41-21">merged <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(gtf_summary, fasta_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gene_id"</span>)</span>
<span id="cb41-22"></span>
<span id="cb41-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check consistency</span></span>
<span id="cb41-24">merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_match <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gtf_length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fasta_length</span>
<span id="cb41-25"></span>
<span id="cb41-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display a few examples</span></span>
<span id="cb41-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"üîç Sample GTF vs FASTA length comparison:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>üîç Sample GTF vs FASTA length comparison:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(merged[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta_header"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gtf_length"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fasta_length"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"length_match"</span>)]), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 4
  fasta_header    gtf_length fasta_length length_match
  &lt;chr&gt;                &lt;dbl&gt;        &lt;int&gt; &lt;lgl&gt;       
1 Ptuh_lncRNA_001        937          935 FALSE       
2 Ptuh_lncRNA_002        828          826 FALSE       
3 Ptuh_lncRNA_003        626          624 FALSE       
4 Ptuh_lncRNA_004      13587        13585 FALSE       
5 Ptuh_lncRNA_005       2805         2803 FALSE       
6 Ptuh_lncRNA_006        424          422 FALSE       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall match rate</span></span>
<span id="cb45-2">match_rate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(merged<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>length_match)</span>
<span id="cb45-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">‚úÖ Percent of exact matches: %.1f%%</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> match_rate))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
‚úÖ Percent of exact matches: 0.0%</code></pre>
</div>
</div>
<hr>
</section>
<section id="code" class="level1">
<h1>Code</h1>
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Global R options</span></span>
<span id="cb47-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">knitr::opts_chunk</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$set</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> = TRUE<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-3"></span>
<span id="cb47-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define key paths and tool directories</span></span>
<span id="cb47-5"> </span>
<span id="cb47-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../data/17-Ptuh-lncRNA"</span></span>
<span id="cb47-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"../output/17-Ptuh-lncRNA"</span></span>
<span id="cb47-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">THREADS</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"24"</span></span>
<span id="cb47-9">  </span>
<span id="cb47-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/Atumefaciens/20230519-E5_coral-fastqc-fastp-multiqc-RNAseq/P_meandrina/trimmed/"</span></span>
<span id="cb47-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq.gz"</span></span>
<span id="cb47-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://owl.fish.washington.edu/halfshell/genomic-databank/Pocillopora_meandrina_HIv1.assembly.fasta"</span></span>
<span id="cb47-13"></span>
<span id="cb47-14"></span>
<span id="cb47-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GTF_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/urol-e5/timeseries_molecular/d5f546705e3df40558eeaa5c18b122c79d2f4453/F-Ptua/data/Pocillopora_meandrina_HIv1.genes-validated.gtf"</span></span>
<span id="cb47-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFF_SOURCE</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/deep-dive-expression/F-Ptuh/data/Pocillopora_meandrina_HIv1.genes-validated.gff3"</span></span>
<span id="cb47-17"></span>
<span id="cb47-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFPATTERN</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'class_code "u"|class_code "x"|class_code "o"|class_code "i"'</span></span>
<span id="cb47-19"></span>
<span id="cb47-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#RAVEN</span></span>
<span id="cb47-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HISAT2_DIR &lt;- "/home/shared/hisat2-2.2.1/"</span></span>
<span id="cb47-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SAMTOOLS_DIR &lt;- "/home/shared/samtools-1.12/"</span></span>
<span id="cb47-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># STRINGTIE_DIR &lt;- "/home/shared/stringtie-2.2.1.Linux_x86_64"</span></span>
<span id="cb47-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GFFCOMPARE_DIR &lt;- "/home/shared/gffcompare-0.12.6.Linux_x86_64"</span></span>
<span id="cb47-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># BEDTOOLS_DIR &lt;- "/home/shared/bedtools2/bin"</span></span>
<span id="cb47-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPC2_DIR &lt;- "/home/shared/CPC2_standalone-1.0.1"</span></span>
<span id="cb47-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CONDA_PATH &lt;- "/opt/anaconda/anaconda3/bin/conda"</span></span>
<span id="cb47-28"></span>
<span id="cb47-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#KLONE</span></span>
<span id="cb47-30"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HISAT2_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-32"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">STRINGTIE_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-33"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs/gffcompare-0.12.6.Linux_x86_64/"</span></span>
<span id="cb47-34"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb47-35"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CPC2_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/srlab/programs/CPC2_standalone-1.0.1/bin/"</span></span>
<span id="cb47-36"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CONDA_PATH</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/mmfs1/gscratch/srlab/nextflow/bin/miniforge/bin/conda"</span></span>
<span id="cb47-37"></span>
<span id="cb47-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_FASTA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.fasta"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-39"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GTF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gtf"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-40"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GFF</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.gff"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-41"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_DIR</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fastq"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-42"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_INDEX</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>- file.path<span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"genome.index"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span>
<span id="cb47-43"></span>
<span id="cb47-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Export these as environment variables for bash chunks.</span></span>
<span id="cb47-45"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Sys.setenv</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span></span>
<span id="cb47-46">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">THREADS</span> = THREADS,</span>
<span id="cb47-47">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DATA_DIR</span> = DATA_DIR,</span>
<span id="cb47-48">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SOURCE</span> = FASTQ_SOURCE,</span>
<span id="cb47-49">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_SUFFIX</span> = FASTQ_SUFFIX,</span>
<span id="cb47-50">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">OUTPUT_DIR</span> = OUTPUT_DIR,</span>
<span id="cb47-51">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_SOURCE</span> = GENOME_SOURCE,</span>
<span id="cb47-52">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GTF_SOURCE</span> = GTF_SOURCE,</span>
<span id="cb47-53">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFF_SOURCE</span> = GFF_SOURCE,</span>
<span id="cb47-54">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HISAT2_DIR</span> = HISAT2_DIR,</span>
<span id="cb47-55">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SAMTOOLS_DIR</span> = SAMTOOLS_DIR,</span>
<span id="cb47-56">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">STRINGTIE_DIR</span> = STRINGTIE_DIR,</span>
<span id="cb47-57">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFCOMPARE_DIR</span> = GFFCOMPARE_DIR,</span>
<span id="cb47-58">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">BEDTOOLS_DIR</span> = BEDTOOLS_DIR,</span>
<span id="cb47-59">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CPC2_DIR</span> = CPC2_DIR,</span>
<span id="cb47-60">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">CONDA_PATH</span> = CONDA_PATH,</span>
<span id="cb47-61">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_FASTA</span> = GENOME_FASTA,</span>
<span id="cb47-62">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GTF</span> = GENOME_GTF,</span>
<span id="cb47-63">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_GFF</span> = GENOME_GFF,</span>
<span id="cb47-64">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">FASTQ_DIR</span> = FASTQ_DIR,</span>
<span id="cb47-65">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GENOME_INDEX</span> = GENOME_INDEX,</span>
<span id="cb47-66">  <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">GFFPATTERN</span> = GFFPATTERN</span>
<span id="cb47-67"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span></span></code></pre></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${DATA_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb48-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-nv</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-2">--no-directories <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-parent</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-3">-P <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb49-4">-A <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SOURCE}</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span></span></code></pre></div>
</div>
<pre><code>RNA-POC-47-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-47-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-48-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-48-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-50-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-50-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-53-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-53-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz
RNA-POC-57-S1-TP2_R1_001.fastp-trim.20230519.fastq.gz
RNA-POC-57-S1-TP2_R2_001.fastp-trim.20230519.fastq.gz</code></pre>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb52-1"></span>
<span id="cb52-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb53-1"></span>
<span id="cb53-2"></span>
<span id="cb53-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GTF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb54-1"></span>
<span id="cb54-2"></span>
<span id="cb54-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFF_SOURCE}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_fasta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gff</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output_gtf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb55-4"></span>
<span id="cb55-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">[[</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">||</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">==</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>html<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">]];</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">then</span></span>
<span id="cb55-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FAIL - FFS you downloaded a HTML not and genome feature file!"</span></span>
<span id="cb55-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span></span>
<span id="cb55-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_fasta</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gff</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output_gtf</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb55-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">fi</span></span></code></pre></div>
</div>
</section>
<section id="hisat" class="level1">
<h1>HISAT</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_exons.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span></span>
<span id="cb56-2"></span>
<span id="cb56-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2_extract_splice_sites.py"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GTF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb57-1"></span>
<span id="cb57-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2-build"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-4">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--exon</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/exon.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ss</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/splice_sites.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb57-8">  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/hisat2-build_stats.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Loop over every file ending in .fastq.gz that contains "_R2_"</span></span>
<span id="cb58-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r2 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${FASTQ_SUFFIX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb58-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the basename (filename without path)</span></span>
<span id="cb58-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb58-5">    </span>
<span id="cb58-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Derive a sample name by taking everything before "_R2_"</span></span>
<span id="cb58-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sample</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${base</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>_R2_<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-8">    </span>
<span id="cb58-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Construct the corresponding R1 filename by replacing "_R2_" with "_R1_"</span></span>
<span id="cb58-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">r1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${r2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_R2_</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>_R1_<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-11">    </span>
<span id="cb58-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the output SAM file name using the sample name</span></span>
<span id="cb58-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sam"</span></span>
<span id="cb58-14">    </span>
<span id="cb58-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Run hisat2 with the paired-end files</span></span>
<span id="cb58-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${HISAT2_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">hisat2"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-x</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_INDEX}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r1</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$r2</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb58-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-S</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb58-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
<section id="convert-sam-to-bam" class="level2">
<h2 class="anchored" data-anchor-id="convert-sam-to-bam">convert SAM to BAM</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> samfile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${sample}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.sam<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb59-2">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.bam"</span></span>
<span id="cb59-3">  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sorted_bamfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${samfile</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>.sam<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.sorted.bam"</span></span>
<span id="cb59-4">  </span>
<span id="cb59-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert SAM to BAM</span></span>
<span id="cb59-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> view <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-bS</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$samfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-7">  </span>
<span id="cb59-8">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort BAM</span></span>
<span id="cb59-9">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> sort <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-10">  </span>
<span id="cb59-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Index sorted BAM</span></span>
<span id="cb59-12">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> index <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-@</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$sorted_bamfile</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb59-13"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span></span></code></pre></div>
</div>
</section>
</section>
<section id="stringtie" class="level1">
<h1>StringTie</h1>
<p>StringTie uses the sorted BAM files to assemble transcripts for each sample, outputting them as GTF (Gene Transfer Format) files. And then merges all individual GTF assemblies into a single merged GTF file. This step extracts transcript information and merges GTFs from all samples‚Äìan important step in creating a canonical list of lncRNAs across all samples included in the pipeline.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">find</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*sorted.bam"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> 1 basename <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span> .sorted.bam <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xargs</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-I{}</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-4">-p <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${THREADS}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-5">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-6">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb60-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/{}.sorted.bam"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb62-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb63-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${STRINGTIE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stringtie"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-2">--merge <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-3">-G <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-4">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb63-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/"</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb64-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/stringtie_merged.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb65-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/stringtie_merged.gtf</span></code></pre></div>
</div>
<p>#GFFCOMPARE</p>
<p><img src="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_687474703a2f2f67616e6e65742e666973682e77617368696e67746f6e2e6564752f7365617368656c6c2f736e6170732f323032332d31312d30335f30392d3_2024-12-20_04-02-37.png" class="img-fluid"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb66-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFCOMPARE_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">gffcompare"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_GFF}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-3">-o <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb66-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/stringtie_merged.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb67-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-4</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb68-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>/gffcompare_merged<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb69-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb69-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb70-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$3 == "transcript" &amp;&amp; $1 !~ /^#/'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/gffcompare_merged.annotated.gtf"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb70-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-E</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GFFPATTERN}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb70-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'($5 - $4 &gt; 199) || ($4 - $5 &gt; 199)'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb71-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb72-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.gtf</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb73-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sort</span> ../output/17-Ptuh-lncRNA/lncRNA_candidates.gtf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uniq</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span></span></code></pre></div>
</div>
</section>
<section id="bedtools" class="level1">
<h1>Bedtools</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb74-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${BEDTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bedtools</span> getfasta <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-2">-fi <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${GENOME_FASTA}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-3">-bed <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.gtf"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-4">-fo <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb74-5">-name <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-split</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb75-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span>/lncRNA_candidates.fasta</span></code></pre></div>
</div>
<p>#CPC2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb76-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> https://github.com/gao-lab/CPC2_standalone/archive/refs/tags/v1.0.1.zip</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb77-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span> v1.0.1.zip</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb78-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/mmfs1/gscratch/srlab/nextflow/bin/miniforge/bin/conda</span> shell.bash hook<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb78-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate /mmfs1/gscratch/srlab/nextflow/bin/miniforge/envs/nextflow  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># replace with your actual env name</span></span>
<span id="cb78-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> /mmfs1/gscratch/scrubbed/sr320/github/deep-dive-expression/F-Ptuh/code/CPC2_standalone-1.0.1/bin/CPC2.py <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb78-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb78-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2"</span></span></code></pre></div>
</div>
<p>Filter</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb79-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$8 == "noncoding" {print $1}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb80-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span></span>
<span id="cb80-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/CPC2.txt"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb81-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb81-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span></code></pre></div>
</div>
<p>Subsetting fasta</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb82-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${SAMTOOLS_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">samtools"</span> faidx <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA_candidates.fasta"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb82-2">-r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb82-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb83-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-2</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span>
<span id="cb83-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.fasta"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb84-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define input and output file paths using the OUTPUT_DIR variable</span></span>
<span id="cb84-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/noncoding_transcripts_ids.txt"</span></span>
<span id="cb84-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">output</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span>
<span id="cb84-4"></span>
<span id="cb84-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process each line of the input file</span></span>
<span id="cb84-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">do</span></span>
<span id="cb84-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove "transcript::" from the line</span></span>
<span id="cb84-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${line</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">transcript::</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-9">    </span>
<span id="cb84-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the line by ':' to get the chromosome and position string</span></span>
<span id="cb84-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">chromosome</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pos</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$line</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-12">    </span>
<span id="cb84-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Split the position string by '-' to separate start and end positions</span></span>
<span id="cb84-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">IFS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">read</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">end</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt;&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pos</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-15">    </span>
<span id="cb84-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the start position to 0-based by subtracting 1</span></span>
<span id="cb84-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">start</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$((start</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">))</span></span>
<span id="cb84-18">    </span>
<span id="cb84-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Write the chromosome, updated start, and end positions to the output file (tab-separated)</span></span>
<span id="cb84-20">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">printf</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s\t%s\t%s\n"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$chromosome</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$start</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$end</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb84-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">done</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$input</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$output</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb85-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb86-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'BEGIN{OFS="\t"; count=1} {printf "%s\t.\tlncRNA\t%d\t%d\t.\t+\t.\tgene_id \"lncRNA_%03d\";\n", $1, $2, $3, count++;}'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.bed"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb86-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb87-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb87-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wc</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span></code></pre></div>
</div>
</section>
<section id="summary-table" class="level1">
<h1>Summary Table</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb88-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf_file</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">${OUTPUT_DIR}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/lncRNA.gtf"</span></span>
<span id="cb88-2"></span>
<span id="cb88-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">awk</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb88-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN {</span></span>
<span id="cb88-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries = 0;</span></span>
<span id="cb88-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    min_length = 1e9;</span></span>
<span id="cb88-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    max_length = 0;</span></span>
<span id="cb88-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length = 0;</span></span>
<span id="cb88-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"># Skip comment lines</span></span>
<span id="cb88-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/^#/ { next }</span></span>
<span id="cb88-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb88-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (NF &lt; 9) next;</span></span>
<span id="cb88-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    total_entries++;</span></span>
<span id="cb88-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    start = $4;</span></span>
<span id="cb88-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    end = $5;</span></span>
<span id="cb88-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    gene_length = end - start + 1;</span></span>
<span id="cb88-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &lt; min_length) min_length = gene_length;</span></span>
<span id="cb88-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (gene_length &gt; max_length) max_length = gene_length;</span></span>
<span id="cb88-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    sum_length += gene_length;</span></span>
<span id="cb88-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    feature[$3]++;</span></span>
<span id="cb88-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    chrom[$1]++;</span></span>
<span id="cb88-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    # Use two-argument match() and then extract the gene_id manually.</span></span>
<span id="cb88-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    if (match($9, /gene_id "[^"]+"/)) {</span></span>
<span id="cb88-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gene_str = substr($9, RSTART, RLENGTH);</span></span>
<span id="cb88-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        # Remove the "gene_id " prefix and the quotes.</span></span>
<span id="cb88-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/gene_id "/, "", gene_str);</span></span>
<span id="cb88-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        gsub(/"/, "", gene_str);</span></span>
<span id="cb88-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        genes[gene_str] = 1;</span></span>
<span id="cb88-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">END {</span></span>
<span id="cb88-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    avg_length = (total_entries &gt; 0) ? sum_length / total_entries : 0;</span></span>
<span id="cb88-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    unique_gene_count = 0;</span></span>
<span id="cb88-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (g in genes)</span></span>
<span id="cb88-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        unique_gene_count++;</span></span>
<span id="cb88-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Basic GTF File Statistics:";</span></span>
<span id="cb88-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "--------------------------";</span></span>
<span id="cb88-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Total entries:      " total_entries;</span></span>
<span id="cb88-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Unique genes:       " unique_gene_count;</span></span>
<span id="cb88-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Min gene length:    " min_length;</span></span>
<span id="cb88-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "Max gene length:    " max_length;</span></span>
<span id="cb88-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    printf("Average gene length: %.2f\n", avg_length);</span></span>
<span id="cb88-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nFeature counts:";</span></span>
<span id="cb88-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (f in feature) {</span></span>
<span id="cb88-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " f ": " feature[f];</span></span>
<span id="cb88-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    print "\nChromosome counts:";</span></span>
<span id="cb88-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    for (c in chrom) {</span></span>
<span id="cb88-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        print "  " c ": " chrom[c];</span></span>
<span id="cb88-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    }</span></span>
<span id="cb88-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb88-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$tf_file</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
<pre><code>Basic GTF File Statistics:
--------------------------
Total entries:      16153
Unique genes:       0
Min gene length:    203
Max gene length:    227016
Average gene length: 3125.62

Feature counts:
  lncRNA: 16153

Chromosome counts:
  Pocillopora_meandrina_HIv1___xfSc0000447: 7
  Pocillopora_meandrina_HIv1___xfSc0000094: 2
  Pocillopora_meandrina_HIv1___Sc0000041: 71
  Pocillopora_meandrina_HIv1___xfSc0000343: 7
  Pocillopora_meandrina_HIv1___xfSc0000004: 3
  Pocillopora_meandrina_HIv1___Sc0000011: 362
  Pocillopora_meandrina_HIv1___xfSc0000812: 1
  Pocillopora_meandrina_HIv1___xfSc0000081: 2
  Pocillopora_meandrina_HIv1___Sc0000032: 132
  Pocillopora_meandrina_HIv1___xpSc0001344: 1
  Pocillopora_meandrina_HIv1___xpSc0001331: 1
  Pocillopora_meandrina_HIv1___xfSc0001179: 1
  Pocillopora_meandrina_HIv1___xfSc0000284: 2
  Pocillopora_meandrina_HIv1___xfSc0000692: 3
  Pocillopora_meandrina_HIv1___xfSc0000029: 2
  Pocillopora_meandrina_HIv1___Sc0000052: 3
  Pocillopora_meandrina_HIv1___xfSc0000145: 2
  Pocillopora_meandrina_HIv1___Sc0000046: 28
  Pocillopora_meandrina_HIv1___xfSc0000948: 1
  Pocillopora_meandrina_HIv1___Sc0000025: 274
  Pocillopora_meandrina_HIv1___xfSc0000477: 2
  Pocillopora_meandrina_HIv1___Sc0000066: 1
  Pocillopora_meandrina_HIv1___Sc0000039: 96
  Pocillopora_meandrina_HIv1___xpSc0001280: 5
  Pocillopora_meandrina_HIv1___xfSc0001170: 1
  Pocillopora_meandrina_HIv1___xfSc0000212: 7
  Pocillopora_meandrina_HIv1___xfSc0000007: 36
  Pocillopora_meandrina_HIv1___Sc0000012: 457
  Pocillopora_meandrina_HIv1___xfSc0000974: 1
  Pocillopora_meandrina_HIv1___xfSc0000817: 1
  Pocillopora_meandrina_HIv1___xfSc0000570: 1
  Pocillopora_meandrina_HIv1___xfSc0000479: 2
  Pocillopora_meandrina_HIv1___xfSc0000237: 2
  Pocillopora_meandrina_HIv1___Sc0000068: 2
  Pocillopora_meandrina_HIv1___Sc0000037: 101
  Pocillopora_meandrina_HIv1___Sc0000003: 803
  Pocillopora_meandrina_HIv1___xfSc0000428: 4
  Pocillopora_meandrina_HIv1___xfSc0000059: 6
  Pocillopora_meandrina_HIv1___Sc0000057: 5
  Pocillopora_meandrina_HIv1___xfSc0000146: 5
  Pocillopora_meandrina_HIv1___Sc0000045: 52
  Pocillopora_meandrina_HIv1___Sc0000009: 729
  Pocillopora_meandrina_HIv1___xfSc0000952: 1
  Pocillopora_meandrina_HIv1___xfSc0000835: 2
  Pocillopora_meandrina_HIv1___xfSc0000000: 71
  Pocillopora_meandrina_HIv1___Sc0000015: 328
  Pocillopora_meandrina_HIv1___xfSc0000716: 1
  Pocillopora_meandrina_HIv1___Sc0000080: 2
  Pocillopora_meandrina_HIv1___xfSc0000616: 1
  Pocillopora_meandrina_HIv1___Sc0000034: 118
  Pocillopora_meandrina_HIv1___xpSc0001290: 1
  Pocillopora_meandrina_HIv1___xfSc0000527: 2
  Pocillopora_meandrina_HIv1___xfSc0000206: 6
  Pocillopora_meandrina_HIv1___Sc0000006: 561
  Pocillopora_meandrina_HIv1___xpSc0001273: 29
  Pocillopora_meandrina_HIv1___xfSc0000540: 4
  Pocillopora_meandrina_HIv1___Sc0000058: 5
  Pocillopora_meandrina_HIv1___Sc0000021: 290
  Pocillopora_meandrina_HIv1___xfSc0000859: 2
  Pocillopora_meandrina_HIv1___Sc0000040: 123
  Pocillopora_meandrina_HIv1___xfSc0000890: 1
  Pocillopora_meandrina_HIv1___xfSc0000836: 1
  Pocillopora_meandrina_HIv1___xfSc0000555: 2
  Pocillopora_meandrina_HIv1___xfSc0000003: 15
  Pocillopora_meandrina_HIv1___Sc0000016: 448
  Pocillopora_meandrina_HIv1___xfSc0000765: 5
  Pocillopora_meandrina_HIv1___Sc0000033: 112
  Pocillopora_meandrina_HIv1___Sc0000018: 348
  Pocillopora_meandrina_HIv1___xfSc0000415: 2
  Pocillopora_meandrina_HIv1___Sc0000053: 14
  Pocillopora_meandrina_HIv1___xfSc0000436: 4
  Pocillopora_meandrina_HIv1___xfSc0000205: 13
  Pocillopora_meandrina_HIv1___Sc0000070: 2
  Pocillopora_meandrina_HIv1___Sc0000049: 4
  Pocillopora_meandrina_HIv1___Sc0000005: 551
  Pocillopora_meandrina_HIv1___xpSc0001276: 1
  Pocillopora_meandrina_HIv1___Sc0000024: 245
  Pocillopora_meandrina_HIv1___Sc0000065: 2
  Pocillopora_meandrina_HIv1___xpSc0001281: 4
  Pocillopora_meandrina_HIv1___xfSc0000006: 13
  Pocillopora_meandrina_HIv1___Sc0000013: 555
  Pocillopora_meandrina_HIv1___xfSc0001237: 2
  Pocillopora_meandrina_HIv1___xfSc0000612: 2
  Pocillopora_meandrina_HIv1___xfSc0000168: 3
  Pocillopora_meandrina_HIv1___xfSc0000083: 2
  Pocillopora_meandrina_HIv1___Sc0000030: 198
  Pocillopora_meandrina_HIv1___Sc0000002: 725
  Pocillopora_meandrina_HIv1___xfSc0000175: 3
  Pocillopora_meandrina_HIv1___Sc0000054: 1
  Pocillopora_meandrina_HIv1___xfSc0000565: 2
  Pocillopora_meandrina_HIv1___Sc0000044: 51
  Pocillopora_meandrina_HIv1___Sc0000008: 538
  Pocillopora_meandrina_HIv1___Sc0000027: 291
  Pocillopora_meandrina_HIv1___xfSc0000840: 1
  Pocillopora_meandrina_HIv1___xfSc0000596: 2
  Pocillopora_meandrina_HIv1___Sc0000060: 1
  Pocillopora_meandrina_HIv1___xfSc0000763: 1
  Pocillopora_meandrina_HIv1___Sc0000035: 227
  Pocillopora_meandrina_HIv1___xfSc0000968: 2
  Pocillopora_meandrina_HIv1___Sc0000001: 883
  Pocillopora_meandrina_HIv1___xpSc0001355: 1
  Pocillopora_meandrina_HIv1___xfSc0000699: 2
  Pocillopora_meandrina_HIv1___xfSc0000655: 4
  Pocillopora_meandrina_HIv1___xfSc0000426: 7
  Pocillopora_meandrina_HIv1___Sc0000020: 294
  Pocillopora_meandrina_HIv1___xfSc0000621: 2
  Pocillopora_meandrina_HIv1___xfSc0000445: 2
  Pocillopora_meandrina_HIv1___xfSc0000074: 1
  Pocillopora_meandrina_HIv1___Sc0000043: 60
  Pocillopora_meandrina_HIv1___xfSc0000837: 1
  Pocillopora_meandrina_HIv1___xfSc0000288: 5
  Pocillopora_meandrina_HIv1___xfSc0000217: 5
  Pocillopora_meandrina_HIv1___xfSc0000002: 34
  Pocillopora_meandrina_HIv1___Sc0000017: 382
  Pocillopora_meandrina_HIv1___Sc0000019: 291
  Pocillopora_meandrina_HIv1___xfSc0000012: 7
  Pocillopora_meandrina_HIv1___Sc0000029: 178
  Pocillopora_meandrina_HIv1___xfSc0000886: 3
  Pocillopora_meandrina_HIv1___xfSc0000868: 3
  Pocillopora_meandrina_HIv1___xfSc0000824: 8
  Pocillopora_meandrina_HIv1___xfSc0000583: 1
  Pocillopora_meandrina_HIv1___Sc0000071: 2
  Pocillopora_meandrina_HIv1___Sc0000004: 652
  Pocillopora_meandrina_HIv1___xfSc0000704: 4
  Pocillopora_meandrina_HIv1___xfSc0000469: 3
  Pocillopora_meandrina_HIv1___xfSc0000223: 2
  Pocillopora_meandrina_HIv1___xfSc0000195: 1
  Pocillopora_meandrina_HIv1___xfSc0000021: 2
  Pocillopora_meandrina_HIv1___Sc0000023: 213
  Pocillopora_meandrina_HIv1___xfSc0000264: 3
  Pocillopora_meandrina_HIv1___Sc0000010: 615
  Pocillopora_meandrina_HIv1___xfSc0001122: 3
  Pocillopora_meandrina_HIv1___xfSc0000811: 1
  Pocillopora_meandrina_HIv1___Sc0000031: 185
  Pocillopora_meandrina_HIv1___xfSc0000788: 5
  Pocillopora_meandrina_HIv1___xfSc0000875: 1
  Pocillopora_meandrina_HIv1___xfSc0000488: 7
  Pocillopora_meandrina_HIv1___xfSc0000017: 2
  Pocillopora_meandrina_HIv1___Sc0000055: 12
  Pocillopora_meandrina_HIv1___xfSc0001011: 2
  Pocillopora_meandrina_HIv1___xfSc0000092: 6
  Pocillopora_meandrina_HIv1___Sc0000047: 22
  Pocillopora_meandrina_HIv1___xfSc0000482: 4
  Pocillopora_meandrina_HIv1___xfSc0000132: 4
  Pocillopora_meandrina_HIv1___xfSc0000024: 2
  Pocillopora_meandrina_HIv1___Sc0000026: 271
  Pocillopora_meandrina_HIv1___xfSc0000995: 1
  Pocillopora_meandrina_HIv1___Sc0000067: 2
  Pocillopora_meandrina_HIv1___Sc0000038: 93
  Pocillopora_meandrina_HIv1___xfSc0000642: 1
  Pocillopora_meandrina_HIv1___xfSc0000376: 1
  Pocillopora_meandrina_HIv1___Sc0000082: 3
  Pocillopora_meandrina_HIv1___xfSc0000975: 3
  Pocillopora_meandrina_HIv1___xfSc0000760: 2
  Pocillopora_meandrina_HIv1___Sc0000069: 1
  Pocillopora_meandrina_HIv1___Sc0000036: 124
  Pocillopora_meandrina_HIv1___xfSc0000275: 1
  Pocillopora_meandrina_HIv1___Sc0000000: 922
  Pocillopora_meandrina_HIv1___xfSc0000199: 2
  Pocillopora_meandrina_HIv1___xfSc0000058: 1
  Pocillopora_meandrina_HIv1___xfSc0000014: 1
  Pocillopora_meandrina_HIv1___xfSc0000725: 5
  Pocillopora_meandrina_HIv1___Sc0000042: 68
  Pocillopora_meandrina_HIv1___xfSc0000892: 1
  Pocillopora_meandrina_HIv1___xfSc0000001: 67
  Pocillopora_meandrina_HIv1___Sc0000014: 378
  Pocillopora_meandrina_HIv1___xfSc0000262: 3
  Pocillopora_meandrina_HIv1___xfSc0000228: 4
  Pocillopora_meandrina_HIv1___Sc0000051: 13
  Pocillopora_meandrina_HIv1___Sc0000028: 208
  Pocillopora_meandrina_HIv1___xfSc0000885: 5
  Pocillopora_meandrina_HIv1___xfSc0000272: 5
  Pocillopora_meandrina_HIv1___Sc0000007: 643
  Pocillopora_meandrina_HIv1___xfSc0000705: 1
  Pocillopora_meandrina_HIv1___Sc0000022: 231</code></pre>


<!-- -->

</section>

 ]]></description>
  <category>lncRNA</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/47-ffs/</guid>
  <pubDate>Sat, 21 Jun 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_deep-dive-expression__RStudio_Server_2025-06-21_17-48-43.png" medium="image" type="image/png"/>
</item>
<item>
  <title>ROL-PI Day three</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/46-ROLPI-d3/</link>
  <description><![CDATA[ 





<p>Day three. Looking for missing files.. working on slides</p>
<p>Narrowed down issue with missing ‚ÄúWGBS‚Äù files from Peve and Ptua to a possible error in wget Azenta named files.</p>
<p>Need to get full data sets for both species and run through Bismark.. and beyond..</p>


<!-- -->


 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/46-ROLPI-d3/</guid>
  <pubDate>Mon, 26 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_Assess_WGBS_data_sample_numbers_by_species__Issue_34__urol-e5timeseries_molecular_2025-05-26_12-43-24.png" medium="image" type="image/png"/>
</item>
<item>
  <title>ROL-PI Day two</title>
  <dc:creator>Steven Roberts</dc:creator>
  <link>https://sr320.github.io/tumbling-oysters/posts/45-ROLPI-d2/</link>
  <description><![CDATA[ 





<p>Day two. Much of time was spent on Epigenetic Simulation then moving on to POISE model.</p>
<p>Did some slide edits‚Ä¶</p>
<p>And coding to figure out what caused the lack of CpG loci in Apul (TLDR::one bad sample)</p>
<section id="trouble-shooting-apul" class="level1">
<h1>Trouble shooting Apul</h1>
<p>Went back to processed txt loci files (from 10x bedgraph).</p>
<p>Found that 225-T1 was much smaller in line counts and we tracked down multiQC on bismark and found very bad alignment.</p>
<p>To remedy, did merge as before.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#pull processed files from Gannet </span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Note: Unfortunately we can't use the `cache` feature to make this process more time efficient, as it doesn't support long vectors</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the base URL</span></span>
<span id="cb1-5">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://gannet.fish.washington.edu/seashell/bu-github/timeseries_molecular/D-Apul/output/15.5-Apul-bismark/"</span></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read the HTML page</span></span>
<span id="cb1-8">page <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html</span>(base_url)</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract links to files</span></span>
<span id="cb1-11">file_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> page <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_nodes</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for files ending in "processed.txt"</span></span>
<span id="cb1-16">processed_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> file_links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"processed</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.txt$"</span>, file_links)]</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create full URLs</span></span>
<span id="cb1-19">file_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, processed_files)</span>
<span id="cb1-20"></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to read a file from URL</span></span>
<span id="cb1-22">read_processed_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(url) {</span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_table</span>(url, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_types =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cols</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c"</span>))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read as character to avoid parsing issues</span></span>
<span id="cb1-24">}</span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import all processed files into a list</span></span>
<span id="cb1-27">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(file_urls, read_processed_file)</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Name the list elements by file name</span></span>
<span id="cb1-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> processed_files</span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of imported data</span></span>
<span id="cb1-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(processed_data)</span>
<span id="cb1-34"></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add a header row that has "CpG" for the first column and "sample" for the second column, which will be populated by the file name </span></span>
<span id="cb1-36"></span>
<span id="cb1-37">processed_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Map</span>(<span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df, filename) {</span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>, filename)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns</span></span>
<span id="cb1-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb1-40">}, processed_data, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(processed_data))  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use stored file names</span></span>
<span id="cb1-41"></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#merge files together by "CpG"</span></span>
<span id="cb1-43">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reduce</span>(processed_data, full_join, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CpG"</span>)</span>
<span id="cb1-44"></span>
<span id="cb1-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Print structure of final merged data</span></span>
<span id="cb1-46"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(merged_data)</span></code></pre></div>
</div>
<p>Then changed things up.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#remove 225-T1</span></span>
<span id="cb2-2"></span>
<span id="cb2-3">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data[, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(merged_data) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ACR-225-TP1_10x_processed.txt"</span>)]</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert all columns (except "CpG") to numeric</span></span>
<span id="cb3-2">merged_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> merged_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG, as.numeric)) \</span></code></pre></div>
</div>
<p>Only keep CpGs that have a non-na value in all samples.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na.omit</span>(merged_data)</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure it's formatted as a data frame</span></span>
<span id="cb4-4">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(filtered_wgbs)</span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Only keep the sample information in the column name. </span></span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*?)_.*$"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(filtered_wgbs))</span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set CpG IDs to rownames</span></span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames</span>(filtered_wgbs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>CpG</span>
<span id="cb4-9">filtered_wgbs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> filtered_wgbs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>CpG)</span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(merged_data)</span>
<span id="cb4-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(filtered_wgbs)</span></code></pre></div>
</div>
<p>We had 12,093,025 CpGs before filtering and have 96785 after filtering.</p>
<hr>
</section>
<section id="how-about-ptua" class="level1">
<h1>How about Ptua?</h1>
<p>First lets go back to processed txt loci file to see if there are any outliers.</p>
<p>Missing data downloads - https://github.com/urol-e5/timeseries_molecular/issues/34</p>


<!-- -->

</section>

 ]]></description>
  <category>methylation</category>
  <category>e5</category>
  <guid>https://sr320.github.io/tumbling-oysters/posts/45-ROLPI-d2/</guid>
  <pubDate>Sat, 24 May 2025 07:00:00 GMT</pubDate>
  <media:content url="http://gannet.fish.washington.edu/seashell/snaps/Monosnap_EpigeneticsSimulationMS_-_Online_LaTeX_Editor_Overleaf_2025-05-25_07-13-14.png" medium="image" type="image/png"/>
</item>
</channel>
</rss>
